// Module included in the following assemblies:
//
// * list of assemblies where this module is included
// ipv6-disconnected-server-setup.adoc

[id="ipv6-disconnected-setting-up-the-client-side-provisioning-node_{context}"]

= Setting up the client-side provisioning node

.Procedure

. Create `/etc/chrony.conf`. This node acts as a master server on the isolated network.
+
----
# cat > /etc/chrony.conf << EOF
server registry.kni7.cloud.lab.eng.bos.redhat.com iburst
driftfile /var/lib/chrony/drift
logdir /var/log/chrony
log measurements statistics tracking
keyfile /etc/chrony.keys
commandkey 24
local stratum 10
initstepslew 20 registry.kni7.cloud.lab.eng.bos.redhat.com
logchange 0.5
allow fd35:919d:4042:2::1000
EOF
----

. Start the service.
+
----
# systemctl enable --now chrony
----

. Sync the status. After raising the client daemon, it will take some time to get in sync.
+
----
# timedatectl
                             Local time: Fri 2020-02-07 06:01:18 EST
                    Universal time: Fri 2020-02-07 11:01:18 UTC
                            RTC time: Fri 2020-02-07 11:07:01
                           Time zone: America/New_York (EST, -0500)
System clock synchronized: no
                          NTP service: active
                 RTC in local TZ: no

# chronyc tracking
Reference ID    : 0B8143DD (fd35:919d:4042:2::1000)
Stratum         : 9
Ref time (UTC)  : Fri Feb 07 11:19:51 2020
System time     : 0.000000970 seconds slow of NTP time
Last offset     : -0.000003914 seconds
RMS offset      : 0.000003584 seconds
Frequency       : 3.777 ppm slow
Residual freq   : -0.001 ppm
Skew            : 0.026 ppm
Root delay      : 0.000046802 seconds
Root dispersion : 0.000088894 seconds
Update interval : 64.1 seconds
Leap status     : Normal

# chronyc sources
210 Number of sources = 1
MS Name/IP address         Stratum Poll Reach LastRx Last sample
===============================================================================
^* fd35:919d:4042:2::1000        8   7   377   112  -6938ns[  -11us] +/-   23us
----

. `System clock synchronized: yes` indicates the time is synchronized.
+
----
# timedatectl
                           Local time: Fri 2020-02-07 06:06:00 EST
                   Universal time: Fri 2020-02-07 11:06:00 UTC
                            RTC time: Fri 2020-02-07 11:11:43
                           Time zone: America/New_York (EST, -0500)
System clock synchronized: yes
               NTP service: active
             RTC in local TZ: no
----
