/ Module included in the following assemblies:
//
// * list of assemblies where this module is included
// ipv6-disconnected-server-setup.adoc

[id="ipv6-disconnected-serving-qcow-images_{context}"]

= Serving qcow images

.Procedure

. Copy the qcow images to a static location.
+
----
# export COMMIT_ID=$(openshift-baremetal-install version | grep '^built from commit' | awk
'{print $4}')

# export RHCOS_OPENSTACK_URI=$(curl -s -S https://raw.githubusercontent.com/openshift/installer/$COMMIT_ID/data/data/rhcos.json  | jq -r
.images.openstack.path)

# export RHCOS_QEMU_URI=$(curl -s -S https://raw.githubusercontent.com/openshift/installer/$COMMIT_ID/data/data/rhcos.json  | jq -r
.images.qemu.path)

# export RHCOS_PATH=$(curl -s -S https://raw.githubusercontent.com/openshift/installer/$COMMIT_ID/data/data/rhcos.json | jq -r
.baseURI)

# export RHCOS_QEMU_SHA_UNCOMPRESSED=$(curl -s -S https://raw.githubusercontent.com/openshift/installer/$COMMIT_ID/data/data/rhcos.json  | jq -r
'.images.qemu["uncompressed-sha256"]')

# export RHCOS_OPENSTACK_SHA_COMPRESSED=$(curl -s -S https://raw.githubusercontent.com/openshift/installer/$COMMIT_ID/data/data/rhcos.json  | jq -r
'.images.openstack.sha256')

# curl -L -o /usr/share/nginx/html/$RHCOS_QEMU_URI
${RHCOS_PATH}${RHCOS_QEMU_URI}

# curl -L -o /usr/share/nginx/html/$RHCOS_OPENSTACK_URI
${RHCOS_PATH}${RHCOS_OPENSTACK_URI}
----

. Start the service.
+
----
# systemctl restart --now nginx
----

. Verify the http service.
+
----
# curl -I -s http://jump-reg-kni7.cloud.lab.eng.bos.redhat.com | grep HTTP
HTTP/1.1 200 OK


# curl -I -s http://jump-reg-kni7.cloud.lab.eng.bos.redhat.com/$RHCOS_OPENSTACK_URI | grep HTTP
HTTP/1.1 200 OK

# curl -I -s http://jump-reg-kni7.cloud.lab.eng.bos.redhat.com/$RHCOS_QEMU_URI | grep HTTP
HTTP/1.1 200 OK
----
