[id="installing-rhv-customizations"]
= Installing a cluster on {rh-virtualization} with customizations
include::modules/common-attributes.adoc[]
:context: installing-rhv-customizations

toc::[]

In {product-title} version {product-version}, you can customize and install a cluster on {rh-virtualization-first} using “installer-provisioned infrastructure.”

To install a customized cluster, you prepare the environment and perform the following steps:

. Create an installation configuration file, the `install-config.yaml` file, by running the installation program and answering its prompts.
. Inspect and modify parameters in the `install-config.yaml` file.
. Make a working copy of the `install-config.yaml` file.
. Run the installation program with a copy of the `install-config.yaml` file.

When you complete these steps, the installation program uses the information in the `install-config.yaml` file to create the {product-title} cluster.

When the installer creates the cluster, it also deletes the `install-config.yaml` file. If you do not provide a working copy of this file, you must recreate the file the next time you want to run the installer.

To learn more, see
xref:../../architecture/architecture-installation.adoc#architecture-installation[this overview of the installation and update processes].

For an alternative to installing a customized cluster, see xref:../../installing/installing_rhv/installing-rhv-default.adoc#installing-rhv-default[Installing a default cluster].

[NOTE]
====
* Replace all example values with real ones.
* This installer is available for Linux and macOS only.
====

include::modules/cluster-entitlements.adoc[leveloffset=+1]
// TBD I recommend moving the contents of /modules/cluster-entitlements.adoc from the installation topics to /architecture/architecture-installation.adoc
include::modules/installation-rhv-verifying-the-rhv-environment.adoc[leveloffset=+1]
include::modules/installation-rhv-preparing-the-network-environment.adoc[leveloffset=+1]
include::modules/installation-obtaining-installer.adoc[leveloffset=+1]
include::modules/ssh-agent-using.adoc[leveloffset=+1]
include::modules/installation-rhv-setting-up-ca-certificate.adoc[leveloffset=+1]
// include::modules/installation-initializing.adoc[leveloffset=+1] TBD Sorry this doesn't work for RHV. Would require elaborate customization. Using the following file instead:
include::modules/installing-rhv-create-install-config-file.adoc[leveloffset=+1]
include::modules/installing-rhv-inspect-and-modify-params-in-install-config.adoc[leveloffset=+1]
include::modules/installing-rhv-customizing-the-virtual-machine-template.adoc[leveloffset=+1]
include::modules/installing-rhv-copying-install-config-and-creating-cluster.adoc[leveloffset=+1]


NOTE: At this point, the installation program begins creating the cluster.

include::modules/installing-rhv-accessing-the-ocp-web-console.adoc[leveloffset=+1]

NOTE: You have finished installing a custom {product-title} cluster on {rh-virtualization}.

include::modules/installing-rhv-post-installation-tasks.adoc[leveloffset=+1]

.Troubleshooting
If the installation fails, the installation program times out and displays an error message. To learn more, see
xref:../../installing/installing_rhv/installing-rhv-troubleshooting.adoc#installing-rhv-troubleshooting[Troubleshooting Installation Problems].
