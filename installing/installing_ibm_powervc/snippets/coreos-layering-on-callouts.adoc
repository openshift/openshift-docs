// Text snippet included in the following modules:
//
// * modules/coreos-layering-install-time
// * modules/

:_mod-docs-content-type: SNIPPET

. Create a YAML file for the `MachineOSConfig` object similar to the following:
+
[source,yaml]
----
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineOSConfig
metadata:
  name: worker
  annotations:
    machineconfiguration.openshift.io/pre-built-image: "quay.io/myorg/custom-rhcos@sha256:abc123..."
spec:
  machineConfigPool:
    name: worker
  imageBuilder:
    imageBuilderType: Job
  renderedImagePushSpec: quay.io/your-registry/layered-rhcos:latest
  renderedImagePushSecret:
    name: push-secret
  containerFile:
  - containerfileArch: NoArch
    content: |
      FROM configs AS final
      RUN rpm-ostree install cowsay && \
        ostree container commit
----
where:
+
`metadata.name`:: Specifies a name for the `MachineOSConfig` object. The name must match the name of the associated machine config pool.

`metadata.annotations.machineconfiguration.openshift.io/pre-built-image`:: Specifies the digested image pull spec of your custom layered image.

`spec.machineConfigPool`:: Specifies the name of the machine config pool associated with the nodes where you want to deploy the custom layered image.

`spec.imageBuilder.imageBuilderType`:: Specifies the name of the image builder to use. This must be `Job`, which is a reference to the `job` object that is managing the image build.

`spec.renderedImagePushSpec`:: Specifies an image registry to push any updated custom layered images to, if needed, after the installation process is complete. This can be any registry that your cluster has access to in the `host[:port][/namespace]/name` or `svc_name.namespace.svc[:port]/repository/name:<tag>` format. You can specify a mirror registry if you cluster is properly configured to use a mirror registry.

`spec.renderedImagePushSecret.name`:: Specifies the name of the push secret needed by the MCO to push the updated custom layered image to that registry.

`spec.containerFile`:: Specifies the containerFile that you used to create the custom layered image.
