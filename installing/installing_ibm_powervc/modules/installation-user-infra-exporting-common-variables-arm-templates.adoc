// Module included in the following assemblies:
//
// * installing/installing_azure/installing-azure-user-infra.adoc
// * installing/installing_azure_stack_hub/installing-azure-stack-hub-user-infra.adoc
// * installing/installing_azure/installing-restricted-networks-azure-user-provisioned.adoc

ifeval::["{context}" == "installing-azure-user-infra"]
:cp: Azure
endif::[]
ifeval::["{context}" == "installing-azure-stack-hub-user-infra"]
:cp: Azure Stack Hub
:ash:
endif::[]
ifeval::["{context}" == "installing-restricted-networks-azure-user-provisioned"]
:cp: Azure
endif::[]

:_mod-docs-content-type: PROCEDURE
[id="installation-user-infra-exporting-common-variables-arm-templates_{context}"]
= Exporting common variables for ARM templates

You must export a common set of variables that are used with the provided Azure Resource Manager (ARM) templates used to assist in completing a user-provided infrastructure install on Microsoft {cp}.

[NOTE]
====
Specific ARM templates can also require additional exported variables, which are detailed in their related procedures.
====

.Prerequisites

* Obtain the {product-title} installation program and the pull secret for your cluster.

.Procedure

. Export common variables found in the `install-config.yaml` to be used by the provided ARM templates:
+
[source,terminal]
----
$ export CLUSTER_NAME=<cluster_name>
----
* `<cluster_name>`: The value of the `.metadata.name` attribute from the `install-config.yaml` file.
+
[source,terminal]
----
$ export AZURE_REGION=<azure_region>
----
ifndef::ash[]
* `<azure_region>`: The region to deploy the cluster into, for example `centralus`. This is the value of the `.platform.azure.region` attribute from the `install-config.yaml` file.
endif::ash[]
ifdef::ash[]
* `<azure_region>`: The region to deploy the cluster into. This is the value of the `.platform.azure.region` attribute from the `install-config.yaml` file.
endif::ash[]
+
[source,terminal]
----
$ export SSH_KEY=<ssh_key>
----
* `<ssh_key>`: The SSH RSA public key file as a string. You must enclose the SSH key in quotes since it contains spaces. This is the value of the `.sshKey` attribute from the `install-config.yaml` file.
+
[source,terminal]
----
$ export BASE_DOMAIN=<base_domain>
----
ifndef::ash[]
* `<base_domain>`: The base domain to deploy the cluster to. The base domain corresponds to the public DNS zone that you created for your cluster. This is the value of the `.baseDomain` attribute from the `install-config.yaml` file.
endif::ash[]
ifdef::ash[]
* `<base_domain>`: The base domain to deploy the cluster to. The base domain corresponds to the DNS zone that you created for your cluster. This is the value of the `.baseDomain` attribute from the `install-config.yaml` file.
endif::ash[]
+
[source,terminal]
----
$ export BASE_DOMAIN_RESOURCE_GROUP=<base_domain_resource_group>
----
ifndef::ash[]
* `<base_domain_resource_group>`: The resource group where the public DNS zone exists. This is the value of the `.platform.azure.baseDomainResourceGroupName` attribute from the `install-config.yaml` file.
endif::ash[]
ifdef::ash[]
* `<base_domain_resource_group>`: The resource group where the DNS zone exists. This is the value of the `.platform.azure.baseDomainResourceGroupName` attribute from the `install-config.yaml` file.
endif::ash[]
+
For example:
+
[source,terminal]
----
$ export CLUSTER_NAME=test-cluster
----
+
[source,terminal]
----
$ export AZURE_REGION=centralus
----
+
[source,terminal]
----
$ export SSH_KEY="ssh-rsa xxx/xxx/xxx= user@email.com"
----
+
[source,terminal]
----
$ export BASE_DOMAIN=example.com
----
+
[source,terminal]
----
$ export BASE_DOMAIN_RESOURCE_GROUP=ocp-cluster
----

. Export the kubeadmin credentials:
+
[source,terminal]
----
$ export KUBECONFIG=<installation_directory>/auth/kubeconfig
----
* `<installation_directory>`: Specify the path to the directory that you stored the installation files in.

ifeval::["{context}" == "installing-azure-user-infra"]
:!cp:
endif::[]
ifeval::["{context}" == "installing-azure-stack-hub-user-infra"]
:!cp:
:!ash:
endif::[]
ifeval::["{context}" == "installing-restricted-networks-azure-user-provisioned"]
:!cp:
endif::[]
