
:_mod-docs-content-type: PROCEDURE
// Module included in the following assemblies:
//
// * backup_and_restore/application_backup_and_restore/installing/installing-oadp-aws.adoc


[id="oadp-configuring-node-agent-load-concurrency_{context}"]
= Configuring node agent load concurrency

[role="_abstract"]
You can control the maximum number of node agent operations that can run simultaneously on each node within your cluster.

You can configure it using one of the following fields of the Data Protection Application (DPA):

* `globalConfig`: Defines a default concurrency limit for the node agent across all nodes.
* `perNodeConfig`: Specifies different concurrency limits for specific nodes based on `nodeSelector` labels. This provides flexibility for environments where certain nodes might have different resource capacities or roles.


.Prerequisites
* You must be logged in as a user with `cluster-admin` privileges.


.Procedure

. If you want to use load concurrency for specific nodes, add labels to those nodes:
+
[source,terminal]
----
$ oc label node/<node_name> label.io/instance-type='large'
----

. Configure the load concurrency fields for your DPA instance:
+
[source,yaml]
----
  configuration:
    nodeAgent:
      enable: true
      uploaderType: kopia
      loadConcurrency:
        globalConfig: 1
        perNodeConfig:
        - nodeSelector:
              matchLabels:
                 label.io/instance-type: large
          number: 3
----
+
where:
+
`globalConfig`:: Specifies the global concurrent number. The default value is 1, which means there is no concurrency and only one load is allowed. The `globalConfig` value does not have a limit.
`label.io/instance-type`:: Specifies the label for per-node concurrency.
`number`:: Specifies the per-node concurrent number. You can specify many per-node concurrent numbers, for example, based on the instance type and size. The range of per-node concurrent number is the same as the global concurrent number. If the configuration file contains a per-node concurrent number and a global concurrent number, the per-node concurrent number takes precedence.
