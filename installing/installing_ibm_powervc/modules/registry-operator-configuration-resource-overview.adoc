// Module included in the following assemblies:
//
// * openshift_images/configuring-registry-operator.adoc
// * registry/configuring-registry-operator.adoc

:_mod-docs-content-type: REFERENCE
[id="registry-operator-configuration-resource-overview_{context}"]
= Image Registry Operator configuration parameters

[role="_abstract"]
You can configure the Image Registry Operator using the `configs.imageregistry.operator.openshift.io` resource.
The resource provides parameters for managing registry state, storage, logging, routing, and deployment settings.

[cols="3a,8a",options="header"]
|===
|Parameter |Description

|`managementState`
|`Managed`: The Operator updates the registry as configuration resources
are updated.

`Unmanaged`: The Operator ignores changes to the configuration resources.

`Removed`: The Operator removes the registry instance and tear down any
storage that the Operator provisioned.

|`logLevel`
|Sets `logLevel` of the registry instance. Defaults to  `Normal`.

The following values for `logLevel` are supported:

* `Normal`
* `Debug`
* `Trace`
* `TraceAll`

|`httpSecret`
|Value needed by the registry to secure uploads, generated by default.

| `operatorLogLevel`
| The `operatorLogLevel` configuration parameter provides intent-based logging for the Operator itself and a simple way to manage coarse-grained logging choices that Operators must interpret for themselves. This configuration parameter defaults to `Normal`. It does not provide fine-grained control.

The following values for `operatorLogLevel` are supported:

* `Normal`
* `Debug`
* `Trace`
* `TraceAll`

|`proxy`
|Defines the Proxy to be used when calling master API
and upstream registries.

|`affinity`
|You can use the `affinity` parameter to configure pod scheduling preferences and constraints for Image Registry Operator pods.

Affinity settings can use the `podAffinity` or `podAntiAffinity` spec. Both options can use either `preferredDuringSchedulingIgnoredDuringExecution` rules or `requiredDuringSchedulingIgnoredDuringExecution` rules.

|`storage`
|`Storagetype`: Details for configuring registry storage, for example S3 bucket
coordinates. Normally configured by default.

|`readOnly`
|Indicates whether the registry instance should reject attempts to push new images or delete existing ones.

|`requests`
|API Request Limit details. Controls how many parallel requests a given registry
instance will handle before queuing additional requests.

|`defaultRoute`
|Determines whether or not an external route is defined using the default
hostname. If enabled, the route uses re-encrypt encryption. Defaults to `false`.

|`routes`
|Array of additional routes to create. You provide the hostname and certificate
for the route.

|`rolloutStrategy`
|Defines rollout strategy for the image registry deployment. Defaults to `RollingUpdate`.

|`replicas`
|Replica count for the registry.

|`disableRedirect`
| Controls whether to route all data through the registry, rather than redirecting to the back end. Defaults to `false`.

|`spec.storage.managementState`

a|
ifndef::openshift-dedicated,openshift-rosa[]
The Image Registry Operator sets the `spec.storage.managementState` parameter to `Managed` on new installations or upgrades of clusters using installer-provisioned infrastructure on AWS or Azure.
endif::openshift-dedicated,openshift-rosa[]

ifdef::openshift-dedicated,openshift-rosa[]
The Image Registry Operator sets the `spec.storage.managementState` parameter to `Managed` on new installations or upgrades of clusters on AWS.
endif::openshift-dedicated,openshift-rosa[]

* `Managed`: Determines that the Image Registry Operator manages underlying storage. If the Image Registry Operator's `managementState` is set to `Removed`, then the storage is deleted.
** If the `managementState` is set to `Managed`, the Image Registry Operator attempts to apply some default configuration on the underlying storage unit. For example, if set to `Managed`, the Operator tries to enable encryption on the S3 bucket before making it available to the registry. If you do not want the default settings to be applied on the storage you are providing, make sure the `managementState` is set to `Unmanaged`.
* `Unmanaged`: Determines that the Image Registry Operator ignores the storage settings. If the Image Registry Operator's `managementState` is set to `Removed`, then the storage is not deleted. If you provided an underlying storage unit configuration, such as a bucket or container name, and the `spec.storage.managementState` is not yet set to any value, then the Image Registry Operator configures it to `Unmanaged`.

|===
