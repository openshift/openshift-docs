// Module included in the following assemblies:
//
// * observability/otel/otel-collector/otel-collector-receivers.adoc

:_mod-docs-content-type: REFERENCE
[id="otel-receivers-kubeletstats-receiver_{context}"]
= Kubelet Stats Receiver

[role="_abstract"]
The Kubelet Stats Receiver extracts metrics related to nodes, pods, containers, and volumes from the kubelet's API server. These metrics are then channeled through the metrics-processing pipeline for additional analysis.

.OpenTelemetry Collector custom resource with an enabled Kubelet Stats Receiver
[source,yaml]
----
# ...
  config:
    receivers:
      kubeletstats:
        collection_interval: 20s
        auth_type: "serviceAccount"
        endpoint: "https://${env:K8S_NODE_NAME}:10250"
        insecure_skip_verify: true
    service:
      pipelines:
        metrics:
          receivers: [kubeletstats]
  env:
    - name: K8S_NODE_NAME # <1>
      valueFrom:
        fieldRef:
          fieldPath: spec.nodeName
# ...
----
<1> Sets the `K8S_NODE_NAME` to authenticate to the API.

The Kubelet Stats Receiver requires additional permissions for the service account used for running the OpenTelemetry Collector.

.Permissions required by the service account
[source,yaml]
----
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: otel-collector
rules:
  - apiGroups: ['']
    resources: ['nodes/stats']
    verbs: ['get', 'watch', 'list']
  - apiGroups: [""]
    resources: ["nodes/proxy"] # <1>
    verbs: ["get"]
# ...
----
<1> The permissions required when using the `extra_metadata_labels` or `request_utilization` or `limit_utilization` metrics.
