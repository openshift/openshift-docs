// Module included in the following assemblies:
//
// * backup_and_restore/application_backup_and_restore/installing/configuring-backup-restore-pvc-datamover.adoc          

:_mod-docs-content-type: PROCEDURE
[id="configuring-backup-pvc_{context}"]
= Configuring a  backup PVC for a Data Mover backup

[role="_abstract"]
Configure backup persistent volume claim (PVC) settings in the `DataProtectionApplication` (DPA) to optimize Data Mover backup performance for different storage classes. The feature gives you read-only access modes for faster data movement.

.Prerequisites

* You have installed the {oadp-short} Operator.

.Procedure

. Configure the `nodeAgent.backupPVC` section in the DPA as shown in the following example:
+
.Example Data Protection Application
[source,yaml]
----
apiVersion: oadp.openshift.io/v1alpha1
kind: DataProtectionApplication
metadata:
  name: ts-dpa
  namespace: openshift-adp
spec:
  backupLocations:
  - velero:
      credential:
        key: cloud
        name: cloud-credentials-gcp
      default: true
      objectStorage:
        bucket: oadp...2jw
        prefix: velero
      provider: gcp
  configuration:
    nodeAgent:
      enable: true
      uploaderType: kopia
      backupPVC:
        storage-class-1:
          readOnly: true
          spcNoRelabeling: true
          storageClass: gp3-csi
        storage-class-2:
          readOnly: false
          spcNoRelabeling: false
          storageClass: gp3-csi
    velero:
      defaultPlugins:
      - gcp
      - openshift
      - csi
----
+
where:
+
`backupPVC`:: Specifies the `backupPVC` section. In this example, the `backupPVC` section has configurations for two storage classes, `storage-class-1` and `storage-class-2`.
`readOnly`:: Specifies that the `backupPVC` for `storage-class-1` is configured as `readOnly`.
`spcNoRelabeling`:: Specifies that the `spcNoRelabeling` field is set to `true` because the `backupPVC` for `storage-class-1` is `readOnly`.

. Create a `Backup` custom resource by using the following configuration:
+
.Example Backup
[source,yaml]
----
apiVersion: velero.io/v1
kind: Backup
metadata:
  name: test-backup
  namespace: openshift-adp
spec:
  includedNamespaces:
  - <application_namespace>
  snapshotMoveData: true
----
+
`snapshotMoveData`:: Set to `true` for a Data Mover backup.

.Verification

* Verify that the backup PVCs are created as read-only (`ROX`) by running the following command:
+
.Example command
[source,terminal]
----
$ oc get pvc -n openshift-adp -w
----
+
[source,terminal]
----
test-backup1-l..d   Bound   pvc-1298.....22f8   2Gi        ROX            standard-csi   <unset>                 37s
test-backup1-l..d   Bound   pvc-1298....022f8   2Gi        ROX            standard-csi   <unset>                 37s
----