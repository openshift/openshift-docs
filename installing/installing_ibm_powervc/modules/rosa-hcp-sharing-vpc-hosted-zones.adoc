// Module included in the following assemblies:
//
// * networking/rosa-hcp-shared-vpc-config.adoc
:_mod-docs-content-type: PROCEDURE
[id="rosa-hcp-sharing-vpc-hosted-zones_{context}"]
= Step Three - VPC Owner: Updating the shared VPC role and creating hosted zones

After the *Cluster Creator* provides the DNS domain and the IAM roles, create two hosted zones and update the trust policy on the IAM roles that were created for sharing the VPC.

[NOTE]
====
The hosted zones can be created in either the centrally-managed VPC account or in the workload account.
====

image::522-shared-vpc-step-3.png[]

*{sp}The hosted zones can be created in either the centrally-managed VPC account or in the workload account in which the cluster is deployed.

.Prerequisites

* You have the full domain name from the *Cluster Creator*.
* You have the _Ingress Operator Cloud Credentials_ role's ARN from the *Cluster Creator*.
* You have the _Installer_ role's ARN from the *Cluster Creator*.
* You have the _Control plane Operator Cloud Credentials_ role's ARN from the *Cluster Creator*.

include::snippets/rosa-long-cluster-name.adoc[]

.Procedure

. In the link:https://aws.amazon.com/ram/[Resource Access Manager of the AWS console], create a resource share that shares the previously created VPC's public and private subnets with the *Cluster Creator's* AWS account ID.

. Update the `Route 53 role` and add the _Installer_ and _Ingress Operator Cloud Credentials_ roles to the principal section of the trust policy.
+
[source,terminal]
----
{
  "Version": "2012-10-17",
  "Statement": [
    {
	  "Sid": "Statement1",
	  "Effect": "Allow",
	  "Principal": {
	  	"AWS": [
          "arn:aws:iam::<Cluster-Creator's-AWS-Account-ID>:role/<prefix>-ingress-operator-cloud-credentials",
          "arn:aws:iam::<Cluster-Creator's-AWS-Account-ID>:role/<prefix>-hcp-Installer-Role",
          "arn:aws:iam::<Cluster-Creator's-AWS-Account-ID>:role/<prefix>-control-plane-operator-cloud-credentials"
        ]
	  },
	  "Action": "sts:AssumeRole"
	}
  ]
}
----

. Update the `VPC endpoint role` and add the _Installer_ and _Ingress Operator Cloud Credentials_ roles to the principal section of the trust policy.
+
[source,terminal]
----
{
  "Version": "2012-10-17",
  "Statement": [
    {
	  "Sid": "Statement1",
	  "Effect": "Allow",
	  "Principal": {
	  	"AWS": [
          "arn:aws:iam::<Cluster-Creator's-AWS-Account-ID>:role/<prefix>-hcp-Installer-Role",
          "arn:aws:iam::<Cluster-Creator's-AWS-Account-ID>:role/<prefix>-control-plane-operator-cloud-credentials"
        ]
	  },
	  "Action": "sts:AssumeRole"
	}
  ]
}
----

. Create a private hosted zone in the link:https://us-east-1.console.aws.amazon.com/route53/v2/[Route 53 section of the AWS console]. In the hosted zone configuration, the domain name is `rosa.<cluster-name>.<base-domain>`. The private hosted zone must be associated with the network owner's VPC.
. Create a local hosted zone in the link:https://us-east-1.console.aws.amazon.com/route53/v2/[Route 53 section of the AWS console]. In the hosted zone configuration, the domain name is `<cluster-name>.hypershift.local`. The local hosted zone must be associated with the network owner's VPC.
. After the hosted zones are created and associated with the network owner's VPC, provide the following to the *Cluster Creator* to continue configuration:
* Hosted zone IDs
* AWS region
* Subnet IDs