= Routes
{product-author}
{product-version}
:data-uri:
:icons:
:experimental:
:toc: macro
:toc-title:

toc::[]

== Overview

An OpenShift link:../architecture/core_concepts/routes.html[route] exposes a
link:../architecture/core_concepts/pods_and_services.html#services[service] at a
host name, like _www.example.com_, so that external clients can reach it by
name.

DNS resolution for a host name is handled separately from routing;
your administrator may have configured a cloud domain that will always
correctly resolve to the OpenShift router, or if using an unrelated
host name you may need to modify its DNS records independently to resolve
to the router.

[[creating-routes]]

== Creating Routes

Tooling for creating routes is developing. In the web console, they are
displayed but there is not yet a method to create them. Using the CLI, you
can create both unsecured and secured routes. In the following example, an
unsecured route will be created:

----
$ oc expose svc/frontend --hostname=www.example.com
----

The new route will inherit the name from the service unless you specify one
using the --name flag.

.YAML definition of the unsecured route created above
====
[source,yaml]
----
apiVersion: v1
kind: Route
metadata:
  name: frontend
spec:
  host: www.example.com
  to:
    kind: Service
    name: frontend
----
====

Unsecured routes are the default configuration, and are therefore the simplest
to set up. However, secured routes offer security for connections to remain
private. To create a secured HTTPS route encrypted with a key and certificate
(PEM-format files which you must generate and sign separately), you can use
the `create route` command and optionally provide certificates and a key. 
For more information on secured routes, see link:https://docs.openshift.org/latest/architecture/core_concepts/routes.html#secured-routes[here].

[NOTE]
====
link:https://en.wikipedia.org/wiki/Transport_Layer_Security[TLS] is the
replacement of SSL for HTTPS and other encrypted protocols.
====

----
$ oc create route edge --service=frontend --cert=${MASTER_CONFIG_DIR}/ca.crt \
                        --key=${MASTER_CONFIG_DIR}/ca.key \
                        --ca-cert=${MASTER_CONFIG_DIR}/ca.crt \
                        --hostname=www.example.com
----

.YAML definition of the secured route created above
====
[source,yaml]
----
apiVersion: v1
kind: Route
metadata:
  name: frontend
spec:
  host: www.example.com
  to:
    kind: Service
    name: frontend
  tls:
    termination: edge
    key: |-
      -----BEGIN PRIVATE KEY-----
      [...]
      -----END PRIVATE KEY-----
    certificate: |-
      -----BEGIN CERTIFICATE-----
      [...]
      -----END CERTIFICATE-----
    caCertificate: |-
      -----BEGIN CERTIFICATE-----
      [...]
      -----END CERTIFICATE-----
----
====

You can create a secured route without specifying a key and certificate, in which case the
ifdef::openshift-enterprise,openshift-origin[]
link:../install_config/install/deploy_router.html#using-wildcard-dns[router's
default certificate]
endif::[]
ifdef::openshift-dedicated[]
router's default certificate 
endif::[]
will be used for TLS termination.

[NOTE]
====
TLS termination in OpenShift relies on
link:https://en.wikipedia.org/wiki/Server_Name_Indication[SNI] for serving
custom certificates. Any non-SNI traffic received on port 443 is handled with
TLS termination and a default certificate, which may not match the requested
host name, resulting in validation errors.
====

Further information on all types of
link:../architecture/core_concepts/routes.html#secured-routes[TLS termination]
as well as
link:../architecture/core_concepts/routes.html#path-based-routes[path-based
routing] are available in the
link:../architecture/core_concepts/routes.html[Architecture section].
