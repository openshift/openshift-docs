:_mod-docs-content-type: ASSEMBLY
[id="upgrade-operator"]
= Upgrading by using the Operator
include::modules/common-attributes.adoc[]
:context: upgrade-operator

toc::[]

[role="_abstract"]
Upgrades through the {rh-rhacs-first} Operator are performed automatically or manually, depending on the *Update approval* option you chose at installation.

Follow these guidelines when upgrading:

* If the version for Central is earlier than 3.74, you must upgrade to 3.74 before upgrading to a 4.x version. For upgrading Central to version 3.74, see the link:https://access.redhat.com/documentation/en-us/red_hat_advanced_cluster_security_for_kubernetes/3.74/html/upgrading/index[upgrade documentation for version 3.74].
* When upgrading Operator-based Central deployments from version 3.74, first ensure the Operator upgrade mode is set to `Manual`. Then, upgrade the Operator to version 4.0 following the procedure in the link:https://access.redhat.com/documentation/en-us/red_hat_advanced_cluster_security_for_kubernetes/4.0/html/upgrading/upgrade-operator[upgrade documentation for version 4.0] and ensure that Central is online. After the upgrade to version 4.0 is complete, Red{nbsp}Hat recommends upgrading Central to the latest version for full functionality.

include::modules/prepare-operator-upgrades.adoc[leveloffset=+1]
include::modules/change-collection-method.adoc[leveloffset=+2]

[role="_additional-resources"]
.Additional resources
* link:https://docs.openshift.com/container-platform/latest/operators/admin/olm-upgrading-operators.html[Updating installed Operators]
* xref:../backup_and_restore/backing-up-acs.adoc#backing-up-acs[Backing up {product-title}]

include::modules/operator-upgrade-modify-central-custom-resource.adoc[leveloffset=+1]

include::modules/operator-upgrade-modify-central-custom-resource-external-db.adoc[leveloffset=+1]

[role="_additional-resources"]
.Additional resources

* xref:../installing/installing_ocp/install-central-ocp.adoc#provision-postgresql-database_install-central-ocp[Provisioning a database in your PostgreSQL instance]

include::modules/operator-upgrade-change-subscription-channel.adoc[leveloffset=+1]

[id="rollback-operator-upgrade"]
== Rolling back an Operator upgrade

To roll back an Operator upgrade, you must perform the steps described in one of the following sections. You can roll back an Operator upgrade by using the CLI or the {ocp} web console.

[NOTE]
====
If you are rolling back from {product-title-short} 4.0, you can only rollback to the latest patch release version of {product-title-short} 3.74.
====

include::modules/rollback-operator-upgrades-cli.adoc[leveloffset=+2]
include::modules/rollback-operator-upgrades-console.adoc[leveloffset=+2]

[role="_additional-resources"]
.Additional resources
* xref:../installing/installing_ocp/install-central-ocp.adoc#install-central-operator_install-central-ocp[Installing Central using the Operator method]
* link:https://access.redhat.com/documentation/en-us/openshift_container_platform/4.15/html/operators/understanding-operators#olm-workflow[Operator Lifecycle Manager workflow]
* link:https://access.redhat.com/documentation/en-us/openshift_container_platform/4.15/html/operators/administrator-tasks#olm-approving-pending-upgrade_olm-upgrading-operators[Manually approving a pending Operator update]

[id="operator-upgrade-troubleshooting_{context}"]
== Troubleshooting Operator upgrade issues

[role="_abstract"]
Follow these instructions to investigate and resolve upgrade-related issues for the {product-title-short} Operator.

include::modules/operator-upgrade-centraldb-cannot-be-scheduled.adoc[leveloffset=+2]

include::modules/operator-upgrade-fail-to-deploy.adoc[leveloffset=+2]
