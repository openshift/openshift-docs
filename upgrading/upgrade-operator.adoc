:_content-type: ASSEMBLY
[id="upgrade-operator"]
= Upgrading by using the Operator
include::modules/common-attributes.adoc[]
:context: upgrade-operator

toc::[]

[role="_abstract"]
Upgrades through the {rh-rhacscs-first} Operator are performed automatically or manually, depending on the *Update approval* option you chose at installation.

{product-title-short} 4.0 includes a significant architectural change, moving Centralâ€™s database to PostgreSQL. Because of this change, {product-title-short} 4.0 Operator is published by a new subscription channel. Therefore, as part of the upgrade instructions, you must manually change the subscription channel to upgrade from {product-title-short} 3.74 to {product-title-short} 4.0.

//If you installed {product-title-short} using the Operator and selected *Automatic* in the *Update approval* field, {product-title-short} is automatically updated when a new software version is released. If you selected *Manual*, you must approve subsequent Operator updates by using Operator Lifecycle Manager (OLM). For more information, see link:https://access.redhat.com/documentation/en-us/openshift_container_platform/4.12/html/operators/administrator-tasks#olm-approving-pending-upgrade_olm-upgrading-operators[Manually approving a pending Operator update].

[IMPORTANT]
====
* Because of the database related changes introduced in {product-title-short} 4.0, even if you have selected *Automatic* in the *Update approval* field, you must manually upgrade to {product-title-short} 4.0.
* You must be using {product-title-short} 3.74 to upgrade to {product-title-short} 4.0. If you are using a version older than 3.74, you must first upgrade to {product-title-short} 3.74 and then upgrade to {product-title-short} 4.0.
====

include::modules/prepare-operator-upgrades.adoc[leveloffset=+1]

[role="_additional-resources"]
.Additional resources
* link:https://docs.openshift.com/container-platform/latest/operators/admin/olm-upgrading-operators.html[Updating installed Operators]
* xref:../backup_and_restore/backing-up-acs.adoc[Backing up {product-title}]

include::modules/operator-upgrade-modify-central-custom-resource.adoc[leveloffset=+1]

include::modules/operator-upgrade-modify-central-custom-resource-tech-preview.adoc[leveloffset=+1]

include::modules/operator-upgrade-change-subscription-channel.adoc[leveloffset=+1]

[id="rollback-operator-upgrade"]
== Rolling back an Operator upgrade

To roll back an Operator upgrade, you must perform the steps described in one of the following sections. You can roll back an Operator upgrade by using the CLI or the {ocp} web console.

[NOTE]
====
If you are rolling back from {product-title-short} 4.0, you can only rollback to the latest patch release version of {product-title-short} 3.74.
====

include::modules/rollback-operator-upgrades-cli.adoc[leveloffset=+2]
include::modules/rollback-operator-upgrades-console.adoc[leveloffset=+2]

[role="_additional-resources"]
.Additional resources
* xref:../installing/installing_ocp/install-central-ocp.adoc#install-central-operator_install-central-ocp[Installing Central using the Operator method]
* link:https://access.redhat.com/documentation/en-us/openshift_container_platform/4.12/html/operators/understanding-operators#olm-workflow[Operator Lifecycle Manager workflow]
* link:https://access.redhat.com/documentation/en-us/openshift_container_platform/4.12/html/operators/administrator-tasks#olm-approving-pending-upgrade_olm-upgrading-operators[Manually approving a pending Operator update]

[id="operator-upgrade-troubleshooting_{context}"]
== Troubleshooting Operator upgrade issues

[role="_abstract"]
Follow the instructions in this section to investigate and resolve upgrade-related issues for the {product-title-short} Operator.

include::modules/operator-upgrade-centraldb-cannot-be-scheduled.adoc[leveloffset=+2]

include::modules/operator-upgrade-fail-to-deploy.adoc[leveloffset=+2]
