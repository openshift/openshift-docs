:_mod-docs-content-type: ASSEMBLY
include::_attributes/common-attributes.adoc[]
[id="using-cohorts"]
= Using cohorts
:context: using-cohorts

toc::[]

You can use cohorts to group cluster queues and determine which cluster queues are able to share borrowable resources with each other.
Borrowable resources are defined as the unused nominal quota of all the cluster queues in a cohort.

Using cohorts can help to optimize resource utilization by preventing under-utilization and enabling fair sharing configurations.
Cohorts can also help to simplify resource management and allocation between teams, because you can group cluster queues for related workloads or for each team.
You can also use cohorts to set resource quotas at a group level to define the limits for resources that a group of cluster queues can consume.

include::modules/clusterqueue-configuring-cohorts-reference.adoc[leveloffset=+1]

////
When a ClusterQueue is part of a cohort, Kueue satisfies the following admission semantics:

When assigning flavors, Kueue goes through the list of flavors in the relevant ResourceGroup inside ClusterQueue’s (.spec.resourceGroups[*].flavors). For each flavor, Kueue attempts to fit a Workload’s pod set according to the quota defined in the ClusterQueue for the flavor and the unused quota in the cohort. If the Workload doesn’t fit, Kueue evaluates the next flavor in the list.

A Workload’s pod set resource fits in a flavor defined for a ClusterQueue resource if the sum of requests for the resource:
Is less than or equal to the unused nominalQuota for the flavor in the ClusterQueue; or
Is less than or equal to the sum of unused nominalQuota for the flavor in the ClusterQueues in the cohort, and
Is less than or equal to the unused nominalQuota + borrowingLimit for the flavor in the ClusterQueue. In Kueue, when (2) and (3) are satisfied, but not (1), this is called borrowing quota.
A ClusterQueue can only borrow quota for flavors that the ClusterQueue defines.
For each pod set resource in a Workload, a ClusterQueue can only borrow quota for one flavor.
////
