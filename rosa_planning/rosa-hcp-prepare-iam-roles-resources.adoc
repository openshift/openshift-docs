:_mod-docs-content-type: ASSEMBLY

[id="rosa-hcp-prepare-iam-roles-resources"]
= Required IAM roles and resources

include::_attributes/attributes-openshift-dedicated.adoc[]
:context: prepare-role-resources

toc::[]

[role="_abstract"]
You must create several role resources on your AWS account in order to create and manage a {product-title} cluster.

include::modules/rosa-prereq-roles-overview.adoc[leveloffset=+1]

[role="_additional-resources"]
[id="additional-resources_role-overview_{context}"]
.Additional resources
* link:https://docs.aws.amazon.com/rosa/latest/userguide/security-iam-awsmanpol.html[AWS Managed IAM policies for {product-title} clusters]

[id="rosa-prepare-am-resources-roles-account"]
== Roles required to create and manage clusters

Several account-wide roles (`account-roles` in the {rosa-cli-first}) are required to create or manage {product-title} clusters. These roles must be created using the {rosa-cli} (`rosa`), regardless of whether you typically use {cluster-manager} or the {rosa-cli} to create and manage your clusters. These roles only need to be created once, and do not need to be created for every cluster you install.

//account roles
include::modules/rosa-hcp-creating-account-wide-sts-roles-and-policies.adoc[leveloffset=+2]

[role="_additional-resources"]
[id="additional-resources_account-roles_{context}"]
.Additional resources
* link:https://docs.aws.amazon.com/rosa/latest/userguide/security-iam-awsmanpol.html[AWS documentation for Managed IAM policies for {product-title} clusters]

[id="rosa-prepare-iam-resources-oidc"]
== Resources required for OIDC authentication

{product-title} clusters use OIDC and the AWS Security Token Service (STS) to authenticate Operator access to AWS resources they require to perform their functions. Each production cluster requires its own OIDC configuration.

include::modules/rosa-sts-byo-oidc.adoc[leveloffset=+2]

[id="rosa-prepare-am-resources-roles-operator"]
== Roles required for Operator managed cluster capabilities
//operator roles
//created per-cluster or per-OIDC provider if that is shared between clusters
Some cluster capabilities, including several capabilities provided by default, are managed using Operators. Cluster-specific Operator roles (`operator-roles` in the {rosa-cli}) use the OpenID Connect (OIDC) provider for the cluster to temporarily authenticate Operator access to AWS resources.

include::modules/rosa-sts-operator-roles.adoc[leveloffset=+2]
include::modules/rosa-operator-config.adoc[leveloffset=+2]

[role="_additional-resources"]
[id="additional-resources_operator-roles_{context}"]
.Additional resources
* link:https://docs.aws.amazon.com/rosa/latest/userguide/security-iam-awsmanpol.html[AWS documentation for Managed IAM policies for {product-title} clusters]

[id="rosa-prepare-iam-resources-roles-ocm"]
== Roles required to use {cluster-manager}

The roles in this section are only required when you want to use {cluster-manager} to create and manage clusters. If you intend to create and manage clusters using only the {rosa-cli-first} and the OpenShift CLI (`oc`), these roles are not required.

include::modules/rosa-sts-ocm-role-creation.adoc[leveloffset=+2]

[role="_additional-resources"]
[id="additional-resources_ocm-role-creation_{context}"]
.Additional resources
* xref:../rosa_architecture/rosa-sts-about-iam-resources.adoc#rosa-sts-account-wide-roles-and-policies-creation-methods_rosa-sts-about-iam-resources[Methods of account-wide role creation]

include::modules/rosa-sts-user-role-creation.adoc[leveloffset=+2]

[role="_additional-resources"]
[id="additional-resources_user-role-creation_{context}"]
.Additional resources
* xref:../rosa_architecture/rosa-sts-about-iam-resources.adoc#rosa-sts-account-wide-roles-and-policies-creation-methods_rosa-sts-about-iam-resources[Methods of account-wide role creation]
