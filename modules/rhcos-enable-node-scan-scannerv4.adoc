// Module included in the following assemblies:
//
// * operating/manage-vulnerabilities/scan-rhcos-node-host.adoc
// * cloud_service/upgrading-cloud/upgrade-cloudsvc-roxctl.adoc
:_mod-docs-content-type: PROCEDURE
[id="rhcos-enable-node-scan-scannerv4_{context}"]
= Enabling {op-system} node scanning with Scanner V4

[role="_abstract"]
If you use {ocp}, you can enable scanning of {op-system-first} nodes for vulnerabilities by using {rh-rhacs-first}.

.Prerequisites
* For scanning {op-system} node hosts of the secured cluster, you must have installed the following software:
** Secured Cluster services on {ocp} {ocp-supported-version} or later
** {product-title-short} version 4.6 or later
+
For information about supported platforms and architecture, see the link:https://access.redhat.com/articles/7045053[{product-title} Support Matrix]. For life cycle support information for {product-title-short}, see the link:https://access.redhat.com/support/policy/updates/rhacs[{product-title} Support Policy].

.Procedure

To enable node indexing, also known as node scanning, by using Scanner V4:

. Ensure that Scanner V4 is deployed in the Central cluster:
+
[source,terminal]
----
$ kubectl -n stackrox get deployment scanner-v4-indexer scanner-v4-matcher scanner-v4-db<1>
----
<1> For {ocp}, use `oc` instead of `kubectl`.
. In the Central pod, on the `central` container, set the `ROX_NODE_INDEX_ENABLED` and the `ROX_SCANNER_V4` variables to `true` by running the following command on the Central cluster:
+
[source,terminal]
----
$ kubectl -n stackrox set env deployment/central ROX_NODE_INDEX_ENABLED=true ROX_SCANNER_V4=true<1>
----
<1> For {ocp}, use `oc` instead of `kubectl`.
. In the Sensor pod, on the `sensor` container, set the `ROX_NODE_INDEX_ENABLED` and the `ROX_SCANNER_V4` variables to `true` by running the following command on all secured clusters where you want to enable node scanning:
+
[source,terminal]
----
$ kubectl -n stackrox set env deployment/sensor ROX_NODE_INDEX_ENABLED=true ROX_SCANNER_V4=true<1>
----
<1> For {ocp}, use `oc` instead of `kubectl`.
. In the Collector Daemonset, in the `compliance` container, set the `ROX_NODE_INDEX_ENABLED` and the `ROX_SCANNER_V4` variables to `true` by running the following command on all secured clusters where you want to enable node scanning:
+
[source,terminal]
----
$ kubectl -n stackrox set env daemonset/collector ROX_NODE_INDEX_ENABLED=true ROX_SCANNER_V4=true<1>
----
<1> For {ocp}, use `oc` instead of `kubectl`.
. To verify that node scanning is working, examine the Central logs for the following message:
+
[source,text]
----
Scanned index report and found <number> components for node <node_name>.
----
+
where:

<number>:: Specifies the number of discovered components.
<node_name>:: Specifies the name of the node.
