// Module included in the following assemblies:
//
// * microshift/microshift_auth_security/microshift-verify-container-signatures.adoc

:_mod-docs-content-type: PROCEDURE
[id="microshift-enable-sigstore-mirror-registries_{context}"]
= Enabling sigstore attachments for mirror registries

If you are using mirror registries you must apply additional configuration to enable sigstore attachments and mirroring by digest.

.Prerequisites

* You have admin access to the {microshift-short} host.
* You completed the steps in "Verifying container signatures using sigstore."

.Procedure

. Enable sigstore attachments by creating the `/etc/containers/registries.d/mirror.registry.local.yaml` file.
+
[source,terminal,subs="+quotes"]
----
$ cat /etc/containers/registries.d/_<mirror.registry.local.yaml>_ <1>
docker:
   mirror.registry.local:
        use-sigstore-attachments: true
----
<1> Name the `_<mirror.registry.local.yaml>_` file after your mirror registry URL.

. Enable mirroring by digest by creating the `/etc/containers/registries.conf.d/999-microshift-mirror.conf` with the following contents:
+
[source,terminal]
----
$ cat /etc/containers/registries.conf.d/999-microshift-mirror.conf
[[registry]]
    prefix = "quay.io/openshift-release-dev"
    location = "mirror.registry.local"
    mirror-by-digest-only = true

[[registry]]
    prefix = "registry.redhat.io"
    location = "mirror.registry.local"
    mirror-by-digest-only = true
----

.Next steps
. Wipe the local container storage clean.
