// Module included in the following assemblies:
//
// * metering/metering-installing-metering.adoc
// * metering/metering-using-metering.adoc

[id="metering-overview_{context}"]
= Metering overview

Metering is a general purpose data analysis tool that enables you to write reports to process data from different data sources. As a cluster administrator, you can use metering to analyze what is happening in your cluster. You can either write your own, or use predefined SQL queries to define how you want to process data from the different data sources you have available.

Metering focuses primarily on in-cluster metric data using Prometheus as a default data source, enabling users of metering to do reporting on pods, namespaces, and most other Kubernetes resources.

You can install metering on {product-title} 4.x clusters and above.

[id="metering-overview-install-metering"]
== Installing metering
You can install metering using the CLI and the web console on {product-title} 4.x and above. To learn more, see xref:../metering/metering-installing-metering.adoc#metering-install-prerequisites_installing-metering[installing metering].

[id="metering-overview-upgrade-metering"]
== Upgrading metering
You can upgrade metering by updating the Metering Operator subscription. Review the following tasks:

* The `MeteringConfig` custom resource specifies all xref:../metering/configuring_metering/metering-about-configuring.adoc#metering-about-configuring[the configuration details for your metering installation]. When you first install the metering stack, a default `MeteringConfig` custom resource is generated. Use the examples in the documentation to modify this default file.

* xref:../metering/reports/metering-about-reports.adoc#metering-about-reports[A report custom resource] provides a method to manage periodic Extract Transform and Load (ETL) jobs using SQL queries. Reports are composed from other metering resources, such as `ReportQuery` resources that provide the actual SQL query to run, and `ReportDataSource` resources that define the data available to the `ReportQuery` and `Report` resources.

[id="metering-overview-use-metering"]
== Using metering
You can use metering for writing reports and viewing report results. To learn more, see xref:../metering/metering-usage-examples.adoc#metering-usage-examples[examples of using metering].

[id="metering-overview-troubleshoot-metering"]
== Troubleshooting metering
You can use the following sections to xref:../metering/metering-troubleshooting-debugging.adoc#metering-troubleshooting_metering-troubleshooting-debugging[troubleshoot specific issues with metering].

* Not enough compute resources
* `StorageClass` resource not configured
* Secret not configured correctly

[id="metering-overview-debug-metering"]
== Debugging metering
You can use the following sections to xref:../metering/metering-troubleshooting-debugging.adoc#metering-debugging_metering-troubleshooting-debugging[debug specific issues with metering].

* Get reporting Operator logs
* Query Presto using presto-cli
* Query Hive using beeline
* Port-forward to the Hive web UI
* Port-forward to HDFS
* Metering Ansible Operator

[id="metering-overview-uninstall-metering"]
== Uninstalling metering
You can remove and clean metering resources from your OpenShift Container Platform cluster. To learn more, see xref:../metering/metering-uninstall.adoc#metering-uninstall[uninstalling metering].

[id="metering-resources_{context}"]
== Metering resources

Metering has many resources which can be used to manage the deployment and installation of metering, as well as the reporting functionality metering provides.

Metering is managed using the following custom resource definitions (CRDs):

[cols="1,7"]
|===

|*MeteringConfig* |Configures the metering stack for deployment. Contains customizations and configuration options to control each component that makes up the metering stack.

|*Report* |Controls what query to use, when, and how often the query should be run, and where to store the results.

|*ReportQuery* |Contains the SQL queries used to perform analysis on the data contained within `ReportDataSource` resources.

|*ReportDataSource* |Controls the data available to `ReportQuery` and `Report` resources. Allows configuring access to different databases for use within metering.

|===
