// Module included in the following assemblies:
//
//  * serverless/knative_eventing/serverless-channels.adoc

[id="serverless-inmemorychannel_{context}"]
= Creating a channel using the cluster default configuration

`InMemoryChannel` channels are for development use only, and should not be used in a production environment.

The following are limitations of `InMemoryChannel` channels:

* No event persistence is available. If a pod goes down, events on that pod are lost.
* `InMemoryChannel` channels do not implement event ordering, so two events that are received in the channel at the same time can be delivered to a subscriber in any order.
* If a subscriber rejects an event, there are no redelivery attempts. Instead, the rejected event is sent to a dead letter sink if this sink exists, or is otherwise dropped. For more information about configuring event delivery and dead letter sink settings for a channel, see xref:../../serverless/knative_eventing/serverless-subscriptions.adoc#serverless-subscriptions[Using subscriptions to send events from a channel to a sink].

When you install Knative Eventing, the following custom resource definition (CRD) is created automatically:

[source,yaml]
----
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: knative-eventing
  name: config-br-default-channel
data:
  channelTemplateSpec: |
    apiVersion: messaging.knative.dev/v1
    kind: InMemoryChannel
----

.Procedure

* Create a generic `Channel` object.
+
[source,yaml]
----
apiVersion: messaging.knative.dev/v1
kind: Channel
metadata:
  name: example-channel
  namespace: default
----

When the `Channel` object is created, a mutating admission webhook adds a set of `spec.channelTemplate` properties for the `Channel` object based on the default channel implementation:

[source,yaml]
----
apiVersion: messaging.knative.dev/v1
kind: Channel
metadata:
  name: example-channel
  namespace: default
spec:
  channelTemplate:
    apiVersion: messaging.knative.dev/v1
    kind: InMemoryChannel
----

The channel controller then creates the backing channel instance based on that `spec.channelTemplate` configuration. The `spec.channelTemplate` properties cannot be changed after creation, because they are set by the default channel mechanism rather than by the user.

When this mechanism is used, two objects are created: a generic channel, and an `InMemoryChannel` channel.

The generic channel acts as a proxy that copies its subscriptions to the `InMemoryChannel` channel, and sets its status to reflect the status of the backing `InMemoryChannel` channel.

Because the channel in this example is created in the default namespace, the channel uses the cluster default kind, which is `InMemoryChannel`.
