// Module included in the following assemblies:
//
// * cloud_experts_tutorials/cloud-experts-dynamic-certificate-custom-domain.adoc

:_mod-docs-content-type: PROCEDURE
[id="cloud-experts-dynamic-certificate-custom-domain-config-dynamic-cert_{context}"]
= Configuring dynamic certificates for custom domain routes

[role="_abstract"]
You can expose cluster applications on any first-level subdomains of the specified domain, but the connection will not be secured with a TLS certificate that matches the domain of the application. To ensure these cluster applications have valid certificates for each domain name, configure cert-manager to dynamically issue a certificate to every new route created under this domain.

.Procedure
. Create the necessary OpenShift resources cert-manager requires to manage certificates for OpenShift routes.
+
This step creates a new deployment (and therefore a pod) that specifically monitors annotated routes in the cluster. If the `issuer-kind` and `issuer-name` annotations are found in a new route, it requests the Issuer (ClusterIssuer in this case) for a new certificate that is unique to this route and which will honor the hostname that was specified while creating the route.
+
[NOTE]
====
If the cluster does not have access to GitHub, you can save the raw contents locally and run `oc apply -f localfilename.yaml -n cert-manager`.
====
+
[source,terminal]
----
$ oc -n cert-manager apply -f https://github.com/cert-manager/openshift-routes/releases/latest/download/cert-manager-openshift-routes.yaml
----
+
The following additional OpenShift resources are also created in this step:
+
* `ClusterRole` - grants permissions to watch and update the routes across the cluster
* `ServiceAccount` - uses permissions to run the newly created pod
* `ClusterRoleBinding` -  binds these two resources
+
. Ensure that the new `cert-manager-openshift-routes` pod is running successfully:
+
[source,terminal]
----
$ oc -n cert-manager get pods
----
+
**Example result**:
+
[source,terminal]
----
NAME                                             READY   STATUS    RESTARTS   AGE
cert-manager-866d8f788c-9kspc                    1/1     Running   0          4h21m
cert-manager-cainjector-6885c585bd-znws8         1/1     Running   0          4h41m
cert-manager-openshift-routes-75b6bb44cd-f8kd5   1/1     Running   0          6s
cert-manager-webhook-8498785dd9-bvfdf            1/1     Running   0          4h41m
----