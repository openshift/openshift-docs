// This module is included in the following assemblies:
// * secure/authenticating-pipelines-repos-using-secrets.adoc

:_mod-docs-content-type: PROCEDURE
[id="op-configuring-basic-authentication-for-git_{context}"]
= Configuring Basic authentication for Git using a service account

[role="_abstract"]
For a pipeline to retrieve resources from password-protected repositories, you can configure the Basic authentication for that pipeline.

[NOTE]
====
Consider using SSH-based authentication rather than Basic authentication.
====

To configure Basic authentication for a pipeline, create a Basic authentication secret, associate this secret with a service account, and associate this service account with a `TaskRun` or `PipelineRun` resource.

[NOTE]
====
For GitHub, authentication using a plain password is deprecated. Instead, use a link:https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token[personal access token].
====

.Procedure

. Create the YAML manifest for the secret in the `secret.yaml` file. In this manifest, specify the username and password or link:https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token[GitHub personal access token] to access the target Git repository.
+
[source,yaml,subs="attributes+"]
----
apiVersion: v1
kind: Secret
metadata:
  name: basic-user-pass
  annotations:
    tekton.dev/git-0: https://github.com
type: kubernetes.io/basic-auth
stringData:
  username: <username>
  password: <password>
----
+
`basic-user-pass`:: Name of the secret.
`<username>`:: Username for the Git repository.
`<password>`:: Password or personal access token for the Git repository.

. Create the YAML manifest for the service account in the `serviceaccount.yaml` file. In this manifest, associate the secret with the service account.
+
[source,yaml,subs="attributes+"]
----
apiVersion: v1
kind: ServiceAccount
metadata:
  name: build-bot
secrets:
  - name: basic-user-pass
----
+
`build-bot`:: Name of the service account. In this example, `build-bot`.
`basic-user-pass`:: Name of the secret. In this example, `basic-user-pass`.

. Create the YAML manifest for the task run or pipeline run in the `run.yaml` file and associate the service account with the task run or pipeline run. Use one of the following examples:

.. Associate the service account with a `TaskRun` resource:
+
[source,yaml,subs="attributes+"]
----
apiVersion: tekton.dev/v1
kind: TaskRun
metadata:
  name: build-push-task-run-2
spec:
  taskRunTemplate:
    serviceAccountName: build-bot
  taskRef:
    name: build-push
----
+
`build-push-task-run-2`:: Name of the task run. In this example, `build-push-task-run-2`.
`build-bot`:: Name of the service account. In this example, `build-bot`.
`build-push`:: Name of the task. In this example, `build-push`.

.. Associate the service account with a `PipelineRun` resource:
+
[source,yaml,subs="attributes+"]
----
apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
  name: demo-pipeline
  namespace: default
spec:
  taskRunTemplate:
    serviceAccountName: build-bot
  pipelineRef:
    name: demo-pipeline
----
+
`demo-pipeline`:: Name of the pipeline run. In this example, `demo-pipeline`.
`build-bot`:: Name of the service account. In this example, `build-bot`.
`demo-pipeline`:: Name of the pipeline. In this example, `demo-pipeline`.

. Apply the YAML manifests that you created by entering the following command:
+
[source,terminal]
----
$ oc apply --filename secret.yaml,serviceaccount.yaml,run.yaml
----
