[id="installation-vsphere-zones-config-yaml_{context}"]
= Sample install-config.yaml customizations for an installer-provisioned VMware vSphere cluster in multiple failure domains

You can further customize the install-config.yaml file to specify more details about your {product-title} cluster's failure domain topology.

[source,yaml]
----
apiVersion: v1
baseDomain: example.com
featureSet: TechPreviewNoUpgrade <13>
compute: 
- hyperthreading: Enabled 
  name: worker
  replicas: 3 
  vsphere:
    zones: <1>
      - "failure-domain-1"
      - "failure-domain-2"
      - "failure-domain-3"
controlPlane: 
  hyperthreading: Enabled
  name: master
  replicas: 3 
  vsphere:
    zones: <1>
      - "failure-domain-1"
      - "failure-domain-2"
      - "failure-domain-3"
metadata:
  name: cluster
platform:
  vsphere: 
    vcenter: your.vcenter.server <2>
    username: username <2>
    password: password <2>
    datacenter: datacenter <2> 
    defaultDatastore: datastore <2>
    folder: "/<datacenter_name>/vm/<folder_name>/<subfolder_name>" <2>
    cluster: cluster <2>
    resourcePool: "/<datacenter_name>/host/<cluster_name>/Resources/<resource_pool_name>" <2>
    diskType: thin 
    failureDomains: <3>
    - name: failure-domain-1 <4>
      region: region-a <5>
      zone: zone-a <6>
      topology: <7>
        datacenter: region-a-dc <8>
        computeCluster: /region-a-dc/host/zone-a-cluster <9>
        resourcePool: /region-a-dc/host/zone-a-cluster/Resources/resource-pool <10>
        networks: <11>
        - port-group
        datastore: datastore-a <12>
    - name: failure-domain-2
      region: region-a
      zone: zone-b
      topology:
        datacenter: region-a-dc
        computeCluster: /region-a-dc/host/zone-b-cluster
        networks:
        - port-group
        datastore: datastore-b
    - name: failure-domain-3
      region: region-b
      zone: zone-a
      topology:
        datacenter: region-b-dc
        computeCluster: /region-b-dc/host/zone-a-cluster
        networks:
        - port-group
        datastore: datastore-c
----

<1> Optional: The list of failure domains among which the nodes in the machine pool will be distributed.
If not defined, nodes will be distributed among all defined failure-domains.

<2> The default vCenter topology. This is used to deploy the bootstrap node and defines the
default datastore for vSphere persistent volumes.

<3> Optional: The list of failure domains associated with the vCenter.  If not defined, the default
vCenter topology defined in <2> will be used.

<4> The name of the failure domain.  This name is used in <1> to scope a machine pool to the failure domain.

<5> The value of the `openshift-region` tag assigned to the topology for the failure failure domain.

<6> The value of the `openshift-zone` tag assigned to the topology for the failure failure domain.

<7> The vCenter reources associated with the failure domain.

<8> Optional: The datacenter associated with the failure domain. If not defined, the datacenter is derived from <2>.

<9> Optional: The full path of the compute cluster associated with the failure domain. If not defined, the compute cluster is derived from <2>.

<10> Optional: The full path of the resource pool associated with the failure domain. If not defined, the resource pool is derived from <2>.

<11> Optional: The port group associated with the failure domain. If not defined, the port group is derived from <2>.

<12> Optional: The datastore associated with the failure domain. If not defined, the datastore is derived from <2>.

<13> This feature is a technology preview and as such requires the `TechPreviewNoUpgrade` feature gate be configured in the `install-config.yaml`.
+
[IMPORTANT]
====
Failure domains are immutable and may not be changed after installation.  Additional failure domains may be created after installation.
====
