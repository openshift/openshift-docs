// Module included in the following assemblies:
//
// * images/using_images/images-other-jenkins.adoc

[id="images-other-jenkins-env-var_{context}"]
= Jenkins environment variables

The Jenkins server can be configured with the following environment variables:

[options="header"]
|===
| Variable | Definition | Example values and settings

|`OPENSHIFT_ENABLE_OAUTH`
|Determines whether the OpenShift Login plug-in manages authentication when
logging in to Jenkins. To enable, set to `true`.
|Default: `false`

|`JENKINS_PASSWORD`
|The password for the `admin` user when using standard Jenkins authentication.
Not applicable when `OPENSHIFT_ENABLE_OAUTH` is set to `true`.
|Default: `password`

|`JAVA_MAX_HEAP_PARAM`,
`CONTAINER_HEAP_PERCENT`,
`JENKINS_MAX_HEAP_UPPER_BOUND_MB`
|These values control the maximum heap size of the Jenkins JVM. If
`JAVA_MAX_HEAP_PARAM` is set, its value takes
precedence. Otherwise, the maximum heap size is dynamically calculated as
`CONTAINER_HEAP_PERCENT` of the container
memory limit, optionally capped at `JENKINS_MAX_HEAP_UPPER_BOUND_MB` MiB.

By default, the maximum heap size of the Jenkins JVM is set to 50% of the
container memory limit with no cap.
|`JAVA_MAX_HEAP_PARAM` example setting: `-Xmx512m`

`CONTAINER_HEAP_PERCENT` default: `0.5`, or 50%

`JENKINS_MAX_HEAP_UPPER_BOUND_MB` example setting: `512 MiB`

|`JAVA_INITIAL_HEAP_PARAM`,
`CONTAINER_INITIAL_PERCENT`
|These values control the initial heap size of the Jenkins JVM. If
`JAVA_INITIAL_HEAP_PARAM` is set, its value takes
precedence. Otherwise, the initial heap size is dynamically calculated as
`CONTAINER_INITIAL_PERCENT` of the
dynamically calculated maximum heap size.

By default, the JVM sets the initial heap size.
|`JAVA_INITIAL_HEAP_PARAM` example setting: `-Xms32m`

`CONTAINER_INITIAL_PERCENT` example setting: `0.1`, or 10%

|`CONTAINER_CORE_LIMIT`
|If set, specifies an integer number of cores used for sizing numbers of internal
JVM threads.
|Example setting: `2`

|`JAVA_TOOL_OPTIONS`
|Specifies options to apply to all JVMs running in this container. It is not
recommended to override this value.
|Default: `-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -Dsun.zip.disableMemoryMapping=true`

|`JAVA_GC_OPTS`
|Specifies Jenkins JVM garbage collection parameters. It is not recommended to
override this value.
|Default: `-XX:+UseParallelGC -XX:MinHeapFreeRatio=5 -XX:MaxHeapFreeRatio=10 -XX:GCTimeRatio=4 -XX:AdaptiveSizePolicyWeight=90`

|`JENKINS_JAVA_OVERRIDES`
|Specifies additional options for the Jenkins JVM. These options are appended to
all other options, including the Java options above, and may be used to override
any of them if necessary. Separate each additional option with a space; if any
option contains space characters, escape them with a backslash.
|Example settings: `-Dfoo -Dbar`; `-Dfoo=first\ value -Dbar=second\ value`.

|`JENKINS_OPTS`
|Specifies arguments to Jenkins.
|

|`INSTALL_PLUGINS`
|Specifies additional Jenkins plug-ins to install when the container is first run
or when `OVERRIDE_PV_PLUGINS_WITH_IMAGE_PLUGINS` is set to `true`.
Plug-ins are specified as a comma-delimited list of name:version pairs.
|Example setting: `git:3.7.0,subversion:2.10.2`.

|`OPENSHIFT_PERMISSIONS_POLL_INTERVAL`
|Specifies the interval in milliseconds that the OpenShift Login plug-in polls
{product-title} for the permissions that are associated with each user that is
defined in Jenkins.
|Default: `300000` - 5 minutes

|`OVERRIDE_PV_CONFIG_WITH_IMAGE_CONFIG`
|When running this image with an {product-title} persistent volume for the Jenkins
configuration directory, the transfer of configuration from the image to the Persistent
Volume is performed only the first time the image starts because the Persistent
Volume is assigned when the Persistent Volume Claim is created. If you create a
custom image that extends this image and updates configuration in the custom image
after the initial startup, the configuration is not copied over unless you set this
environment variable to `true`.
|Default: `false`

|`OVERRIDE_PV_PLUGINS_WITH_IMAGE_PLUGINS`
|When running this image with an {product-title} persistent volume for the Jenkins
configuration directory, the transfer of plugins from the image to the Persistent
Volume is performed only the first time the image starts because the Persistent
Volume is assigned when the Persistent Volume Claim is created. If you create a
custom image that extends this image and updates plug-ins in the custom image after
the initial startup, the plug-ins are not copied over unless you set this
environment variable to `true`.
|Default: `false`

|`ENABLE_FATAL_ERROR_LOG_FILE`
|When running this image with an {product-title} Persistent Volume Claim for the
Jenkins configuration directory, this environment variable allows the fatal error
log file to persist when a fatal error occurs. The fatal error file is saved at
`/var/lib/jenkins/logs`.
|Default: `false`

|`NODEJS_SLAVE_IMAGE`
|Setting this value overrides the image that is used for the default NodeJS agent
Pod configuration. A related imagestreamtag named `jenkins-agent-nodejs` is in
in the project. This variable must be set before Jenkins starts the first time
for it to have an effect.
|Default NodeJS agent image in Jenkins server:
`image-registry.openshift-image-registry.svc:5000/openshift/jenkins-agent-nodejs:latest`

|`MAVEN_SLAVE_IMAGE`
|Setting this value overrides the image used for the default maven agent Pod
configuration. A related imagestreamtag named `jenkins-agent-maven` is in the
project. This variable must be set before Jenkins starts the first time for it
to have an effect.
|Default Maven agent image in Jenkins server:
`image-registry.openshift-image-registry.svc:5000/openshift/jenkins-agent-maven:latest`

|`AGENT_BASE_IMAGE`
|Setting this value overrides the image used for the 'jnlp' container in the sample kubernetes plug-in PodTemplates
provided with this image.  Otherwise, the image from the 'jenkins-agent-base:latest' ImageStreamTag in the 'openshift'
namespace is used.
|Default:
`image-registry.openshift-image-registry.svc:5000/openshift/jenkins-agent-base:latest`

|`JAVA_SIDECAR_IMAGE`
|Setting this value overrides the image used for the 'java-sidecar' container in the 'java-sidecar' sample kubernetes
plug-in PodTemplates provided with this image.  Otherwise, the image from the 'java:latest' ImageStreamTag in the
'openshift' namespace is used.
|Default:
`image-registry.openshift-image-registry.svc:5000/openshift/java:latest`

|`NODEJS_SIDECAR_IMAGE`
|Setting this value overrides the image used for the 'nodejs-sidecar' container in the 'nodejs-sidecar' sample kubernetes
plug-in PodTemplates provided with this image.  Otherwise, the image from the 'nodejs:latest' ImageStreamTag in the
'openshift' namespace is used.
|Default:
`image-registry.openshift-image-registry.svc:5000/openshift/nodejs:latest`

|===
