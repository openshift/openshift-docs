// Module included in the following assemblies:
//
// * scalability_and_performance/telco-hub-rds.adoc

:_mod-docs-content-type: CONCEPT
[id="telco-hub-observability_{context}"]
= Observability

The {rh-rhacm} multicluster engine Observability component provides centralized aggregation and visualization of metrics and alerts for all managed clusters.
To balance performance and data analysis, the monitoring service maintains a subset list of aggregated metrics that are collected at a downsampled interval.
The metrics can be accessed on the hub through a set of different preconfigured dashboards.

Observability installation::
The necessary configuration CRs to enable observability are included in the reference configuration.
The primary CR to enable and configure the observability service is the `MulticlusterObservability` CR (MCO).
This CR defines:

* Configurable retention settings
* Storage for the different components: `thanos-receive`, `thanos-compact`, `thanos-rule`, `thanos-store-shard`, `alert-manager`.
* `metadata.annotations.mco-disable-alerting="true"` annotation that allows for tuning the monitoring configuration on managed clusters.
+
[NOTE]
====
Without this setting the observability component attempts to configure the managed cluster monitoring configuration.

When you set this value, the hub configuration is merged with the necessary observability alert forwarding configuration in the managed cluster monitoring `ConfigMap` CR.
====

When the Observability service is enabled, {rh-rhacm} deploys a workload to each managed cluster to push metrics and alerts generated by local monitoring to the hub cluster.
The metrics and alerts to be forwarded from the managed cluster to the hub are defined by a `ConfigMap` CR in the `open-cluster-management-addon-observability` namespace.
Custom metrics can be also specified.

Alertmananger configuration::
+
--
* The hub cluster provides an observability alertmanager that can be configured to push alerts to external systems, for example, email.
The alertmanager is enabled by default.
* You must configure alert forwarding.
* When the alertmanager is enabled but not configured, the hub alertmanager does not forward alerts externally.
* When observability is enabled, the managed clusters can be configured to send alerts to any endpoint including the hub alertmanager.
* When a managed cluster is configured to forward alerts to external sources, alerts are not routed through the hub cluster alertmanager.
* Alert state is available as a metric.
* When observability is enabled, the managed cluster alert states are included in the subset of metrics forwarded to the hub cluster and are available through Observability dashboards.
--

Limits and requirements::
* Observability requires persistent object storage for long-term metrics.
Refer to <<Storage requirements>> for more information.

Engineering considerations::
* Forwarding of metrics is a subset of the full metric data.
It includes only the metrics defined in the `observability-metrics-allowlist` configmap and any custom metrics added by the user.
* Metrics are forwarded at a downsampled rate.
Metrics are forwarded by taking the latest datapoint at a 5 minute interval (or as defined by the `MultiClusterObservability` CR configuration).
* A network outage may lead to a loss of metrics forwarded to the hub cluster during that interval.
This can be mitigated if metrics are also forwarded directly from managed clusters to an external metrics collector in the providers network.
Full resolution metrics are available on the managed cluster.
* In addition to default metrics dashboards on the hub, users may define custom dashboards.
* The reference configuration is sized based on 15 days of metrics storage by the hub cluster for 3500 {sno} clusters.
If longer retention or other managed cluster topology or sizing is required, the storage calculations must be updated and sufficient storage capacity be maintained.
Refer to the <<Storage requirements>> to understand how to calculate new values.
