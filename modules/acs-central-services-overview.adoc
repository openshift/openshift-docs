// Module included in the following assemblies:
//
// * architecture/acs-architecture.adoc
:_mod-docs-content-type: CONCEPT
[id="acs-central-services_{context}"]
= Central services

//an abbreviated version of this is used in acscs-central-overview.adoc until we go back and do some restructuring to be able to single source. If updating this section, check to make sure updates aren't needed to acscs-central-overview.adoc.
You install Central services on a single cluster.
These services include the following components:

* *Central*: Central is the {product-title-short} application management interface and services.
It handles API interactions and user interface ({product-title-short} Portal) access.
You can use the same Central instance to secure multiple {ocp} or Kubernetes clusters.
* *Central DB*: Central DB is the database for {product-title-short} and handles all data persistence. It is currently based on PostgreSQL 13.
* *Scanner V4*: Beginning with version 4.4, {product-title-short} contains the Scanner V4 vulnerability scanner for scanning container images. Scanner V4 is built on link:https://github.com/quay/claircore[ClairCore], which also powers the link:https://github.com/quay/clair[Clair] scanner. Scanner V4 supports scanning of language and OS-specific image components. For version 4.4, you must use this scanner in conjunction with the StackRox Scanner to provide node and platform scanning capabilities until Scanner V4 support those capabilities. Scanner V4 contains the Indexer, Matcher, and DB components.
** *Scanner V4 Indexer*: The Scanner V4 Indexer performs image indexing, previously known as image analysis. Given an image and registry credentials, the Indexer pulls the image from the registry. It finds the base operating system, if it exists, and looks for packages. It stores and outputs an index report, which contains the findings for the given image.
** *Scanner V4 Matcher*: The Scanner V4 Matcher performs vulnerability matching. If the Central services Scanner V4 Indexer indexed the image, then the Matcher fetches the index report from the Indexer and matches the report with the vulnerabilities stored in the Scanner V4 database. If a Secured Cluster services Scanner V4 Indexer performed the indexing, then the Matcher uses the index report that was sent from that Indexer, and then matches against vulnerabilities. The Matcher also fetches vulnerability data and updates the Scanner V4 database with the latest vulnerability data. The Scanner V4 Matcher outputs a vulnerability report, which contains the final results of an image.
** *Scanner V4 DB*: This database stores information for Scanner V4, including all vulnerability data and index reports. A persistent volume claim (PVC) is required for Scanner V4 DB on the cluster where Central is installed.
* *StackRox Scanner*: The StackRox Scanner is the default scanner in {product-title-short}. Version 4.4 adds a new scanner, Scanner V4. The StackRox Scanner originates from a fork of the Clair v2 open source scanner. You must continue using this scanner for RHCOS node scanning and platform scanning.
* *Scanner-DB*: This database contains data for the StackRox Scanner.

{product-title-short} scanners analyze each image layer to determine the base operating system and identify programming language packages and packages that were installed by the operating system package manager. They match the findings against known vulnerabilities from various vulnerability sources. In addition, the StackRox Scanner identifies vulnerabilities in the node's operating system and platform. These capabilities are planned for Scanner V4 in a future release.

[id="vulnerability-sources_{context}"]
== Vulnerability sources

{product-title-short} uses the following vulnerability sources:

* link:https://secdb.alpinelinux.org/[Alpine Security Database]
* Data tracked in link:https://alas.aws.amazon.com/index.html[Amazon Linux Security Center]
* link:https://security-tracker.debian.org/tracker/data/json[Debian Security Tracker]
* link:https://linux.oracle.com/security/oval[Oracle OVAL]
* link:https://packages.vmware.com/photon/photon_oval_definitions/[Photon OVAL]
* link:https://access.redhat.com/security/data/oval/v2/[Red{nbsp}Hat OVAL]
* link:https://access.redhat.com/security/data/metrics/cvemap.xml[Red{nbsp}Hat CVE Map]: This is used for images which appear in the link:https://catalog.redhat.com/software/containers/explore[Red{nbsp}Hat Container Catalog].
* link:https://support.novell.com/security/oval/[SUSE OVAL]
* link:https://security-metadata.canonical.com/oval/[Ubuntu OVAL]
* link:https://osv.dev/[OSV]: This is used for language-related vulnerabilities, such as Go, Java, Node.js (JavaScript), Python, and Ruby. This source might provide GitHub Security Advisory (GHSA) IDs rather than CVE numbers for vulnerabilities.
+
[NOTE]
====
The {product-title-short} Scanner V4 also uses the OSV database available at link:https://osv.dev/[OSV.dev] under link:https://github.com/google/osv.dev/blob/master/LICENSE[this license].
====
* link:https://nvd.nist.gov/vuln/search[NVD]: This is used for various purposes such as filling in information gaps when vendors do not provide information. For example, Alpine does not provide a description, CVSS score, severity, or published date.
+
[NOTE]
====
This product uses the NVD API but is not endorsed or certified by the NVD.
====
* link:https://github.com/stackrox/stackrox/blob/master/scanner/updater/manual/vulns.go[StackRox]: The upstream StackRox project maintains a set of vulnerabilities that might not be discovered due to data formatting from other sources or absence of data.

The Scanner V4 Indexer uses the following files to index Red{nbsp}Hat containers:

* link:https://www.redhat.com/security/data/metrics/repository-to-cpe.json[repository-to-cpe.json]: Maps RPM repositories to their related CPEs, which is required for matching vulnerabilities for RHEL-based images.
* link:https://access.redhat.com/security/data/metrics/container-name-repos-map.json[container-name-repos-map.json]: This matches container names to the repositories to which they are shipped.

