// Module included in the following assemblies:
//
// * nodes/nodes-nodes-garbage-collection.adoc
// * post_installation_configuration/node-tasks.adoc

:_content-type: CONCEPT
[id="nodes-nodes-garbage-collection-images_{context}"]
= Understanding how images are removed through garbage collection

Image garbage collection relies on disk usage as reported by *cAdvisor* on the
node to decide which images to remove from the node.

The policy for image garbage collection is based on two conditions:

* The percent of disk usage (expressed as an integer) which triggers image
garbage collection. The default is *85*.

* The percent of disk usage (expressed as an integer) to which image garbage
collection attempts to free. Default is *80*.

For image garbage collection, you can modify any of the following variables using
a custom resource.

.Variables for configuring image garbage collection

[options="header",cols="1,3"]
|===

|Setting |Description

|`imageMinimumGCAge`
|The minimum age for an unused image before the image is removed by garbage collection. The default is *2m*.

|`imageGCHighThresholdPercent`
|The percent of disk usage, expressed as an integer, which triggers image
garbage collection. The default is *85*.

|`imageGCLowThresholdPercent`
|The percent of disk usage, expressed as an integer, to which image garbage
collection attempts to free. The default is *80*.
|===

Two lists of images are retrieved in each garbage collector run:

1. A list of images currently running in at least one pod.
2. A list of images available on a host.

As new containers are run, new images appear. All images are marked with a time
stamp. If the image is running (the first list above) or is newly detected (the
second list above), it is marked with the current time. The remaining images are
already marked from the previous spins. All images are then sorted by the time
stamp.

Once the collection starts, the oldest images get deleted first until the
stopping criterion is met.
