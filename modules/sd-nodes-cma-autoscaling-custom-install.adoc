// Module included in the following assemblies:
//
// * nodes/cma/nodes-cma-autoscaling-custom-install.adoc

:_mod-docs-content-type: PROCEDURE
[id="sd-nodes-cma-autoscaling-custom-install_{context}"]
= Installing the custom metrics autoscaler

You can use the following procedure to install the Custom Metrics Autoscaler Operator.

.Prerequisites

* You have access to the cluster as a user with the `cluster-admin` role.
ifdef::openshift-dedicated[]
+
If your {product-title} cluster is in a cloud account that is owned by Red Hat (non-CCS), you must request `cluster-admin` privileges.
endif::openshift-dedicated[]

* Remove any previously-installed Technology Preview versions of the Cluster Metrics Autoscaler Operator.

* Remove any versions of the community-based KEDA.
+
Also, remove the KEDA 1.x custom resource definitions by running the following commands:
+
[source,terminal]
----
$ oc delete crd scaledobjects.keda.k8s.io
----
+
[source,terminal]
----
$ oc delete crd triggerauthentications.keda.k8s.io
----

* Ensure that the `keda` namespace exists. If not, you must manaully create the `keda` namespace.

* Optional: If you need the Custom Metrics Autoscaler Operator to connect to off-cluster services, such as an external Kafka cluster or an external Prometheus service, put any required service CA certificates into a config map. The config map must exist in the same namespace where the Operator is installed. For example:
+
[source,terminal]
----
$ oc create configmap -n openshift-keda thanos-cert  --from-file=ca-cert.pem
----

.Procedure

. In the {product-title} web console, click *Operators* -> *OperatorHub*.

. Choose *Custom Metrics Autoscaler* from the list of available Operators, and click *Install*.

. On the *Install Operator* page, ensure that the *A specific namespace on the cluster* option
is selected for *Installation Mode*.

. For *Installed Namespace*, click *Select a namespace*.

. Click *Select Project*:
+
* If the `keda` namespace exists, select *keda* from the list.
* If the `keda` namespace does not exist:
+
.. Select *Create Project* to open the *Create Project* window.
.. In the *Name* field, enter `keda`.
.. In the *Display Name* field, enter a descriptive name, such as `keda`.
.. Optional: In the *Display Name* field, add a description for the namespace.
.. Click *Create*.

. Click *Install*.

. Verify the installation by listing the Custom Metrics Autoscaler Operator components:

.. Navigate to *Workloads* -> *Pods*.

.. Select the `keda` project from the drop-down menu and verify that the `custom-metrics-autoscaler-operator-*` pod is running.

.. Navigate to *Workloads* -> *Deployments* to verify that the `custom-metrics-autoscaler-operator` deployment is running.

. Optional: Verify the installation in the OpenShift CLI using the following command:
+
[source,terminal]
----
$ oc get all -n keda
----
+
The output appears similar to the following:
+
.Example output
[source,text]
----
NAME                                                      READY   STATUS    RESTARTS   AGE
pod/custom-metrics-autoscaler-operator-5fd8d9ffd8-xt4xp   1/1     Running   0          18m

NAME                                                 READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/custom-metrics-autoscaler-operator   1/1     1            1           18m

NAME                                                            DESIRED   CURRENT   READY   AGE
replicaset.apps/custom-metrics-autoscaler-operator-5fd8d9ffd8   1         1         1       18m
----

