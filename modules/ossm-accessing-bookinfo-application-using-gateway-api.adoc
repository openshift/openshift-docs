:_mod-docs-content-type: PROCEDURE
[id="ossm-accessing-bookinfo-application-using-gateway-api"]
= Accessing the Bookinfo application by using Gateway API

The {k8s} Gateway API deploys a gateway by creating a `Gateway` resource. In {ocp-product-title} 4.15 and later, {SMProductName} implements the Gateway API custom resource definitions (CRDs). However, in {ocp-product-title} 4.18 and earlier, the CRDs are not installed by default. Hence, in {ocp-product-title} 4.15 through 4.18, you must manually install the CRDs. Starting with {ocp-product-title} 4.19, these CRDs are automatically installed and managed, and you can no longer create, update, or delete them.

For details about enabling Gateway API for Ingress in {ocp-product-title} 4.19 and later, see "Configuring ingress cluster traffic" in the {ocp-product-title} documentation.

[NOTE]
====
Red{nbsp}Hat provides support for using the {k8s} Gateway API with {SMProductName}. Red{nbsp}Hat does not provide support for the {k8s} Gateway API custom resource definitions (CRDs). In this procedure, the use of community Gateway API CRDs is shown for demonstration purposes only.
====

.Prerequisites

* You are logged in to the {ocp-product-title} web console as `cluster-admin`.

* The {SMProductName} Operator must be installed.

* The {istio} resource must be deployed.

.Procedure

. Enable the Gateway API CRDs for {ocp-product-title} 4.18 and earlier, by running the following command:
+
[source,terminal]
----
$ oc get crd gateways.gateway.networking.k8s.io &> /dev/null ||  { oc kustomize "github.com/kubernetes-sigs/gateway-api/config/crd?ref=v1.0.0" | oc apply -f -; }
----

. Create and configure a gateway by using the `Gateway` and `HTTPRoute` resources by running the following command:
+
[source,terminal]
----
$ oc apply -f https://raw.githubusercontent.com/openshift-service-mesh/istio/release-1.24/samples/bookinfo/gateway-api/bookinfo-gateway.yaml -n bookinfo
----
+
[NOTE]
====
To configure a gateway with the `bookinfo` application by using the Gateway API, this example uses a sample gateway configuration file that must be applied in the namespace where the application is installed.
====

. Ensure that the Gateway API service is ready, and has an address allocated by running the following command:
+
[source,terminal]
----
$ oc wait --for=condition=programmed gtw bookinfo-gateway -n bookinfo
----

. Retrieve the host by running the following command:
+
[source,terminal]
----
$ export INGRESS_HOST=$(oc get gtw bookinfo-gateway -n bookinfo -o jsonpath='{.status.addresses[0].value}')
----

. Retrieve the port by running the following command:
+
[source,terminal]
----
$ export INGRESS_PORT=$(oc get gtw bookinfo-gateway -n bookinfo -o jsonpath='{.spec.listeners[?(@.name=="http")].port}')
----

. Retrieve the gateway URL by running the following command:
+
[source,terminal]
----
$ export GATEWAY_URL=$INGRESS_HOST:$INGRESS_PORT
----

. Obtain the gateway host name and the URL of the product page by running the following command:
+
[source,terminal]
----
$ echo "http://${GATEWAY_URL}/productpage"
----

.Verification

* Verify that the *productpage* is accessible from a web browser.