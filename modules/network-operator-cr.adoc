// Module included in the following assemblies:
//
// * networking/configuring-network-operator.adoc
// * installing/installing_aws/installing-aws-network-customizations.adoc

[id="network-networkoperator-default-cr-{context}"]
= Network Operator Custom Resource (CR)

The network configuration in an `Network.operator.openshift.io` Custom Resource
(CR) stores the configuration settings for the Network Operator.

The following parameters are set in the `Network.config.openshift.io` CR and
copied to the `Network.operator.openshift.io` CR by the Network Operator:

* `clusterNetwork`
* `serviceNetwork`
* `networkType`

The following CR displays the default configuration for the Network Operator and
explains both the parameters you can configure and valid parameter values:

////
TODO

Revisit parameter descriptions. Most values here cannot be configured
subsequent to cluster installation. Instead, they are set at install time.
The wording "This parameter is set in the `config.openshift.io` object." is
not exactly correct.
////

.Network.operator.openshift.io CR
[source,yaml]
----
apiVersion: operator.openshift.io/v1
kind: Network
spec:
  clusterNetworks:
  - cidr: 10.128.0.0/14 <1>
    hostPrefix: 23 <2>
  serviceNetwork: 172.30.0.0/16 <3>
  defaultNetwork: <4>
    type: OpenShiftSDN <5>
    openshiftSDNConfig: <6>
      mode: NetworkPolicy <7>
      mtu: 1450 <8>
      vxlanPort: 4789 <9>
  deployKubeProxy: false
  kubeProxyConfig: <10>
    bindAddress: 0.0.0.0 <11>
    iptablesSyncPeriod: 30s <12>
    proxyArguments:
      iptables-min-sync-period: <13>
      - 30s
----

<1> A block of IP addresses from which pod IPs are allocated. {product-title}
uses the Classless Inter-Domain Routing (CIDR) standard to allocate IP
addresses. The 'OpenShiftSDN' network plug-in supports multiple ClusterNetworks.
The address blocks for multiple ClusterNetworks must not overlap. This parameter
is set in the `config.openshift.io` object.
<2> The subnet prefix length to assign to each individual node. For example, if
`hostPrefix` is set to `23`, then each node is assigned a `/23` subnet out of
the given `cidr`, allowing for 510 (2^(32 - 23) - 2) pod IP addresses.
<3> A block of IP addresses for services. `OpenShiftSDN` allows only one
serviceNetwork block. This parameter is set in the `config.openshift.io` object.
<4> The header for the parameters that specify the default pod network.
<5> The Network plug-in that is to be deployed. `OpenShiftSDN` is the only
plug-in supported in {product-title} {product-version}. This parameter is set in
the `config.openshift.io` object.
<6> Specify only if you want to override part of the {product-title} SDN
configuration.
<7> Configures the isolation mode for `OpenShiftSDN`. The allowed values are
`Multitenant`, `Subnet`, or `NetworkPolicy`. The default value is
`NetworkPolicy`.
<8> MTU for the VXLAN overlay network. This is normally configured
automatically, but if the nodes in your cluster do not all use the same MTU,
then you must set this explicitly to 50 less than the smallest node MTU value.
<9> The port to use for all VXLAN packets. The default value is 4789. If you are
running in a virtualized environment with existing nodes that are part of
another VXLAN network then you may need to change this.
<10> The parameters in this section specify the `kube-proxy` configuration. If
you do not specify the parameter values, the Network Operator chooses sensible
defaults.
//Currently only `OpenShiftSDN` uses this.
//+optional
<11> The IP address for `kube-proxy` to serve on. The default value is
`0.0.0.0`.
<12> The refresh period for `iptables` rules. The default value is `30s`. Valid
suffixes include `s`, `m`, and `h` and are described in the
link:https://golang.org/pkg/time/#ParseDuration[Go time package] documentation.
<13> The minimum duration before refreshing `iptables` rules. This parameter
ensures that the refresh does not happen too frequently. Valid suffixes include
`s`, `m`, and `h` and are described in the
link:https://golang.org/pkg/time/#ParseDuration[Go time package]

Use the following command to view the `Network.operator.openshift.io` CR object
in a running cluster.

----
$ oc get Network.operator.openshift.io default -o yaml
----
