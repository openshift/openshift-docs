// Module included in the following assemblies:
//
// * logging/log_collection_forwarding/logging-output-types.adoc

:_mod-docs-content-type: PROCEDURE
[id="logging-custom-output-tenants-elasticsearch_{context}"]
= Configuring custom tenants for Elasticsearch outputs

The default Elasticsearch behavior sends logs to indices defined by their `log_type` value and appended by `-write`. For example, `application` logs are sent to the `app-write` index.

You can configure the Elasticsearch index if JSON log forwarding is enabled. See "Additional resources" for more information.

.Prerequisites

* You have installed the {clo}.
* You have access to an external Elasticsearch instance and have enabled JSON log forwarding.
* You have installed the {oc-first}.

.Procedure

. Create or modify a `ClusterLogForwarder` custom resource (CR) that contains one or both of the `structuredTypeKey` and `structuredTypeName` fields. If both are specified, the `structureTypeName` field is used as a fallback if the field defined by the `structuredTypeKey` is not present in the log record.
+
.Example `ClusterLogForwarder` CR
[source,yaml]
----
apiVersion: logging.openshift.io/v1
kind: ClusterLogForwarder
metadata:
# ...
spec:
  outputs:
    - name: external-es
      type: elasticsearch
      elasticsearch:
        structuredTypeKey: kubernetes.labels.logFormat # <1>
        structuredTypeName: myParsedMessages # <2>
  pipelines:
    - name: parsed-app-logs
      inputRefs:
    	 - application
      outputRefs:
    	 - external-es
      parse: json # <3>
----
<1> The `structuredTypeKey` field is the field of the log record used to construct an index name.
<2> The `structureTypeName` field is a static value used to construct an index name.
<3> JSON log forwarding must be enabled in the `ClusterLogForwarder` CR by specifying the `parse: json` field.

The logs must be normalized to avoid MapperParsingException. See the Understanding MapperParsingException article for more information.

.Verification
