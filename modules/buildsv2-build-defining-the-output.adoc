:_content-type: PROCEDURE

[id="build-defining-the-output_{context}"]
= Defining the Output

A `Build` resource can specify the output where it should push the image. For external private registries, it is recommended to specify a secret with the related data to access it. An option is available to specify the annotation and labels for the output image. The annotations and labels mentioned here are specific to the container image and do not relate to the `Build` annotations.

*NOTE*: If you specify annotations or labels, Builds v2 pushes the output image twice. The first push comes from the build strategy. Then, a follow-on update changes the image configuration to add the annotations and labels. If you have automation based on push events in your container registry, be aware of this behavior.

.Prerequisites

* You have a `Build` definition.

.Procedure

* Specify where to push the image by using the `output` parameters.

.Example: Push to a public registry
[source,yaml]
----
apiVersion: shipwright.io/v1alpha1
kind: Build
metadata:
  name: s2i-nodejs-build
spec:
  source:
    url: https://github.com/shipwright-io/sample-nodejs
    contextDir: source-build/
  strategy:
    name: source-to-image
    kind: ClusterBuildStrategy
  builder:
    image: docker.io/centos/nodejs-10-centos7
  output:
    image: image-registry.openshift-image-registry.svc:5000/build-examples/nodejs-ex
----

.Example: Push to a private registry
[source,yaml]
----
apiVersion: shipwright.io/v1alpha1
kind: Build
metadata:
  name: s2i-nodejs-build
spec:
  source:
    url: https://github.com/shipwright-io/sample-nodejs
    contextDir: source-build/
  strategy:
    name: source-to-image
    kind: ClusterBuildStrategy
  builder:
    image: docker.io/centos/nodejs-10-centos7
  output:
    image: us.icr.io/source-to-image-build/nodejs-ex
    credentials:
      name: icr-knbuild
----

.Example: Specify image annotations and labels
[source,yaml]
----
apiVersion: shipwright.io/v1alpha1
kind: Build
metadata:
  name: s2i-nodejs-build
spec:
  source:
    url: https://github.com/shipwright-io/sample-nodejs
    contextDir: source-build/
  strategy:
    name: source-to-image
    kind: ClusterBuildStrategy
  builder:
    image: docker.io/centos/nodejs-10-centos7
  output:
    image: us.icr.io/source-to-image-build/nodejs-ex
    credentials:
      name: icr-knbuild
    annotations:
      "org.opencontainers.image.source": "https://github.com/org/repo"
      "org.opencontainers.image.url": "https://my-company.com/images"
    labels:
      "maintainer": "team@my-company.com"
      "description": "This is my cool image"
----

.Verification

* To verify that annotations were added to the output image, use the `docker manifest inspect` command. For example:
+
[source,sh]
----
$ docker manifest inspect us.icr.io/source-to-image-build/nodejs-ex \
    | jq ".annotations"
----

* To verify which labels were added to the output image that is on the host machine, use the `docker inspect` command. For example:
+
[source,sh]
----
$ docker inspect us.icr.io/source-to-image-build/nodejs-ex \
    | jq ".[].Config.Labels"
----

[role="_additional-resources"]
.Additional resources
* link:https://docs.docker.com/engine/reference/commandline/manifest_inspect/[docker manifest inspect]
* link:https://docs.docker.com/engine/reference/commandline/inspect/[docker inspect]
