// Module included in the following assemblies:
//
// microshift_configuring/microshift-feature-gates.adoc

:_mod-docs-content-type: PROCEDURE
[id="microshift-feature-gates-using_{context}"]
= Using feature gates for {microshift-short}

[role="_abstract"]
To use feature gates in your development environment, you must specify them in the `config.yaml` file or create a configuration snippet file. You must also configure the feature set you want to work with.

[IMPORTANT]
====
* A `config.yaml` configuration file takes precedence over built-in settings. The `config.yaml` file is read every time the {microshift-short} service starts.
* Configuration snippet YAMLs take precedence over both built-in settings and the `config.yaml` configuration file.
* After you enable feature gates, you cannot disable them.
====

.Prerequisites

* You installed {microshift-short}.
* You installed the {oc-first}.
* You have `sudo` privileges on the {microshift-short} host.

.Procedure

. Apply features gates in one of the two following ways:

.. Update the {microshift-short} `config.yaml` configuration file by making a copy of the provided `config.yaml.default` file in the `/etc/microshift/` directory. Name it `config.yaml` and keep it in the source directory.

.. Use a configuration snippet to apply the ingress control settings you want. To do this, create a configuration snippet YAML file and put it in the `/etc/microshift/config.d/` configuration directory. For example, `/etc/microshift/config.d/10-feature-gate.yaml`.

. Replace the default values in the `xyz` section of the {microshift-short} YAML with your valid values, or create a configuration snippet file with the sections you need.
+
.Feature gates configuration with example values
[source,yaml]
----
# ...
apiServer:
  featureGates:
    featureSet: TechPreviewNoUpgrade
# ...
apiServer:
  featureGates:
    featureSet: CustomNoUpgrade
    customNoUpgrade:
      enabled:
      - "CPUManagerPolicyAlphaOptions"
      - "MemoryQoS"
      disabled:
      - "SomeDefaultEnabledFeature"
# ...
----

. Use the following configuration rules:
.. You must set the `featureSet` field when configuring feature gates.
.. When you use `customNoUpgrade` feature, you must set the `featureSet` to `CustomNoUpgrade`. The `customNoUpgrade` field is only valid when `featureSet: CustomNoUpgrade`.

. Configure any settings required for the feature set you want to work with.

. Restart {microshift-short} to apply the configuration changes by running the following command:
+
[source,terminal]
----
$ sudo systemctl restart microshift
----
