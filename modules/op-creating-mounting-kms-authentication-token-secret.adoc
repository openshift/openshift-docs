// This module is included in the following assemblies:
// * secure/using-tekton-chains-for-openshift-pipelines-supply-chain-security.adoc

:_mod-docs-content-type: PROCEDURE
[id="creating-mounting-kms-authentication-token-secret_{context}"]
= Creating and mounting the KMS authentication token secret

[role="_abstract"]
You can supply the authentication token for the Key Management Service (KMS) server by using a secret. For example, if the KMS provider is Hashicorp Vault, the secret must contain the value of `VAULT_TOKEN`.

You must create this secret, mount it on the {tekton-chains} controller, and set the `signers.kms.auth.token-path` parameter to the full path name of the authentication token file.

.Prerequisites

* You installed the {oc-first} utility.
* You have logged in to your {OCP} cluster with administrative rights for the `openshift-pipelines` namespace.

.Procedure

. Create a secret named `kms-secrets` with the `KMS_AUTH_TOKEN` file that has the authentication token for the KMS server by entering the following command:
+
[source, terminal]
----
$ oc create secret generic kms-secrets -n tekton-chains \
  --from-file=KMS_AUTH_TOKEN=<path_and_name>
----
+
Replace `<path_and_name>` with the full path and name of the file that has the authentication token for the KMS server, for example, `/home/user/KMS_AUTH_TOKEN`. You can use another file name instead of `KMS_AUTH_TOKEN`.

. In the `TektonConfig` custom resource (CR), in the `chain` section, configure mounting the secret on the {tekton-chains} controller and set the `signers.kms.auth.token-path` parameter to the full path name of the authentication token file, as shown in the following example:
+
.Example configuration for mounting the `kms-secrets` secret
[source,yaml]
----
apiVersion: operator.tekton.dev/v1
kind: TektonConfig
metadata:
  name: config
spec:
# ...
  chain:
    disabled: false
    signers.kms.auth.token-path: /etc/kms-secrets/KMS_AUTH_TOKEN
    options:
      deployments:
        tekton-chains-controller:
          spec:
            template:
              spec:
                containers:
                - name: tekton-chains-controller
                  volumeMounts:
                  - mountPath: /etc/kms-secrets
                    name: kms-secrets
                volumes:
                -  name: kms-secrets
                   secret:
                    secretName: kms-secrets
# ...
----
