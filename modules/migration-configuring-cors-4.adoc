// Module included in the following assemblies:
//
// migration/migrating_openshift_3_to_4/migrating-openshift-3-to-4.adoc
[id='migration-configuring-cors-4_{context}']
= Configuring cross-origin resource sharing on {product-title} 4 clusters

If you installed the migration controller on your {product-title} 4 cluster, the cluster's resources are modified by the CAM operator and you do not need to configure cross-origin resource sharing. If you did not install the migration controller, you must configure cross-origin resource sharing manually.

To access the API server of an {product-title} 4 cluster from a web application on a different host (in this case, the Cluster Application Migration tool), you must add the CAM host name to the API server and the Kubernetes API server CRs.

.Procedure

. Log in to the {product-title} 4 cluster.
. Edit the API server CR:
+
----
$ oc edit authentication.operator cluster
----

. Add the CAM host name to the `additionalCORSAllowedOrigins` stanza:
+
[source,yaml]
----
spec:
  additionalCORSAllowedOrigins:
  - (?i)//migration-openshift-migration\.apps\.cluster\.com(:|\z)
----
+
[NOTE]
====
This example uses the following syntax:

* The `(?i)` makes it case-insensitive.
* The `//` pins to the beginning of the domain and matches the double slash
following `http:` or `https:`.
* The `\.` escapes dots in the domain name.
* The `(:|\z)` matches the end of the domain name `(\z)` or a port separator
`(:)`.
====

. Save the file to apply the changes.

. Edit the Kubernetes API server CR:
+
----
$ oc edit kubeapiserver.operator cluster
----

. Add `corsAllowedOrigins` and the CAM host name to the `unsupportedConfigOverrides` stanza:
+
[source,yaml]
----
spec:
  unsupportedConfigOverrides:
    corsAllowedOrigins:
    - (?i)//migration-openshift-migration\.apps\.cluster\.com(:|\z)
----

. Save the file to apply the changes.
