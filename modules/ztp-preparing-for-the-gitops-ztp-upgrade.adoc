// Module included in the following assemblies:
//
// *scalability_and_performance/ztp-deploying-disconnected.adoc

:_content-type: PROCEDURE
[id="ztp-preparing-for-the-gitops-ztp-upgrade_{context}"]
= Preparing for the upgrade

Use the following procedure to prepare your site for the GitOps ZTP upgrade.

.Procedure

. Obtain the new version of the GitOps ZTP container.

. Extract the `argocd/deployment` directory using the following commands:
+
[source,terminal]
----
$ mkdir -p ./out
----
+
[source,terminal]
----
$ podman run --rm ztp-site-generator:latest extract /home/ztp --tar | tar x -C ./out
----
+
The `/out` directory contains the following subdirectories:
+
* `out/extra-manifest`: contains the source CR files that `SiteConfig` uses to generate
the extra manifest `configMap`.
* `out/source-crs`: contains the source CR files that `PolicyGenTemplate` uses to generate
the {rh-rhacm-first} policies.
* `out/argocd/deployment`: contains patches and yaml files to apply on the hub cluster for use
in the next step of this procedure.
* `out/argocd/example`: contains example `SiteConfig` and `PolicyGenTemplate` files that
represent the recommended configuration.

. Update the `clusters-app.yaml` and `policies-app.yaml` files to reflect the name of your
applications and the URL, branch, and path for your Git repository.

If the upgrade includes changes to policies that may result in obsolete policies,
these policies should be removed prior to performing the upgrade.
