// Module included in the following assemblies:
//
// * hardware_accelerators/amd-gpu-operator.adoc

:_content-type: PROCEDURE
[id="amd-testing-rocm-smi_{context}"]
= Testing rocm-smi

.Procedure

. Create a YAML file that tests `rocm-smi`:
+
[source,terminal]
----
$ cat << EOF > rocm-smi.yaml
----
+
.Example output
[source,yaml]
----
apiVersion: v1
kind: Pod
metadata:
 name: rocm-smi
spec:
 containers:
 - image: docker.io/rocm/pytorch:latest
   name: rocm-smi
   command: ["/bin/sh","-c"]
   args: ["rocm-smi"]
   resources:
    limits:
      amd.com/gpu: 1
    requests:
      amd.com/gpu: 1
 restartPolicy: Never
EOF
----

. Create the `rocm-smi` pod:
+
[source,terminal]
----
$ oc create -f rocm-smi.yaml
----
+
.Example output
[source,terminal]
----
pod/rocm-smi created
----

. Check the `rocm-smi` log with one MI210 GPU:
+
[source,terminal]
----
$ oc get pods
----
+
.Example output
[source,terminal]
----
NAME        READY   STATUS      RESTARTS   AGE
rocm-smi    0/1     Completed   0          40s
----

. Check the logs:
+
[source,terminal]
----
$ oc logs pod/rocm-smi
----
+
.Example output
[source,terminal]
----
====================================== ROCm System Management Interface ======================================
================================================ Concise Info ================================================
Device  [Model : Revision]    Temp    Power  Partitions      SCLK    MCLK     Fan  Perf  PwrCap  VRAM$  GPU$  
        Name (20 chars)       (Edge)  (Avg)  (Mem, Compute)                                                   
==============================================================================================================
0       [0x0c34 : 0x02]       32.0Â°C  38.0W  N/A, N/A        800Mhz  1600Mhz  0$   auto  300.0W    0$   0$    
        Instinct MI210                                                                                        
==============================================================================================================
============================================ End of ROCm SMI Log =============================================
----

. Delete the pod: 
+
[source,terminal]
----
$ oc delete -f rocm-smi.yaml
----
+
.Example output
[source,terminal]
----
pod "rocm-smi" deleted
----