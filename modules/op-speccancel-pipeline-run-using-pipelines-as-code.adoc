// This module is included in the following assemblies:
// * pac/managing-pipeline-runs-pac.adoc

:_mod-docs-content-type: REFERENCE
[id="speccancel-pipeline-run-using-pipelines-as-code_{context}"]
= Annotations for specifying automatic cancellation-in-progress for a pipeline run

By default, {pac} does not cancel pipeline runs automatically. Every pipeline run that {pac} creates and starts executes until it completes. However, events that trigger pipeline runs can come in quick succession. For example, if a pull request triggers a pipeline run and then the user pushes new commits into the pull request source branch, each push triggers a new copy of the pipeline run. If several pushes happen, several copies can run, which can consume excessive cluster resources.

You can configure a pipeline run to enable automatic cancellation-in-progress. If you enable automatic cancellation for a pipeline run, {pac} cancels the pipeline run in the following situations:

* {pac} has successfully started a copy of the same pipeline run for the same pull request or the same source branch.

* The pull request that triggered the pipeline run is merged or closed.

You can use the following example to enable automatic cancellation when you create the `sample-pipeline` pipeline run:

[source,yaml]
----
apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
  name: sample-pipeline
annotations:
  pipelinesascode.tekton.dev/cancel-in-progress: "true"
# ...
----

:FeatureName: Automatic cancellation-in-progress of pipeline runs
include::snippets/technology-preview.adoc[]

[NOTE]
====
* {pac} cancels a pipeline run _after_ starting a new copy of this pipeline run successfully. The `pipelinesascode.tekton.dev/cancel-in-progress` setting does _not_ ensure that only one copy of the pipeline run is executing at any time.

* To enable `cancellation-in-progress` for all default pipeline runs, use the `enable-cancel-in-progress-on-pull-requests` and the `enable-cancel-in-progress-on-push` settings. These settings are available in the `platforms.openshift.pipelinesAsCode.settings` spec of the `TektonConfig` custom resource (CR) configure {pac}. 
====
