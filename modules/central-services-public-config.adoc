// Module included in the following assemblies:
//
// * installing/installing_helm/install-helm-customization.adoc
// * installing/installing_ocp/install-central-ocp.adoc
// * installing/installing_other/install-central-other.adoc

:_mod-docs-content-type: CONCEPT
[id="central-services-public-configuration-file_{context}"]
= Public configuration file
This section lists the configurable parameters of the `values-public.yaml` file.

[id="central-services-public-configuration-file-image-pull-secrets_{context}"]
== Image pull secrets
Image pull secrets are the credentials required for pulling images from your registry.

|===
| Parameter | Description

| `imagePullSecrets.allowNone`
| Use `true` if you are using a custom registry and it allows pulling images without credentials.

| `imagePullSecrets.useExisting`
| A comma-separated list of secrets as values.
For example, `secret1, secret2`.
Use this option if you have already created pre-existing image pull secrets with the given name in the target namespace.

| `imagePullSecrets.useFromDefaultServiceAccount`
| Use `true` if you have already configured the default service account in the target namespace with sufficiently scoped image pull secrets.
|===

[id="central-services-public-configuration-file-image_{context}"]
== Image
Image declares the configuration to set up the main registry, which the Helm chart uses to resolve images for the `central.image`, `scanner.image`, `scanner.dbImage`, `scannerV4.image`, and `scannerV4.db.image` parameters.

|===
| Parameter | Description

| `image.registry`
| Address of your image registry.
Either use a hostname, such as `registry.redhat.io`, or a remote registry hostname, such as `us.gcr.io/stackrox-mirror`.
|===

[id="central-services-public-configuration-file-config-as-code_{context}"]
== Policy as code

Policy as code provides a way to configure {product-title-short} to work with a continuous delivery tool such as Argo CD to track, manage, and apply policies that you have authored locally or exported from the {product-title-short} portal and modified. You configure Argo CD or your other tool to apply policy as code resources to the same namespace in which {product-title-short} is installed.

|===
| Parameter | Description

| `configAsCode.enabled`
| By default, the value is `true` so that policy as code is enabled. Set to `false` to disable the policy as code feature.

|===

[id="central-services-public-configuration-file-environment-variables_{context}"]
== Environment variables
{product-title} automatically detects your cluster environment and sets values for `env.openshift`, `env.istio`, and `env.platform`.
Only set these values to override the automatic cluster environment detection.

|===
| Parameter | Description

| `env.openshift`
| Use `true` for installing on an {ocp} cluster and overriding automatic cluster environment detection.

| `env.istio`
| Use `true` for installing on an Istio enabled cluster and overriding automatic cluster environment detection.

| `env.platform`
| The platform on which you are installing {product-title-short}.
Set its value to `default` or `gke` to specify cluster platform and override automatic cluster environment detection.

| `env.offlineMode`
| Use `true` to use {product-title-short} in offline mode.
//TODO: Add link to offline mode.
|===

[id="additional-trusted-certificate-authorities_{context}"]
== Additional trusted certificate authorities
The {product-title-short} automatically references the system root certificates to trust.
When Central, the StackRox Scanner, or Scanner V4 must reach out to services that use certificates issued by an authority in your organization or a globally trusted partner organization, you can add trust for these services by specifying the root certificate authority to trust by using the following parameter:

|===
| Parameter | Description

| `additionalCAs.<certificate_name>`
| Specify the PEM encoded certificate of the root certificate authority to trust.

|===

[id="default-network-policy-creation_{context}"]
== Default network policies

To provide security at the network level, {product-title-short} creates default `NetworkPolicy` resources in the namespace where Central is installed. These network policies allow ingress to specific components on specific ports. If you do not want {product-title-short} to create these policies, set this parameter to `Disabled`. The default value is `Enabled`.

[WARNING]
====
Disabling creation of default network policies can break communication between {product-title-short} components. If you disable creation of default policies, you must create your own network policies to allow this communication.
====

|===
| Parameter | Description

|`network.enableNetworkPolicies`
| Specify if {product-title-short} creates default network policies to allow communication between components. To create your own network policies, set this parameter to `False`. The default value is `True`.

|===

[id="central-services-public-configuration-file-central_{context}"]
== Central
Configurable parameters for Central.

* For exposing Central deployment for external access.
You must specify one parameter, either `central.exposure.loadBalancer`, `central.exposure.nodePort`, or `central.exposure.route`.
When you do not specify any value for these parameters, you must manually expose Central or access it by using port-forwarding.

The following table includes settings for an external PostgreSQL database.

|===
| Parameter | Description

|`central.declarativeConfiguration.mounts.configMaps`
| Mounts config maps used for declarative configurations.

|`Central.declarativeConfiguration.mounts.secrets`
| Mounts secrets used for declarative configurations.

| `central.endpointsConfig`
| The endpoint configuration options for Central.

| `central.nodeSelector`
| If the node selector selects tainted nodes, use this parameter to specify a taint toleration key, value, and effect for Central. This parameter is mainly used for infrastructure nodes.

| `central.tolerations`
| If the node selector selects tainted nodes, use this parameter to specify a taint toleration key, value, and effect for Central. This parameter is mainly used for infrastructure nodes.

| `central.exposeMonitoring`
| Specify `true` to expose Prometheus metrics endpoint for Central on port number `9090`.

| `central.image.registry`
| A custom registry that overrides the global `image.registry` parameter for the Central image.

| `central.image.name`
| The custom image name that overrides the default Central image name (`main`).

| `central.image.tag`
| The custom image tag that overrides the default tag for Central image.
If you specify your own image tag during a new installation, you must manually increment this tag when you to upgrade to a new version by running the `helm upgrade` command.
If you mirror Central images in your own registry, do not modify the original image tags.

| `central.image.fullRef`
| Full reference including registry address, image name, and image tag for the Central image.
Setting a value for this parameter overrides the `central.image.registry`, `central.image.name`, and `central.image.tag` parameters.

| `central.resources.requests.memory`
| The memory request for Central.

| `central.resources.requests.cpu`
| The CPU request for Central.

| `central.resources.limits.memory`
| The memory limit for Central.

| `central.resources.limits.cpu`
| The CPU limit for Central.

| `central.exposure.loadBalancer.enabled`
| Use `true` to expose Central by using a load balancer.

| `central.exposure.loadBalancer.port`
| The port number on which to expose Central.
The default port number is 443.

| `central.exposure.nodePort.enabled`
| Use `true` to expose Central by using the node port service.

| `central.exposure.nodePort.port`
| The port number on which to expose Central.
When you skip this parameter, {ocp} automatically assigns a port number.
Red{nbsp}Hat recommends that you do not specify a port number if you are exposing {product-title-short} by using a node port.

| `central.exposure.route.enabled`
| Use `true` to expose Central by using a route.
Disables all route settings if set to `false`.
This parameter is only available for {ocp} clusters.

| `central.exposure.route.host`
| Use this parameter to specify a custom hostname to use for Central's passthrough route.
Leave this unset to accept the default value that {ocp} provides.
This parameter is only available for {ocp} clusters.

| `central.exposure.route.reencrypt.enabled`
| Set this to `true` to expose Central through a {osp} reencrypt route.
The default value is `false`.
This parameter is only available for {ocp} clusters.

| `central.exposure.route.reencrypt.host`
| Use this parameter to specify a custom hostname to use for Central's reencrypt route.
Leave this unset to accept the default value that {ocp} provides.
This parameter is only available for {ocp} clusters.

| `central.exposure.route.reencrypt.tls.caCertificate`
| Use this parameter to specify a PEM-encoded certificate chain that might be used to establish a complete chain of trust.
By default, {ocp} provides the certificate authority.
This parameter is only available for {ocp} clusters.

| `central.exposure.route.reencrypt.tls.certificate`
| Use this parameter to specify the PEM-encoded certificate that is served on the route. The {ocp} certificate authority signs the default certificate.
This parameter is only available for {ocp} clusters.

| `central.exposure.route.reencrypt.tls.destinationCACertificate`
| Use this parameter to specify the CA certificate of the final destination, that is of Central.
The {ocp} router uses this certificate to perform health checks on the secure connection. By default, Central provides the certificate authority.

| `central.exposure.route.reencrypt.tls.key`
| Use this parameter to specify the PEM-encoded private key of the certificate that is served on the route.
The {ocp} certificate authority signs the default certificate.
This parameter is only available for {ocp} clusters.

| `central.db.external`
| Use `true` to specify that Central DB should not be deployed and that an external database will be used.

| `central.db.source.connectionString`
a| The connection string for Central to use to connect to the database. This is only used when `central.db.external` is set to true. The connection string must be in keyword/value format as described in the PostgreSQL documentation in "Additional resources".

* Only PostgreSQL 13 is supported.
* Connections through PgBouncer are not supported.
* User must be superuser with ability to create and delete databases.

| `central.db.source.minConns`
| The minimum number of connections to the database to be established.

| `central.db.source.maxConns`
| The maximum number of connections to the database to be established.

| `central.db.source.statementTimeoutMs`
| The number of milliseconds a single query or transaction can be active against the database.

| `central.db.postgresConfig`
| The postgresql.conf to be used for Central DB as described in the PostgreSQL documentation in "Additional resources".

| `central.db.hbaConfig`
| The pg_hba.conf to be used for Central DB as described in the PostgreSQL documentation in "Additional resources".

| `central.db.nodeSelector`
| Specify a node selector label as `label-key: label-value` to force Central DB to only schedule on nodes with the specified label.

| `central.db.image.registry`
| A custom registry that overrides the global `image.registry` parameter for the Central DB image.

| `central.db.image.name`
| The custom image name that overrides the default Central DB image name (`central-db`).

| `central.db.image.tag`
| The custom image tag that overrides the default tag for Central DB image.
If you specify your own image tag during a new installation, you must manually increment this tag when you to upgrade to a new version by running the `helm upgrade` command.
If you mirror Central DB images in your own registry, do not modify the original image tags.

| `central.db.image.fullRef`
| Full reference including registry address, image name, and image tag for the Central DB image.
Setting a value for this parameter overrides the `central.db.image.registry`, `central.db.image.name`, and `central.db.image.tag` parameters.

| `central.db.resources.requests.memory`
| The memory request for Central DB.

| `central.db.resources.requests.cpu`
| The CPU request for Central DB.

| `central.db.resources.limits.memory`
| The memory limit for Central DB.

| `central.db.resources.limits.cpu`
| The CPU limit for Central DB.

| `central.db.persistence.hostPath`
| The path on the node where {product-title-short} should create a database volume. Red{nbsp}Hat does not recommend using this option.

| `central.db.persistence.persistentVolumeClaim.claimName`
| The name of the persistent volume claim (PVC) you are using.

| `central.db.persistence.persistentVolumeClaim.createClaim`
| Use `true` to create a new persistent volume claim, or `false` to use an existing claim.

| `central.db.persistence.persistentVolumeClaim.size`
| The size (in GiB) of the persistent volume managed by the specified claim.

|===

[id="central-services-public-configuration-file-scanner_{context}"]
== StackRox Scanner
The following table lists the configurable parameters for the StackRox Scanner. This is the scanner used for node and platform scanning. If Scanner V4 is not enabled, the StackRox scanner also performs image scanning. Beginning with version 4.4, Scanner V4 can be enabled to provide image scanning. See the next table for Scanner V4 parameters.

|===
| Parameter | Description

| `scanner.disable`
| Use `true` to install {product-title-short} without the StackRox Scanner.
When you use it with the `helm upgrade` command, Helm removes the existing StackRox Scanner deployment.

| `scanner.exposeMonitoring`
| Specify `true` to expose Prometheus metrics endpoint for the StackRox Scanner on port number `9090`.

| `scanner.replicas`
| The number of replicas to create for the StackRox Scanner deployment.
When you use it with the `scanner.autoscaling` parameter, this value sets the initial number of replicas.

| `scanner.logLevel`
| Configure the log level for the StackRox Scanner.
Red{nbsp}Hat recommends that you not change the default log level value (`INFO`).

| `scanner.nodeSelector`
| Specify a node selector label as `label-key: label-value` to force the StackRox Scanner to only schedule on nodes with the specified label.

| `scanner.tolerations`
| If the node selector selects tainted nodes, use this parameter to specify a taint toleration key, value, and effect for the StackRox Scanner. This parameter is mainly used for infrastructure nodes.

| `scanner.autoscaling.disable`
| Use `true` to disable autoscaling for the StackRox Scanner deployment.
When you disable autoscaling, the `minReplicas` and `maxReplicas` parameters do not have any effect.

| `scanner.autoscaling.minReplicas`
| The minimum number of replicas for autoscaling.

| `scanner.autoscaling.maxReplicas`
| The maximum number of replicas for autoscaling.

| `scanner.resources.requests.memory`
| The memory request for the StackRox Scanner.

| `scanner.resources.requests.cpu`
| The CPU request for the StackRox Scanner.

| `scanner.resources.limits.memory`
| The memory limit for the StackRox Scanner.

| `scanner.resources.limits.cpu`
| The CPU limit for the StackRox Scanner.

| `scanner.dbResources.requests.memory`
| The memory request for the StackRox Scanner database deployment.

| `scanner.dbResources.requests.cpu`
| The CPU request for the StackRox Scanner database deployment.

| `scanner.dbResources.limits.memory`
| The memory limit for the StackRox Scanner database deployment.

| `scanner.dbResources.limits.cpu`
| The CPU limit for the StackRox Scanner database deployment.

| `scanner.image.registry`
| A custom registry for the StackRox Scanner image.

| `scanner.image.name`
| The custom image name that overrides the default StackRox Scanner image name (`scanner`).

| `scanner.dbImage.registry`
| A custom registry for the StackRox Scanner DB image.

| `scanner.dbImage.name`
| The custom image name that overrides the default StackRox Scanner DB image name (`scanner-db`).

| `scanner.dbNodeSelector`
| Specify a node selector label as `label-key: label-value` to force the StackRox Scanner DB to only schedule on nodes with the specified label.

| `scanner.dbTolerations`
| If the node selector selects tainted nodes, use this parameter to specify a taint toleration key, value, and effect for the StackRox Scanner DB. This parameter is mainly used for infrastructure nodes.

|===

[id="central-services-public-configuration-file-scannerv4_{context}"]
== Scanner V4
The following table lists the configurable parameters for Scanner V4.

|===
| Parameter | Description

| `scannerV4.db.persistence.persistentVolumeClaim.claimName`
| The name of the PVC to manage persistent data for Scanner V4. By default, for Central, the system creates a PVC and uses the default value of `scanner-v4-db` for the name.
| `scannerV4.db.persistence.persistentVolumeClaim.size`
| The size of the PVC to manage persistent data for Scanner V4.

| `scannerV4.db.persistence.persistentVolumeClaim.storageClassName`
| The name of the storage class to use for the PVC. If your cluster is not configured with a default storage class, you must provide a value for this parameter.

| `scannerV4.disable`
| Use `false` to enable Scanner V4. When setting this parameter, the StackRox Scanner must also be enabled by setting `scanner.disable=false`. Until feature parity between the StackRox Scanner and Scanner V4 is reached, Scanner V4 can only be used in combination with the StackRox Scanner. Enabling Scanner V4 without also enabling the StackRox Scanner is not supported. When you set this parameter to `true` with the `helm upgrade` command, Helm removes the existing Scanner V4 deployment.

| `scannerV4.exposeMonitoring`
| Specify `true` to expose Prometheus metrics endpoint for Scanner V4 on port number `9090`.

| `scannerV4.indexer.replicas`
| The number of replicas to create for the Scanner V4 Indexer deployment.
When you use it with the `scannerV4.indexer.autoscaling` parameter, this value sets the initial number of replicas.

| `scannerV4.indexer.logLevel`
| Configure the log level for the Scanner V4 Indexer.
Red{nbsp}Hat recommends that you not change the default log level value (`INFO`).

| `scannerV4.indexer.nodeSelector`
| Specify a node selector label as `label-key: label-value` to force the Scanner V4 Indexer to only schedule on nodes with the specified label.

| `scannerV4.indexer.tolerations`
| If the node selector selects tainted nodes, use this parameter to specify a taint toleration key, value, and effect for the Scanner V4 Indexer. This parameter is mainly used for infrastructure nodes.

| `scannerV4.indexer.autoscaling.disable`
| Use `true` to disable autoscaling for the Scanner V4 Indexer deployment.
When you disable autoscaling, the `minReplicas` and `maxReplicas` parameters do not have any effect.

| `scannerV4.indexer.autoscaling.minReplicas`
| The minimum number of replicas for autoscaling.

| `scannerV4.indexer.autoscaling.maxReplicas`
| The maximum number of replicas for autoscaling.

| `scannerV4.indexer.resources.requests.memory`
| The memory request for the Scanner V4 Indexer.

| `scannerV4.indexer.resources.requests.cpu`
| The CPU request for the Scanner V4 Indexer.

| `scannerV4.indexer.resources.limits.memory`
| The memory limit for the Scanner V4 Indexer.

| `scannerV4.indexer.resources.limits.cpu`
| The CPU limit for the Scanner V4 Indexer.

| `scannerV4.matcher.replicas`
| The number of replicas to create for the Scanner V4 Matcher deployment.
When you use it with the `scannerV4.matcher.autoscaling` parameter, this value sets the initial number of replicas.

| `scannerV4.matcher.logLevel`
|Red{nbsp}Hat recommends that you not change the default log level value (`INFO`).

| `scannerV4.matcher.nodeSelector`
| Specify a node selector label as `label-key: label-value` to force the Scanner V4 Matcher to only schedule on nodes with the specified label.

| `scannerV4.matcher.tolerations`
| If the node selector selects tainted nodes, use this parameter to specify a taint toleration key, value, and effect for the Scanner V4 Matcher. This parameter is mainly used for infrastructure nodes.

| `scannerV4.matcher.autoscaling.disable`
| Use `true` to disable autoscaling for the Scanner V4 Matcher deployment.
When you disable autoscaling, the `minReplicas` and `maxReplicas` parameters do not have any effect.

| `scannerV4.matcher.autoscaling.minReplicas`
| The minimum number of replicas for autoscaling.

| `scannerV4.matcher.autoscaling.maxReplicas`
| The maximum number of replicas for autoscaling.

| `scannerV4.matcher.resources.requests.memory`
| The memory request for the Scanner V4 Matcher.

| `scannerV4.matcher.resources.requests.cpu`
| The CPU request for the Scanner V4 Matcher.

| `scannerV4.db.resources.requests.memory`
| The memory request for the Scanner V4 database deployment.

| `scannerV4.db.resources.requests.cpu`
| The CPU request for the Scanner V4 database deployment.

| `scannerV4.db.resources.limits.memory`
| The memory limit for the Scanner V4 database deployment.

| `scannerV4.db.resources.limits.cpu`
| The CPU limit for the Scanner V4 database deployment.

| `scannerV4.db.nodeSelector`
| Specify a node selector label as `label-key: label-value` to force the Scanner V4 DB to only schedule on nodes with the specified label.

| `scannerV4.db.tolerations`
| If the node selector selects tainted nodes, use this parameter to specify a taint toleration key, value, and effect for the Scanner V4 DB. This parameter is mainly used for infrastructure nodes.

| `scannerV4.db.image.registry`
| A custom registry for the Scanner V4 DB image.

| `scannerV4.db.image.name`
| The custom image name that overrides the default Scanner V4 DB image name (`scanner-v4-db`).

| `scannerV4.image.registry`
| A custom registry for the Scanner V4 image.

| `scannerV4.image.name`
| The custom image name that overrides the default Scanner V4 image name (`scanner-v4`).

|===

[id="central-services-public-configuration-file-customizations_{context}"]
== Customization
Use these parameters to specify additional attributes for all objects that {product-title-short} creates.

|===
| Parameter | Description

| `customize.labels`
| A custom label to attach to all objects.

| `customize.annotations`
| A custom annotation to attach to all objects.

| `customize.podLabels`
| A custom label to attach to all deployments.

| `customize.podAnnotations`
| A custom annotation to attach to all deployments.

| `customize.envVars`
| A custom environment variable for all containers in all objects.

| `customize.central.labels`
| A custom label to attach to all objects that Central creates.

| `customize.central.annotations`
| A custom annotation to attach to all objects that Central creates.

| `customize.central.podLabels`
| A custom label to attach to all Central deployments.

| `customize.central.podAnnotations`
| A custom annotation to attach to all Central deployments.

| `customize.central.envVars`
| A custom environment variable for all Central containers.

| `customize.scanner.labels`
| A custom label to attach to all objects that Scanner creates.

| `customize.scanner.annotations`
| A custom annotation to attach to all objects that Scanner creates.

| `customize.scanner.podLabels`
| A custom label to attach to all Scanner deployments.

| `customize.scanner.podAnnotations`
| A custom annotation to attach to all Scanner deployments.

| `customize.scanner.envVars`
| A custom environment variable for all Scanner containers.

| `customize.scanner-db.labels`
| A custom label to attach to all objects that Scanner DB creates.

| `customize.scanner-db.annotations`
| A custom annotation to attach to all objects that Scanner DB creates.

| `customize.scanner-db.podLabels`
| A custom label to attach to all Scanner DB deployments.

| `customize.scanner-db.podAnnotations`
| A custom annotation to attach to all Scanner DB deployments.

| `customize.scanner-db.envVars`
| A custom environment variable for all Scanner DB containers.

| `customize.scanner-v4-indexer.labels`
| A custom label to attach to all objects that Scanner V4 Indexer creates and into the pods belonging to them.

| `customize.scanner-v4-indexer.annotations`
| A custom annotation to attach to all objects that Scanner V4 Indexer creates and into the pods belonging to them.

| `customize.scanner-v4-indexer.podLabels`
| A custom label to attach to all objects that Scanner V4 Indexer creates and into the pods belonging to them.

| `customize.scanner-v4-indexer.podAnnotations`
| A custom annotation to attach to all objects that Scanner V4 Indexer creates and into the pods belonging to them.

| `customize.scanner-4v-indexer.envVars`
| A custom environment variable for all Scanner V4 Indexer containers and the pods belonging to them.

| `customize.scanner-v4-matcher.labels`
| A custom label to attach to all objects that Scanner V4 Matcher creates and into the pods belonging to them.

| `customize.scanner-v4-matcher.annotations`
| A custom annotation to attach to all objects that Scanner V4 Matcher creates and into the pods belonging to them.

| `customize.scanner-v4-matcher.podLabels`
| A custom label to attach to all objects that Scanner V4 Matcher creates and into the pods belonging to them.

| `customize.scanner-v4-matcher.podAnnotations`
| A custom annotation to attach to all objects that Scanner V4 Matcher creates and into the pods belonging to them.

| `customize.scanner-4v-matcher.envVars`
| A custom environment variable for all Scanner V4 Matcher containers and the pods belonging to them.

| `customize.scanner-v4-db.labels`
| A custom label to attach to all objects that Scanner V4 DB creates and into the pods belonging to them.

| `customize.scanner-v4-db.annotations`
| A custom annotation to attach to all objects that Scanner V4 DB creates and into the pods belonging to them.

| `customize.scanner-v4-db.podLabels`
| A custom label to attach to all objects that Scanner V4 DB creates and into the pods belonging to them.

| `customize.scanner-v4-db.podAnnotations`
| A custom annotation to attach to all objects that Scanner V4 DB creates and into the pods belonging to them.

| `customize.scanner-4v-db.envVars`
| A custom environment variable for all Scanner V4 DB containers and the pods belonging to them.



|===

You can also use:

* the `customize.other.service/\*.labels` and the `customize.other.service/*.annotations` parameters, to specify labels and annotations for all objects.
* or, provide a specific service name, for example, `customize.other.service/central-loadbalancer.labels` and `customize.other.service/central-loadbalancer.annotations` as parameters and set their value.

[id="central-services-public-configuration-file-advance-customization_{context}"]
== Advanced customization
[IMPORTANT]
====
The parameters specified in this section are for information only.
Red{nbsp}Hat does not support {product-title-short} instances with modified namespace and release names.
====

|===
| Parameter | Description

| `allowNonstandardNamespace`
| Use `true` to deploy {product-title-short} into a namespace other than the default namespace `stackrox`.

| `allowNonstandardReleaseName`
| Use `true` to deploy {product-title-short} with a release name other than the default `stackrox-central-services`.
|===
