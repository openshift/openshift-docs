// Module included in the following assemblies:
//
// * builds/triggering-builds-build-hooks.adoc

:_mod-docs-content-type: PROCEDURE
[id="third-party-cluster-webhook-failures_{context}"]
= Recovering an unstable cluster due to admission webhooks

[role="_abstract"]
If a misconfigured admission webhook causes your cluster to fail, you must delete the webhook configuration to restore immediate functionality.

.Procedure

. Back up the webhook configuration. Choose either `ValidatingWebhookConfiguration` or `MutatingWebhookConfiguration` for the <webhook_configuration> value.
+
[source,terminal]
----
oc get <webhook_configuration> <webhook-name> -o yaml > webhook-backup.yaml
----

. Delete the webhook.
+
[source,terminal]
----
oc delete <webhook_configuration> <webhook_name>
----

. Fix the webhook configuration to exclude infrastructure namespaces when you reapply it.
+
[source,yaml]
----
apiVersion: admissionregistration.k8s.io/v1
kind:
namespaceSelector:
    matchExpressions:
        key: kubernetes.io/metadata.name operator: NotIn values: ["openshift-", "kube-"]
----
+
where:
+
`kind`:: Use either `ValidatingWebhookConfiguration` or `MutatingWebhookConfiguration` based on your needs.