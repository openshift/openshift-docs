// This module is included in the following assemblies:
// * install_config/customizing-configurations-in-the-tektonconfig-cr.adoc

:_mod-docs-content-type: REFERENCE
[id="event-pruner-reference_{context}"]
= Configuration of the event-based pruner

:FeatureName: The event-based pruner
include::snippets/technology-preview.adoc[]

You can configure the pruning behavior for the event-based pruner by modifying the `tekton-pruner-default-spec` config map in the `openshift-pipelines` namespace. This config map supports both global pruning policies and optional namespace-specific overrides.

The following example shows a default `tekton-pruner-default-spec` config map that uses global pruning rules:

[source,yaml]
----
apiVersion: v1
kind: ConfigMap
metadata:
  name: tekton-pruner-default-spec
  namespace: openshift-pipelines
data:
  global-config: |
    enforcedConfigLevel: global
    ttlSecondsAfterFinished: 300
    successfulHistoryLimit: 3
    failedHistoryLimit: 3
    historyLimit: 5
# ...
----
* `ttlSecondsAfterFinished: 300`: Delete resources 300 seconds (5 minutes) after completion.
* `successfulHistoryLimit: 3`: Retain 3 successful runs.
* `failedHistoryLimit: 3`: Retain 3 failed runs.
* `historyLimit: 5`: Limit retention to 5 runs. This setting is used if status-specific limits are not defined. 

You can define pruning rules for individual namespaces by setting `enforcedConfigLevel` to `namespace` and configuring policies under the `namespaces` section. In the following example, a 60 second time to live (TTL) is applied to resources in the `dev-project` namespace:

[source,yaml]
----
# ...
data:
  global-config: |
    enforcedConfigLevel: namespace
    ttlSecondsAfterFinished: 300
    namespaces:
      dev-project:
        ttlSecondsAfterFinished: 60
# ...
----

You can use the following parameters in the `global-config` section of the `tekton-pruner-default-spec` config map:

[cols="1,3",options="header"]
|===
|Parameter |Description

|`ttlSecondsAfterFinished`
|Delete resources after a fixed number of seconds following completion.

|`successfulHistoryLimit`
|Retain the specified number of most recent successful runs, and delete older successful runs.

|`failedHistoryLimit`
|Retain the specified number of most recent failed runs, and delete older failed runs.

|`historyLimit`
|Apply a generic history limit when status-specific limits are not defined.

|`enforcedConfigLevel`
|Specify the level at which the pruner applies the configuration. Accepted values: `global` or `namespace`.

|`namespaces`
|Define per-namespace pruning rules.
|===
