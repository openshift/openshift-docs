// Module is included in the following assemblies:
//
// * serverless/admin_guide/serverless-kafka-admin.adoc

:_content-type: PROCEDURE
[id="serverless-kafka-broker-sasl-default-config_{context}"]
= Configuring SASL authentication for Apache Kafka brokers

_Simple Authentication and Security Layer_ (SASL) is used by Apache Kafka for authentication. If you use SASL authentication on your cluster, users must provide credentials to Knative for communicating with the Kafka cluster; otherwise events cannot be produced or consumed.

.Prerequisites

* You have cluster or dedicated administrator permissions on {ocp-product-title}.
* The {ServerlessOperatorName}, Knative Eventing, and the `KnativeKafka` CR are installed on your {ocp-product-title} cluster.
* You have created a project or have access to a project with the appropriate roles and permissions to create applications and other workloads in {ocp-product-title}.
* You have a username and password for a Kafka cluster.
* You have chosen the SASL mechanism to use, for example, `PLAIN`, `SCRAM-SHA-256`, or `SCRAM-SHA-512`.
* If TLS is enabled, you also need the `ca.crt` certificate file for the Kafka cluster.
* Install the OpenShift CLI (`oc`).

.Procedure

. Create the certificate files as a secret in the `knative-eventing` namespace:
+
[source,terminal]
----
$ oc create secret -n knative-eventing generic <secret_name> \
  --from-literal=protocol=SASL_SSL \
  --from-literal=sasl.mechanism=<sasl_mechanism> \
  --from-file=ca.crt=caroot.pem \
  --from-literal=password="SecretPassword" \
  --from-literal=user="my-sasl-user"
----
** Use the key names `protocol`, `sasl.mechanism`, `ca.crt`, `password`, and `user`. Do not change them.
+
[NOTE]
====
The `ca.crt` key is optional if the Kafka cluster uses a certificate signed by a public CA whose certificate is already in the system truststore.
====

. Edit the `KnativeKafka` CR and add a reference to your secret in the `broker` spec:
+
[source,yaml]
----
apiVersion: operator.serverless.openshift.io/v1alpha1
kind: KnativeKafka
metadata:
  namespace: knative-eventing
  name: knative-kafka
spec:
  broker:
    enabled: true
    defaultConfig:
      authSecretName: <secret_name>
...
----
