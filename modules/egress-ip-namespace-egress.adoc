// Module included in the following assemblies:
//
// * cloud_experts_tutorials/cloud-experts-consistent-egress-ip.adoc

:_mod-docs-content-type: PROCEDURE
[id="cloud-experts-consistent-egress-ip-namespace-egress_{context}"]
= Testing the namespace egress

[role="_abstract"]
You can test the namespace egress by using the {oc-first} tool.

.Procedure
. Start an interactive shell to test the namespace egress rule:
+
[source,terminal]
----
$ oc run \
  demo-egress-ns \
  -it \
  --namespace=demo-egress-ns \
  --env=LOAD_BALANCER_HOSTNAME=$LOAD_BALANCER_HOSTNAME \
  --image=registry.access.redhat.com/ubi9/ubi -- \
  bash
----
+
. Send a request to the load balancer and ensure that you can successfully connect:
+
[source,terminal]
----
$ curl -s http://$LOAD_BALANCER_HOSTNAME
----
+
. Check the output for a successful connection: 
+
[NOTE]
====
The `client_address` is the internal IP address of the load balancer not your egress IP. You can verify that you have  configured the client address correctly by connecting with your service limited to `.spec.loadBalancerSourceRanges`.
====
+
*For example*:
+
[source,terminal]
----
CLIENT VALUES:
client_address=10.10.207.247
command=GET
real path=/
query=nil
request_version=1.1
request_uri=http://internal-a3e61de18bfca4a53a94a208752b7263-148284314.us-east-1.elb.amazonaws.com:8080/

SERVER VALUES:
server_version=nginx: 1.10.0 - lua: 10001

HEADERS RECEIVED:
accept=*/*
host=internal-a3e61de18bfca4a53a94a208752b7263-148284314.us-east-1.elb.amazonaws.com
user-agent=curl/7.76.1
BODY:
-no body in request-
----
+
. Exit the pod by running the following command:
+
[source,terminal]
----
$ exit
----