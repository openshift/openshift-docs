// Module included in the following assemblies:
//
// * scalability_and_performance/ztp-factory-install-clusters.adoc
:_content-type: CONCEPT
[id="install--ocp-odf-hub-cluster-factory_{context}"]
= Install the {product-title} and OpenShift Data Foundation on the hub cluster in a "factory" setting

Before you can provision spoke clusters at scale in the factory setting, you must install the {product-title} and OpenShift Data Foundation on the designated hub cluster.

* Deploy the {product-title} cluster following the guidance in the section "Deploying installer-provisioned clusters on bare metal". Alternatively you can use the technology preview Assisted Installer from link:https://cloud.redhat.com/[cloud.redhat.com] to create the cluster.
* Deploy the OpenShift Data Foundation following the guidance link:https://access.redhat.com/documentation/en-us/red_hat_openshift_data_foundation/4.9/html/deploying_openshift_data_foundation_using_bare_metal_infrastructure/index[Deploying OpenShift Data Foundation using bare metal infratstructure].
* Create storage classes and persistent volumes with 200Gb of storage (NVMe or SSD) for:

    ** 1 persistent volume for Internal Registry
    ** 1 persistent volume for HTTPD
    ** 1 persistent volume for RHACM
    ** 2 persistent volumes for Assisted Installer

* Install Openshift Pipelines

At this stage the hub cluster shown in the following diagram should have internet connectivity. 

.Hub cluster deployment 

image::install-factory-hub_1.png[Hub cluster]

The cluster should also be on a private network with customer configured DNS and DHCP services. DNS needs to be configured for the API on the ingress of the hub in order to reach some routes on the hub cluster. DNS entries needs configured for the number of spoke clusters you intend to to deploy in parallel.  

You need enough DHCP addresses to host as many spoke clusters you as you intend to deploy. Each {product-version} node in the cluster must have access to an NTP server. {product-version} nodes use NTP to synchronize their clocks. For example, cluster nodes use SSL certificates that require validation, which might fail if the date and time between the nodes are not in sync.


