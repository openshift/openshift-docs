// Module filename: nw-modifying-nwoperator-config-startup.adoc
// Module included in the following assemblies:
// * networking/configuring-network-operator.adoc

[id='modifying-nwoperator-config-startup-{context}']
= Modifying Advanced Network Configuration Parameters

You can modify the advanced network configuration parameters in the
`NetworkConfig.networkoperator.openshift.io` Custom Resource (CR) object
before you start the cluster.
This procedure uses the `install-config.yaml` file that was generated
when you modified the basic network configuration.

.Prerequisites

* You need the `install-config.yaml` file.

.Procedure

. Use the following command to create `manifests`.
+
----
$ openshift-install create manifests
----
+
The installer creates a `manifests` directory which contains `.yaml` files.
Two of these files describe the configuration that the Network Operator needs.
+
* `cluster-network-01-crd.yml` contains the Custom Resource Definitions (CRD)
for the `Network.config.openshift.io` and
`NetworkConfig.networkoperator.openshift.io` Custom Resources (CRs).
* `cluster-network-02-config.yml` contains the `Network.config.openshift.io`
CR, which specifies the basic network
configuration:
+
[source,yaml]
----
apiVersion: config.openshift.io/v1
kind: Network
metadata:
  creationTimestamp: null
  name: cluster
spec:
  clusterNetwork:
  - cidr: 10.128.0.0/14The
    hostPrefix: 23
  networkType: OpenShiftSDN
  serviceNetwork:
  - 172.30.0.0/16
status:
  clusterNetwork: null
  clusterNetworkMTU: 0
  networkType: ""
  serviceNetwork: null

----
 +
 The Network Operator takes its configuration from
 `cluster-network-02-config.yml` when the cluster is created,
 therefore both the `Network.config.openshift.io` and
 NetworkConfig.networkoperator.openshift.io` CRs must be stored in
 `cluster-network-02-config.yml`.

. Open `cluster-network-02-config.yml` in a text editor.

. Add the following `NetworkConfig.networkoperator.openshift.io` CR after
the `Network.config.openshift.io` CR
in `cluster-network-02-config.yml`.
+
[source,yaml]
----

---
 apiVersion: networkoperator.openshift.io/v1
 kind: NetworkConfig
 metadata:
   name: cluster
 spec:
   additionalNetworks: null
   clusterNetwork:
   - cidr: 10.128.0.0/14
     hostPrefix: 23
   defaultNetwork:
     type: OpenShiftSDN
   serviceNetwork:
   - 172.30.0.0/16
----
+
The following example shows the `cluster-network-02-config.yml` after editing:
it contains both a `Network.config.openshift.io` CR and a
NetworkConfig.networkoperator.openshift.io` CR, separated by `---`.
+
[source,yaml]
----
  apiVersion: config.openshift.io/v1 <1>
  kind: Network
  metadata:
    creationTimestamp: null
    name: cluster
  spec:
    clusterNetwork:
    - cidr: 10.128.0.0/14 <2>
      hostPrefix: 23 <2>
    networkType: OpenShiftSDN <2>
    serviceNetwork:
    - 172.30.0.0/16 <2>
  status:
    clusterNetwork: null
    clusterNetworkMTU: 0
    networkType: ""
    serviceNetwork: null

  --- <3>
  apiVersion: networkoperator.openshift.io/v1 <4>
  kind: NetworkConfig
  metadata:
    name: default
  spec:
    additionalNetworks: null
    clusterNetworks:
    - cidr: 10.128.0.0/14 <2>
      hostSubnetLength: 9 <2>
    defaultNetwork:
      type: OpenShiftSDN <2>
    serviceNetwork: 172.30.0.0/16 <2>

----

<1> The `Network.config.openshift.io` CR
<2> The Network Operator reads these basic network settings from the
`Network.config.openshift.io` CR. They are also listed in the
`NetworkConfig.networkoperator.openshift.io` CR.
If the value for a given parameter
is different in the two CRs, the Network Operator uses the values in the
`Network.config.openshift.io` CR.
<3> `---`: Separator line to divide the two CRs.

. The `NetworkConfig.networkoperator.openshift.io` CR in the example above only
shows basic network configuration. Add optional configurations if necessary.
  * `kube-proxy`
  * `OpenShiftSDN`
 and  settings to the CR.
+
OpenShift has sensible defaults pre-configured for the parameters in the CRs,
so you only need to specify the parameters that you want to change in the
`NetworkConfig.networkoperator.openshift.io` CR.

. Save `cluster-network-02-config.yml` and quit the text editor.

.Next Steps
* Create the cluster.
