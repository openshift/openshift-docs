:_mod-docs-content-type: PROCEDURE
[id="cluster-logging-collector-log-forward-cloudwatch_{context}"]
= Forwarding logs to Amazon CloudWatch

To configure log forwarding to CloudWatch, create a `ClusterLogForwarder` custom resource (CR) with an output for CloudWatch and a pipeline that uses the output.

.Prerequisites

* You have installed {clo}.
* You have administrator access to {ocp-product-title}.
* You have installed {oc-first}.

.Procedure

include::snippets/creating-an-aws-secret-access-key.adoc[]

. Create or edit a YAML file that defines the `ClusterLogForwarder` CR object. In the file, specify the name of the secret. For example:
+
[source,yaml]
----
apiVersion: observability.openshift.io/v1
kind: ClusterLogForwarder
metadata:
  name: <log_forwarder_name>
  namespace: <log_forwarder_namespace>
spec:
  serviceAccount: 
    name: <service_account_name> # <1>
  outputs:
   - name: cw-output # <2>
     type: cloudwatch # <3>
     cloudwatch:
       authentication:
         type: awsAccessKey
         awsAccessKey:
           keyId:
             key: <key>
             secretName: cw-secret # <4>
           keySecret:
             key: <key>
             secretName: cw-secret
       groupName: <prefix-{.dynamic_value||"none"}> # <5>
       region: us-east-2 # <6>
  pipelines:
    - name: infra-logs # <7>
      inputRefs: # <8>
        - infrastructure
        - audit
        - application
      outputRefs:
        - cw-output # <9>
----
<1> Specify the name of your service account.
<2> Specify a name for the output.
<3> Specify the `cloudwatch` type.
<4> Specify the name of the secret that contains your AWS credentials.
<5> Specify the strategy for grouping logstreams. The value can be a combination of static and dynamic values consisting of field paths separated by "||". Encase dynamic values in single curly brackets "{}". Follow dynamic values with a static fallback value.
<6> Specify the AWS region.
<7> Specify a name for the pipeline.
<8> Specify the names of inputs defined in the `input.name` field for this pipeline. You can also use the built-in values `application`, `infrastructure`, `audit`.
<9> Specify the names of outputs defined in the `outputs.name` field for this pipeline.

. Apply the CR object:
+
[source,terminal]
----
$ oc apply -f <file-name>.yaml
----
