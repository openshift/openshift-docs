// This module is included in the following assemblies:
// * create/remote-pipelines-tasks-resolvers.adoc

// // *openshift_pipelines/remote-pipelines-tasks-resolvers.adoc
:_mod-docs-content-type: REFERENCE
[id="resolver-cluster-tasks-ref_{context}"]
= Tasks provided in the {pipelines-shortname} namespace

An {pipelines-shortname} installation includes a set of standard tasks that you can use in your pipelines. These tasks are located in the {pipelines-shortname} installation namespace, which is normally the `openshift-pipelines` namespace. You can use the cluster resolver to access the tasks.

Until version 1.16, {pipelines-shortname} included `ClusterTask` functionality. Versions 1.17 and later no longer include this functionality. If your pipelines use `ClusterTask` references, you can re-create them with the tasks that are available from the {pipelines-shortname} installation namespace by using the cluster resolver. However, certain changes are made in these tasks compared to the previously existing `ClusterTask` definitions.

You cannot specify a custom execution image in any of the tasks available in the {pipelines-shortname} installation namespace. These tasks do not support parameters such as `BUILDER_IMAGE`, `gitInitImage`, or `KN_IMAGE`. If you want to use a custom execution image, create a copy of the task and replace the image by editing the copy.

[discrete]
[id="op-taskref-buildah_{context}"]
== buildah

The `buildah` task builds a source code tree into a container image and then pushes the image to a container registry.

.Example usage of the `buildah` task
[source,yaml,subs="attributes+"]
----
apiVersion: tekton.dev/v1
kind: Pipeline
metadata:
  name: build-and-deploy
spec:
# ...
  tasks:
# ...
  - name: build-image
    taskRef:
      resolver: cluster
      params:
      - name: kind
        value: task
      - name: name
        value: buildah
      - name: namespace
        value: openshift-pipelines
    params:
    - name: IMAGE
      value: $(params.IMAGE)
    workspaces:
    - name: source
      workspace: shared-workspace
# ...
----

.Supported parameters for the `buildah` task
[cols="1,2,1,1",options="header"]
|===
| Parameter | Description | Type | Default value
|`IMAGE` |Fully qualified container image name to be built by Buildah. |`string` |
|`DOCKERFILE` |Path to the `Dockerfile` (or `Containerfile`) relative to the `source` workspace. |`string` |`./Dockerfile`
|`CONTEXT` |Path to the directory to use as the context. |`string` |`.`
|`STORAGE_DRIVER` |Set the Buildah storage driver to reflect the settings of the current cluster node settings. |`string` |`vfs`
|`FORMAT` |The format of the container to build, either `oci` or `docker`. |`string` |`oci`
|`BUILD_EXTRA_ARGS` |Extra parameters for the `build` command when building the image. |`string` |
|`PUSH_EXTRA_ARGS` |Extra parameters for the `push` command when pushing the image. |`string` |
|`SKIP_PUSH` |Skip pushing the image to the container registry. |`string` |`false`
|`TLS_VERIFY` |The TLS verification flag, normally `true`. |`string` |`true`
|`VERBOSE` |Turn on verbose logging; all commands executed are added to the log. |`string` |`false`
|===

.Supported workspaces for the `buildah` task
[cols="1,3",options="header"]
|===
| Workspace | Description
|`source` |Container build context, usually the application source code that includes a `Dockerfile` or `Containerfile` file.
|`dockerconfig` |An optional workspace for providing a `.docker/config.json` file that Buildah uses to access the container registry. Place the file at the root of the workspace with the name `config.json` or `.dockerconfigjson`.
|`rhel-entitlement` |An optional workspace for providing the entitlement keys that Buildah uses to access a {op-system-base-full} subscription. The mounted workspace must contains the `entitlement.pem` and `entitlement-key.pem` files.
|===

.Results that the `buildah` task returns
[cols="1,1,2",options="header"]
|===
| Result | Type | Description
|`IMAGE_URL` |`string` |The fully qualified name of the image that was built.
|`IMAGE_DIGEST` |`string` |Digest of the image that was built.
|===

.Changes from the `buildah` `ClusterTask`

* The `VERBOSE` parameter was added.
* The `BUILDER_IMAGE` parameter was removed.

[discrete]
[id="op-taskref-git-cli_{context}"]
== git-cli

The `git-cli` task runs the `git` command-line utility. You can pass the full Git command or several commands to run using the `GIT_SCRIPT` parameter. If the commands need authentication to a Git repository, for example, in order to complete a push, you must supply the authentication credentials.

.Example usage of the `git-cli` task
[source,yaml,subs="attributes+"]
----
apiVersion: tekton.dev/v1
kind: Pipeline
metadata:
  name: update-repo
spec:
# ...
  tasks:
# ...
  - name: push-to-repo
    taskRef:
      resolver: cluster
      params:
      - name: kind
        value: task
      - name: name
        value: git-cli
      - name: namespace
        value: openshift-pipelines
    params:
    - name: GIT_SCRIPT
      value: "git push"
    - name: GIT_USER_NAME
      value: "Example Developer"
    - name: GIT_USER_EMAIL
      value: "developer@example.com"
    workspaces:
    - name: ssh-directory
      workspace: ssh-workspace # <1>
    - name: source
      workspace: shared-workspace
# ...
----
<1> In this example, `ssh-workspace` must contain the contents of the `.ssh` directory with a valid key for authorization to the Git repository.

.Supported parameters for the `git-cli` task
[cols="1,2,1,1",options="header"]
|===
| Parameter | Description | Type | Default value
|`CRT_FILENAME` |Certificate Authority (CA) bundle filename in the `ssl-ca-directory` workspace. |`string` |`ca-bundle.crt`
|`HTTP_PROXY` |HTTP proxy server (non-TLS requests). |`string` |
|`HTTPS_PROXY` |HTTPS proxy server (TLS requests). |`string` |
|`NO_PROXY` |Opt out of proxying HTTP/HTTPS requests. |`string` |
|`SUBDIRECTORY` |Relative path to the `source` workspace where the git repository is present. |`string` |
|`USER_HOME` |Absolute path to the Git user home directory in the pod. |`string` |`/home/git`
|`DELETE_EXISTING` |Erase any existing contents of the `source` workspace before completing the git operations. |`string` |`true`
|`VERBOSE` |Log all the executed commands. |`string` |`false`
|`SSL_VERIFY` |The global `http.sslVerify` value. Do not use `false` unless
you trust the remote repository. |`string` |`true`
|`GIT_USER_NAME` |Git user name for performing Git operations. |`string` |
|`GIT_USER_EMAIL` |Git user email for performing Git operations. |`string` |
|`GIT_SCRIPT` |The Git script to run. |`string` |`git help`
|===

.Supported workspaces for the `git-cli` task
[cols="1,3",options="header"]
|===
| Workspace | Description
|`ssh-directory` |A `.ssh` directory with the private key, `known_hosts`, `config`, and other files as necessary. If you provide this workspace, the task uses it for authentication to the Git repository. Bind this workspace to a `Secret` resource for secure storage of authentication information.
|`basic-auth` |A workspace containing a `.gitconfig` and `.git-credentials` files. If you provide this workspace, the task uses it for authentication to the Git repository. Use a `ssh-directory` workspace for authentication instead of `basic-auth` whenever possible. Bind this workspace to a `Secret` resource for secure storage of authentication information.
|`ssl-ca-directory` |A workspace containing CA certificates. If you provide this workspace, Git uses these certificates to verify the peer when interacting with remote repositories using HTTPS.
|`source` |A workspace that contains the fetched Git repository.
|`input` |An optional workspace that contains the files that need to be added to the Git repository. You can access the workspace from your script using `$(workspaces.input.path)`, for example:

`cp $(workspaces.input.path)/<file_that_i_want> .` +
`git add <file_that_i_want>`
|===

.Results that the `git-cli` task returns
[cols="1,1,2",options="header"]
|===
| Result | Type | Description
|`COMMIT` |`string` |The SHA digest of the commit that is at the HEAD of the current branch in the cloned Git repository.
|===

.Changes from the `git-cli` `ClusterTask`

* Several new parameters were added.
* The `BASE_IMAGE` parameter was removed.
* The `ssl-ca-directory` workspace was added.
* The default values for the `USER_HOME` and `VERBOSE` parameters were changed.
* The name of the result was changed from `commit` to `COMMIT`.

[discrete]
[id="op-taskref-git-clone_{context}"]
== git-clone

The `git-clone` task uses Git to initialize and clone a remote repository on a workspace. You can use this task at the start of a pipeline that builds or otherwise processes this source code.

.Example usage of the `git-clone` task
[source,yaml,subs="attributes+"]
----
apiVersion: tekton.dev/v1
kind: Pipeline
metadata:
  name: build-source
spec:
# ...
  tasks:
  - name: clone-repo
    taskRef:
      resolver: cluster
      params:
      - name: kind
        value: task
      - name: name
        value: git-clone
      - name: namespace
        value: openshift-pipelines
    params:
    - name: URL
      value: "https://github.com/example/repo.git"
    workspaces:
    - name: output
      workspace: shared-workspace
----

.Supported parameters for the `git-clone` task
[cols="1,2,1,1",options="header"]
|===
| Parameter | Description | Type | Default value
|`CRT_FILENAME` |Certificate Authority (CA) bundle filename in the `ssl-ca-directory` workspace. |`string` |`ca-bundle.crt`
|`HTTP_PROXY` |HTTP proxy server (non-TLS requests). |`string` |
|`HTTPS_PROXY` |HTTPS proxy server (TLS requests). |`string` |
|`NO_PROXY` |Opt out of proxying HTTP/HTTPS requests. |`string` |
|`SUBDIRECTORY` |Relative path in the `output` workspace where the task places the Git repository. |`string` |
|`USER_HOME` |Absolute path to the Git user home directory in the pod. |`string` |`/home/git`
|`DELETE_EXISTING` |Delete the contents of the default workspace, if they exist, before running the Git operations. |`string` |`true`
|`VERBOSE` |Log the executed commands. |`string` |`false`
|`SSL_VERIFY` |The global `http.sslVerify` value. Do not set this parameter to to `false` unless you trust the remote repository. |`string` |`true`
|`URL` |Git repository URL. |`string` |
|`REVISION` |The revision to check out, for example, a branch or tag. |`string` |`main`
|`REFSPEC` |The `refspec` string for the repository that the task fetches before checking out the revision. |`string` |
|`SUBMODULES` |Initialize and fetch Git submodules. |`string` |`true`
|`DEPTH` |Number of commits to fetch, a "shallow clone" is a single commit. |`string` |`1`
|`SPARSE_CHECKOUT_DIRECTORIES` |List of directory patterns, separated by commas, for performing a  "sparse checkout". |`string` |
|===

.Supported workspaces for the `git-clone` task
[cols="1,3",options="header"]
|===
| Workspace | Description
|`ssh-directory` |A `.ssh` directory with the private key, `known_hosts`, `config`, and other files as necessary. If you provide this workspace, the task uses it for authentication to the Git repository. Bind this workspace to a `Secret` resource for secure storage of authentication information.
|`basic-auth` |A workspace containing a `.gitconfig` and `.git-credentials` files. If you provide this workspace, the task uses it for authentication to the Git repository. Use a `ssh-directory` workspace for authentication instead of `basic-auth` whenever possible. Bind this workspace to a `Secret` resource for secure storage of authentication information.
|`ssl-ca-directory` |A workspace containing CA certificates. If you provide this workspace, Git uses these certificates to verify the peer when interacting with remote repositories using HTTPS.
|`output` |A workspace that contains the fetched git repository, data will be placed on the root of the workspace or on the relative path defined by the `SUBDIRECTORY` parameter.
|===

.Results that the `git-clone` task returns
[cols="1,1,2",options="header"]
|===
| Result | Type | Description
|`COMMIT` |`string` |The SHA digest of the commit that is at the HEAD of the current branch in the cloned Git repository.
|`URL` |`string` |The URL of the repository that was cloned.
|`COMMITTER_DATE` |`string` |The epoch timestamp of the commit that is at the HEAD of the current branch in the cloned Git repository.
|===

.Changes from the `git-clone` `ClusterTask`

* All parameter names were changed to uppercase.
* All result names were changed to uppercase.
* The `gitInitImage` parameter was removed.

[discrete]
[id="op-taskref-kn_{context}"]
== kn

The `kn` task uses the `kn` command-line utility to complete operations on Knative resources, such as services, revisions, or routes.

.Example usage of the `kn` task
[source,yaml,subs="attributes+"]
----
apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
 name: kn-run
spec:
 pipelineSpec:
   tasks:
   - name: kn-run
     taskRef:
       resolver: cluster
       params:
       - name: kind
         value: task
       - name: name
         value: kn
       - name: namespace
         value: openshift-pipelines
     params:
     - name: ARGS
       value: [version]
----

.Supported parameters for the `kn` task
[cols="1,2,1,1",options="header"]
|===
| Parameter | Description | Type | Default value
|`ARGS` |The arguments for the `kn` utility. |`array` |`- help`
|===

.Changes from the `kn` `ClusterTask`

* The `KN_IMAGE` parameter was removed.

[discrete]
[id="op-taskref-kn-apply_{context}"]
== kn-apply

The `kn-apply` task deploys a specified image to a Knative Service. This task uses the `kn service apply` command to create or update the specified Knative service.

.Example usage of the `kn-apply` task
[source,yaml,subs="attributes+"]
----
apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
 name: kn-apply-run
spec:
 pipelineSpec:
   tasks:
   - name: kn-apply-run
     taskRef:
       resolver: cluster
       params:
       - name: kind
         value: task
       - name: name
         value: kn-apply
       - name: namespace
         value: openshift-pipelines
     params:
     - name: SERVICE
       value: "hello"
     - name: IMAGE
       value: "gcr.io/knative-samples/helloworld-go:latest"
----

.Supported parameters for the `kn-apply` task
[cols="1,2,1,1",options="header"]
|===
| Parameter | Description | Type | Default value
|`SERVICE` |The Knative service name. |`string` |
|`IMAGE` |The fully qualified name of the image to deploy. |`string` |
|===

.Changes from the `kn-apply` `ClusterTask`

* The `KN_IMAGE` parameter was removed.


[discrete]
[id="op-taskref-maven_{context}"]
== maven

The `maven` task runs a Maven build.

.Example usage of the `maven` task
[source,yaml,subs="attributes+"]
----
apiVersion: tekton.dev/v1
kind: Pipeline
metadata:
  name: build-and-deploy
spec:
# ...
  tasks:
# ...
  - name: build-from-source
    taskRef:
      resolver: cluster
      params:
      - name: kind
        value: task
      - name: name
        value: maven
      - name: namespace
        value: openshift-pipelines
    workspaces:
    - name: source
      workspace: shared-workspace
# ...
----

.Supported parameters for the `maven` task
[cols="1,2,1,1",options="header"]
|===
| Parameter | Description | Type | Default value
|`GOALS` | The Maven goals to run. |`array` |`- package`
|`MAVEN_MIRROR_URL` |The Maven repository mirror URL. |`string` |
|`SUBDIRECTORY` |The subdirectory within the `source` workspace that the task runs the Maven build on. |`string` |`.`
|===

.Supported workspaces for the `maven` task
[cols="1,3",options="header"]
|===
| Workspace | Description
|`source` |The workspace that contains the Maven project.
|`server_secret` |The workspace that contains the secrets for connecting to the Maven server, such as the user name and password.
|`proxy_secret` |The workspace that contains the credentials for connecting to the proxy server, such as the user name and password.
|`proxy_configmap` |The workspace that contains proxy configuration values, such as `proxy_port`, `proxy_host`, `proxy_protocol`, `proxy_non_proxy_hosts`.
|`maven_settings` |The workspace that contains custom Maven settings.
|===

.Changes from the `maven` `ClusterTask`

* The parameter name `CONTEXT_DIR` was changed to `SUBDIRECTORY`.
* The workspace name `maven-settings` was changed to `maven_settings`.

[discrete]
[id="op-taskref-openshift-client_{context}"]
== openshift-client

The `openshift-client` task runs commands using the `oc` command-line interface. You can use this task to manage an {OCP} cluster.

.Example usage of the `openshift-client` task
[source,yaml,subs="attributes+"]
----
apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
 name: openshift-client-run
spec:
 pipelineSpec:
   tasks:
   - name: openshift-client-run
     taskRef:
       resolver: cluster
       params:
       - name: kind
         value: task
       - name: name
         value: openshift-client
       - name: namespace
         value: openshift-pipelines
     params:
     - name: SCRIPT
       value: "oc version"
----

.Supported parameters for the `openshift-client` task
[cols="1,2,1,1",options="header"]
|===
| Parameter | Description | Type | Default value
|`SCRIPT` |The `oc` CLI arguments to run. |`string` |`oc help`
|`VERSION` |The {OCP} version to use. |`string` |`latest`
|===

.Supported workspaces for the `openshift-client` task
[cols="1,3",options="header"]
|===
| Workspace | Description
|`manifest_dir` |The workspace containing manifest files that you want to apply using the `oc` utility.
|`kubeconfig_dir` |An optional workspace in which you can provide a `.kube/config` file that contains credentials for accessing the cluster. Place this file at the root of the workspace and name it `kubeconfig`.
|===

.Changes from the `openshift-client` `ClusterTask`

* The workspace name `manifest-dir` was changed to `manifest_dir`.
* The workspace name `kubeconfig-dir` was changed to `kubeconfig_dir`.


[discrete]
[id="op-taskref-s2i-dotnet_{context}"]
== s2i-dotnet

The `s2i-dotnet` task builds the source code using the Source to Image (S2I) dotnet builder image, which is available from the {OCP} registry as `image-registry.openshift-image-registry.svc:5000/openshift/dotnet`.

:lang: dotnet
include::snippets/ref-s2i-task.adoc[]

[discrete]
[id="op-taskref-s2i-go_{context}"]
== s2i-go

The `s2i-go` task builds the source code using the S2I Golang builder image, which is available from the {OCP} registry as `image-registry.openshift-image-registry.svc:5000/openshift/golang`.

:lang: go
include::snippets/ref-s2i-task.adoc[]

[discrete]
[id="op-taskref-s2i-java_{context}"]
== s2i-java

The `s2i-java` task builds the source code using the S2I Java builder image, which is available from the {OCP} registry as `image-registry.openshift-image-registry.svc:5000/openshift/java`.

.Supported parameters for the `s2i-java` task
[cols="1,2,1,1",options="header"]
|===
| Parameter | Description | Type | Default value

|`IMAGE` |The fully qualified name for the container image that the S2I process builds. |`string` |
|`IMAGE_SCRIPTS_URL` |The URL containing the default assemble and run scripts for the builder image. |`string` |`image:///usr/libexec/s2i`
|`ENV_VARS` |An array of values for environment variables to set in the build process, listed in the `KEY=VALUE` format. |`array` |
|`CONTEXT` |Path to the directory within the `source` workspace to use as the context. |`string` |`.`
|`STORAGE_DRIVER` |Set the Buildah storage driver to reflect the settings of the current cluster node settings. |`string` |`vfs`
|`FORMAT` |The format of the container to build, either `oci` or `docker`. |`string` |`oci`
|`BUILD_EXTRA_ARGS` |Extra parameters for the `build` command when building the image. |`string` |
|`PUSH_EXTRA_ARGS` |Extra parameters for the `push` command when pushing the image. |`string` |
|`SKIP_PUSH` |Skip pushing the image to the container registry. |`string` |`false`
|`TLS_VERIFY` |The TLS verification flag, normally `true`. |`string` |`true`
|`VERBOSE` |Turn on verbose logging; all commands executed are added to the log. |`string` |`false`
|`VERSION` |The tag of the image stream, which corresponds to the language version. |`string` |`latest`
|===

.Supported workspaces for the `s2i-java` task
[cols="1,3",options="header"]
|===
| Workspace | Description
|`source` |The application source code, which is the build context for the S2I workflow.
|`dockerconfig` |An optional workspace for providing a `.docker/config.json` file that Buildah uses to access the container registry. Place the file at the root of the workspace with the name `config.json` or `.dockerconfigjson`.
|===

.Results that the `s2i-java` task returns
[cols="1,1,2",options="header"]
|===
| Result | Type | Description
|`IMAGE_URL` |`string` |The fully qualified name of the image that was built.
|`IMAGE_DIGEST` |`string` |Digest of the image that was built.
|===

.Changes from the `s2i-java` `ClusterTask`

* Several new parameters were added.
* The `BUILDER_IMAGE`, `MAVEN_ARGS_APPEND`, `MAVEN_CLEAR_REPO`, and `MAVEN_MIRROR_URL` parameters were removed. You can pass the `MAVEN_ARGS_APPEND`, `MAVEN_CLEAR_REPO`, and `MAVEN_MIRROR_URL` values as environment variables.
* The parameter name `PATH_CONTEXT` was changed to `CONTEXT`.
* The parameter name `TLS_VERIFY` was changed to `TLSVERIFY`.
* The `IMAGE_URL` result was added.

[discrete]
[id="op-taskref-s2i-nodejs_{context}"]
== s2i-nodejs

The `s2i-nodejs` task builds the source code using the S2I NodeJS builder image, which is available from the {OCP} registry as `image-registry.openshift-image-registry.svc:5000/openshift/nodejs`.

:lang: nodejs
include::snippets/ref-s2i-task.adoc[]

[discrete]
[id="op-taskref-s2i-perl_{context}"]
== s2i-perl

The `s2i-perl` task builds the source code using the S2I Perl builder image, which is available from the {OCP} registry as `image-registry.openshift-image-registry.svc:5000/openshift/perl`.

:lang: perl
include::snippets/ref-s2i-task.adoc[]

[discrete]
[id="op-taskref-s2i-php_{context}"]
== s2i-php

The `s2i-php` task builds the source code using the S2I PHP builder image, which is available from the {OCP} registry as `image-registry.openshift-image-registry.svc:5000/openshift/php`.

:lang: php
include::snippets/ref-s2i-task.adoc[]

[discrete]
[id="op-taskref-s2i-python_{context}"]
== s2i-python

The `s2i-python` task builds the source code using the S2I Python builder image, which is available from the {OCP} registry as `image-registry.openshift-image-registry.svc:5000/openshift/python`.

:lang: python
include::snippets/ref-s2i-task.adoc[]

[discrete]
[id="op-taskref-s2i-ruby_{context}"]
== s2i-ruby

The `s2i-ruby` task builds the source code using the S2I Ruby builder image, which is available from the {OCP} registry as `image-registry.openshift-image-registry.svc:5000/openshift/ruby`.

:lang: ruby
include::snippets/ref-s2i-task.adoc[]

[discrete]
[id="op-taskref-skopeo-copy_{context}"]
== skopeo-copy

The `skopeo-copy` task executes the `skopeo copy` command.

Skopeo is a command-line tool for working with remote container image registries without requiring a local container engine or daemon. The `skopeo-copy` command copies an image from one remote registry to another, for example, from an internal registry to a production registry. Skopeo supports authorization on image registries using credentials that you provide.

.Example usage of the `skopeo-copy` task
[source,yaml,subs="attributes+"]
----
apiVersion: tekton.dev/v1
kind: Pipeline
metadata:
  name: build-deploy-image
spec:
# ...
  tasks:
  - name: copy-image
    taskRef:
      resolver: cluster
      params:
      - name: kind
        value: task
      - name: name
        value: skopeo-copy
      - name: namespace
        value: openshift-pipelines
    params:
    - name: SOURCE_IMAGE_URL
      value: "docker://internal.registry/myimage:latest"
    - name: DESTINATION_IMAGE_URL
      value: "docker://production.registry/myimage:v1.0"
    workspaces:
    - name: output
      workspace: shared-workspace
----


.Supported parameters for the `skopeo-copy` task
[cols="1,2,1,1",options="header"]
|===
| Parameter | Description | Type | Default value
|`SOURCE_IMAGE_URL` |Fully qualified name, including tag, of the source container image. |`string` |
|`DESTINATION_IMAGE_URL` |Fully qualified name, including tag, of the destination image to which Skopeo copies the source image. |`string` |
|`SRC_TLS_VERIFY` |The TLS verification flag for the source registry, normally `true`. |`string` |`true`
|`DEST_TLS_VERIFY` |The TLS verification flag for the destination registry, normally `true` |`string` |`true`
|`VERBOSE` |Output debug information to the log. |`string` |`false`
|===

.Supported workspaces for the `skopeo-copy` task
[cols="1,3",options="header"]
|===
| Workspace | Description
|`images_url` |If you want to copy more than one image, use this workspace to provide the image URLs.
|===

.Results that the `skopeo-copy` task returns
[cols="1,1,2",options="header"]
|===
| Result | Type | Description
|`SOURCE_DIGEST` |`string` |The SHA256 digest of the source image.
|`DESTINATION_DIGEST` |`string` |The SHA256 digest of the destination image.
|===

.Changes from the `skopeo-copy` `ClusterTask`

* All parameter names were changed to uppercase.
* The `VERBOSE` parameter was added.
* The workspace name was changed from `images-url` to `images_url`.
* The `SOURCE_DIGEST` and `DESTINATION_DIGEST` results were added.

[discrete]
[id="op-taskref-tkn_{context}"]
== tkn

The `tkn` task performs operations on Tekton resources using tkn.

.Example usage of the `tkn` task
[source,yaml,subs="attributes+"]
----
apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
 name: tkn-run
spec:
 pipelineSpec:
   tasks:
   - name: tkn-run
     taskRef:
       resolver: cluster
       params:
       - name: kind
         value: task
       - name: name
         value: tkn
       - name: namespace
         value: openshift-pipelines
     params:
     - name: ARGS
----

.Supported parameters for the `tkn` task
[cols="1,2,1,1",options="header"]
|===
| Parameter | Description | Type | Default value
|`SCRIPT` |The `tkn` CLI script to execute. |`string` |`tkn $@`
|`ARGS` |The `tkn` CLI arguments to run. |`array` |`- --help`
|===

.Supported workspaces for the `tkn` task
[cols="1,3",options="header"]
|===
| Workspace | Description
|`kubeconfig_dir` |An optional workspace in which you can provide a `.kube/config` file that contains credentials for accessing the cluster. Place this file at the root of the workspace and name it `kubeconfig`.
|===

.Changes from the `tkn` `ClusterTask`

* The `TKN_IMAGE` parameter was removed.
* The workspace name was changed from `kubeconfig` to `kubeconfig_dir`.

[discrete]
[id="op-opc-task_{context}"]
== opc task

The `opc` task simplifies interaction with Tekton resources in {pipelines-title} by enabling you to run `opc` CLI commands directly in your Pipelines. You can use the `opc` task to perform various operations on Tekton resources, such as listing pipelines, viewing pipeline runs, or managing tasks. The following example shows how to invoke the `opc` task in a PipelineRun:

[source,yaml]
----
apiVersion: tekton.dev/v1
kind: PipelineRun
metadata: 
  name: opc-task-pipeline
spec:
  pipelineRef:
    name: task-opc
  params:
    - name: SCRIPT
      value: "opc $@"
    - name: ARGS
      value: opc-command-you-want-to-execute
----
Replace `opc-command-you-want-to-execute` with the `opc` CLI command you want to run.

The following example shows how to use the `opc` task to list pipelines in your cluster.

[source,yaml]
----
apiVersion: tekton.dev/v1
kind: Pipeline
metadata:
  name: opc-task-pipeline
spec:
  tasks:
    - name: opc-pipeline-list
      taskRef:
        resolver: cluster
        params:
          - name: kind
            value: task
          - name: name
            value: opc
          - name: namespace
            value: openshift-pipelines
      params:
        - name: SCRIPT
          value: "opc $@"
        - name: ARGS
          value:
            - pipeline
            - list
            - -n
            - $(context.pipelineRun.namespace)
----

To execute the workflow defined in the `opc-task-pipeline` task, create and apply the following `PipelineRun` resource.

[source,yaml]
----
apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
  name: opc-task-run
spec:
  pipelineRef:
    name: opc-task-pipeline
----

As a result, the following output is displayed:

[source]
----
[opc-pipeline-list : opc] Running Script /scripts/opc-client.sh
[opc-pipeline-list : opc] NAME                AGE              LAST RUN       STARTED         DURATION   STATUS
[opc-pipeline-list : opc] opc-task-pipeline   15 minutes ago   opc-task-run   5 seconds ago   ---        Running
----

If your container registry requires authentication, create a Kubernetes Secret that describes the following attributes:

[source,terminal]
----
kubectl create secret docker-registry imagestreams \
  --docker-server="image-registry.openshift-image-registry.svc:5000" \
  --docker-username="${REGISTRY_USERNAME}" \
  --docker-password="${REGISTRY_TOKEN}"
----
[NOTE]
====
Ensure that the `Secret` is linked to the `ServiceAccount` that runs the `TaskRun` or `PipelineRun`.
====