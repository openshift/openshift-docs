// Module included in the following assemblies:
//
// * hardware_accelerators/amd-gpu-operator.adoc

:_content-type: PROCEDURE
[id="amd-testing-rocminfo_{context}"]
= Testing rocminfo

.Procedure

. Create a YAML file that tests `rocminfo`:
+
[source,terminal]
----
$ cat << EOF > rocminfo.yaml
----
+
.Example output
[source,yaml]
----
apiVersion: v1
kind: Pod
metadata:
 name: rocminfo
spec:
 containers:
 - image: docker.io/rocm/pytorch:latest
   name: rocminfo
   command: ["/bin/sh","-c"]
   args: ["rocminfo"]
   resources:
    limits:
      amd.com/gpu: 1
    requests:
      amd.com/gpu: 1
 restartPolicy: Never
EOF
----

. Create the `rocminfo` pod:
+
[source,terminal]
----
$ oc create -f rocminfo.yaml
----
+
.Example output
[source,terminal]
----
apiVersion: v1
pod/rocminfo created
----

. Check the `rocmnfo` log with one MI210 GPU:
+
[source,terminal]
----
$ oc logs rocminfo | grep -A5 "Agent"
----
+
.Example output
[source,terminal]
----
HSA Agents               
==========               
*******                  
Agent 1                  
*******                  
  Name:                    Intel(R) Xeon(R) Gold 6330 CPU @ 2.00GHz
  Uuid:                    CPU-XX                             
  Marketing Name:          Intel(R) Xeon(R) Gold 6330 CPU @ 2.00GHz
  Vendor Name:             CPU                                
--
Agent 2                  
*******                  
  Name:                    Intel(R) Xeon(R) Gold 6330 CPU @ 2.00GHz
  Uuid:                    CPU-XX                             
  Marketing Name:          Intel(R) Xeon(R) Gold 6330 CPU @ 2.00GHz
  Vendor Name:             CPU                                
--
Agent 3                  
*******                  
  Name:                    gfx90a                             
  Uuid:                    GPU-024b776f768a638b               
  Marketing Name:          AMD Instinct MI210                 
  Vendor Name:             AMD             
----

. Delete the pod: 
+
[source,terminal]
----
$ oc delete -f rocminfo.yaml
----
+
.Example output
[source,terminal]
----
pod "rocminfo" deleted
----

