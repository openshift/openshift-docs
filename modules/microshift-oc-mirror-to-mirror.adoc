// Module included in the following assemblies:
//
// * microshift_running_apps/microshift_operators/microshift-operators-oc-mirror.adoc

:_mod-docs-content-type: PROCEDURE
[id="microshift-oc-mirror-mirror-to-mirror_{context}"]
= Mirroring from mirror to mirror

[role="_abstract"]
You can use the oc-mirror plugin to mirror an image set directly to a target mirror registry that is accessible during image set creation.

.Prerequisites

* You have access to the internet to get the required container images.
* You installed the {oc-first}.
* You installed the `oc-mirror` CLI plugin.
* You created the image set configuration file.

.Procedure

* Mirror the images from the specified image set configuration to a specified registry by running the following command:
+
[source,terminal,subs="quotes+"]
----
$ oc-mirror --config imageset-config.yaml --workspace file://_<v2_workspace>_ \// <1>
  docker://_<remote_registry>_ --v2 <2>
----
<1> You must use the `--workspace` flag for the mirror-to-mirror process. Replace _<v2_workspace>_ with the directory you want to use to store custom resources for the mirroring process.
<2> Replace _<remote_registry>_ with the name of the registry to mirror the image set file to. The registry must start with `docker://`. If you specify a top-level namespace for the mirror registry, you must also use this same namespace on later executions.
+
.Example output
[source,terminal]
----
Rendering catalog image "registry.example.com/redhat/redhat-operator-index:v{ocp-version}" with file-based catalog
----
+
--
[IMPORTANT]
====
You must use the `ImageDigestMirrorSet` YAML file as reference content for manual configuration of CRI-O in {microshift-short}. You cannot apply the resource directly into a {microshift-short} node.
====
--

.Verification
. List the contents of the `cluster-resources` subdirectory by running the following command:
+
[source,terminal,subs="+quotes"]
----
$ ls _<v2_workspace>_/working-dir/cluster-resources/ <1>
----
<1> Replace _<v2_workspace>_ with the directory you used to store custom resources for the mirroring process.

.Next steps

* Convert the `ImageDigestMirrorSet` YAML content for use in manually configuring CRI-O.
* If required, mirror the images from mirror to disk for disconnected or offline use.

.Troubleshooting

* link:https://access.redhat.com/solutions/7032017[Unable to retrieve source image].
