// Module included in the following assemblies:
//
// * virt/virtual_machines/virt-create-vms.adoc

[id="virt-preparing-container-disk-for-vms_{context}"]
= Preparing a container disk for virtual machines

A container disk must be built with a virtual machine image and pushed
to a container registry before it can be attached to a virtual machine as a containerDisk volume.

.Prerequisites

* You have root or sudo privileges on your local system to install podman.

* The virtual machine image must be either QCOW2 or RAW format.

.Procedure

. Install `podman` if it is not already installed:
+
[source,terminal]
----
$ sudo yum install podman -y
----

. Create a Dockerfile to build the virtual machine image into a container.
The virtual machine image must be owned by QEMU, which has a UID of `107`, and placed in the `/disk` directory inside the container.
+
[source,terminal]
----
$ cat > Dockerfile << EOF
FROM scratch
ADD --chown=107:107 <vm_image>.qcow2 /disk/ <1>
EOF
----
<1> Where <vm_image> is the virtual machine image in either QCOW2 or RAW format.+
To use a remote virtual machine image, replace `<vm_image>.qcow2` with the complete url for the remote image.

. Build and tag the container:
+
[source,terminal]
----
$ podman build -t <registry>/<vm_image>:latest .
----

. Push the container to the registry:
+
[source,terminal]
----
$ podman push <registry>/<vm_image>:latest
----
