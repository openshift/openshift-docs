// module included in the following assemblies:
//
// * configuration/monitor-acs.adoc

:_mod-docs-content-type: PROCEDURE
[id="prometheus-server-example_{context}"]
= Setting up a Perses dashboard in {ocp} to monitor {product-title-short}

[role="_abstract"]
You can configure an in-cluster Prometheus server to work with {rh-rhacs-first}. You can then use a tool such as Perses running in {ocp} or externally to monitor {product-title-short}.

To view a sample Perses configuration, navigate to the `monitoring-examples` repository in the `stackrox` organization on GitHub, select the `main` branch, and then open the `perses` directory.

.Prerequisites

. You have configured Prometheus to scrape metrics from the Central service.
+
For more information, see "Setting a Prometheus server scraping from Central service".

.Procedure


. Create the Perses data source by using the following content, for example:
+
[source,yaml]
----
apiVersion: perses.dev/v1alpha1
kind: PersesDatasource
metadata:
  name: rhacs-datasource
  namespace: stackrox
spec:
  client:
    tls:
      caCert:
        certPath: /ca/service-ca.crt
        type: file
      enable: true
  config:
    default: true
    display:
      name: RHACS Prometheus Datasource
    plugin:
      kind: PrometheusDatasource
      spec:
        proxy:
          kind: HTTPProxy
          spec:
            url: 'http://<PROMETHEUS_SERVICE_HOSTNAME>:<PROMETHEUS_SERVICE_PORT>'
----
+
where:
+
--
`<PROMETHEUS_SERVICE_HOSTNAME>`:: Specifies the hostname of the Prometheus service in your cluster.
* If Prometheus is installed by using the monitoring stack, the hostname might be, for example, `prometheus-operated.stackrox.svc.cluster.local`.
* If Prometheus in installed by using the Prometheus Operator or another installation, the hostname might be something different.
`<PROMETHEUS_SERVICE_PORT>`:: Specifies the port of the Prometheus service in your cluster. For example, `9090`.
--

. Create a Perses dashboard by using the following content, for example:
+
[source,yaml]
----
include::snippets/create-perses-dashboard.yaml[]
----
+
This YAML creates a Perses dashboard in the `stackrox` namespace that shows a status panel for the total policy violations over the last 30 days, with variables for `Cluster` and `Namespace`, that refreshes every minute.