// Module included in the following assemblies:
//
// * integration/integrate-using-short-lived-tokens.adoc
:_mod-docs-content-type: PROCEDURE
[id="azure-workload-identity-federation-openshift_{context}"]
= Configuring {ocp}

[role="_abstract"]
By running {rh-rhacs-first} on {ocp}, you can configure short-lived tokens by using Microsoft Entra ID managed identities.

.Prerequisites
* You have a public OpenID Connect (OIDC) configuration bucket with the {ocp} service account signer key.
+
For more information, see link:https://docs.openshift.com/container-platform/{ocp-latest-version}/authentication/managing_cloud_provider_credentials/cco-short-term-creds.html["Manual mode with short-term credentials for components"] in _OpenShift Container Platform_ documentation.
* You have a Microsoft Entra ID user-assigned managed identity.
* You have access to a Microsoft Azure subscription with the permission to assign role assignments.

.Procedure
* To add the federated identity credentials to a user-assigned managed identity, run the following command, for example:
+
[source,terminal]
----
$ az identity federated-credential create \
    --name "${FEDERATED_CREDENTIAL_NAME}" \
    --identity-name "${MANAGED_IDENTITY_NAME}" \// <1>
    --resource-group "${RESOURCE_GROUP}" \
    --issuer "${OIDC_ISSUER_URL}" \// <2>
    --subject system:serviceaccount:stackrox:central \ <3>
    --audience openshift
----
<1> The managed identity must have all the permissions for federation.
<2> The issuer must match the service account token issuer of the {ocp} cluster.
<3> For delegated scanning, set the subject to *system:serviceaccount:stackrox:sensor*.
+
For more information about how to configure short-lived tokens by using Microsoft Entra ID managed identities, see link:https://learn.microsoft.com/en-us/entra/workload-id/workload-identity-federation-create-trust-user-assigned-managed-identity?pivots=identity-wif-mi-methods-azp[Configure a user-assigned managed identity to trust an external identity provider] (Microsoft Azure documentation).
