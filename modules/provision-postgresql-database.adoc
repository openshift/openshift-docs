// Module included in the following assemblies:
//
// * installing/installing_ocp/install-central-ocp.adoc
:_mod-docs-content-type: PROCEDURE
[id="provision-postgresql-database_{context}"]
= Provisioning a database in your PostgreSQL instance

[role="_abstract"]
You can use your existing PostgreSQL infrastructure to provision a database for {product-title-short}. Use this intructions in this section for configuring a PostgreSQL database environment, creating a user, database, schema, role, and granting required permissions.

:FeatureName: External PostgreSQL support
include::snippets/technology-preview.adoc[]

.Procedure
. Create a new user:
+
[source,terminal]
----
CREATE USER stackrox WITH PASSWORD <password>;
----
. Create a datatabe:
+
[source,terminal]
----
CREATE DATABASE stackrox;
----
. Connect to the datatabe:
+
[source,terminal]
----
\connect stackrox
----
. Create user schema:
+
[source,terminal]
----
CREATE SCHEMA stackrox;
----
. (Optional) Revoke rights on public:
+
[source,terminal]
----
REVOKE CREATE ON SCHEMA public FROM PUBLIC;
REVOKE USAGE ON SCHEMA public FROM PUBLIC;
REVOKE ALL ON DATABASE stackrox FROM PUBLIC;
----
. Create a role:
+
[source,terminal]
----
CREATE ROLE readwrite;
----
. Grant connection permission to the role:
+
[source,terminal]
----
GRANT CONNECT ON DATABASE stackrox TO readwrite;
----
. Add required permissions to the `readwrite` role:
+
[source,terminal]
----
GRANT USAGE ON SCHEMA stackrox TO readwrite;
GRANT USAGE, CREATE ON SCHEMA stackrox TO readwrite;
GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA stackrox TO readwrite;
ALTER DEFAULT PRIVILEGES IN SCHEMA stackrox GRANT SELECT, INSERT, UPDATE, DELETE ON TABLES TO readwrite;
GRANT USAGE ON ALL SEQUENCES IN SCHEMA stackrox TO readwrite;
ALTER DEFAULT PRIVILEGES IN SCHEMA stackrox GRANT USAGE ON SEQUENCES TO readwrite;
----
. Assign the `readwrite` role to the `stackrox` user:
+
[source,terminal]
----
GRANT readwrite TO stackrox;
----
