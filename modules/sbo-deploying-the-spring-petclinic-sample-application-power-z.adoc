[id="sbo-deploying-the-spring-petclinic-sample-application-ibm-power-z_{context}"]
= Deploying the Spring PetClinic sample application

To deploy the Spring PetClinic sample application on an {product-title} cluster, you must use a deployment configuration and configure your local environment to test the application.

.Procedure

. Switch to the *Developer* perspective and ensure that you are in the appropriate project, for example, `my-postgresql`. Click the btn:[+Add] button and select *Import from Git*.
+
.Importing from Git
image::image1_power.png[]

. Scroll down to “Advanced options”, and click on *Build configuration*.
+
.Building configuration
image::image2_power1.png[]

. Add the following environment variables:
+
[source,text]
----
Name: org.springframework.cloud.bindings.boot.enable
Value: true

Name: spring.profiles.active 
Value: postgresql,spring-data-jpa
----
+
.Adding environment variables
image::buildconfig.JPG[]

. Verify that the Spring PetClinic sample application is created and deployed:
+
[source,text]
----
$ oc get pods
----
+
[source,text]
.Example output
----
NAME                                     READY    STATUS      RESTARTS   AGE
postgresql-operator-56bd6964c4-j2slb     1/1     Running       0        91m
sampledatabase-cbc655488-xjlxt           1/1     Running       0        81m
spring-petclinic-rest-1-build            0/1     Completed     0        10m
spring-petclinic-rest-7bdbdc987b-rfvnq   1/1     Running       0        4m48s
----
+

The application is not yet connected to the database service. If you try to interact with the application, it will return errors.

For example, if you try to access the list of all pets using `curl`, you can see an error message similar to the following sample message:
[source,text]
----
$ oc rsh spring-petclinic-rest-7bdbdc987b-rfvnq sh-4.2$ 
----
[source,text]
----
$ curl -X GET "http://localhost:9966/petclinic/api/pets" -H "accept: application/json"
----
[source,text]
.Example output
----
{"className":"org.springframework.transaction.CannotCreateTransactionException","exMessage":"Could not open JPA EntityManager for transaction; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to acquire JDBC Connection"}
----

You can now use the {servicebinding-title} to connect the application to the database service.
