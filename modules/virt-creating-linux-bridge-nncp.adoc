// Module included in the following assemblies:
//
// * virt/vm_networking/virt-connecting-vm-to-linux-bridge.adoc
// * virt/post_installation_configuration/virt-post-install-network-config.adoc

:_mod-docs-content-type: PROCEDURE
[id="virt-creating-linux-bridge-nncp_{context}"]
= Creating a Linux bridge NNCP

[role="_abstract"]
You can create a `NodeNetworkConfigurationPolicy` (NNCP) manifest for a Linux bridge network.

.Prerequisites

* You have installed the Kubernetes NMState Operator.

.Procedure

* Create the `NodeNetworkConfigurationPolicy` manifest. This example includes sample values that you must replace with your own information.
+
[source,yaml]
----
apiVersion: nmstate.io/v1
kind: NodeNetworkConfigurationPolicy
metadata:
  name: br1-eth1-policy
spec:
  desiredState:
    interfaces:
      - name: br1
        description: Linux bridge with eth1 as a port
        type: linux-bridge
        state: up
        ipv4:
          enabled: false
        bridge:
          options:
            stp:
              enabled: false
          port:
            - name: eth1
----
** `metadata.name` defines the name of the node network configuration policy.
** `spec.desiredState.interfaces.name` defines the name of the new Linux bridge.
** `spec.desiredState.interfaces.description` is an optional field that can be used to define a human-readable description for the bridge.
** `spec.desiredState.interfaces.type` defines the interface type. In this example, the type is a Linux bridge.
** `spec.desiredState.interfaces.state` defines the requested state for the interface after creation.
** `spec.desiredState.interfaces.ipv4.enabled` defines whether the ipv4 protocol is active. Setting this to `false` disables IPv4 addressing on this bridge.
** `spec.desiredState.interfaces.bridge.options.stp.enabled` defines whether STP is active. Setting this to `false` disables STP on this bridge.
** `spec.desiredState.interfaces.bridge.port.name` defines the node NIC to which the bridge is attached.
+
[NOTE]
====
To create the NNCP manifest for a Linux bridge using OSA with {ibm-z-name}, you must disable VLAN filtering by the setting the `rx-vlan-filter` to `false` in the `NodeNetworkConfigurationPolicy` manifest.

Alternatively, if you have SSH access to the node, you can disable VLAN filtering by running the following command:

[source,terminal]
----
$ sudo ethtool -K <osa-interface-name> rx-vlan-filter off
----
====
