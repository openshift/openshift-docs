:_content-type: PROCEDURE
[id="scaling-up-nodes-aws"]
= Scaling up nodes in AWS

You can scape up control-plane nodes in Amazon Web Services (AWS) by changing the instant type of existing nodes.

.Prerequisites

* You have a running AWS cluster.

.Procedure

. Check the available machines and obtain the `machine` for which you want to change the instance type:
+
[source,terminal]
----
$ oc get machines -n openshift-machine-api -o wide
----
+
.Example output
[source,terminal]
----
NAME                                                PHASE     TYPE        REGION      ZONE         AGE     NODE                                         PROVIDERID                              STATE
ci-ln-1kgfjy2-76ef8-xdwrd-master-0                  Running   m5.xlarge   us-west-2   us-west-2a   3h36m   ip-10-0-140-141.us-west-2.compute.internal   aws:///us-west-2a/i-062b01aa405655286   running
ci-ln-1kgfjy2-76ef8-xdwrd-master-1                  Running   m5.xlarge   us-west-2   us-west-2d   3h36m   ip-10-0-199-102.us-west-2.compute.internal   aws:///us-west-2d/i-0564e400ba4c6d9fe   running
ci-ln-1kgfjy2-76ef8-xdwrd-master-2                  Running   m5.xlarge   us-west-2   us-west-2a   3h36m   ip-10-0-150-22.us-west-2.compute.internal    aws:///us-west-2a/i-0a3b188165e31d2ef   running
ci-ln-1kgfjy2-76ef8-xdwrd-worker-us-west-2a-4ngrn   Running   m5.xlarge   us-west-2   us-west-2a   3h29m   ip-10-0-177-58.us-west-2.compute.internal    aws:///us-west-2a/i-000fb2fcf49268c20   running
ci-ln-1kgfjy2-76ef8-xdwrd-worker-us-west-2a-pt8kz   Running   m5.xlarge   us-west-2   us-west-2a   3h29m   ip-10-0-148-211.us-west-2.compute.internal   aws:///us-west-2a/i-0fb8e9f5a1b67f198   running
ci-ln-1kgfjy2-76ef8-xdwrd-worker-us-west-2d-rnzwp   Running   m5.xlarge   us-west-2   us-west-2d   3h29m   ip-10-0-207-182.us-west-2.compute.internal   aws:///us-west-2d/i-0f1319fcd363e8544   running
----

. Select the machine that you want to update and save its machine configuration on the file system:
+
[source,terminal]
----
$ oc get machine <name-of-machine> -n openshift-machine-api -o yaml > name-machine-machine.yaml
----
+
.Example output
[source,terminal]
----
$ oc get machine ci-ln-1kgfjy2-76ef8-xdwrd-master-0 -n openshift-machine-api -o yaml > ci-ln-1kgfjy2-76ef8-xdwrd-master-0.yaml
----

. Remove the `status` field from the `ci-ln-1kgfjy2-76ef8-xdwrd-master-0.yaml` file:
+
[source,yaml]
----
status:
addresses:
- address: 10.0.140.141
  type: InternalIP
- address: ip-10-0-140-141.us-west-2.compute.internal
  type: InternalDNS
- address: ip-10-0-140-141.us-west-2.compute.internal
  type: Hostname
conditions:
- lastTransitionTime: "2022-04-12T04:34:27Z"
  status: "True"
  type: InstanceExists
lastUpdated: "2022-04-12T04:34:31Z"
nodeRef:
  kind: Node
  name: ip-10-0-140-141.us-west-2.compute.internal
  uid: c7620b3b-4e47-4290-92cc-aaa465f8cfc6
phase: Running
providerStatus:
  conditions:
  - lastProbeTime: "2022-04-12T04:34:27Z"
    lastTransitionTime: "2022-04-12T04:34:27Z"
    message: Machine successfully created
    reason: MachineCreationSucceeded
    status: "True"
    type: MachineCreation
  instanceId: i-062b01aa405655286
  instanceState: running
----

. Remove the `providerID` field from the `ci-ln-1kgfjy2-76ef8-xdwrd-master-0.yaml` file:
+
[source,yaml]
----
spec:
  metadata: {}
  providerID: aws:///us-west-2a/i-062b01aa405655286
----

. Remove the `annotations` and `generation` fields from the `ci-ln-1kgfjy2-76ef8-xdwrd-master-0.yaml` file:
+
[source,yaml]
----
apiVersion: machine.openshift.io/v1beta1
kind: Machine
metadata:
  annotations:
    machine.openshift.io/instance-state: running
  creationTimestamp: "2022-04-12T04:28:06Z"
  finalizers:
  - machine.machine.openshift.io
  generation: 2
----

. Remove the `resourceVersion` and `uid` fields from the `ci-ln-1kgfjy2-76ef8-xdwrd-master-0.yaml` file:
+
[source,yaml]
----
resourceVersion: "9628"
uid: 34df7779-57e3-422e-a838-7e12393445c7
----

. Edit the `spec` section and change the value of `instanceType` field in `ci-ln-1kgfjy2-76ef8-xdwrd-master-0.yaml` file:
+
[source,yaml]
----
instanceType: <instance-type-AWS> <1>
----

<1> Defines various AWS instance types.
+
. Change the value of `machine.openshift.io/instance-type` field in `ci-ln-1kgfjy2-76ef8-xdwrd-master-0.yaml` file:
+
[source,yaml]
----
machine.openshift.io/instance-type: <instance-type-AWS>
----

. Apply the edited machine configuration:
+
[source,terminal]
----
$ oc apply -f ci-ln-1kgfjy2-76ef8-xdwrd-master-0.yaml
----
