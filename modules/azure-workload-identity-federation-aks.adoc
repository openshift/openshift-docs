// Module included in the following assemblies:
//
// * integration/integrate-using-short-lived-tokens.adoc
:_mod-docs-content-type: PROCEDURE
[id="azure-workload-identity-federation-gke_{context}"]
= Configuring Microsoft Azure Kubernetes Service

[role="_abstract"]
By running {rh-rhacs-first} on Microsoft Azure Kubernetes Service (AKS), you can configure short-lived tokens by using Microsoft Entra ID managed identities.

[NOTE]
====
If you use Kubernetes, enter `kubectl` instead of `oc`.
====

.Prerequisites
* You have access to the cluster and integration resources within Microsoft Azure.

.Procedure
. Create a trust relationship between the external IdP and a user-assigned managed identity or application in Microsoft Entra ID.
+
For more information, see link:https://learn.microsoft.com/en-us/entra/workload-id/workload-identity-federation#how-it-works[Workload identity federation] (Microsoft Azure documentation).
. Annotate the {product-title-short} service account by running the following command:
+
[IMPORTANT]
====
When setting up the delegated scanning, use *sensor* instead of *central*.
====
+
[source,terminal]
----
$ oc annotate serviceaccount \
    central \
    --namespace stackrox \
    azure.workload.identity/client-id=<CLIENT_ID>
----
+
where:
+
--
`<CLIENT_ID>`:: Specifies the client ID of the associated identity.
--
+
.Example output
[source,terminal]
----
serviceaccount/central annotated
----