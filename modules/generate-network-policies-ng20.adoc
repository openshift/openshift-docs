// Module included in the following assemblies:
//
// * operating/manage-network-policies.adoc
:_content-type: PROCEDURE
[id="generate-network-policies-ng20_{context}"]
= Generating network policies in the network graph

[role="_abstract"]
{product-title-short} lets you automatically generate network policies based on the actual observed network communication flows in your environment.

You can generate policies based on the cluster, namespaces, and deployments that you have selected in the network graph. Policies are generated for any deployments that are included in the current Network Graph scope. For example, the current scope could include the entire cluster, a cluster and namespaces, or individually selected deployments in the selected namespaces. You can also further reduce the scope by applying one of the filters from the *Filter deployments* field with any combination of the cluster, namespace, and deployment selections. For example, you could narrow the scope to deployments in a specific cluster and namespace that are affected by a specific CVE. Policies are generated from the traffic observed during the baseline discovery period.

. In the {product-title-short} portal, navigate to *Network Graph*.
. Select a cluster, and then select one or more namespaces.
. Optional: Select individual deployments to restrict the policy generated to only those deployments. You can also use the *Filter deployments* feature to further narrow the scope.
. In the network graph header, select *Network policy generator*.
. Optional: In the information panel that opens, select *Exclude ports & protocols* to remove the port/protocol restrictions when generating network policies from a baseline.
+
As an example, the `nginx3` deployment makes a port 80 connection to `nginx4`, and this is included as part of the baseline for `nginx4`. If policies are generated and this checkbox is not selected (the default behavior), the generated policy will restrict the allowed connections from `nginx3` to `nginx4` to only port 80. If policies are generated with this option selected, the generated policy will allow any port in the connection from `nginx3` to `nginx4`.
. Click *Generate and simulate network policies*. {product-title-short} generates policies for the scope that you have chosen. This scope is displayed at the top of the *Generate network policies* panel.
+
[NOTE]
====
Clicking on the deployment information in the scope displays a list of the deployments that are included.
====
. Optional: Copy the generated network policy configuration YAML file to the clipboard or download it by clicking the download icon in the panel.
. Optional: To compare the generated network policies to the existing network policies, click *Compare*. The YAML files for existing and generated network policies are shown in a side-by-side view.
+
[NOTE]
====
Some items do not have generated policies, such as namespaces with existing ingress policies or deployments in certain protected namespaces such as as `stackrox` or `acs`.
====
. Optional: Click the *Actions* menu to perform the following activities:
* Share the YAML file with notifiers: Sends the YAML file to one of the system notifiers you have configured, for example, Slack, ServiceNow, or an application that uses generic webhooks. These notifiers are configured by navigating to *Platform Configuration* -> *Integrations*. See the documentation in the "Additional resources" section for more information.
* Rebuild rules from active traffic: Refreshes the generated policies that are displayed.
* Revert rules to previously applied YAML: Removes the simulated policy and reverts to the last network policy.