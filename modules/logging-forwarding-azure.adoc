// Module included in the following assemblies:
// * logging/configuring-log-forwarding.adoc

:_mod-docs-content-type: PROCEDURE
[id="logging-forwarding-azure_{context}"]
= Forwarding to Azure Monitor Logs

You can forward logs to link:https://learn.microsoft.com/en-us/azure/azure-monitor/logs/data-platform-logs[Azure Monitor Logs]. This functionality is provided by the link:https://vector.dev/docs/reference/configuration/sinks/azure_monitor_logs/[Vector Azure Monitor Logs sink].

.Prerequisites

* You have basic familiarity with Azure services.
* You have an Azure account configured for Azure Portal or Azure CLI access.
* You have obtained your Azure Monitor Logs primary or the secondary security key.
* You have determined which log types to forward.
* You installed the {oc-first}.
* You have installed {clo}.
* You have administrator permissions.


.Procedure 

. Enable log forwarding to Azure Monitor Logs via the HTTP Data Collector API:

Create a secret with your shared key:
[source,yaml]
----
apiVersion: v1
kind: Secret
metadata:
  name: my-secret
  namespace: openshift-logging
type: Opaque
data:
  shared_key: <your_shared_key> # <1>
----
<1> Must contain a primary or secondary key for the link:https://learn.microsoft.com/en-us/azure/azure-monitor/logs/log-analytics-workspace-overview[Log Analytics workspace] making the request.

. To obtain a link:https://learn.microsoft.com/en-us/rest/api/storageservices/authorize-with-shared-key[shared key], you can use this command in Azure CLI:

[source,text]
----
Get-AzOperationalInsightsWorkspaceSharedKey -ResourceGroupName "<resource_name>" -Name "<workspace_name>‚Äù
----


. Create or edit your `ClusterLogForwarder` CR using the template matching your log selection.

.Forward all logs
[source,yaml]
----
apiVersion: observability.openshift.io/v1
kind: ClusterLogForwarder
metadata:
  name: <log_forwarder_name>
  namespace: openshift-logging
spec:
  serviceAccount: 
    name: <service_account_name> #<1>
  outputs:
  - name: azure-monitor
    type: azureMonitor
    azureMonitor:
      customerId: my-customer-id # <2>
      logType: my_log_type # <3>
      authentication:
        sharedKey:
          secretName: my-secret
          key: shared_key
  pipelines:
    - name: app-pipeline
      inputRefs:
      - application
      outputRefs:
      - azure-monitor
----
<1> The name of your service account.
<2> Unique identifier for the Log Analytics workspace. Required field.
<3> Record type of the data being submitted. May only contain letters, numbers, and underscores (_), and may not exceed 100 characters. For more information, see link:https://learn.microsoft.com/en-us/azure/azure-monitor/logs/data-collector-api?tabs=powershell#record-type-and-properties[Azure record type] in the Microsoft Azure documentation.
