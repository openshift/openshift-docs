// Module included in the following assemblies:
//
// monitoring/configuring-monitoring-stack.adoc

[id='modifying-retention-time-for-prometheus-metrics-data-{context}']
= Modifying retention time for Prometheus metrics data

In Prometheus, the retention time determines when old data gets removed. By default, the Prometheus Cluster Monitoring stack configures that to be 15 days. This procedure shows how you can change the retention time.

.Procedure

. Check whether the `cluster-monitoring-config` ConfigMap object exists already:
+
----
oc -n openshift-monitoring get configmaps cluster-monitoring-config
----
+
If it does not exist, create a new one:
+
----
oc -n openshift-monitoring create configmap cluster-monitoring-config
----

. Start editing the `cluster-monitoring-config` ConfigMap:
+
----
oc -n openshift-monitoring edit configmap cluster-monitoring-config
----

. Create the `data` section if it does not exist yet:
+
----
data:
 config.yaml: |
----

. Put your retention time configuration under `data/config.yaml`:
+
[subs="quotes"]
  apiVersion: v1
  kind: ConfigMap
  metadata:
    name: cluster-monitoring-config
    namespace: openshift-monitoring
  data:
    config.yaml: |+
      prometheusK8s:
        retentionTime: *_time specification_*
+
Substitute *time specification* with a number directly followed by `ms` (milliseconds), `s` (seconds), `m` (minutes), `h` (hours), `d` (days), `w` (weeks), or `y` (years).
+
For example, to configure retention time to be 24 hours, use:
+
[subs="quotes"]
  apiVersion: v1
  kind: ConfigMap
  metadata:
    name: cluster-monitoring-config
    namespace: openshift-monitoring
  data:
    config.yaml: |+
      prometheusK8s:
        retentionTime: *24h*
