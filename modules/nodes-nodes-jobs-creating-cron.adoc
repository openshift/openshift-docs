// Module included in the following assemblies:
//
// * nodes/nodes-nodes-jobs.adoc

[id="nodes-nodes-jobs-creating-cron_{context}"]
= Creating CronJobs

You create a CronJob in {product-title} by creating a job object.

.Procedure

To create a CronJob:

. Create a YAML file similar to the following:
+
[source,yaml]
----
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: pi
spec:
  schedule: "*/1 * * * *"  <1>
  concurrencyPolicy: "Replace" <2>
  startingDeadlineSeconds: 200 <3>
  suspend: true            <4>
  successfulJobsHistoryLimit: 3 <5>
  failedJobsHistoryLimit: 1     <6>
  jobTemplate:             <7>
    spec:
      template:
        metadata:
          labels:          <8>
            parent: "cronjobpi"
        spec:
          containers:
          - name: pi
            image: perl
            command: ["perl",  "-Mbignum=bpi", "-wle", "print bpi(2000)"]
          restartPolicy: OnFailure <9>
----
+
<1> Schedule for the job specified in link:https://en.wikipedia.org/wiki/Cron[cron format]. In this example, the job will run every minute.
<2> An optional concurrency policy, specifying how to treat concurrent jobs within a CronJob. Only one of the following concurrent policies may be specified. If not specified, this defaults to allowing concurrent executions.
* `Allow` allows CronJobs to run concurrently.
* `Forbid` forbids concurrent runs, skipping the next run if the previous has not
finished yet.
* `Replace` cancels the currently running job and replaces
it with a new one.
<3> An optional deadline (in seconds) for starting the job if it misses its
scheduled time for any reason. Missed jobs executions will be counted as failed
ones. If not specified, there is no deadline.
<4> An optional flag allowing the suspension of a CronJob. If set to `true`,
all subsequent executions will be suspended.
<5> The number of successful finished jobs to retain (defaults to 3).
<6> The number of failed finished jobs to retain (defaults to 1).
<7> Job template. This is similar to the job example.
<8> Sets a label for jobs spawned by this CronJob.
<9> The restart policy of the pod. This does not apply to the job controller.
+
[NOTE]
====
The `.spec.successfulJobsHistoryLimit` and `.spec.failedJobsHistoryLimit` fields are optional.
These fields specify how many completed and failed jobs should be kept.  By default, they are
set to `3` and `1` respectively.  Setting a limit to `0` corresponds to keeping none of the corresponding
kind of jobs after they finish.
====

. Create the CronJob:
+
[source,terminal]
----
$ oc create -f <file-name>.yaml
----

[NOTE]
====
You can also create and launch a CronJob from a single command using `oc create cronjob`. The following command creates and launches a CronJob similar to the one specified in the previous example:

[source,terminal]
----
$ oc create cronjob pi --image=perl --schedule='*/1 * * * *' -- perl -Mbignum=bpi -wle 'print bpi(2000)'
----

With `oc create cronjob`, the `--schedule` option accepts schedules in link:https://en.wikipedia.org/wiki/Cron[cron format].

====
