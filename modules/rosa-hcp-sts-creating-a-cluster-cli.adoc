// Module included in the following assemblies:
//
// * rosa_hcp/rosa-hcp-sts-creating-a-cluster-quickly.adoc

:_mod-docs-content-type: PROCEDURE
[id="rosa-hcp-sts-creating-a-cluster-cli_{context}"]
= Creating a {hcp-title} cluster using the CLI

When using the {product-title} (ROSA) CLI, `rosa`, to create a cluster, you can select the default options to create the cluster quickly.

.Prerequisites

* You have completed the AWS prerequisites for {hcp-title}.
* You have available AWS service quotas.
* You have enabled the ROSA service in the AWS Console.
* You have installed and configured the latest ROSA CLI (`rosa`) on your installation host. Run `rosa version` to see your currently installed version of the ROSA CLI. If a newer version is available, the CLI provides a link to download this upgrade.
* You have logged in to your Red Hat account by using the ROSA CLI.
* You have created an OIDC configuration.
* You have verified that the AWS Elastic Load Balancing (ELB) service role exists in your AWS account.

.Procedure

//. Create environmental variables for your region and cluster name.
//+
//[source,terminal]
//----
//CLUSTER_NAME="<cluster-name>"
//REGION="<region>"
//----

. Use one of the following commands to create your {hcp-title} cluster:
+
[NOTE]
====
When creating a {hcp-title} cluster, the default machine Classless Inter-Domain Routing (CIDR) is `10.0.0.0/16`. If this does not correspond to the CIDR range for your VPC subnets, add `--machine-cidr <address_block>` to the following commands. To learn more about the default CIDR ranges for {product-title}, see xref:../networking/cidr-range-definitions.adoc#cidr-range-definitions[CIDR range definitions].
====
+
--
* If you did not set environmental variables, run the following command:
+
[source,terminal]
----
$ rosa create cluster --cluster-name=<cluster_name> \ <.>
    --mode=auto --hosted-cp [--private] \ <.> 
    --operator-roles-prefix <operator-role-prefix> \ <.>
    --oidc-config-id <id-of-oidc-configuration> \ 
    --subnet-ids=<public-subnet-id>,<private-subnet-id>
----
<.> Specify the name of your cluster, ensuring that the cluster name consists of no more than 15 lowercase alphanumeric characters or '-', starts with a letter, and ends with an alphanumeric character.
<.> Optional: The `--private` argument is used to create private {hcp-title} clusters. If you use this argument, ensure that you only use your private subnet ID for `--subnet-ids`.
<.> By default, the cluster-specific Operator role names are prefixed with the cluster name and a random 4-digit hash. You can optionally specify a custom prefix to replace `<cluster_name>-<hash>` in the role names. The prefix is applied when you create the cluster-specific Operator IAM roles. For information about the prefix, see _About custom Operator IAM role prefixes_.
+
[NOTE]
====
If you specified custom ARN paths when you created the associated account-wide roles, the custom path is automatically detected. The custom path is applied to the cluster-specific Operator roles when you create them in a later step.
====
--
+
* If you set the environmental variables, create a cluster with a single, initial machine pool, using either a publicly or privately available API, and a publicly or privately available Ingress by running the following command:
+
[source,terminal]
----
$ rosa create cluster --private --cluster-name=<cluster_name> \ 
  --mode=auto --hosted-cp --operator-roles-prefix=$OPERATOR_ROLES_PREFIX \ 
  --oidc-config-id=$ODIC_CONFIG --subnet-ids=$SUBNET_IDS
----
+
* If you set the environmental variables, create a cluster with a single, initial machine pool, a publicly available API, and a publicly available Ingress by running the following command:
+
[source,terminal]
----
$ rosa create cluster --cluster-name=<cluster_name> --mode=auto --hosted-cp --operator-roles-prefix=$OPERATOR_ROLES_PREFIX --oidc-config-id=$ODIC_CONFIG --subnet-ids=$SUBNET_IDS
----

. Check the status of your cluster by running the following command:
+
[source,terminal]
----
$ rosa describe cluster --cluster=<cluster_name>
----
+
The following `State` field changes are listed in the output as the cluster installation progresses:
+
* `pending (Preparing account)`
* `installing (DNS setup in progress)`
* `installing`
* `ready`
+
[NOTE]
====
If the installation fails or the `State` field does not change to `ready` after more than 10 minutes, check the installation troubleshooting documentation for details. For more information, see _Troubleshooting installations_. For steps to contact Red Hat Support for assistance, see _Getting support for Red Hat OpenShift Service on AWS_.
====

. Track the progress of the cluster creation by watching the {product-title} installation program logs. To check the logs, run the following command:
+
[source,terminal]
----
$ rosa logs install --cluster=<cluster_name> --watch \ <1>
----
<1> Optional: To watch for new log messages as the installation progresses, use the `--watch` argument.
