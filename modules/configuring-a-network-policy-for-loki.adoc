:_newdoc-version: 2.18.4
:_template-generated: 2025-10-17
:_mod-docs-content-type: PROCEDURE

[id="configuring-a-network-policy-for-loki_{context}"]
= Configuring a network policy for Loki

Enable or disable the deployment of `NetowrkPolicies` per LokiStack by setting the `networkPolicies` field. 

.Prerequisites
* You have administrator permissions.
* You have installed the {oc-first}.
* You have installed the {loki-op}.
* You have created a `LokiStack` custom resource (CR).

.Procedure
. Update the `LokiStack` CR:
+
[source,yaml]
----
apiVersion: loki.grafana.com/v1
kind: LokiStack
metadata:
  name: logging-loki
  namespace: openshift-logging
spec:
  size: 1x.small
  storage:
    schemas:
    - version: v13
      effectiveDate: "<yyyy>-<mm>-<dd>"
    secret:
      name: logging-loki-s3
      type: s3
  storageClassName: <storage_class_name>
  tenants:
    mode: openshift-logging
  networkPolicies:
    disabled: false  # Enable network policies
----
+
You can set one of the following values for the `spec.networkPolicies.disabled` field:
+
`true`::
{loki-op} will delete any network policy that it was managing previously.
`false`::
{loki-op} will deploy a set of network policies that restrict the the communications to and from the Loki components.
+
If you do not define a `networkPolicies.disabled` value, the platform default values are inherited. This is enabled only in {ocp-product-title} 4.20 and later. 

. Apply the `LokiStack` CR object by running the following command:
+
[source,terminal]
----
$ oc apply -f <filename>.yaml
----
