:_newdoc-version: 2.18.4
:_template-generated: 2025-04-28
:_mod-docs-content-type: CONCEPT

[id="example-of-forwarding-logs-to-external-elasticsearch_{context}"]
= Example of forwarding logs to external Elasticsearch

You can forward logs to external Elasticsearch with Logging 6.

In Logging 5.9, you could use custom Elasticsearch indices by using the `structuredTypeKey` and `structuredTypeName` options

.Example 5.9 snippet
[source,yaml]
----
...
spec:
  outputs:
    - name: default
      type: elasticsearch
      elasticsearch:
        structuredTypeKey: log_type
        structuredTypeName: unknown
...
----

In Logging 6.x you can create a custom index as shown in the following example.

.Example 6.x snippet
[source,yaml]
----
...
spec:
  outputs:
  - name: es-output
    type: elasticsearch
    elasticsearch:
      url: https://elasticsearch:9200
      version: 6
      index: '{.log_type||"unknown"}' # <1>
...
----
<1> `index` is set to read the field value `.log_type` and falls back to "unknown" if not found. A string fallback is always required to ensure a valid index.

The following example shows the complete spec for forwarding logs to an external ElasticSearch log store in Logging 6.x.

.Example cluster log forwarder
[source,yaml]
----
apiVersion: observability.openshift.io/v1
kind: ClusterLogForwarder
metadata:
  name: my-forwarder
spec:
  serviceAccount:
    name: logging-admin
  outputs:
  - name: es-external
    type: elasticsearch
    elasticsearch:
      url: https://external-es-service:9200
      version: 8
      index: '{.log_type||"nologformat"}-write' # <1>
    tls:
      ca:
        key: bundle.crt
        secretName: my-tls-secret
      certificate:
        key: tls.crt
        secretName: my-tls-secret
      key:
        key: tls.key
        secretName: my-tls-secret
  filters:
  - name: my-parse
    type: parse
  pipelines:
  - name: my-pipeline
    inputRefs:
    - application
    - infrastructure
    filterRefs:
    - my-parse
    outputRefs:
    - es-external
----
<1> `index` can be a combination of dynamic and static values. Dynamic values are enclosed in curly brackets {} and must end with a "quoted" static fallback value separated with ||.

In this example, application logs are written to the 'application-write' and 'infrastructure-write' index. In the older Logging versions that did not include the index spec, application logs would have instead written to 'app-write' and 'infra-write' index.
////
[role="_additional-resources"]
.Additional resources
* link:https://github.com/redhat-documentation/modular-docs#modular-documentation-reference-guide[Modular Documentation Reference Guide]
* xref:some-module_{context}[]
////
