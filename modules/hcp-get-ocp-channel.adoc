// Module included in the following assemblies:
//
// * hosted_control_planes/hcp-updating.adoc

:_mod-docs-content-type: PROCEDURE
[id="hcp-get-ocp-channel_{context}"]
= Updating your hosted cluster

You can update your hosted cluster by setting a channel that matches with your desired channel semantics.

The initial `HostedCluster` resource does not have any information in the `status.version.availableUpdates` and `status.version.conditionalUpdates` fields. After you set the `spec.channel` field to the {product-title} release version, the HyperShift Operator updates the `status.version` field with the available and conditional updates.

.Procedure

. Check recommended {product-title} channels by running the following command:
+
[source,terminal]
----
$ oc -n <hosted_cluster_namespace> get -o jsonpath='{.status.version.desired.channels}' hostedcluster <hosted_cluster_name>
----

. Set a channel in your hosted cluster that matches with your desired channel semantics. For more information about channels and releases, see "Understanding update channels and releases". Run the following command:
+
[source,terminal]
----
$ oc patch -n <hosted_cluster_namespace> hostedcluster <hosted_cluster_name> --type=merge -p '{"spec":{"channel":"<channel>"}}' <1>
----
<1> Replace `<channel>` with the {product-title} release version that you specified in `spec.release`. For example, if you set the `spec.release` to `ocp-release:4.18.4-multi`, you can set `spec.channel` to fast-{product-version} and stable-{product-version}. For more information about channels, see "Understanding update channels and releases".

. Update the `spec.release` field of the `HostedCluster` to trigger the control plane rollout by running the following command:
+
[source,terminal]
----
$ oc patch -n <hosted_cluster_namespace> hostedcluster <hosted_cluster_name> --type=merge -p '{"spec":{"release":{"image":"<release_payload>"}}}' <1>
----
<1> Replace `<release_payload>` with the {product-title} release payload that you can find in the `availableUpdates` or `conditionalUpdates` fields.

. Check the list of available updates for your hosted cluster by running the following command:
+
[source,terminal]
----
$ oc get -n <hosted_cluster_namespace> hostedcluster <hosted_cluster_name> -o jsonpath='{.status.version.availableUpdates}'
----

. Monitor the progress of your ongoing update, the update rollout status, timestamps, and issues by using the information retrieved by the Cluster Version Operator (CVO):

.. Check the status of the `ClusterVersionProgressing` and `ClusterVersionSucceeding` conditions in your `HostedCluster` resource by running the following command:
+
[source,terminal]
----
$ oc get hostedcluster <hosted_cluster_name> -o jsonpath-as-json='{.status.conditions}'
----

.. Optional: To retrieve more detailed information about the status of your update, see "Gathering cluster update status using oc adm upgrade status (Technology Preview)".

.. Run the following command to check the status of conditions:
+
[source,terminal]
----
$ oc get hostedcluster <hosted_cluster_name> -o jsonpath='{.status.conditions}'
----
+
See the following update rollout status conditions:

* `ClusterVersionSucceeding`: Indicates if the cluster is successfully updating.
* `ClusterVersionProgressing`: Indicates if the update is actively progressing.

.Verification

* Verify that the `history` field in the `HostedCluster` resource indicates a status as `Completed`. Run the following command:
+
[source,terminal]
----
$ oc get hostedcluster <hosted_cluster_name> -o jsonpath-as-json='{.status.version.history}'
----
