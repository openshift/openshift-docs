// Module included in the following assemblies:
//
// * installing/installing_openstack/installing-openstack-installer.adoc
// * installing/installing_openstack/installing-openstack-installer-custom.adoc
// * installing/installing_openstack/installing-openstack-installer-kuryr.adoc

[id="installation-osp-accessing-api-floating_{context}"]

= Enabling API access with floating IP addresses

Make {product-title} API endpoints accessible by attaching two floating IP (FIP) addresses to them: one for the API load balancer (`lb FIP`), and one for OpenShift applications (`apps FIP`).

[IMPORTANT]
The load balancer FIP is also used in the `install-config.yaml` file.

.Procedure

. Using the OpenStack CLI, create a new external network:
+
----
$ openstack floating ip create <external network>
----

. Add a record that follows this pattern to your DNS server:
+
[source,dns]
----
api.<cluster name>.<base domain>  IN  A  <lb FIP>
----
+
[NOTE]
====
If you don't control the DNS server, you can add the record to your `/etc/hosts` file instead. This action makes the API accessible to you only, which is not suitable for production deployment, but does allow installation for development and testing.
====
// Break the rest of this into its own module that follows OpenShift installation, then?
. Attach a floating IP address to the `ingress-port` at the end of your installation.
.. Show the port:
+
----
$ openstack port show <cluster name>-<clusterID>-ingress-port
----

.. Attach the port to the IP address:
+
----
$ openstack floating ip set --port <ingress port ID> <apps FIP>
----

. Add a wildcard `A` record for `*apps.` to your DNS file:
+
[source,dns]
----
*.apps.<cluster name>.<base domain>  IN  A  <apps FIP>
----

[NOTE]
====
If you don't control the DNS, you can add these hostnames to `/etc/hosts`:

[source,dns]
----
<apps FIP> console-openshift-console.apps.<cluster name>.<base domain>
<apps FIP> integrated-oauth-server-openshift-authentication.apps.<cluster name>.<base domain>
<apps FIP> oauth-openshift.apps.<cluster name>.<base domain>
<apps FIP> prometheus-k8s-openshift-monitoring.apps.<cluster name>.<base domain>
<apps FIP> grafana-openshift-monitoring.apps.<cluster name>.<base domain>
<apps FIP> <app name>.apps.<cluster name>.<base domain>
----

This action makes the API accessible to you only, which is not suitable for production deployment, but does allow installation for development and testing.
====