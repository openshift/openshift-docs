// Module included in the following assemblies:
//
// * integration/integrate-using-email.adoc
:_mod-docs-content-type: PROCEDURE
[id="configure-acs-email_{context}"]
= Configuring the email plugin

The {product-title-short} notifier can send email to a recipient specified in the integration, or it can use annotations to determine the recipient.

[IMPORTANT]
====
If you are using {product-title-managed-short}, it blocks port `25` by default. Configure your mail server to use port `587` or `465` to send email notifications.
====

.Procedure

. Go to *Platform Configuration* -> *Integrations*.
. Under the *Notifier Integrations* section, select *Email*.
. Select *New Integration*.
. In the *Integration name* field, enter a name for your email integration.
. In the *Email server* field, enter the address of your email server. The email server address includes fully qualified domain name (FQDN) and the port number; for example, `smtp.example.com:465`.
. Optional: If you are using an unauthenticated Simple Mail Transfer Protocol (SMTP), select *Enable unauthenticated SMTP*. This is insecure and not recommended, but might be required for some integrations. For example, you might need to enable this option if you use an internal server for notifications that does not require authentication.
+
[NOTE]
====
You cannot change an existing email integration that uses authentication to enable unauthenticated SMTP. You must delete the existing integration and create a new one with *Enable unauthenticated SMTP* selected.
====
. Enter the user name and password of a service account that is used for authentication.
. Optional: Enter the name that you want to appear in the `FROM` header of email notifications in the *From* field; for example, `Security Alerts`.
. Specify the email address that you want to appear in the `SENDER` header of email notifications in the *Sender* field.
. Specify the email address that will receive the notifications in the *Default recipient* field.
. Optional: Enter an annotation key in *Annotation key for recipient*. You can use annotations to dynamically determine an email recipient. To do this:

.. Add an annotation similar to the following example in your namespace or deployment YAML file, where `email` is the `Annotation key` that you specify in your email integration. You can create an annotation for the deployment or the namespace.
+
[subs="+quotes"]
----
annotations:
  email: _<email_address>_
----
.. Use the annotation key `email` in the *Annotation key for recipient* field.
+
If you configured the deployment or namespace with an annotation, the {product-title-short} sends the alert to the email specified in the annotation. Otherwise, it sends the alert to the default recipient.
+
[NOTE]
====
The following rules govern how {product-title-short} determines the recipient of an email notification:

* If the deployment has an annotation key, the annotation's value overrides the default value.
* If the namespace has an annotation key, the namespace's value overrides the default value.
* If a deployment has an annotation key and a defined audience, {product-title-short} sends an email to the audience specified in the key.
* If a deployment does not have an annotation key, {product-title-short} checks the namespace for an annotation key and sends an email to the specified audience.
* If no annotation keys exist, {product-title-short} sends an email to the default recipient.
====
. Optional: Select *Disable TLS certificate validation (insecure)* to send email without TLS. You should not disable TLS unless you are using StartTLS.
+
[NOTE]
====
Use TLS for email notifications. Without TLS, all email is sent unencrypted.
====

. Optional: To use StartTLS, select either *Login* or *Plain* from the *Use STARTTLS (requires TLS to be disabled)* drop-down menu.
+
[IMPORTANT]
====
With StartTLS, credentials are passed in plain text to the email server before the session encryption is established.

* StartTLS with the *Login* parameter sends authentication credentials in a `*base64*` encoded string.
* StartTLS with the *Plain* parameter sends authentication credentials to your mail relay in plain text.
====

. Optional: Enter a hostname to use for the SMTP HELO/EHLO messages sent during the SMTP handshake. If you do not specify a hostname, `localhost` is used by default.