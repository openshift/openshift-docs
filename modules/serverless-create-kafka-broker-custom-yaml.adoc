// Module included in the following assemblies:
//
//  * serverless/knative_eventing/serverless-using-brokers.adoc

[id="serverless-create-kafka-broker-custom-yaml_{context}"]
= Creating a Kafka broker with custom configuration by using YAML

You can create a Kafka broker by using YAML with custom configuration.

:FeatureName: Creating a Kafka broker with custom configuration
include::../modules/technology-preview.adoc[leveloffset=+0]

.Prerequisites

* The {ServerlessOperatorName}, Knative Eventing, and the `KnativeKafka` custom resource are installed on your {product-title} cluster.
* You have created a project or have access to a project with the appropriate roles and permissions to create applications and other workloads in {product-title}.

.Procedure

. Create a config map for configuration as a YAML file:
+
[source,yaml]
----
apiVersion: v1
kind: ConfigMap
metadata:
  name: my-kafka-broker-config
data:
  default.topic.partitions: <partitions>
  default.topic.replication.factor: <replication_factor>
  bootstrap.servers: <bootstrap_servers>
----

. Apply the config map YAML file:
+
[source,terminal]
----
$ oc apply -f <filename>
----

. Create a Kafka broker as a YAML file that points to the preceding configuration:
+
[source,yaml]
----
apiVersion: eventing.knative.dev/v1
kind: Broker
metadata:
  annotations:
    eventing.knative.dev/broker.class: Kafka
  name: my-demo-kafka-broker
spec:
  config:
    apiVersion: v1
    kind: ConfigMap
    name: my-kafka-broker-config
    namespace: <namespace>
----

. Apply the broker YAML file:
+
[source,terminal]
----
$ oc apply -f <filename>
----
