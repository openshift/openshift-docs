// Module included in the following assemblies:
//
// storage/persistent_storage/persistent-storage-local.adoc

[id="local-removing-device_{context}"]
= Removing a local volume or local volume set

Occasionally, local volumes and local volume sets must be deleted. While removing the entry in the resource and deleting the persistent volume is typically enough, if you want to reuse the same device path or have it managed by a different StorageClass, then additional steps are needed.

[NOTE]
====
The following procedure outlines an example for removing a local volume. The same procedure can also be used to remove symlinks for a local volume set custom resource.
====

.Prerequisite

* The PersistentVolume must be in a `Released` or `Available` state.
+
[WARNING]
====
Deleting a PersistentVolume that is still in use can result in data loss or corruption.
====

.Procedure

. Edit the previously created LocalVolume to remove any unwanted disks.

.. Edit the cluster resource:
+
[source,terminal]
----
$ oc edit localvolume <name> -n openshift-local-storage
----

.. Navigate to the lines under `devicePaths`, and delete any representing unwanted disks.

. Delete any PersistentVolumes created.
+
[source,terminal]
----
$ oc delete pv <pv-name>
----

. Delete any symlinks on the node.
+
[WARNING]
====
The following step involves accessing a node as the root user. Modifying the state of the node beyond the steps in this procedure could result in cluster instability.
====
+
.. Create a debug pod on the node:
+
[source,terminal]
----
$ oc debug node/<node-name>
----

.. Change your root directory to the host:
+
[source,terminal]
----
$ chroot /host
----

.. Navigate to the directory containing the local volume symlinks.
+
[source,terminal]
----
$ cd /mnt/openshift-local-storage/<sc-name> <1>
----
<1> The name of the StorageClass used to create the local volumes.

.. Delete the symlink belonging to the removed device.
+
[source,terminal]
----
$ rm <symlink>
----
