// Module included in the following assemblies:

// update/ossm-updating-openshift-service-mesh.adoc

:_mod-docs-content-type: PROCEDURE
[id="ossm-updating-istio-cni-resource-version_{context}"]
= Updating the Istio CNI resource version

You can update the {istio} Container Network Interface (CNI) resource version by changing the version in the resource. Then, the {SMProductShortName} Operator deploys a new version of the CNI plugin that replaces the old version of the CNI plugin. The `istio-cni-node` pods automatically reconnect to the new CNI plugin.

.Prerequisites

* You are logged in to {ocp-product-title} as a user with the `cluster-admin` role.
* You have installed the {SMProductName} Operator and deployed {istio}.
* You have installed the {istio} CNI plugin with the required version. In the following example, the `IstioCNI` resource named `default` is deployed in the `istio-cni` namespace.
* You have either updated the {istio} control plane to the required version (for `Inplace` strategy) or created a new control plane revision (for `RevisionBased` strategy). 

.Procedure

. Change the version in the `{istio}` resource. For example, to update to {istio} `{istio-latest}`, set the `spec.version` field to `{istio-latest}` by running the following command:
+
[source,terminal,subs="+attributes"]
----
$ oc patch istiocni default -n istio-cni --type='merge' -p '{"spec":{"version":"v{istio-latest}"}}'
----

. Wait for the `IstioCNI` DaemonSet to reach the `Ready` status after the update by running the following command:
+
[source,terminal]
----
$ oc wait --for=condition=Ready istiocnis/default --timeout=5m
----

. Confirm that the new version of the CNI plugin is ready by running the following command:
+
[source,terminal]
----
$ oc get istiocni default
----
+
You should see an output similar to the following example:
+
[source,terminal]
----
NAME      READY   STATUS    VERSION   AGE
default   True    Healthy   v{istio-latest}   7d1h
----

. Check the status of the pods by running the following command:
+
[source,terminal]
----
$ oc get pods -n istio-cni
----
+
You should see an output similar to the following example:
+
[source,terminal]
----
NAME                   READY   STATUS    RESTARTS   AGE
istio-cni-node-abc12   1/1     Running   0          3m
istio-cni-node-def34   1/1     Running   0          3m
istio-cni-node-ghi56   1/1     Running   0          3m
----

[NOTE]
====
When you use the `RevisionBased` strategy, the {istio} CNI component remains compatible with many control plane versions. It continues to manage traffic redirection for both the old and the new control planes throughout the migration. The {istio} CNI is compatible with a control plane running the same minor version or one minor version higher.
====