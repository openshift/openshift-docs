// Module included in the following assemblies:
//
// getting_started_moa/creating-first-moa-cluster.adoc


[id="moa-create-dedicated-cluster-admins.adoc"]
= Creating dedicated-admins and cluster-admins

.Prerequisites

You have added an Identity Provider (IDP) to your cluster.

.Procedure

. Create a `dedicated-admin` user.
.. Enter the following command to promote your user to a `dedicated-admin`:
+
[source,terminal]
----
$ moactl create user --cluster rh-moa-test-cluster1 --dedicated-admins=rh-moa-test-user
----
+
.. Enter the following command to verify that your user now has `dedicated-admin` access. As a `dedicated-admin` you should receive some errors when entering the following command:
+
[source,terminal]
----
$ oc get all -n openshift-apiserver
----
+
.Example output
[source,terminal]
----
NAME                  READY   STATUS    RESTARTS   AGE
pod/apiserver-6ndg2   1/1     Running   0          17h
pod/apiserver-lrmxs   1/1     Running   0          17h
pod/apiserver-tsqhz   1/1     Running   0          17h
NAME          TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE
service/api   ClusterIP   172.30.23.241   <none>        443/TCP   17h
NAME                       DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR                     AGE
daemonset.apps/apiserver   3         3         3       3            3           node-role.kubernetes.io/master=   17h
Error from server (Forbidden): horizontalpodautoscalers.autoscaling is forbidden: User "rh-moa-test-user" cannot list resource "horizontalpodautoscalers" in API group "autoscaling" in the namespace 
"openshift-apiserver"
Error from server (Forbidden): jobs.batch is forbidden: User "rh-moa-test-user" cannot list resource "jobs" in API group "batch" in the namespace "openshift-apiserver"
Error from server (Forbidden): cronjobs.batch is forbidden: User "rh-moa-test-user" cannot list resource "cronjobs" in API group "batch" in the namespace "openshift-apiserver"
Error from server (Forbidden): imagestreams.image.openshift.io is forbidden: User "rh-moa-test-user" cannot list resource "imagestreams" in API group "image.openshift.io" in the namespace "openshift
-apiserver"
----
+
. Create a `cluster-admin` user.
.. Enable `cluster-admin` capability on the cluster:
+
[source,terminal]
----
$ moactl edit cluster rh-moa-test-cluster1 --enable-cluster-admins
----
+
.. Give your user `cluster-admin` privileges:
+
[source,terminal]
----
$ moactl create user --cluster rh-moa-test-cluster1 --cluster-admins rh-moa-test-user
----
+
.. Verify your user is listed as a `cluster-admin`:
+
[source,terminal]
----
$ moactl list users --cluster rh-moa-test-cluster1
----
+
.Example output
[source,terminal]
----
GROUP             NAME
cluster-admins    rh-moa-test-user
dedicated-admins  rh-moa-test-user
----
+
. Enter the following command to verify that your user now has `cluster-admin` access. As a `cluster-admin` you should be able to enter the following command without errors.
+
[source,terminal]
----
$ oc get all -n openshift-apiserver                       
----
+
.Example output
[source,terminal]
----
NAME                  READY   STATUS    RESTARTS   AGE
pod/apiserver-6ndg2   1/1     Running   0          17h
pod/apiserver-lrmxs   1/1     Running   0          17h
pod/apiserver-tsqhz   1/1     Running   0          17h
NAME          TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE
service/api   ClusterIP   172.30.23.241   <none>        443/TCP   18h
NAME                       DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR                     AGE
daemonset.apps/apiserver   3         3         3       3            3           node-role.kubernetes.io/master=   18h
----