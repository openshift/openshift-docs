// Module included in the following assemblies:
//
// * support/troubleshooting/troubleshooting-operator-issues.adoc

[id="troubleshooting-disabling-autoreboot-mco-console_{context}"]
= Disabling the Machine Config Operator from automatically rebooting by using the console

To avoid unwanted disruptions from changes made by the Machine Config Operator (MCO), you can use the {product-title} web console to modify the machine config pool (MCP) to prevent the MCO from making any changes to nodes in that pool. This prevents any reboots that would normally be part of the MCO update process. 

[NOTE]
====
Pausing an MCP prevents the MCO from applying any configuration changes on the associated nodes. Pausing an MCP also prevents any automatically-rotated certificates from being pushed to the associated nodes, including the automatic rotation of the `kube-apiserver-to-kubelet-signer` CA certificate. If the MCP is paused when the `kube-apiserver-to-kubelet-signer` CA certificate expires, and the MCO attempts to renew the certificate automatically, the new certificate is created but not applied across the nodes in the paused MCP. This causes failure in multiple `oc` commands, including but not limited to `oc debug`, `oc logs`, `oc exec`, and `oc attach`. Pausing an MCP should be done with careful consideration about the `kube-apiserver-to-kubelet-signer` CA certificate expiration and for short periods of time only.

New CA certificates are generated at 292 days from the installation date and removed at 365 days from that date. To determine the next automatic CA certificate rotation, see the link:https://access.redhat.com/articles/5651701[Understand CA cert auto renewal in Red Hat OpenShift 4].
====

.Prerequisites

* You have access to the cluster as a user with the `cluster-admin` role.

.Procedure

To pause or unpause automatic MCO update rebooting: 

* Pause the autoreboot process:

. Log in to the {product-title} web console as a user with the `cluster-admin` role.

. Click *Compute* -> *Machine Config Pools*.

. On the *Machine Config Pools* page, click either *master* or *worker*, depending upon which nodes you want to pause rebooting for.

. On the *master* or *worker* page, click *YAML*.

. In the YAML, update the `spec.paused` field to `true`.
+
.Sample MachineConfigPool object 
[source,yaml]
----
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfigPool
 ...
spec:
 ...
  paused: true <1>
----
<1> Update the `spec.paused` field to `true` to pause rebooting.

. To verify that the MCP is paused, return to the *Machine Config Pools* page.
+
On the *Machine Config Pools* page, the *Paused* column reports *True* for the MCP you modified.
+
If the MCP has pending changes while paused, the *Updated* column is *False* and *Updating* is *False*. When *Updated* is *True* and *Updating* is *False*, there are no pending changes.
+
[IMPORTANT]
====
If there are pending changes (where both the *Updated* and *Updating* columns are *False*), it is recommended to schedule a maintenance window for a reboot as early as possible. Use the following steps for unpausing the autoreboot process to apply the changes that were queued since the last reboot.
====

* Unpause the autoreboot process: 

. Log in to the {product-title} web console as a user with the `cluster-admin` role.

. Click *Compute* -> *Machine Config Pools*.

. On the *Machine Config Pools* page, click either *master* or *worker*, depending upon which nodes you want to pause rebooting for.

. On the *master* or *worker* page, click *YAML*.

. In the YAML, update the `spec.paused` field to `false`.
+
.Sample MachineConfigPool object 
[source,yaml]
----
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfigPool
 ...
spec:
 ...
  paused: false <1>
----
<1> Update the `spec.paused` field to `false` to allow rebooting.
+
[NOTE]
====
By unpausing an MCP, the MCO applies all paused changes reboots {op-system-first} as needed.
====

. To verify that the MCP is paused, return to the *Machine Config Pools* page.
+
On the *Machine Config Pools* page, the *Paused* column reports *False* for the MCP you modified.
+
If the MCP is applying any pending changes, the *Updated* column is *False* and the *Updating* column is *True*. When *Updated* is *True* and *Updating* is *False*, there are no further changes being made.

