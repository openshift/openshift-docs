// Module included in the following assemblies:
//
// * operating/examine-images-for-vulnerabilities.adoc
:_mod-docs-content-type: CONCEPT
[id="scanning-images_{context}"]
= Scanning images

[role="_abstract"]

For version 4.4, {product-title-short} provides two scanners: the StackRox Scanner and Scanner V4. Both scanners can examine images in secured clusters connected in your network. Secured cluster scanning is enabled by default in {osp} environments deployed by using the Operator or when delegated scanning is used. See "Accessing delegated image scanning" for more information.

[IMPORTANT]
====
Even if you have Scanner V4 enabled, at this time, the StackRox Scanner must still be enabled to provide scanning of RHCOS nodes and platform vulnerabilities such as {osp}, Kubernetes, and Istio. Support for that functionality in Scanner V4 is planned for a future release. Do not disable the StackRox Scanner.
====

When using the StackRox Scanner, {product-title-short} performs the following actions:

* Central submits image scanning requests to the StackRox Scanner.
* Upon receiving these requests, the StackRox Scanner pulls the image layers from the relevant registry, checks the images, and identifies installed packages in each layer.
Then it compares the identified packages and programming language-specific dependencies with the vulnerability lists and sends information back to Central
* The StackRox Scanner identifies the vulnerabilities in the following areas:

** Base image operating system
** Packages that are installed by the package managers
** Programming language specific dependencies
** Programming runtimes and frameworks

When using Scanner V4, {product-title-short} performs the following actions:

* Central requests the Scanner V4 Indexer to download and index (analyze) given images.
* Scanner V4 Indexer pulls image metadata from registries to determine the layers of the image, and downloads each previously unindexed layer.
* Scanner V4 Indexer requests mapping files from Central that assist the indexing process. Scanner V4 Indexer produces in an index report.
* Central requests that Scanner V4 Matcher match given images to known vulnerabilities. This process results in the final scan result: a vulnerability report. Scanner V4 Matcher requests the latest vulnerabilities from Central.
* Scanner V4 Matcher requests the results of the image indexing, the index report, from Scanner V4 Indexer. It then uses the report to determine relevant vulnerabilities. This interaction occurs only when the image is indexed in the Central cluster. This interaction does not occur when Scanner V4 is matching vulnerabilities for images indexed in secured clusters.
* The Indexer stores data in the Scanner V4 DB that is related to the indexing results to ensure that image layers are only downloaded and indexed once. This prevents unnecessary network traffic and other resource utilization.
* When secured cluster scanning is enabled, Sensor requests Scanner V4 to index images. Scanner V4 Indexer requests mapping files from Sensor that assist the indexing process unless Central exists in the same namespace. In that case, Central is contacted instead.

[id="common-scanner-warning-messages_{context}"]
== Understanding and addressing common Scanner warning messages

When scanning images with {rh-rhacs-first}, you might see the `CVE DATA MAY BE INACCURATE` warning message.
Scanner displays this message when it cannot retrieve complete information about the operating system or other packages in the image.

The following table shows some common Scanner warning messages:

.Warning messages
[%autowidth]
|===
| *Message* | *Description*

|`Unable to retrieve the OS CVE data, only Language CVE data is available`
|Indicates that Scanner does not officially support the base operating system of the image; therefore, it cannot retrieve CVE data for the operating system-level packages.

|`Stale OS CVE data`
|Indicates that the base operating system of the image has reached end-of-life, which means the vulnerability data is outdated. For example, Debian 8 and 9.

For more information about the files needed to identify the components in the images, see xref:../operating/examine-images-for-vulnerabilities.adoc#examine-images-for-vulnerabilities[Examining images for vulnerabilities].


|`Failed to get the base OS information`
|Indicates that Scanner scanned the image, but was unable to determine the base operating system used for the image.

|`Failed to retrieve metadata from the registry`
|Indicates that the target registry is unreachable on the network. The cause could be a firewall blocking `docker.io`, or an authentication issue preventing access.

To analyze the root cause, create a special registry integration for private registries or repositories to get the pod logs for {product-title-short} Central. For instructions on how to do this, see xref:../integration/integrate-with-image-registries.adoc[Integrating with image registries].

|`Image out of scope for Red{nbsp}Hat Vulnerability Scanner Certification`
a|Indicates that Scanner scanned the image, but the image is old and does not fall within the scope of Red{nbsp}Hat Scanner Certification. For more information, see https://redhat-connect.gitbook.io/partner-guide-red-hat-vulnerability-scanner-cert/[Partner Guide for Red{nbsp}Hat Vulnerability Scanner Certification].

IMPORTANT: If you are using a Red{nbsp}Hat link:https://catalog.redhat.com/software/containers/explore[container image], consider using a base image newer than June 2020.

|===

[id="supported-operating-systems_{context}"]
== Supported operating systems

The supported platforms listed in this section are the distributions in which Scanner identifies vulnerabilities, and it is different from the supported platforms on which you can install {product-title}.

Scanner identifies vulnerabilities in images that contain the following Linux distributions. For more information about the vulnerability databases used, see "Vulnerability sources" in "{product-title-short} Architecture".

[cols="1,3",options="header"]
|===
| Distribution | Version

| link:https://www.alpinelinux.org/[Alpine Linux]
| `alpine:3.2`^[1]^,`alpine:3.3`, `alpine:3.4`, `alpine:3.5`, `alpine:3.6`, `alpine:3.7`, `alpine:3.8`, `alpine:3.9`, `alpine:3.10`, `alpine:3.11`, `alpine:3.12`, `alpine:3.13`, `alpine:3.14`, `alpine:3.15`, `alpine:3.16`, `alpine:3.17`, `alpine:3.18`, `alpine:3.19`, `alpine:3.20`, `alpine:edge`

| link:https://aws.amazon.com/amazon-linux-ami[Amazon Linux]
| `amzn:2018.03`, `amzn:2`, `amzn:2023`^[2]^

| CentOS
| `centos:6`^[1]^, `centos:7`^[1]^, `centos:8`^[1]^

| link:https://www.debian.org/releases/[Debian]
| `debian:11`, `debian:12`, `debian:unstable`^[1]^, link:https://github.com/GoogleContainerTools/distroless[`Distroless`]

The following vulnerability sources are not updated by the vendor:
`debian:8`^[1]^, `debian:9`^[1]^, `debian:10`^[1]^

| link:https://www.oracle.com/linux/[Oracle Linux]
| `ol:5`^[2]^, `ol:6`^[2]^, `ol:7`^[2]^, `ol:8`^[2]^, `ol:9`^[2]^

| link:https://vmware.github.io/photon/assets/files/html/3.0/Introduction.html[Photon OS]
| `photon:1.0`^[2]^, `photon:2.0`^[2]^, `photon:3.0`^[2]^

| link:https://www.redhat.com/en/technologies/linux-platforms/enterprise-linux[{op-system-base-full}]
| `rhel:6`^[3]^, `rhel:7`^[3]^, `rhel:8`^[3]^, `rhel:9`^[3]^

| link:https://www.suse.com/[SUSE]
| `sles:11`^[2]^, `sles:12`^[2]^, `sles:15`^[2]^, `opensuse-leap:15.0`^[2]^, `opensuse-leap:15.1`^[2]^

| link:http://releases.ubuntu.com/[Ubuntu]
| `ubuntu:14.04`, `ubuntu:16.04`, `ubuntu:18.04`, `ubuntu:20.04`, `ubuntu:22.04`, `ubuntu:24.04`, `ubuntu:24.10`

The following vulnerability sources are not updated by the vendor:
`ubuntu:12.04`^[1]^, `ubuntu:12.10`^[1]^, `ubuntu:13.04`^[1]^, `ubuntu:14.10`^[1]^, `ubuntu:15.04`^[1]^, `ubuntu::15.10`^[1]^, `ubuntu::16.10`^[1]^, `ubuntu:17.04`^[1]^, `ubuntu:17.10`^[1]^, `ubuntu:18.10`^[1]^, `ubuntu:19.04`^[1]^, `ubuntu:19.10`^[1]^, `ubuntu:20.10`^[1]^, `ubuntu:21.04`^[1]^, `ubuntu:21.10`^[1]^, `ubuntu:22.10`^[1]^, `ubuntu:23.04`^[1]^, `ubuntu:23.10`^[1]^
|===
. Only supported in the StackRox Scanner.
. Only supported in Scanner V4.
. Images older than June 2020 are not supported in Scanner V4.

[NOTE]
====
Scanner does not support the Fedora operating system because Fedora does not maintain a vulnerability database.
However, Scanner still detects language-specific vulnerabilities in Fedora-based images.
====

[id="supported-package-formats_{context}"]
== Supported package formats

Scanner can check for vulnerabilities in images that use the following package formats:

[cols="2",options="header"]
|===
| Package format | Package managers

| apk
| apk

| dpkg
| apt, dpkg

| rpm
| dnf, microdnf, rpm, yum
|===

[id="supported-programming-languages_{context}"]
== Supported programming languages

Scanner can check for vulnerabilities in dependencies for the following programming languages:

[cols="1,3",options="header"]
|===
| Programming language | Package format

| Go^[1]^
| Binaries: The standard library version used to build the binary is analyzed. If the binaries are built with module support (go.mod), then the dependencies are also analyzed.

| Java
| JAR, WAR, EAR, JPI, HPI

| JavaScript
| package.json

| Python
| egg, wheel

| Ruby
| gem
|===
. Only supported in Scanner V4.

[id="supported-runtimes-frameworks_{context}"]
== Supported runtimes and frameworks

Beginning from {product-title} 3.0.50 (Scanner version 2.5.0), the StackRox Scanner identifies vulnerabilities in the following developer platforms:

* .NET Core
* ASP.NET Core

These are not supported by Scanner V4.
