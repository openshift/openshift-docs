// This module is included in the following assemblies:
// * about/op-release-notes.adoc

:_mod-docs-content-type: REFERENCE
[id="op-release-notes-1-14_{context}"]
= Release notes for {pipelines-title} General Availability 1.14

With this update, {pipelines-title} General Availability (GA) 1.14 is available on {OCP} 4.12 and later versions.

[id="new-features-1-14_{context}"]
== New features

In addition to fixes and stability improvements, the following sections highlight what is new in {pipelines-title} 1.14:

[id="pipelines-new-features-1-14_{context}"]
=== Pipelines

* With this update, you can use a parameter of a task or pipeline or a result of a previous task to specify the name of a resource to bind to a workspace, for example, `name: $(params.name)-configmap`.

* With this update, {pipelines-shortname} supports using your existing entitlements for Red Hat Enterprise Linux in build processes within your pipelines. The built-in `buildah` cluster task can now use these entitlements.

* With this update, if a pipeline run or task run uses the `pipeline` service account, you can use CSI volume types in the pipeline or task.

* With this update, you can use a `StepAction` custom resource (CR) to define a reusable scripted action that you can invoke from any number of tasks. To use this feature, you must set the `pipeline.options.configMaps.feature-flags.data.enable-step-actions` spec in the `TektonConfig` CR to `true`.

* With this update, object parameters and array results are enabled by default. You do not need to set any flags to use them.

* With this update, you can use the HTTP resolver to fetch a pipeline or task from an HTTP URL, as shown in the following examples:
+
.Example usage for a task
[source,yaml]
----
apiVersion: tekton.dev/v1
kind: TaskRun
metadata:
  name: remote-task-reference
spec:
  taskRef:
    resolver: http
    params:
    - name: url
      value: https://raw.githubusercontent.com/tektoncd-catalog/git-clone/main/task/git-clone/git-clone.yaml
----
+
.Example usage for a pipeline
[source,yaml]
----
apiVersion: tekton.dev/v1beta1
kind: PipelineRun
metadata:
  name: http-demo
spec:
  pipelineRef:
    resolver: http
    params:
    - name: url
      value: https://raw.githubusercontent.com/tektoncd/catalog/main/pipeline/build-push-gke-deploy/0.1/build-push-gke-deploy.yaml
----

* With this update, you can use an enum declaration to limit the values that you can supply for a parameter of a pipeline or task, as shown in the following example. To use this feature, you must set the `pipeline.options.configMaps.feature-flags.data.enable-param-enum` spec in the `TektonConfig` CR to `true`.
+
.Example usage
[source,yaml]
----
apiVersion: tekton.dev/v1
kind: Pipeline
metadata:
  name: pipeline-param-enum
spec:
  params:
  - name: message
    enum: ["v1", "v2"]
    default: "v1"
# ...
----

* With this update, when using the Git resolver with the authenticated source control management (SCM) API, you can override the default token, SCM type, and server URL that you configured. See the following example:
+
.Example usage
[source,yaml]
----
apiVersion: tekton.dev/v1beta1
kind: TaskRun
metadata:
  name: git-api-demo-tr
spec:
  taskRef:
    resolver: git
    params:
    - name: org
      value: tektoncd
    - name: repo
      value: catalog
    - name: revision
      value: main
    - name: pathInRepo
      value: task/git-clone/0.6/git-clone.yaml
    # create the my-secret-token secret in the namespace where the
    # pipelinerun is created. The secret must  contain a GitHub personal access
    # token in the token key of the secret.
    - name: token
      value: my-secret-token
    - name: tokenKey
      value: token
    - name: scmType
      value: github
    - name: serverURL
      value: https://ghe.mycompany.com
----

* With this update, you can define default resource requirements for containers and init-containers in pods that {pipelines-shortname} creates when executing task runs. Use the `pipeline.options.configMaps.config-defaults.data.default-container-resource-requirements` spec in the `TektonConfig` CR to set these requirements. You can set the default values for all containers and also for particular containers by name or by prefix, such as `sidecar-*`.

[id="Operator-new-features-1-14_{context}"]
=== Operator

* With this update, {pipelines-shortname} supports horizontal pod autoscaling for the Operator proxy webhook. If the pod that runs the Operator proxy webhook reaches 85% CPU utilization, the autoscaler creates another replica of the pod. If you want to use more than one replica for the Operator proxy webhook at startup, you must configure this number in the `options.horizontalPodAutoscalers` spec of the `TektonConfig` CR.

* With this update, the internal leader election for several components of {pipelines-shortname} was improved. The Operator controller, Operator webhook, proxy webhook, {pac} watcher, {pac} webhook, and the Tekton Chains controller now use separate leader election ConfigMaps. The leader election affects which replica of a component processes a request.

* Before this update, when you scaled up the number of replicas of the {pipelines-shortname} controller, manual intervention was required to enable the use of the new replicas; namely, you needed to delete leases in the leader election. With this update, when you scale up the number of replicas of the {pipelines-shortname} controller, the leader election includes the new replicas automatically, so the new replicas can process information.

* With this update, you can optionally set the following flags in the `spec.pipeline` spec of the `TektonConfig` CR:
** `coschedule`
** `enable-cel-in-whenexpression`
** `enable-param-enum`
** `enable-step-actions`
** `enforce-nonfalsifiability`
** `keep-pod-on-cancel`
** `max-result-size`
** `metrics.count.enable-reason`
** `results-from`
** `set-security-context`
** `default-resolver-type`

[id="triggers-new-features-1-14_{context}"]
=== Triggers

* With this update, when specifying CEL expressions for the Triggers interceptor, you can use the `first` and `last` functions to access values in a JSON array.

* With this update, when specifying CEL expressions for the Triggers interceptor, you can use the `translate` function that facilitates the utilization of regular expressions to replace characters with specified strings, as in the following example:
+
.Sample use of the `translate` function
----
".translate("[^a-z0-9]+", "ABC")
----
+
.Sample input string
----
This is $an Invalid5String
----
+
.Sample result string
----
ABChisABCisABCanABCnvalid5ABCtring
----

[id="web-console-new-features-1-14_{context}"]
=== Web console

* With this update, you can enable the web console plugin for {pipelines-shortname}. If you enable the plugin, you can view pipeline and task execution statistics in the *Pipelines overview* page and in the page of a pipeline. You must install {tekton-results} to view this information.
+
[NOTE]
====
To use the web console plugin for {pipelines-shortname}, you must use, at a minimum, the following {OCP} releases:

* For {OCP} version 4.12: 4.12.51
* For {OCP} version 4.13: 4.13.34
* For {OCP} version 4.14: 4.14.13
* For {OCP} version 4.15: any release
====

* With this update, if you are using {OCP} 4.15 and you enabled the console plugin, you can view archive information about past pipeline runs and task runs. {tekton-results} provides this information.

* With this update, the `PipelineRun` details page, accessible from both the *Developer* or *Administrator* perspective of the web console, introduces a *Vulnerabilities* row. This new row offers a visual representation of identified vulnerabilities, categorized by severity (critical, high, medium, and low). To enable this feature, update your tasks and associated pipelines to the specified format. Additionally, once enabled, you can also access the information about identified vulnerabilities through the *Vulnerabilities* column in the pipeline run list view page.

* With this update, the `PipelineRun` details page, accessible from both the *Developer* or *Administrator* perspective of the web console, provides an option to download or view Software Bill of Materials (SBOMs) for enhanced transparency and control. To enable this feature, update your tasks and associated pipelines to the specified format.

[id="cli-new-features-1-14_{context}"]
=== CLI

* With this update, the `tkn version` command displays the version of the {tekton-hub} component if this component is installed.

* With this update, you can use the `tkn customrun list` command to list custom runs.

* With this update, when using the `tkn task start` command, you can specify a URL for an OCI image in the `-i` or `--image` argument. The command pulls the image and runs the specified task from this image.

* With this update, the `opc version` command displays the version of the {tekton-results} CLI component, which is a part of the `opc` utility.

[id="pac-new-features-1-14_{context}"]
=== {pac}

* With this update, when using {pac}, you can specify the `pipelinesascode.tekton.dev/pipeline` annotation on a pipeline run to fetch the pipeline from a {tekton-hub} instance. The value of this annotation must refer to a single pipeline on {tekton-hub}.

* With this update, you can deploy an additional {pac} controller with different configuration settings and different secrets. You can use multiple {pac} controllers to interact with multiple GitHub instances.

* With this update, {pac} includes metrics publication for the GitLab and BitBucket providers. You can access the metrics using the `/metrics` path on the {pac} controller and watcher service, port 9090.

* With this update, when specifying the conditions for executing a pipeline run using a CEL expression with `pipelinesascode.tekton.dev/on-cel-expression` , you can check for existence of files in the Git repository:
** `files.all.exists(x, x.matches('<path_or_regular_expression>'))` for all files
** `files.added.exists(x, x.matches('<path_or_regular_expression>'))` for files that were added since the last run of this pipeline
** `files.modified.exists(x, x.matches('<path_or_regular_expression>'))` for files that were modified since the last run of this pipeline
** `files.deleted.exists(x, x.matches('<path_or_regular_expression>'))` for files that were deleted since the last run of this pipeline
** `files.renamed.exists(x, x.matches('<path_or_regular_expression>'))` for files that were renamed since the last run of this pipeline; this expression checks the new names of the renamed files

[id="tekton-chains-new-features-1-14_{context}"]
=== {tekton-chains}

* With this update, {tekton-chains} supports the `v1` value of the API version.

* With this update, you can set the `artifacts.pipelinerun.enable-deep-inspection` parameter in the `TektonConfig` CR. When this parameter is `true`, {tekton-chains} records the results of the child task runs of a pipeline run. When this parameter is `false`, {tekton-chains} records the results of the pipeline run but not of its child task runs.

* With this update, you can set the `builddefinition.buildtype` parameter in the `TektonConfig` CR to set the build type for in-toto attestation. When this parameter is `\https://tekton.dev/chains/v2/slsa`, {tekton-chains} records in-toto attestations in strict conformance with the SLSA v1.0 specification. When this parameter is `\https://tekton.dev/chains/v2/slsa-tekton`, {tekton-chains} records in-toto attestations with additional information such as the labels and annotations in each task run and pipeline run, and also adds each task in a pipeline run under `resolvedDependencies`.

* Before this update, when {tekton-chains} was configured to use `gcs` storage, Tekton Chains did not record pipeline run information. With this update, {tekton-chains} records pipeline run information with this storage.

* With this update, performance metrics are available for {tekton-chains}. To access the metrics, expose the `tekton-chains-metrics` service and then use the `/metrics` path on this service, port 9090. These metrics are also available in the {OCP} Monitoring stack.

* With this update, {tekton-chains} uses the new `v2alpha3` record format version when recording pipeline runs and task runs that use the `v1` version value.

* With this update, {tekton-chains} uses the `v1` version of pipeline run and task run formats internally.

[id="tekton-results-new-features-1-14_{context}"]
=== {tekton-results}

* With this update, if {tekton-results} is installed, {tekton-results} records the summary and record data for pipeline runs started using {pac}.

* With this update, {tekton-results} provides up to 100 megabytes of logging information for a pipeline or task.

* With this update, any authenticated user can view the `tekton-results-api-service` route in the openshift-pipelines namespace to interact with Tekton Results using a REST API.

* With this update, the {tekton-results} API includes a new endpoint for fetching summary and aggregation for a list of records.

* With this update, the `GetLog` endpoint of the {tekton-results} API returns raw bytes with the `text/plain` content type.

* With this update, you can optionally specify a custom CA certificate in the `options.configMaps.tekton-results-api-config.data.config.DB_SSLROOTCERT` spec in the `TektonResult` CR. In this case, {tekton-results} requires an SSL connection to the database server and uses this certificate for the connection. If you want to use this setting, when configuring {tekton-results} you must also use alternate specs for several other configuration parameters, as listed in the following table. Both the regular and the alternate parameter specs are in the `TektonResult` CR.
+
.Alternate configuration parameters for {tekton-results}
[options="header"]
|===

| Regular parameter spec | Alternate parameter spec

| `logs_api` | `options.configMaps.tekton-results-api-config.data.config.LOGS_API`
| `log_level` | `options.configMaps.tekton-results-api-config.data.config.LOG_LEVEL`
| `db_port` | `options.configMaps.tekton-results-api-config.data.config.DB_PORT`
| `db_host` | `options.configMaps.tekton-results-api-config.data.config.DB_HOST`
| `logs_path` | `options.configMaps.tekton-results-api-config.data.config.LOGS_PATH`
| `logs_type` | `options.configMaps.tekton-results-api-config.data.config.LOGS_TYPE`
| `logs_buffer_size` | `options.configMaps.tekton-results-api-config.data.config.LOGS_BUFFER_SIZE`
| `auth_disable` | `options.configMaps.tekton-results-api-config.data.config.AUTH_DISABLE`
| `db_enable_auto_migration` | `options.configMaps.tekton-results-api-config.data.config.DB_ENABLE_AUTO_MIGRATION`
| `server_port` | `options.configMaps.tekton-results-api-config.data.config.SERVER_PORT`
| `prometheus_port` | `options.configMaps.tekton-results-api-config.data.config.PROMETHEUS_PORT`
| `gcs_bucket_name` | `options.configMaps.tekton-results-api-config.data.config.GCS_BUCKET_NAME`

|===
+
For the configuration parameters not listed in this table, use the regular specs as described in the documentation.
+
[IMPORTANT]
====
Use the alternate parameter specs only if you need to use the `DB_SSLROOTCERT` setting.
====

[id="breaking-changes-1-14_{context}"]
== Breaking changes

* With this update, when using the Bundles resolver, you can no longer specify the `serviceAccount` parameter. Instead, you can specify the `secret` parameter to provide the name of a secret containing authentication information for the registry. You must update any tasks or pipelines that use the `serviceAccount` parameter of the Bundles resolver to use the `secret` parameter instead. The `pipeline.bundles-resolver-config.default-service-account` spec in the `TektonConfig` CR is no longer supported.

[id="known-issues-1-14_{context}"]
== Known issues

* The `tkn pipeline logs -f` command does not display the logs of tasks that were defined in a pipeline with the `retries: X` parameter while this pipeline is in progress.

[id="fixed-issues-1-14_{context}"]
== Fixed issues

* Before this update, when using GitHub Enterprise, an incoming webhook did not work. With this update, you can use incoming webhooks with GitHub Enterprise.

* Before this update, if a task run or pipeline run disabled timeouts, {pipelines-shortname} would run a series of rapid reconciliations on the task run or pipeline run, degrading the performance of the controller. With this update, the controller reconciles task runs and pipeline runs with disabled timeouts normally.

* Before this update, if you used a custom namespace to install Tekton Hub, the installation deleted the `openshift-pipelines` namespace, removing the {pipelines-shortname} installation. With this update, you can use a custom namespace to install Tekton Hub and your {pipelines-shortname} installation is unaffected

* Before this update, when using {pac} with GitLab, if the user triggered a pipeline run by using a comment in a merge request such as `/test`, {pac} did not report the status of the pipeline run on the merge request. With this update, {pac} correctly reports the status of the pipeline run on the merge request.

* Before this update, when using CEL filtering in Tekton Results with subgroups, as shown in the following example, the subgroups did not work correctly. With this update, subgroups work correctly.
+
.Example CEL filter with a subgroup
[source]
----
"data_type==TASK_RUN && (data.spec.pipelineSpec.tasks[0].name=='hello'||data.metadata.name=='hello')"
----

* Before this update, when a pipeline run was cancelled, {tekton-results} did not record the logs of this pipeline run. With this update, {tekton-results} records the logs of a cancelled pipeline run.

[id="release-notes-1-14-1_{context}"]
== Release notes for {pipelines-title} General Availability 1.14.1

With this update, {pipelines-title} General Availability (GA) 1.14.1 is available on {OCP} 4.12 and later versions.

[id="fixed-issues-1-14-1_{context}"]
=== Fixed issues

* Before this update, when using multiple {pac} controllers configured with different GitHub apps, the {pac} watcher component crashed with a `nilerror` message. With this update, {pac} functions normally with multiple controllers configured with different GitHub apps.

[id="release-notes-1-14-2_{context}"]
== Release notes for {pipelines-title} General Availability 1.14.2

With this update, {pipelines-title} General Availability (GA) 1.14.2 is available on {OCP} 4.12 and later versions.

[id="fixed-issues-1-14-2_{context}"]
=== Fixed issues

* Before this update, when you started a pipeline run using {pac}, {tekton-results} did not store information about this pipeline run. Because of this issue, the web console plugin did not include the pipeline run in the execution statistics display. With this update, {tekton-results} stores information about {pac} pipeline runs and these pipeline runs are included in the execution statistics display.

* Before this update, when you started many pipeline runs using {pac} at the same time and these pipelines runs included a `max-keep-run` annotation, the {pac} watcher component failed to process some of the pending pipeline runs and they remained in a pending state. With this update, {pac} pipeline runs are processed correctly.

[id="release-notes-1-14-3_{context}"]
== Release notes for {pipelines-title} General Availability 1.14.3

With this update, {pipelines-title} General Availability (GA) 1.14.3 is available on {OCP} 4.12 and later versions.

[id="fixed-issues-1-14-3_{context}"]
=== Fixed issues

* Before this update, when you started many pipeline runs using {pac} at the same time and these pipelines runs included a `max-keep-run` annotation, the {pac} watcher was unable to reconcile the pipeline runs because of a race condition between deletion of existing pipeline runs and processing new pipeline runs. Because of this issue, some pipeline runs could not be processed.  With this update, the {pac} watcher processes pipeline runs.

* Before this update, when you used the `tkn pr logs -f` command to view the logs for a running pipeline, the command line utility stopped responding, even if the pipeline run completed successfully. With  this update, the `tkn pr logs -f` command properly displays the log information and exits.

[id="release-notes-1-14-4_{context}"]
== Release notes for {pipelines-title} General Availability 1.14.4

With this update, {pipelines-title} General Availability (GA) 1.14.4 is available on {OCP} 4.12 and later versions.

[id="fixed-issues-1-14-4_{context}"]
=== Fixed issues

* Before this update, a large number of error messages referencing `tekton-pipelines-webhook.ConversionWebhook` could be logged. With this update, unneeded conversion webhook configuration for the `ClusterTask` and `StepAction` Custom Resource Definitions (CRDs) was removed, and such error messages are no longer logged.

* Before this update, some configuration settings using the `options` sections in the `TektonConfig` custom resource (CR) did not work, because a race condition would occur if the same setting was configured in both the `options` section and another field in the `TektonConfig` CR. With this update, the settings work.

* Before this update, the {pipelines-shortname} console plugin pod did not move to the node specified using the `nodeSelector`, `tolerations`, and `priorityClassName` settings. With this update, the {pipelines-shortname} plugin pod moves to the correct node.

* Before this update, some error messages were logged in the operator controller logs without the proper context information. With this update, error messages contain the required information.

* Before this update, if the `pipelines-scc-rolebinding` rolebinding was missing or deleted in any namespace, the {pipelines-shortname} operator controller would fail to create default resources in new namespaces correctly. With this update, the controller functions correctly.

* Before this update, if you configured the Horizontal Pod Autoscaler (HPA) using the `options` section in the `TektonConfig` CR, any existing HPA was updated correctly but a new HPA was not created when required. With this update, Horizontal Pod Autoscaler configuration using the `options` section works correctly.

* Before this update, if a user or an {pipelines-shortname} controller used the {pipelines-shortname} API to modify a pipeline run that was in the process of being started by {pac},  {pac} could stop and the log contained "panic" messages. With this update, the pipeline being started by {pac} can be modified concurrently.

* Before this update, in {pac}, a concurrency limit setting of `0` was not interpreted as disabling the concurrency limit. With this update, a concurrency limit setting of `0` disables the concurrency limit.
