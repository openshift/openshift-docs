// Module included in the following assemblies:
//
// * list assemblies

:_content-type: PROCEDURE
[id="logging-install-loki-operator-cli_{context}"]
= Installing the Loki Operator by using the OpenShift CLI

You can use the {oc-first} to install the Loki Operator on your {product-title} cluster.

.Prerequisites

* You have administrator permissions.
* You have installed the {oc-first}.
* You have access to an instance of a supported object store. For example, AWS S3, Google Cloud Storage, Azure, Swift, Minio, or OpenShift Data Foundation.

.Procedure

. Create a subscription for the Loki Operator:
+
[source,yaml]
----
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: loki-operator
  namespace: openshift-operators-redhat <1>
spec:
  charsion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: loki-operator
  namespace: openshift-operators-redhat <1>
spec:
  channel: stable <2>
  name: loki-operator
  source: redhat-operators <3>
  sourceNamespace: openshift-marketplace
----
<1> You must specify the `openshift-operators-redhat` namespace.
<2> Specify `stable`, or `stable-5.<y>` as the channel.
<3> Specify `redhat-operators`. If your {product-title} cluster is installed on a restricted network, also known as a disconnected cluster, specify the name of the `CatalogSource` object you created when you configured the Operator Lifecycle Manager (OLM).

. Apply the subscription:
+
[source,terminal]
----
$ oc apply -f <filename>.yaml
----

. Create a `LokiStack` object:
+
[source,yaml]
----
apiVersion: loki.grafana.com/v1
kind: LokiStack
metadata:
  name: logging-loki
  namespace: openshift-logging
spec:
  size: 1x.small # <1>
  storage:
    schemas:
    - version: v12
      effectiveDate: "2022-06-01"
    secret:
      name: logging-loki-s3 # <2>
      type: s3 # <3>
  storageClassName: <storage_class_name> # <4>
  tenants:
    mode: openshift-logging
----
<1> Supported size options for production instances of Loki are `1x.small` and `1x.medium`.
<2> Enter the name of your log store secret.
<3> Enter the type of your log store secret.
<4> Enter the name of an existing storage class for temporary storage. For best performance, specify a storage class that allocates block storage. Available storage classes for your cluster can be listed by entering the following command:
+
[source,terminal]
----
$ oc get storageclasses
----

. Apply the `LokiStack` object:
+
[source,terminal]
----
$ oc apply -f <filename>.yaml
----

.Verification

. List the pods in the *openshift-logging* project by running the following command:
+
[source,terminal]
----
$ oc get pods -n openshift-logging
----

. Observe that the `lokistack` pods exist in the output:
+
.Example output
[source,terminal]
----
NAME                                               READY   STATUS    RESTARTS   AGE
lokistack-sample-compactor-0                       1/1     Running   0          42m
lokistack-sample-distributor-7d7688bcb9-dvcj8      1/1     Running   0          42m
lokistack-sample-gateway-5f6c75f879-bl7k9          2/2     Running   0          42m
lokistack-sample-gateway-5f6c75f879-xhq98          2/2     Running   0          42m
lokistack-sample-index-gateway-0                   1/1     Running   0          42m
lokistack-sample-ingester-0                        1/1     Running   0          42m
lokistack-sample-querier-6b7b56bccc-2v9q4          1/1     Running   0          42m
lokistack-sample-query-frontend-84fb57c578-gq2f7   1/1     Running   0          42m
----
