:_mod-docs-content-type: Procedure
[id="ossm-installing-multi-primary-single-network-mesh_{context}"]
= Installing a multi-primary single-network mesh 
:context: ossm-installing-multi-primary-single-network-mesh

Install {istio} in the multi-primary single-network topology on two {ocp-product-title} clusters. 

[NOTE]
====
In this procedure, `CLUSTER1` is the East cluster and `CLUSTER2` is the West cluster. 
====

You can adapt these instructions for a mesh spanning more than two clusters.

.Prerequisites

* You have installed the {SMProduct} Operator on all of the clusters that comprise the mesh.

* You have completed "Creating certificates for a multi-cluster mesh". 

* You have completed "Applying certificates to a multi-cluster topology".

* You have created an {istio} Container Network Interface (CNI) resource.

* You have `istioctl` installed on the laptop you will use to run these instructions.

.Procedure

. Create an `ISTIO_VERSION` environment variable that defines the {istio} version to install by running the following command:
+
[source,terminal]
----
$ export ISTIO_VERSION=1.24.0 
----

. Install {istio} on the East cluster:

.. Create an `Istio` resource on the East cluster by running the following command:
+
[source,terminal]
----
$ cat <<EOF | oc --context "${CTX_CLUSTER1}" apply -f -
apiVersion: sailoperator.io/v1alpha1
kind: Istio
metadata:
  name: default
spec:
  version: v${ISTIO_VERSION}
  namespace: istio-system
  values:
    global:
      meshID: mesh1
      multiCluster:
        clusterName: cluster1
      network: network1
EOF
----

.. Wait for the control plane to return the "Ready" status condition by running the following command:
+
[source,terminal]
----
$ oc --context "${CTX_CLUSTER1}" wait --for condition=Ready istio/default --timeout=3m
----

. Install {istio} on the West cluster:

.. Create an `Istio` resource on the West cluster by running the following command:
+
[source,terminal]
----
$ cat <<EOF | oc --context "${CTX_CLUSTER2}" apply -f -
apiVersion: sailoperator.io/v1alpha1
kind: Istio
metadata:
  name: default
spec:
  version: v${ISTIO_VERSION}
  namespace: istio-system
  values:
    global:
      meshID: mesh1
      multiCluster:
        clusterName: cluster2
      network: network1
EOF
----

.. Wait for the control plane to return the "Ready" status condition by running the following command:
+
[source,terminal]
----
$ oc --context "${CTX_CLUSTER2}" wait --for condition=Ready istio/default --timeout=3m
----

. Install a remote secret on the East cluster that provides access to the API server on the West cluster by running the following command:
+
[source,terminal]
----
$ istioctl create-remote-secret \
  --context="${CTX_CLUSTER2}" \
  --name=cluster2 | \
  oc --context="${CTX_CLUSTER1}" apply -f -
----

. Install a remote secret on the West cluster that provides access to the API server on the East cluster by running the following command:
+
[source,terminal]
----
$ istioctl create-remote-secret \
  --context="${CTX_CLUSTER1}" \
  --name=cluster1 | \
  oc --context="${CTX_CLUSTER2}" apply -f -
----
