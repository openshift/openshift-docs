// Module is included in the following assemblies:
//
// * installing_gitops/installing-openshift-gitops.adoc
// * managing_cluster_configuration/managing-openshift-cluster-configuration.adoc

:_mod-docs-content-type: PROCEDURE
[id="installing-gitops-operator-using-cli_{context}"]
= Installing {gitops-title} Operator using CLI

[role="_abstract"]
You can install {gitops-title} Operator from the OperatorHub by using the CLI.

[NOTE]
====
For the {gitops-shortname} version 1.10 and later, the default namespace changed from `openshift-operators` to `openshift-gitops operator`.
====

.Prerequisite

* You have login credentials to access the {OCP} cluster with `cluster-admin` privileges.
* You have installed the link:https://docs.redhat.com/en/documentation/openshift_container_platform/latest/html/cli_tools/openshift-cli-oc[`oc` CLI].

.Procedure

. Create a `openshift-gitops-operator` namespace:
+
[source,terminal]
----
$ oc create ns openshift-gitops-operator
----
+
.Example output
[source,terminal]
----
namespace/openshift-gitops-operator created
----
+
[NOTE]
====
You can enable cluster monitoring on `openshift-gitops-operator`, or any namespace, by applying the `openshift.io/cluster-monitoring=true` label:

[source,terminal]
----
$ oc label namespace <namespace> openshift.io/cluster-monitoring=true
----

.Example output
[source,terminal]
----
namespace/<namespace> labeled
----
====

. Create a `OperatorGroup` object YAML file, for example, `gitops-operator-group.yaml`:
+
.Example OperatorGroup
[source,yaml]
----
apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: openshift-gitops-operator
  namespace: openshift-gitops-operator
spec:
  upgradeStrategy: Default
----

. Apply the `OperatorGroup` to the cluster:
+
[source,terminal]
----
$ oc apply -f gitops-operator-group.yaml
----
+
.Example output
[source,terminal]
----
operatorgroup.operators.coreos.com/openshift-gitops-operator created
----

. Create a `Subscription` object YAML file to subscribe a namespace to the {gitops-title} Operator, for example, `openshift-gitops-sub.yaml`:
+
.Example Subscription
[source,yaml]
----
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: openshift-gitops-operator
  namespace: openshift-gitops-operator
spec:
  channel: latest <1>
  installPlanApproval: Automatic
  name: openshift-gitops-operator <2>
  source: redhat-operators <3>
  sourceNamespace: openshift-marketplace <4> 
----
<1> Specify the channel name from where you want to subscribe the Operator.
<2> Specify the name of the Operator to subscribe to.
<3> Specify the name of the CatalogSource that provides the Operator.
<4> The namespace of the CatalogSource. Use `openshift-marketplace` for the default OperatorHub CatalogSources.

. Apply the `Subscription` to the cluster:
+
[source,terminal]
----
$ oc apply -f openshift-gitops-sub.yaml
----
+
.Example output
[source,terminal]
----
subscription.operators.coreos.com/openshift-gitops-operator created
----

. After the installation is complete, verify that all the pods in the `openshift-gitops` namespace are running:
+
[source,terminal]
----
$ oc get pods -n openshift-gitops
----
+
.Example output
[source,terminal]
----
NAME                                                      	  READY   STATUS    RESTARTS   AGE
cluster-785cfc5f75-669wq                                      1/1     Running   0          76s
gitops-plugin-6664c749dd-dx64s                                1/1     Running   0          76s
openshift-gitops-application-controller-0                     1/1     Running   0          74s
openshift-gitops-applicationset-controller-549d7f6686-wzckt   1/1     Running   0          74s
openshift-gitops-dex-server-5d4ffdb9b9-lb7b7                  1/1     Running   0          74s
openshift-gitops-redis-6d65c94d4b-k9l8k                       1/1     Running   0          75s
openshift-gitops-repo-server-79db854c58-279jr                 1/1     Running   0          75s
openshift-gitops-server-f488b848-xntbc                        1/1     Running   0          75s
----

. Verify that the pods in the `openshift-gitops-operator` namespace are running:
+
[source,terminal]
----
$ oc get pods -n openshift-gitops-operator
----
+
.Example output
[source,terminal]
----
NAME                                                            READY   STATUS    RESTARTS   AGE
openshift-gitops-operator-controller-manager-6fdc5cd9dc-jr9mn   2/2     Running   0          41s
----

