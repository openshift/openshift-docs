// Module included in the following assemblies:
//
// *scalability_and_performance/sno-du-deploying-clusters-on-single-nodes.adoc

:_content-type: PROCEDURE
[id="sno-du-configuring-sriov_{context}"]
= Configuring single root I/O virtualization (SR-IOV)

SR-IOV is commonly used to enable the fronthaul and the midhaul networks.

Procedure

* Use the following configuration to configure SRIOV on a single node distributed unit (DU) using an
Intel NIC. Note that the first custom resource (CR) is required. The following CRs are examples.
+
[source,yaml]
----
apiVersion: sriovnetwork.openshift.io/v1
kind: SriovOperatorConfig
metadata:
    name: default
    namespace: openshift-sriov-network-operator
spec:
    configDaemonNodeSelector:
        node-role.kubernetes.io/master: ""
    disableDrain: true
    enableInjector: true
    enableOperatorWebhook: true
---
apiVersion: sriovnetwork.openshift.io/v1
kind: SriovNetwork
metadata:
    name: sriov-nw-du-mh
    namespace: openshift-sriov-network-operator
spec:
    networkNamespace: openshift-sriov-network-operator
    resourceName: du_mh
    vlan: 150 <1>
---
apiVersion: sriovnetwork.openshift.io/v1
kind: SriovNetworkNodePolicy
metadata:
    name: sriov-nnp-du-mh
    namespace: openshift-sriov-network-operator
spec:
    deviceType: vfio-pci
    isRdma: false
    nicSelector:
        pfNames:
            - ens7f0 <2>
    nodeSelector:
        node-role.kubernetes.io/master: ""
    numVfs: 8 <3>
    priority: 10
    resourceName: du_mh
---
apiVersion: sriovnetwork.openshift.io/v1
kind: SriovNetwork
metadata:
    name: sriov-nw-du-fh
    namespace: openshift-sriov-network-operator
spec:
    networkNamespace: openshift-sriov-network-operator
    resourceName: du_fh
    vlan: 140 <4>
---
apiVersion: sriovnetwork.openshift.io/v1
kind: SriovNetworkNodePolicy
metadata:
    name: sriov-nnp-du-fh
    namespace: openshift-sriov-network-operator
spec:
    deviceType: netdevice
    isRdma: true
    nicSelector:
        pfNames:
            - ens5f0 <5>
    nodeSelector:
        node-role.kubernetes.io/master: ""
    numVfs: 8 <6>
    priority: 10
    resourceName: du_fh
----

<1> The VLAN for the midhaul network.
<2> The interface connected to the midhaul network.
<3> The number of VFs for the midhaul network.
<4> The VLAN for the fronthaul network.
<5> The interface connected to the fronthaul network.
<6> The number of VFs for the fronthaul network.
