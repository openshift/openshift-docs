// Module included in the following assemblies:
//
// * observability/otel/otel-forwarding-telemetry-data.adoc

:_mod-docs-content-type: CONCEPT
[id="otel-forwarding-data-to-google-managed-prometheus_{context}"]
= Forwarding telemetry data to Google Managed Prometheus

[role="_abstract"]
To forward metrics to the Google Managed Prometheus, use the OpenTelemetry Collector with the OTLP exporter, metricstarttime processor and googleclientauth extension.

.OpenTelemetry Collector custom resource with a configured File Storage Extension that persists an OTLP sending queue
[source,yaml]
----
# ...
  config:
    extensions:
      file_storage/all_settings:
        directory: /var/lib/otelcol/mydir # <1>
        timeout: 1s # <2>
        compaction:
          on_start: true # <3>
          directory: /tmp/ # <4>
          max_transaction_size: 65_536 # <5>
        fsync: false # <6>
    processors:
   transform/collision:
     metric_statements:
     - context: datapoint
       statements:
       - set(attributes["exported_location"], attributes["location"])
       - delete_key(attributes, "location")
       - set(attributes["exported_cluster"], attributes["cluster"])
       - delete_key(attributes, "cluster")
       - set(attributes["exported_namespace"], attributes["namespace"])
       - delete_key(attributes, "namespace")
       - set(attributes["exported_job"], attributes["job"])
       - delete_key(attributes, "job")
       - set(attributes["exported_instance"], attributes["instance"])
       - delete_key(attributes, "instance")
       - set(attributes["exported_project_id"], attributes["project_id"])
       - delete_key(attributes, "project_id")

    exporters:
      otlp:
        sending_queue:
          storage: file_storage/all_settings # <7>

    service:
      extensions: [file_storage/all_settings] # <8>
      pipelines:
        traces:
          receivers: [otlp]
          exporters: [otlp]
# ...
