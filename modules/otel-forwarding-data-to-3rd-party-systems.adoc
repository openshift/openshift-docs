//Module included in the following assemblies:
//
// * observability/otel/otel-forwarding-data.adoc

:_mod-docs-content-type: PROCEDURE
[id="otel-forwarding-data-to-3rd-party-systems_{context}"]
= Forwarding telemetry data to 3rd party systems

== OpenTelemetry protocol

The supported way to export telemetry data is via the OpenTelemetry Protocol (OTLP) and the OTLP exporter (TODO add link to the OTLP exporter).
There are two flavors of the OTLP protocol: gRPC and HTTP. Depending on the 3rd party system, use the one that is supported.

== Third party exporters

If the 3rd party system does not support OTLP or other supported protocol in the Red Hat build of OpenTelemetry, deploy a
custom collector which can receive telemetry data via OTLP and export it to the 3rd party system using a custom exporter.
This can be achieved by deploying a custom OpenTelemetry Collector via the operator hub (if the 3rd party system supports it) or by deploying a custom OpenTelemetry Collector manually.

The custom collector can be deployed manually by using a deployment, config map and a service.

.Example of a custom collector deployment. Note that custom deployment is not supported by Red Hat.
[source,yaml]
----
apiVersion: v1
kind: ConfigMap
metadata:
  name: custom-otel-collector-config
data:
  otel-collector-config.yaml: |
    receivers:
      otlp:
        protocols:
          grpc:
    exporters:
      debug: {}
      prometheus:
    service:
      pipelines:
        traces:
          receivers: [otlp]
          exporters: [debug] # <1>
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: custom-otel-collector-deployment
spec:
  replicas: 1
  selector:
    matchLabels:
      component: otel-collector
  template:
    metadata:
      labels:
        component: otel-collector
    spec:
      containers:
      - name: opentelemetry-collector
        image: ghcr.io/open-telemetry/opentelemetry-collector-releases/opentelemetry-collector-contrib:latest # <2>
        command:
        - "/otelcol-contrib"
        - "--config=/conf/otel-collector-config.yaml"
        ports:
        - name: otlp
          containerPort: 4317
          protocol: TCP
        volumeMounts:
        - name: otel-collector-config-vol
          mountPath: /conf
          readOnly: true
      volumes:
      - name: otel-collector-config-vol
        configMap:
          name: custom-otel-collector-config
---
apiVersion: v1
kind: Service
metadata:
  name: custom-otel-collector-service # <3>
  labels:
    component: otel-collector
spec:
  type: ClusterIP
  ports:
  - name: otlp-grpc
    port: 4317
    targetPort: 4317
  selector:
    component: otel-collector
----

<1> Replace `debug` with the required exporter for the 3rd party system.
<2> Replace the image with the required version of the OpenTelemetry Collector that has the required exporter for the 3rd party system.
<3> The service name is used in the Red Hat build of OpenTelemetry Collector CR to configure the OTLP exporter.