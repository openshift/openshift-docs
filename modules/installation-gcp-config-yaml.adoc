// Module included in the following assemblies:
//
// * installing/installing_gcp/installing-gcp-customizations.adoc
// * installing/installing_gcp/installing-gcp-network-customizations.adoc
// * installing/installing_gcp/installing-gcp-vpc.adoc
// * installing/installing_gcp/installing-gcp-private.adoc
// * installing/installing_gcp/installing-restricted-networks-gcp-installer-provisioned.adoc

ifeval::["{context}" == "installing-gcp-network-customizations"]
:with-networking:
endif::[]
ifeval::["{context}" != "installing-gcp-network-customizations"]
:without-networking:
endif::[]
ifeval::["{context}" == "installing-gcp-vpc"]
:vpc:
endif::[]
ifeval::["{context}" == "installing-gcp-private"]
:private:
:vpc:
endif::[]
ifeval::["{context}" == "installing-restricted-networks-gcp-installer-provisioned"]
:restricted:
endif::[]

:_mod-docs-content-type: REFERENCE
[id="installation-gcp-config-yaml_{context}"]
= Sample customized install-config.yaml file for {gcp-short}

You can customize the `install-config.yaml` file to specify more details about your {product-title} cluster's platform or modify the values of the required parameters.

[IMPORTANT]
====
This sample YAML file is provided for reference only. You must obtain your `install-config.yaml` file by using the installation program and modify it.
====

[source,yaml]
----
apiVersion: v1
baseDomain: <base_domain>
credentialsMode: <credentials_mode>
controlPlane:
  hyperthreading: <hyperthreading_setting>
  name: master
  platform:
    gcp:
      type: n2-standard-4
      zones:
      - us-central1-a
      - us-central1-c
      osDisk:
        diskType: pd-ssd
        diskSizeGB: 1024
        encryptionKey:
          kmsKey:
            name: worker-key
            keyRing: test-machine-keys
            location: global
            projectID: project-id
      tags:
      - control-plane-tag1
      - control-plane-tag2
      osImage:
        project: <os_image_project>
        name: <os_image_name>
  replicas: 3
compute:
- hyperthreading: <hyperthreading_setting>
  name: worker
  platform:
    gcp:
      type: n2-standard-4
      zones:
      - us-central1-a
      - us-central1-c
      osDisk:
        diskType: pd-standard
        diskSizeGB: 128
        encryptionKey:
          kmsKey:
            name: worker-key
            keyRing: test-machine-keys
            location: global
            projectID: project-id
        tags:
        - compute-tag1
        - compute-tag2
        osImage:
          project: <os_image_project>
          name: <os_image_name>
  replicas: 3
metadata:
  name: <cluster_name>
ifdef::without-networking[]
networking:
endif::[]
ifdef::with-networking[]
networking: <3>
endif::[]
  clusterNetwork:
  - cidr: 10.128.0.0/14
    hostPrefix: 23
  machineNetwork:
  - cidr: 10.0.0.0/16
  networkType: <network_type>
  serviceNetwork:
  - 172.30.0.0/16
platform:
  gcp:
    projectID: <project_id>
    region: <region>
    defaultMachinePlatform:
      tags:
      - global-tag1
      - global-tag2
      osImage:
        project: <os_image_project>
        name: <os_image_name>
ifdef::vpc,restricted[]
    network: <network>
    controlPlaneSubnet: <control_plane_subnet>
    computeSubnet: <compute_subnet>
endif::vpc,restricted[]
ifndef::restricted[]
pullSecret: <pull_secret>
endif::restricted[]
ifdef::restricted[]
pullSecret: <pull_secret>
endif::restricted[]
ifndef::vpc,restricted[]
ifndef::openshift-origin[]
fips: <fips_mode>
sshKey: <ssh_key>
endif::openshift-origin[]
ifdef::openshift-origin[]
sshKey: <ssh_key>
endif::openshift-origin[]
endif::vpc,restricted[]
ifdef::vpc[]
ifndef::openshift-origin[]
fips: <fips_mode>
sshKey: <ssh_key>
endif::openshift-origin[]
ifdef::openshift-origin[]
sshKey: <ssh_key>
endif::openshift-origin[]
endif::vpc[]
ifdef::restricted[]
ifndef::openshift-origin[]
fips: <fips_mode>
sshKey: <ssh_key>
endif::openshift-origin[]
ifdef::openshift-origin[]
sshKey: <ssh_key>
endif::openshift-origin[]
endif::restricted[]
ifdef::private[]
ifndef::openshift-origin[]
publish: <publish_mode>
endif::openshift-origin[]
ifdef::openshift-origin[]
publish: <publish_mode>
endif::openshift-origin[]
endif::private[]
ifdef::restricted[]
ifndef::openshift-origin[]
additionalTrustBundle: |
    -----BEGIN CERTIFICATE-----
    <MY_TRUSTED_CA_CERT>
    -----END CERTIFICATE-----
imageContentSources:
- mirrors:
  - <local_registry>/<local_repository_name>/release
  source: quay.io/openshift-release-dev/ocp-release
- mirrors:
  - <local_registry>/<local_repository_name>/release
  source: quay.io/openshift-release-dev/ocp-v4.0-art-dev
endif::openshift-origin[]
ifdef::openshift-origin[]
additionalTrustBundle: |
  -----BEGIN CERTIFICATE-----
  <MY_TRUSTED_CA_CERT>
  -----END CERTIFICATE-----
imageContentSources:
- mirrors:
  - <local_registry>/<local_repository_name>/release
  source: quay.io/openshift-release-dev/ocp-release
- mirrors:
  - <local_registry>/<local_repository_name>/release
  source: quay.io/openshift-release-dev/ocp-v4.0-art-dev
endif::openshift-origin[]
endif::restricted[]
----
where:

<base_domain>:: Specifies the base domain for the cluster. Required. The installation program prompts you for this value.
<cluster_name>:: Specifies the cluster name. Required. The installation program prompts you for this value.
<project_id>:: Specifies the GCP project ID. Required. The installation program prompts you for this value.
<region>:: Specifies the GCP region. Required. The installation program prompts you for this value.
<pull_secret>:: Specifies the pull secret. Required. The installation program prompts you for this value. For restricted networks, use the format: `'{"auths":{"<local_registry>": {"auth": "<credentials>","email": "you@example.com"}}}'`. For other installations, use: `'{"auths": ...}'`.
<credentials_mode>:: Optional: Specifies the credentials mode to force the Cloud Credential Operator (CCO) to use. By default, the CCO uses the root credentials in the `kube-system` namespace to dynamically try to determine the capabilities of the credentials. For details about CCO modes, see the "About the Cloud Credential Operator" section in the _Authentication and authorization_ guide. For example: `Mint`.
controlPlane, compute:: Specifies control plane and compute configuration. If you do not provide these parameters and values, the installation program provides the default value. The `controlPlane` section is a single mapping, but the `compute` section is a sequence of mappings. To meet the requirements of the different data structures, the first line of the `compute` section must begin with a hyphen, `-`, and the first line of the `controlPlane` section must not. Only one control plane pool is used.
<hyperthreading_setting>:: Specifies whether to enable or disable simultaneous multithreading, or `hyperthreading`. By default, simultaneous multithreading is enabled to increase the performance of your machines' cores. You can disable it by setting the parameter value to `Disabled`. If you disable simultaneous multithreading in some cluster machines, you must disable it in all cluster machines.
+
[IMPORTANT]
====
If you disable simultaneous multithreading, ensure that your capacity planning accounts for the dramatically decreased machine performance. Use larger machine types, such as `n1-standard-8`, for your machines if you disable simultaneous multithreading.
====
encryptionKey:: Optional: Specifies a custom encryption key to encrypt both virtual machines and persistent volumes. Your default compute service account must have the permissions granted to use your KMS key and have the correct IAM role assigned. The default service account name follows the `service-<project_number>@compute-system.iam.gserviceaccount.com` pattern. For more information about granting the correct permissions for your service account, see "Machine management" -> "Creating compute machine sets" -> "Creating a compute machine set on {gcp-short}".
tags:: Optional: Specifies a set of network tags to apply to the control plane or compute machine sets. The `platform.gcp.defaultMachinePlatform.tags` parameter will apply to both control plane and compute machines. If the `compute.platform.gcp.tags` or `controlPlane.platform.gcp.tags` parameters are set, they override the `platform.gcp.defaultMachinePlatform.tags` parameter.
<os_image_project>, <os_image_name>:: Optional: Specifies a custom {op-system-first} that should be used to boot control plane and compute machines. The `project` and `name` parameters under `platform.gcp.defaultMachinePlatform.osImage` apply to both control plane and compute machines. If the `project` and `name` parameters under `controlPlane.platform.gcp.osImage` or `compute.platform.gcp.osImage` are set, they override the `platform.gcp.defaultMachinePlatform.osImage` parameters.
<network_type>:: Specifies the cluster network plugin to install. The default value `OVNKubernetes` is the only supported value.
ifdef::vpc,restricted[]
<network>:: Specifies the name of an existing VPC.
<control_plane_subnet>:: Specifies the name of the existing subnet to deploy the control plane machines to. The subnet must belong to the VPC that you specified.
<compute_subnet>:: Specifies the name of the existing subnet to deploy the compute machines to. The subnet must belong to the VPC that you specified.
endif::vpc,restricted[]
ifdef::restricted[]
<local_registry>, <credentials>:: For `<local_registry>`, specify the registry domain name, and optionally the port, that your mirror registry uses to serve content. For example, `registry.example.com` or `registry.example.com:5000`. For `<credentials>`, specify the base64-encoded user name and password for your mirror registry.
endif::restricted[]
ifdef::vpc[]
ifndef::openshift-origin[]
<fips_mode>:: Specifies whether to enable or disable FIPS mode. By default, FIPS mode is not enabled. If FIPS mode is enabled, the {op-system-first} machines that {product-title} runs on bypass the default Kubernetes cryptography suite and use the cryptography modules that are provided with {op-system} instead.
+
--
[IMPORTANT]
====
To enable FIPS mode for your cluster, you must run the installation program from a {op-system-base-full} computer configured to operate in FIPS mode. For more information about configuring FIPS mode on RHEL, see link:https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/assembly_installing-the-system-in-fips-mode_security-hardening[Installing the system in FIPS mode].

When running {op-system-base-full} or {op-system-first} booted in FIPS mode, {product-title} core components use the {op-system-base} cryptographic libraries that have been submitted to NIST for FIPS 140-2/140-3 Validation on only the x86_64, ppc64le, and s390x architectures.
====
--
<ssh_key>:: Specifies the SSH key that you use to access the machines in your cluster. Optional.
endif::openshift-origin[]
ifdef::openshift-origin[]
<ssh_key>:: Specifies the SSH key that you use to access the machines in your cluster. Optional.
endif::openshift-origin[]
endif::vpc[]
ifdef::restricted[]
ifndef::openshift-origin[]
<fips_mode>:: Specifies whether to enable or disable FIPS mode. By default, FIPS mode is not enabled. If FIPS mode is enabled, the {op-system-first} machines that {product-title} runs on bypass the default Kubernetes cryptography suite and use the cryptography modules that are provided with {op-system} instead.
+
[IMPORTANT]
====
When running {op-system-base-full} or {op-system-first} booted in FIPS mode, {product-title} core components use the {op-system-base} cryptographic libraries that have been submitted to NIST for FIPS 140-2/140-3 Validation on only the x86_64, ppc64le, and s390x architectures.
====
<ssh_key>:: Specifies the SSH key that you use to access the machines in your cluster. Optional.
endif::openshift-origin[]
ifdef::openshift-origin[]
<ssh_key>:: Specifies the SSH key that you use to access the machines in your cluster. Optional.
endif::openshift-origin[]
endif::restricted[]
ifndef::vpc,restricted[]
ifndef::openshift-origin[]
<fips_mode>:: Specifies whether to enable or disable FIPS mode. By default, FIPS mode is not enabled. If FIPS mode is enabled, the {op-system-first} machines that {product-title} runs on bypass the default Kubernetes cryptography suite and use the cryptography modules that are provided with {op-system} instead.
+
[IMPORTANT]
====
When running {op-system-base-full} or {op-system-first} booted in FIPS mode, {product-title} core components use the {op-system-base} cryptographic libraries that have been submitted to NIST for FIPS 140-2/140-3 Validation on only the x86_64, ppc64le, and s390x architectures.
====
<ssh_key>:: Specifies the SSH key that you use to access the machines in your cluster. Optional.
endif::openshift-origin[]
ifdef::openshift-origin[]
<ssh_key>:: Specifies the SSH key that you use to access the machines in your cluster. Optional.
endif::openshift-origin[]
endif::vpc,restricted[]
+
[NOTE]
====
For production {product-title} clusters on which you want to perform installation debugging or disaster recovery, specify an SSH key that your `ssh-agent` process uses.
====
ifdef::private[]
ifndef::openshift-origin[]
<publish_mode>:: Specifies how to publish the user-facing endpoints of your cluster. Set `publish` to `Internal` to deploy a private cluster, which cannot be accessed from the internet. The default value is `External`.
endif::openshift-origin[]
ifdef::openshift-origin[]
<publish_mode>:: Specifies how to publish the user-facing endpoints of your cluster. Set `publish` to `Internal` to deploy a private cluster, which cannot be accessed from the internet. The default value is `External`.
endif::openshift-origin[]
endif::private[]
ifdef::restricted[]
ifndef::openshift-origin[]
additionalTrustBundle:: Specifies the contents of the certificate file that you used for your mirror registry.
imageContentSources:: Specifies the `imageContentSources` section from the output of the command to mirror the repository.
endif::openshift-origin[]
ifdef::openshift-origin[]
additionalTrustBundle:: Specifies the contents of the certificate file that you used for your mirror registry.
imageContentSources:: Specifies the `imageContentSources` section from the output of the command to mirror the repository.
endif::openshift-origin[]
endif::restricted[]

ifeval::["{context}" == "installing-gcp-network-customizations"]
:!with-networking:
endif::[]
ifeval::["{context}" != "installing-gcp-network-customizations"]
:!without-networking:
endif::[]
ifeval::["{context}" == "installing-gcp-vpc"]
:!vpc:
endif::[]
ifeval::["{context}" == "installing-gcp-private"]
:!private:
:!vpc:
endif::[]
ifeval::["{context}" == "installing-restricted-networks-gcp-installer-provisioned"]
:!restricted:
endif::[]
