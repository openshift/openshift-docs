// Module included in the following assemblies:
//
// * about/logging-release-notes.adoc

:_mod-docs-content-type: REFERENCE
[id="logging-release-notes-6-4-0_{context}"]
= Logging 6.4.0 release notes

This release of {LoggingProductName} is supported on {ocp-product-title} 4.18 and later. This release includes new features and bug fixes. 

This release includes link:https://access.redhat.com/errata/RHBA-2025:21335[RHBA-2025:21335].

[id="openshift-logging-release-notes-6-4-0-enhancements_{context}"]
== New features and enhancements

[id="log-collection_{context}"]
=== Log collection

* With this release, the Vector collector has been updated to be based on Vector version 0.47.0.
(https://issues.redhat.com/browse/LOG-7166[LOG-7166])


* With this release, the permissions required by the {CLO} have been reduced to only those required for deploying the log collector. Permissions for functions that are no longer supported by the operator have been removed. (https://issues.redhat.com/browse/LOG-7473[LOG-7473])

*  This release provides changes to log collector deployments to promote Technology Preview configuration options introduced in link:https://issues.redhat.com/browse/LOG-7196[LOG-7196] to General Availability.
The change enables caching of kube API server calls and introduces a `ClusterLogForwarder` field to tune collector rollout strategy.
Administrators managing clusters with large numbers of nodes can now modify the collector upgrade behavior so that the collector requests do not overwhelm the Kubernetes API server. You can control the behavior by setting `MaxUnavailable` field for collectors during upgrade.(https://issues.redhat.com/browse/LOG-7587[LOG-7587])

* With this release, an alert has been added to notify administrators of deprecated features that will be removed in future releases. As a result, you can make adjustments as needed. (link:https://issues.redhat.com/browse/LOG-7596[LOG-7596])

* With this release, you can forward logs to {aws-short} S3-compatible services using a new `s3` output type.
The output supports custom endpoints and multiple authentication methods.
It also provides flexible options for log organization that you can configure with dynamic key prefix templating, and tuning of log compression and batching. (link:https://issues.redhat.com/browse/LOG-7683[LOG-7683])

* With this release, cross-account log forwarding is available for both CloudWatch and S3 outputs using the AWS AssumeRole functionality.
This feature enables centralized logging by using a secure, two-step authentication process.
By doing so, it upholds the principle of least privilege and maintains strong security boundaries, promoting a clear separation of concerns in the target account.
(link:https://issues.redhat.com/browse/LOG-7687[LOG-7687])

* With this release, {clo} optionally provides permissive `NetworkPolicy` resources to override any restrictive network policies present in an {ocp-product-title} cluster.
For more information, see link:https://docs.redhat.com/en/documentation/red_hat_openshift_logging/6.4/html/configuring_logging/cluster-logging-collector#network_policies-to-override-restrictive-network-in-a-cluster_cluster-logging-collector[Network policies to override restrictive network in a cluster].

[id="log-storage_{context}"]
=== Log storage

* With this release, a new alert has been added to the LokiStack to inform users if LokiStack components have not reached the ready state. (link:https://issues.redhat.com/browse/LOG-5470[LOG-5470])

* With this release, the statistics page has been improved to help users better understand the performance of a query. (link:https://issues.redhat.com/browse/LOG-7746[LOG-7746])

* With this release, {loki-op} can deploy and manage a set of network policies that restrict the communications to and from the Loki components to enhance security.
For more information, see link:https://docs.redhat.com/en/documentation/red_hat_openshift_logging/6.4/html/configuring_logging/configuring-lokistack-storage#loki-network-policies-for-added-security_configuring-the-log-store[Loki network policies for added security].

[id="logging-release-notes-6-4-0-technology-preview-features_{context}"]
== Technology preview features

:FeatureName: The OpenTelemetry Protocol (OTLP) output log forwarder
include::snippets/technology-preview.adoc[]


[id="logging-release-notes-6-4-0-bug-fixes_{context}"]
== Bug fixes

* Before this update, the sample code for creating an `AlertingRule` resource in the web user interface did not contain all the description annotations.
With this update, the missing description annotation have been added. (link:https://issues.redhat.com/browse/LOG-6782[LOG-6782])

* Before this update, the {CLO} generated configuration that did not account for unmatched log events, and produced a warning message when the collector started.
With this update, unmatched log events are accounted for and an error alert is produced if unmatched messages are detected. The warning message has been removed. (link:https://issues.redhat.com/browse/LOG-6807[LOG-6807])

* Before this update, user action of generating an info-level log message containing the keyword `error` was incorrectly highlighted as errors in the {ocp-product-title} web console.
With this update, the web console no longer highlights info-level logs containing the `error` keyword as errors.
(link:https://issues.redhat.com//browse/LOG-7222[LOG-7222])

* Before this update, the `clusterLogForwarder` API did not validate the URL scheme for Kafka outputs.
This could cause users to configure a Kafka output with an invalid URL that was missing the required `tcp://` or `tls://` prefix, leading to a silent failure where logs were not forwarded as expected.
With this update, new validation has been added to the API.
The clusterLogForwarder now rejects configurations with a Kafka URL that does not have a tcp or tls scheme, preventing the misconfiguration and ensuring logs can be forwarded successfully. (link:https://issues.redhat.com/browse/LOG-7340[LOG-7340])

* Before this update, the `vector_buffer_byte_size` and `vector_buffer_events` metrics incorrectly reported negative values under certain system load and timing conditions.
This led to unreliable monitoring, potentially masking buffer issues.
With this update, a concurrent, centralized state tracker ensures that these metrics are always reported as non-negative values.
This ensures that the metrics correctly report buffer sizes helping with accurate monitoring. (link:https://issues.redhat.com/browse/LOG-7436[LOG-7436])

* Before this fix, Vector could not recover from silently closed TCP connections.
With this update, Vector uses `keepalive` probes to detect and automatically re-establish unresponsive TCP connections. (link:https://issues.redhat.com/browse/LOG-7502[LOG-7502])

* Before this update, the `ClusterLogForwarder` API required the URL for OTLP endpoints to terminate with `v1/logs`. With this update, this requirement has been relaxed to allow any URL that specifies an `http` or `https` protocol. (link:https://issues.redhat.com/browse/LOG-7582[LOG-7582])

*  Before this update, any request that exceeded a Kafka broker's `message.max.size` value would be rejected because the collector's tuning did not correctly set an allowable producer configuration.
With this update, you can set the collector's kafka client configuration to allow message sizes that are equal to or smaller than the `MaxSize` value. (link:https://issues.redhat.com/browse/LOG-7608[LOG-7608])

* Before this update, the prune filter failed to remove the `.openshift.sequence` field from the log record. With this update, the field is correctly pruned from the log record. (link:https://issues.redhat.com/browse/LOG-7620[LOG-7620])

* Before this update, the prune filter failed to remove the `.kubernetes.container_iostream` field from the log record. With this fix, the field is now correctly pruned from the log record. (link:https://issues.redhat.com/browse/LOG-7622[LOG-7622])


[id="logging-release-notes-6-4-0-deprecation-notice_{context}"]
== Deprecation notice

In this release, the 'observability.openshift.io/max-unavailable-rollout' annotation is deprecated and will be removed in a future release.
The annotation has been replaced by the `spec.collector.maxUnavailable` field in the `ClusterLogForwarder` resource.
For more information, see link:https://docs.redhat.com/en/documentation/red_hat_openshift_logging/6.4/html/configuring_logging/cluster-logging-collector#configuring-pod-rollout-strategy_cluster-logging-collector[Configuring pod rollout strategy].


[id="logging-release-notes-6-4-0-removal-notice_{context}"]
== Removal notice

In this release, the `observability.openshift.io/use-apiserver-cache` annotation has been removed.
With this release, kube-api caching is now always enabled.
For more information, see link:https://docs.redhat.com/en/documentation/red_hat_openshift_logging/6.4/html/configuring_logging/cluster-logging-collector#configuring-pod-rollout-strategy_cluster-logging-collector[Configuring pod rollout strategy].


[id="logging-release-notes-6-4-0-known-issues_{context}"]
== Known issues

* When network policies are enabled in {loki-op} and a S3-compatible object storage, for example Minio or {odf-first}, is used, the network policies do not allow access to the object storage.
(link:https://issues.redhat.com/browse/LOG-8075[LOG-8075])

* When network policies are enabled in {loki-op} and Swift is used as an object storage, the network policies do not allow access to the object storage.
(link:https://issues.redhat.com/browse/LOG-8083[LOG-8083])

* When network policies are enabled in {loki-op} and a cluster-wide proxy is configured, the network policies do not allow access to object storage.
(link:https://issues.redhat.com/browse/LOG-8084[LOG-8084])

* When network policies are enabled in {CLO} and the Loki output is used without specifying a port in the `url` field, the egress network policy is created with the wrong port number.
(link:https://issues.redhat.com/browse/LOG-8091[LOG-8091])

* When network policies are enabled in {CLO} and an HTTP output is used together with an HTTP proxy, the egress network policy does not allow access to the HTTP proxy.
(link:https://issues.redhat.com/browse/LOG-8109[LOG-8109])
