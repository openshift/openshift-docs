// Module included in the following assembly:
//
// * cicd/pipelines/op-release-notes.adoc
:_content-type: REFERENCE
[id="op-release-notes-1-9_{context}"]
= Release notes for {pipelines-title} General Availability 1.9

With this update, {pipelines-title} General Availability (GA) 1.9 is available on {product-title} 4.11 and later versions.

[id="new-features-1-9_{context}"]
== New features

In addition to the fixes and stability improvements, the following sections highlight what is new in {pipelines-title} 1.9.

[id="pipelines-new-features-1-9_{context}"]
=== Pipelines

* With this update, you can specify pipeline parameters and results in arrays and object dictionary forms.

* This update provides support for Container Storage Interface (CSI) and projected volumes for your workspace.

* With this update, you can specify the `stdoutConfig` and `stderrConfig` parameters when defining pipeline steps. Defining these parameters helps to capture standard output and standard error, associated with steps, to local files.

* With this update, you can add variables in the `steps[].onError` event handler, for example, `$(params.CONTINUE)`.

* With this update, you can use the output from the `finally` task in the `PipelineResults` definition. For example, `$(finally.<pipelinetask-name>.result.<result-name>)`, where `<pipelinetask-name>` denotes the pipeline task name and `<result-name>` denotes the result name.

* This update supports task-level resource requirements for a task run.

* With this update, you do not need to recreate parameters that are shared, based on their names, between a pipeline and the defined tasks. This update is part of a developer preview feature.

* This update adds support for remote resolution, such as built-in git, cluster, bundle, and hub resolvers.


[id="triggers-new-features-1-9_{context}"]
=== Triggers

* This update adds the `Interceptor` CRD to define `NamespacedInterceptor`. You can use `NamespacedInterceptor` in the `kind` section of interceptors reference in triggers or in the `EventListener` specification.

* This update enables `CloudEvents`.

* With this update, you can configure the webhook port number when defining a trigger.

* This update supports using trigger `eventID` as input to `TriggerBinding`.

* This update supports validation and rotation of certificates for the `ClusterInterceptor` server. 
** Triggers perform certificate validation for core interceptors and rotate a new certificate to `ClusterInterceptor` when its certificate expires. 


[id="cli-new-features-1-9_{context}"]
=== CLI 

* This update supports showing annotations in the `describe` command.

* This update supports showing pipeline, tasks, and timeout in the `pr describe` command.

* This update adds flags to provide pipeline, tasks, and timeout in the `pipeline start` command.

* This update supports showing the presence of workspace, optional or mandatory, in the `describe` command of a task and pipeline.

* This update adds the `timestamps` flag to show logs with a timestamp.

* This update adds a new flag `--ignore-running-pipelinerun`, which ignores the deletion of `TaskRun` associated with `PipelineRun`.

* This update adds support for experimental commands. This update also adds experimental subcommands, `sign` and `verify` to the `tkn` CLI tool. 

* This update makes the Z shell (Zsh) completion feature usable without generating any files.

* This update introduces a new CLI tool called `opc`. It is anticipated that an upcoming release will replace the `tkn` CLI tool with `opc`.
+
[IMPORTANT]
====
* The new CLI tool `opc` is a Technology Preview feature.
* `opc` will be a replacement for `tkn` with additional {pipelines-title} specific features, which do not necessarily fit in `tkn`.
====

[id="operator-new-features-1-9_{context}"]
=== Operator

* With this update, you can install {pac} as a separate component, not as a part of `TektonAddon`. You can configure {pac} in the `TektonConfig` CRD.

* With this update, you can also modify {pac} configurations in the `TektonConfig` CRD.

* With this update, if you disable the developer perspective, the Operator does not install developer console related custom resources.

* This update includes `ClusterTriggerBinding` support for Bitbucket Server and Bitbucket Cloud and helps you to reuse a `TriggerBinding` across your entire cluster.

[id="resolver-new-features-1-9_{context}"]
=== Resolvers

:FeatureName: Resolvers
include::snippets/technology-preview.adoc[]

* With this update, you can configure pipeline resolvers in the `TektonConfig` CRD. You can enable or disable these pipeline resolvers:  `enable-bundles-resolver`, `enable-cluster-resolver`, `enable-git-resolver`, and `enable-hub-resolver`.
+
[source,yaml,subs="attributes+"]
----
apiVersion: operator.tekton.dev/v1alpha1
kind: TektonConfig
metadata:
  name: config
spec:
  pipeline: 
    enable-bundles-resolver: true
    enable-cluster-resolver: true
    enable-git-resolver: true
    enable-hub-resolver: true
...
----
+
You can also provide resolver specific configurations in `TektonConfig`. For example, you can define the following fields in the `map[string]string` format to set configurations for individual resolvers:
+ 
[source,yaml,subs="attributes+"]
----
apiVersion: operator.tekton.dev/v1alpha1
kind: TektonConfig
metadata:
  name: config
spec:
  pipeline: 
    bundles-resolver-config:
      default-service-account: pipelines
    cluster-resolver-config:
      default-namespace: test
    git-resolver-config:
      server-url: localhost.com
    hub-resolver-config: 
      default-tekton-hub-catalog: tekton
...
----


[id="chains-new-features-1-9_{context}"]
=== {tekton-chains}

:FeatureName: Tekton Chains
include::snippets/technology-preview.adoc[]

* Before this update, only Open Container Initiative (OCI) images were supported as outputs of `TaskRun` in the in-toto provenance agent. This update adds in-toto provenance metadata as outputs with these suffixes, `ARTIFACT_URI` and `ARTIFACT_DIGEST`.

* Before this update, only `TaskRun` attestations were supported. This update adds support for `PipelineRun` attestations as well. 

* This update adds support for {tekton-chains} to get the `imgPullSecret` parameter from the pod template. This update helps you to configure repository authentication based on each pipeline run or task run without modifying the service account.

[id="tekton-hub-new-features-1-9_{context}"]
=== {tekton-hub}

:FeatureName: {tekton-hub}
include::snippets/technology-preview.adoc[]

* With this update, as an administrator, you can use an external database, such as Crunchy PostgreSQL with {tekton-hub}, instead of using the default {tekton-hub} database. This update helps you to perform the following actions:
** Specify the coordinates of an external database to be used with {tekton-hub}
** Disable the default {tekton-hub} database deployed by the Operator

* This update removes the dependency of `config.yaml` from external Git repositories and moves the complete configuration data into the API `ConfigMap`. This update helps an administrator to perform the following actions:
** Add the configuration data, such as categories, catalogs, scopes, and defaultScopes in the {tekton-hub} custom resource.
** Modify {tekton-hub} configuration data on the cluster. All modifications are preserved upon Operator upgrades.
** Update the list of catalogs for {tekton-hub}
** Change the categories for {tekton-hub}
+ 
[NOTE]
====
If you do not add any configuration data, you can use the default data in the API `ConfigMap` for {tekton-hub} configurations.
====

[id="pac-new-features-1-9_{context}"]
=== {pac}

* This update adds support for concurrency limit in the `Repository` CRD to define the maximum number of `PipelineRuns` running for a repository at a time. The `PipelineRuns` from a pull request or a push event are queued in alphabetical order.

* This update adds a new command `tkn pac logs` for showing the logs of the latest pipeline run for a repository.

* This update supports advanced event matching on file path for push and pull requests to GitHub and GitLab. For example, you can use the Common Expression Language (CEL) to run a pipeline only if a path has changed for any markdown file in the `docs` directory. 
+
[source,yaml]
----
  ...
  annotations:
     pipelinesascode.tekton.dev/on-cel-expression: |
      event == "pull_request" && "docs/*.md".pathChanged()
----

* With this update, you can reference a remote pipeline in the `pipelineRef:` object using annotations.

* With this update, you can auto-configure new GitHub repositories with {pac}, which sets up a namespace and creates a `Repository` CRD for your GitHub repository.

* With this update, {pac} generates metrics for `PipelineRuns` with provider information.

* This update provides the following enhancements for the `tkn-pac` plugin:
** Detects running pipelines correctly 
** Fixes showing duration when there is no failure completion time
** Shows an error snippet and highlights the error regular expression pattern in the `tkn-pac describe` command
** Adds the `use-real-time` switch to the `tkn-pac ls` and `tkn-pac describe` commands
** Imports the `tkn-pac` logs documentation
** Shows `pipelineruntimeout` as a failure in the `tkn-pac ls` and `tkn-pac describe` commands.
** Show a specific pipeline run failure with the `--target-pipelinerun` option.
      
* With this update, you can view the errors for your pipeline run in the form of a version control system (VCS) comment or a small snippet in the GitHub checks. 

* With this update, {pac} optionally can detect errors inside the tasks if they are of a simple format and add those tasks as annotations in GitHub. This update is part of a developer preview feature.

* This update adds the following new commands:
** `tkn-pac webhook add`: Adds a webhook to project repository settings and updates the `webhook.secret` key in the existing `k8s Secret` object without updating the repository. 
** `tkn-pac webhook update-token`: Updates provider token for an existing `k8s Secret` object without updating the repository.

* This update enhances functionality of the `tkn-pac create repo` command, which creates and configures webhooks for GitHub, GitLab, and BitbucketCloud along with creating repositories. 

* With this update, the `tkn-pac describe` command shows the latest fifty events in a sorted order.

* This update adds the `--last` option to the `tkn-pac logs` command.

* With this update, the `tkn-pac resolve` command prompts for a token on detecting a `git_auth_secret` in the file template.

* With this update, {pac} hides secrets from log snippets to avoid exposing secrets in the GitHub interface.

* With this update, the secrets automatically generated for `git_auth_secret` are an owner reference with `PipelineRun`. The secrets get cleaned with the `PipelineRun`, not after the pipeline run execution. 

* This update adds support to cancel a pipeline run with the `/cancel` comment.

* Before this update, the GitHub apps token scoping was not defined and tokens would be used on every repository installation. With this update, you can scope the GitHub apps token to the target repository using the following parameters:
** `secret-github-app-token-scoped`: Scopes the app token to the target repository, not to every repository the app installation has access to.
** `secret-github-app-scope-extra-repos`: Customizes the scoping of the  app token with an additional owner or repository.

* With this update, you can use {pac} with your own Git repositories that are hosted on GitLab. 
 
* With this update, you can access pipeline execution details in the form of kubernetes events in your namespace. These details help you to troubleshoot pipeline errors without needing access to admin namespaces.

* This update supports authentication of URLs in the {pac} resolver with the Git provider. 

* With this update, you can set the name of the hub catalog by using a setting in the `pipelines-as-code` config map.

* With this update, you can set the maximum and default limits for the `max-keep-run` parameter. 

* This update adds documents on how to inject custom Secure Sockets Layer (SSL) certificates in {pac} to let you connect to provider instance with custom certificates.

* With this update, the `PipelineRun` resource definition has the log URL included as an annotation. For example, the `tkn-pac describe` command shows the log link when describing a `PipelineRun`.

* With this update, `tkn-pac` logs show repository name, instead of `PipelineRun` name.
