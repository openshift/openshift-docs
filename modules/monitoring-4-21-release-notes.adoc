// Module included in the following assembly:
//
// * release-notes/monitoring-release-notes.adoc

:_mod-docs-content-type: REFERENCE
[id="monitoring-4-21-release-notes_{context}"]
= {ocp} {product-version} monitoring release notes

[role="_abstract"]
Changes for {ocp} {product-version} monitoring stack, including new features and enhancements, Technology Previews, deprecated and removed features, known issues, and fixed issues.

The changes are included in the following errata advisory:

* link:<link>[RHSA-year:00000]

[id="monitoring-4-21-updates-to-monitoring-components-and-dependencies_{context}"]
== Updates to monitoring stack components and dependencies

This release includes the following version updates for monitoring stack components and dependencies:

* Alertmanager to 0.29.0
* Prometheus to 3.7.3
* Prometheus Operator to 0.87.1
* kube-state-metrics agent to 2.17.0
* node-exporter agent to 1.10.2
* prom-label-proxy to 0.12.1

// [id="monitoring-4-21-changes-alerting-rules_{context}"]
// == Changes to alerting rules

// [NOTE]
// ====
// Red{nbsp}Hat does not guarantee backward compatibility for recording rules or alerting rules.
// ====

// * <text>

[id="monitoring-4-21-new-features-and-enhancements_{context}"]
== New features and enhancements

The monitoring stack for this release includes the following new features and enhancements:

Thanos Ruler now uses user-workload Prometheus retention by default::
With this release, if you set retention for user-workload Prometheus, Thanos Ruler automatically inherits the same retention time, unless explicitly configured otherwise. This ensures consistent metric querying across both systems.

// [id="monitoring-4-21-technology-preview-features_{context}"]
// == Technology Preview features

// [IMPORTANT]
// ====
// [subs="attributes+"]
// Technology Preview features are not supported with Red{nbsp}Hat production service level agreements (SLAs) and might not be functionally complete. Red{nbsp}Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.

// For more information about the support scope of Red{nbsp}Hat Technology Preview features, see link:https://access.redhat.com/support/offerings/techpreview/[Technology Preview Features Support Scope].
// ====

// The following table tracks features that are in Technology Preview or were Technology Preview in recent releases. Features are marked with the following statuses:

// * _Not Available_
// * _Technology Preview_
// * _General Availability_

// .Monitoring Technology Preview tracker
// [cols="4,1,1,1",options="header"]
// |====
// |Feature |4.19 |4.20 |4.21

// |<feature>
// |Technology Preview
// |Technology Preview
// |General Availability

// |====

// The monitoring stack for this release includes the following Technology Preview features:

// <Feature> (Technology Preview)::
// <Release note text>. (can be written as a new feature template)
// For more information, see <link_to_product_docs>.
// +
// link:https://issues.redhat.com/browse/MON-xxxx[MON-xxxx]

// [id="monitoring-4-21-deprecated-features_{context}"]
// == Deprecated features

// The following features in the monitoring stack are deprecated in this release:

// <feature> is deprecated::
// The <feature>, which <purpose>, is deprecated and might be removed in a future major release. You can <purpose> by using <alternative> instead.
// +
// link:https://issues.redhat.com/browse/MON-xxxx[MON-xxxx]

// [id="monitoring-4-21-removed-features_{context}"]
// == Removed features

// The following features in the monitoring stack are removed in this release:

// <feature> is removed::
// The <feature>, which <purpose>, is removed and is no longer supported. You can <purpose> by using <alternative> instead.
// +
// link:https://issues.redhat.com/browse/MON-xxxx[MON-xxxx]

// [id="monitoring-4-21-deprecated-and-removed-tracker_{context}"]
// == Deprecated and removed feature tracker

// The following table tracks features that are deprecated or removed in recent releases. Features are marked with the following statuses:

// * _General Availability_
// * _Deprecated_
// * _Removed_

// .Monitoring deprecated and removed feature tracker
// [cols="4,1,1,1",options="header"]
// |====
// |Feature |4.19 |4.20 |4.21

// |<feature>
// |General Availability
// |General Availability
// |Deprecated

// |====

// [id="monitoring-4-21-known-issues_{context}"]
// == Known issues

// The monitoring stack for this release includes the following known issues:

// Heading that summarizes the known issue::
// <Cause>. As a consequence, <consequence>.
// +
// To work around this problem, <workaround in imperative>. As a result, <result>.
// +
// link:https://issues.redhat.com/browse/MON-xxxx[MON-xxxx]

[id="monitoring-4-21-fixed-issues_{context}"]
== Fixed issues

The monitoring stack for this release includes the following fixed issues:

False alerts and failed DNS queries when local Alertmanager is disabled::
Before this update, after disabling local Alertmanager, Prometheus retained Alertmanager configuration references, which resulted in failed DNS queries and false alerts. With this release, the {cmo-full} removes Alertmanager endpoints from Prometheus when Alertmanager is disabled, preventing false alerts, and failed DNS queries.
+
link:https://issues.redhat.com/browse/OCPBUGS-62160[OCPBUGS-62160]

InfiniBand metrics collection errors resolved::
Before this update, certain InfiniBand hardware configurations could trigger invalid responses that disrupted the metrics collection process, leading to no Infiniband metrics being generated. With this release, node-exporter properly handles these hardware-level reporting errors, ensuring continuous monitoring and data availability.
+
link:https://issues.redhat.com/browse/OCPBUGS-62727[OCPBUGS-62727]