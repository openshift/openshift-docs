// Module included in the following assemblies:
//
// * networking/changing-cluster-network-mtu.adoc

:_mod-docs-content-type: PROCEDURE
[id="nw-cluster-mtu-creating-mc-objects_{context}"]
= Creating MachineConfig objects

Use the following procedure to create the `MachineConfig` objects.

.Procedure

. Create two `MachineConfig` objects, one for the control plane nodes and another for the worker nodes in your cluster:

.. Create the following Butane config in the `control-plane-interface.bu` file:
+
[NOTE]
====
include::snippets/butane-version.adoc[]
====
+
[source,yaml, subs="attributes+"]
----
variant: openshift
version: {product-version}.0
metadata:
  name: 01-control-plane-interface
  labels:
    machineconfiguration.openshift.io/role: master
storage:
  files:
    - path: /etc/NetworkManager/conf.d/99-<interface>-mtu.conf <1>
      contents:
        local: <interface>-mtu.conf <2>
      mode: 0600
----
<1> Specifies the `NetworkManager` connection name for the primary network interface.
<2> Specifies the local filename for the updated `NetworkManager` configuration file from an earlier step.

.. Create the following Butane config in the `worker-interface.bu` file:
+
[NOTE]
====
include::snippets/butane-version.adoc[]
====
+
[source,yaml, subs="attributes+"]
----
variant: openshift
version: {product-version}.0
metadata:
  name: 01-worker-interface
  labels:
    machineconfiguration.openshift.io/role: worker
storage:
  files:
    - path: /etc/NetworkManager/conf.d/99-<interface>-mtu.conf <1>
      contents:
        local: <interface>-mtu.conf <2>
      mode: 0600
----
<1> Specifies the `NetworkManager` connection name for the primary network interface.
<2> Specifies the local filename for the updated `NetworkManager` configuration file from an earlier step.

. Create `MachineConfig` objects from the Butane configs by running the following command:
+
[source,terminal]
----
$ for manifest in control-plane-interface worker-interface; do
    butane --files-dir . $manifest.bu > $manifest.yaml
  done
----
+
[WARNING]
====
Do not apply these machine configs until explicitly instructed later in this procedure. Applying these machine configs now causes a loss of stability for the cluster.
====