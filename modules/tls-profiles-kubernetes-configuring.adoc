// Module included in the following assemblies:
//
// * security/tls-profiles.adoc

[id="tls-profiles-kubernetes-configuring_{context}"]
= Configuring the TLS security profile for the Kubernetes control plane

By default, the Kubernetes control plane uses the `Intermediate` TLS security profile. You can configure the control plane to use a different TLS security profile.

.Prerequisites

* You have access to the cluster as a user with the `cluster-admin` role.

.Procedure

. Edit the default `APIServer` custom resource (CR) to configure the TLS security profile:
+
.Sample `tls-security-profile.yaml` file
[source,yaml]
----
apiVersion: config.openshift.io/v1
kind: APIServer
metadata:
  name: cluster
spec:
  tlsSecurityProfile:
    custom: <1>
      ciphers:
      - ECDHE-ECDSA-CHACHA20-POLY1305
      - ECDHE-RSA-CHACHA20-POLY1305
      - ECDHE-RSA-AES128-GCM-SHA256
      - ECDHE-ECDSA-AES128-GCM-SHA256
      minTLSVersion: VersionTLS11
    type: Custom
----
<1> Specify `old: {}`, `intermediate: {}`, or `custom`. The `Custom` profile requires you to provide additional settings.
<2> Specify the TLS security profile type. The default is `Intermediate`.
* `Old`
* `Intermediate`
* `Custom`

. Apply the TLS security profile setting:
+
[source,terminal]
----
$ oc apply -f tls-security-profile.yaml
----

.Verification

* Verify that the TLS security profile is set on the `APIServer` CR:
+
[source,terminal]
----
$ oc describe apiserver cluster
----
+
.Sample `APIServer` CR
[source,yaml]
----
Name:         cluster
Namespace:
Labels:       <none>
Annotations:  include.release.openshift.io/ibm-cloud-managed: true
              include.release.openshift.io/self-managed-high-availability: true
              include.release.openshift.io/single-node-developer: true
              oauth-apiserver.openshift.io/secure-token-storage: true
              release.openshift.io/create-only: true
API Version:  config.openshift.io/v1
Kind:         APIServer
 ...
Spec:
  Audit:
    Profile:  Default
  Tls Security Profile:
    Custom:
      Ciphers:
        ECDHE-ECDSA-CHACHA20-POLY1305
        ECDHE-RSA-CHACHA20-POLY1305
        ECDHE-RSA-AES128-GCM-SHA256
        ECDHE-ECDSA-AES128-GCM-SHA256
      Min TLS Version:  VersionTLS11
    Type:               Custom
----
