// Module included in the following assemblies:
//
//* microshift_running_apps/microshift_operators/microshift-operators-oc-mirror.adoc

:_mod-docs-content-type: PROCEDURE
[id="microshift-oc-mirror-creating-imageset-config_{context}"]
= Creating an image set configuration file

You must create an `ImageSetConfiguration` YAML file. This image set configuration file specifies both the Operators to mirror and the configuration settings for the oc-mirror plugin. Edit the contents of the image set configuration file so that the entries are compatible with both {microshift-short} and the Operator you plan to use.

[NOTE]
====
oc mirror v2 uses a cache system instead of metadata. The cache system prevents the need to start the entire mirroring process over when a single step fails. Instead, you can troubleshoot the failed step and the process does not re-mirror images that existed before the failure.
====

.Prerequisites

* You created a container image registry credentials file. For more information, see the following reference:

** link:https://docs.redhat.com/en/documentation/openshift_container_platform/4.19/html/disconnected_environments/mirroring-in-disconnected-environments#installation-adding-registry-pull-secret_installing-mirroring-disconnected[Configuring credentials that allow images to be mirrored]

.Procedure

. Create and edit the `ImageSetConfiguration` YAML for {microshift-short} by using the following example as a guide:
+
.Example edited {microshift-short} image set configuration file
[source,yaml,subs="attributes+"]
----
kind: ImageSetConfiguration
apiVersion: mirror.openshift.io/v2alpha1
mirror:
  operators:
  - catalog: registry.redhat.io/redhat/redhat-operator-index:v{ocp-version} <1>
    packages:
    - name: amq-broker-rhel9 <2>
      channels:
      - name: 7.13.x <3>
  additionalImages: <4>
   - name: quay.io/rh_ee_aguidi/multi-platform-container:latest
   - name: quay.io/rh_ee_aguidi/empty-image:latest
----
<1> Set the Operator catalog to retrieve images from.
<2> Specify the Operator packages to include in the image set. Remove this field to retrieve all packages in the catalog.
<3> Specify only certain channels of the Operator packages to include in the image set. You must always include the default channel for the Operator package even if you do not use the bundles in that channel. You can find the default channel by running the following command: `oc mirror list operators --catalog=<catalog_name> --package=<package_name>`.
<4> Specify any additional images to include in the image set. If you do not need to specify additional images, delete this field.
+
--
[IMPORTANT]
====
The `platform` field, related fields, and Helm are not supported by {microshift-short}.
====
--

. Save the updated file as `ImageSetConfiguration.yaml`.

.Next steps
* Use the oc-mirror plugin to mirror an image set directly to a target mirror registry.
* Configure CRI-O.
* Apply the catalog sources to your clusters.
