// Module included in the following assembly:
//
// * release_notes/gitops-release-notes.adoc

:_content-type: REFERENCE
[id="gitops-release-notes-1-10-0_{context}"]
= Release notes for {gitops-title} 1.10.0

{gitops-title} 1.10.0 is now available on {OCP} 4.12, 4.13 and 4.14.

[id="errata-updates-1-10.0_{context}"]
== Errata updates

[id="gitops-1-10-0-security-update-advisory_{context}"]
=== RHSA-2023:5407 and RHEA-2023:5408 - {gitops-title} 1.10.0 security update advisory

Issued: 2023-09-29

The list of security fixes and enhancements that are included in this release is documented in the following advisories:

* link:https://access.redhat.com/errata/RHSA-2023:5407[RHSA-2023:5407]
* link:https://access.redhat.com/errata/RHEA-2023:5408[RHEA-2023:5408]

If you have installed the {gitops-title} Operator in the default namespace, run the following command to view the container images in this release:

[source,terminal]
----
$ oc describe deployment gitops-operator-controller-manager -n openshift-gitops-operator
----

[id="new-features-1-10-0_{context}"]
== New features

The current release adds the following improvements:

* With this update, the Argo CD CRD API version is upgraded from `v1alpha1` to `v1beta1` to accomodate the breaking changes resulting from the deprecation of `.spec.dex` and certain `.spec.sso` fields. To streamline the automatic migration of existing `v1alpha1` Argo CD CRs to `v1beta1`, conversion webhook support is implemented. link:https://issues.redhat.com/browse/GITOPS-3040[GITOPS-3040]
+
[NOTE]
====
By default, the conversion webhook is enabled only for OLM-installed Operators. For non-OLM installations of the Operator, enabling the webhook is optional. However, without conversion webhook support, you have to manually migrate any existing Argo CD `v1alpha1` CRs to `v1beta1`.
====

* With this update, the {gitops-title} Operator deploys three monitoring dashboards in the Administrator perspective of the web console. The three dashboards are *GitOps Overview*, *GitOps Components*, and *GitOps gRPC*. To access these dashboards, go to *Observe* â†’ *Monitoring*. link:https:https://issues.redhat.com/browse/GITOPS-1767[GITOPS-1767]
+
[NOTE]
====
Disabling or changing the content of the dashboards is not supported.
====

* Previously, timestamps were presented in a Unix epoch format. With this update, the timestamps are changed to RFC3339 format, for example: 2023-06-27T07:12:48-04:00, to improve overall readability. link:https://issues.redhat.com/browse/GITOPS-2898[GITOPS-2898]

* With this update, the default Argo CD instance in the `openshift-gitops` namespace has restricted permissions for non-admin users by default. This improves security because non-admin users no longer have access to sensitive information. However, as an administrator, you can set permissions and grant non-admin users access to the resources managed by the default `openshift-gitops` Argo CD instance by configuring your Argo CD RBAC. This change only applies to the default `openshift-gitops` Argo CD instance. link:https://issues.redhat.com/browse/GITOPS-3032[GITOPS-3032]

* With this update, the default installation namespace for {gitops-title} Operator is changed to its own namespace called `openshift-gitops-operator`. You can still choose the old default installation namespace, `openshift-operators`, through a drop-down menu available in the OperatorHub UI at installation time. You can also enable cluster monitoring on the new namespace by selecting the check box, which makes the Operator's performance metrics accessible within the {OCP} web console. link:https://issues.redhat.com/browse/GITOPS-3073[GITOPS-3073]
+
[NOTE]
====
The {gitops-title} Operator's metrics are only available when the Operator is installed in the default namespace, `openshift-gitops-operator`.
====

* With this update, the {gitops-title} Operator exports custom metrics that allow you to track the performance of the Operator. The following are the exported metrics:
** `active_argocd_instances_total`: This shows the number of Argo CD instances currently managed across the cluster.
** `active_argocd_instances_by_phase{phase="<_PHASE>"}`: This shows the number of Argo CD instances in a given phase, such as pending, available, among others.
** `active_argocd_instance_reconciliation_count{namespace="<_YOUR-DEFINED-NAMESPACE>"}`: This shows the number of times the instance in a given namespace is reconciled.
** `controller_runtime_reconcile_time_seconds_per_instance{namespace="<_YOUR-DEFINED-NAMESPACE>"}`: This metric displays the distribution of reconciliation cycles by their duration for the instance in a given namespace.
+
To access these metrics, go to the *Observe* tab on the web console, and run queries against the monitoring stack. link:https://issues.redhat.com/browse/GITOPS-2645[GITOPS-2645]
+
[NOTE]
====
You need to install the {gitops-title} Operator in the default `openshift-gitops-operator` namespace with monitoring enabled to have these metrics automatically available.
====

* Before this update, there was no option for choosing an algorithm for distributing the destination clusters equally across the different application controller shards. Now, you can set the sharding algorithm to the `round-robin` parameter, which distributes clusters equally across the different application controller shards so that the synchronization load is spread equally among the shards. link:https://issues.redhat.com/browse/GITOPS-3288[GITOPS-3288]

* Before this update, there was no option for scaling the application controller replicas dynamically. Now, you can dynamically scale the number of application controllers based on the number of clusters managed by each application controller. link:https://issues.redhat.com/browse/GITOPS-3287[GITOPS-3287]

[role="_additional-resources"]
.Additional resources
* link:https://developers.redhat.com/articles/2023/09/26/dynamically-scale-argo-cd-application-controller-openshift-gitops-110[Dynamically scale the Argo CD application controller with {gitops-title} 1.10.0]


[id="deprecated-features-1-10-0_{context}"]
== Deprecated and removed features

* With this release, the following deprecated `sso` and `dex` fields are removed from Argo CD CR:
** The `.spec.sso.image`, `.spec.sso.version`, `.spec.sso.resources`, and `.spec.sso.verifyTLS` fields for keycloak SSO configurations
** The `.spec.dex` fields, along with `DISABLE_DEX` environment variable
+
Additionally, the `.status.dex` and `.status.ssoConfig` fields are also removed, and a new status field, `.status.sso`, is introduced. The new field reflects the workload status of the SSO provider (dex or keycloak) configured through the `.spec.sso.provider` field. link:https://issues.redhat.com/browse/GITOPS-2473[GITOPS-2473]
+
[IMPORTANT]
====
To configure dex or keycloak SSO, use the equivalent fields under `.spec.sso`.
==== 

* With this update, the deprecated `.spec.resourceCustomizations` field is removed from Argo CD CR. Bug fixes and support are only provided through the end of the {gitops-title} v1.9 lifecycle.
As an alternative to `.spec.resourceCustomizations`, you can use `.spec.resourceHealthChecks`, `.spec.resourceIgnoreDifferences`, and `.spec.resourceActions` fields instead. link:https://issues.redhat.com/browse/GITOPS-3041[GITOPS-3041]
+
[IMPORTANT]
====
To prevent data loss during upgrade to {gitops-title} Operator v1.10.0, ensure that you backup `.spec.resourceCustomization` value if it is used in your Argo CD CRs.
==== 

* With this update, the deprecated legacy Configuration Management Plugins (CMPs) feature, specified in the `argocd-cm` config map or the Operator through the `.spec.configManagementPlugins` field in Argo CD CR, has been removed in Argo CD v2.8. To continue using your legacy plugins, consider migrating them to the new sidecar available in the Operator through the `.spec.repo.sidecarContainers` field in Argo CD CR. link:https://issues.redhat.com/browse/GITOPS-3462[GITOPS-3462]


[id="fixed-issues-1-10-0_{context}"]
== Fixed issues

The following issues have been resolved in the current release:

* Before this update, there were vulnerabilities on Redis. This update fixes the issue by upgrading Redis to the latest version of `registry.redhat.io/rhel-8/redis-6`. link:https://issues.redhat.com/browse/GITOPS-3069[GITOPS-3069]

* Before this update, users were facing an "x509: certificate signed by unknown authority" error when using scmProvider with GitLab. This update fixes the issue by adding support for the `Insecure` flag for scmProvider with GitLab, and an option for mounting TLS certificate on the applicationSet controller.
This certificate can then be utilized for scmProvider interactions with GitLab. link:https://issues.redhat.com/browse/GITOPS-3107[GITOPS-3107]