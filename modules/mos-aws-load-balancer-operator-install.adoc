
:_mod-docs-content-type: PROCEDURE
[id="mos-aws-load-balancer-operator-install_{context}"]
= Installing AWS Load Balancer Operator

// TODO OSDOCS-11830 until this is validated
[WARNING]
====
The instructions in this section have not yet been validated against all supported environments. Do not use these instructions for production environments.
====

//Replaces Creating an IAM role for the ALB Operator and Creating an IAM role for the ALB Controller using the ccoctl tool




// TODO OSDOCS-11830 Create IAM role for ALBO without ccoctl
// Verify tutorial method here: https://docs.redhat.com/en/documentation/red_hat_openshift_service_on_aws/4/html/tutorials/cloud-experts-aws-load-balancer-operator
// Know your variables: rosa cluster name, region, OIDC endpoint, AWS account ID, VPC ID, public subnet ID/s, private subnet ID/s
// Tag VPC with kubernetes.io/cluster/<cluster-id>:owned - is this necessary or just useful?
// Tag private subnets with internal-elb, tag public subnets with elb - these appear to be done automatically when creating a VPC with rosa create network
//Hidden prereq? need to create VPC and cluster across multiple regions



//= Configuring AWS Load Balancer Operator for Managed OpenShift clusters

//. Gather the following information for your cluster:
//** Cluster infrastructure ID
//** OIDC Endpoint URL
//** OIDC Provider ARN

//(The following is what you are doing with ccoctl, without being in your project or logged on to your console)
// remote resources for credential requests:
//Operator: https://raw.githubusercontent.com/openshift/aws-load-balancer-operator/main/hack/controller/controller-credentials-request.yaml
//Controller: https://raw.githubusercontent.com/openshift/aws-load-balancer-operator/main/hack/controller/controller-credentials-request.yaml

//. Create the required IAM policy for the ALB Operator
//.. Log in to the cluster as a user with the dedicated-admin role.
//.. Create a new project named aws-load-balancer-operator (required name or any name?)
//.. Create the trust policy for the ALBO, using the OIDC Endpoint URL and the OIDC Provider ARN for your cluster.
//.. Create a new albo-operator role and assign it the ALBO trust policy.
//.. Attach the https://raw.githubusercontent.com/openshift/aws-load-balancer-operator/release-1.1/hack/operator-permission-policy.json permission policy to the new role
//. Create the required IAM policy for the ALB Controller
//.. (very similar steps to above)
// (The above is all that you are doing with ccoctl, without being in your project or logged on to your openshift console at all?)

//. HCP: Add tags to ensure discovery?
//. Create the OperatorGroup - why
//. Create the Subscription - why
//. Create the ALB Controller - why

// Installing file networking/networking_operators/modules/aws-installing-an-aws-load-balancer-operator.adoc covers:
// Create a new project for the operator
// Create the trust policy for the operator
// Create a role using the trust policy for the operator
// Assign the policy to the operator role?
// Create a trust policy for the controller
// Create a role based on the controller trust policy
// Assign the policy to the controller role?