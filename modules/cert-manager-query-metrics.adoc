// Module included in the following assemblies:
//
// * security/cert_manager_operator/cert-manager-operator-monitoring.adoc

:_content-type: PROCEDURE
[id="cert-manager-query-metrics_{context}"]
= Querying metrics for the {cert-manager-operator}

After you have enabled monitoring for the {cert-manager-operator}, you can query its metrics by using the {product-title} web console.

.Prerequisites

// TODO: Need cluster-admin or what other role? "a user with view permissions for all projects" <- what is this specifically
* You have access to the cluster as a user with the `cluster-admin` role.
* You have installed the {cert-manager-operator}.
* You have enabled monitoring and metrics collection for the {cert-manager-operator}.

.Procedure

. From the {product-title} web console, navigate to *Observe* -> *Metrics*.

. Add a query by using one of the following formats:

** Specify the endpoints:
+
[source,promql]
----
{instance="<endpoint>"} <1>
----
<1> Replace `<endpoint>` with the value of the endpoint for the `cert-manager` service. You can find the endpoint value by running the following command: `oc describe service cert-manager -n cert-manager`.
+
// TODO: Can we narrow this down with a better query to actually get just the endpoint to output?

** Specify the `tcp-prometheus-servicemonitor` port:
+
[source,promql]
----
{endpoint="tcp-prometheus-servicemonitor"}
----
+
// TODO: Not getting any results with just these. Are they expected to put these in there exactly, or would they need to put a function or something in front? Or did I miss a step? Don't see cert-manager in Observe -> Targets
// Tried editing   to add potentially missing:
//serviceMonitorSelector: {}
// matchLabels:
//   openshift.io/cluster-monitoring: "true"
