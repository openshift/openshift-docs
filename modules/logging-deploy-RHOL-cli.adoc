// Module included in the following assemblies:
//
//

:_content-type: PROCEDURE
[id="logging-deploy-cli_{context}"]
= Installing the {logging-title} using the CLI

You can use the {product-title} CLI to install the Red Hat OpenShift Logging Operator.

.Prerequisites

*

.Procedure

To install the Red Hat OpenShift Logging Operator using the CLI:

. Create a namespace for the Red Hat OpenShift Logging Operator:

.. Create a namespace object YAML file (for example, `olo-namespace.yaml`) for the Red Hat OpenShift Logging Operator:
+
[source,yaml]
----
apiVersion: v1
kind: Namespace
metadata:
  name: openshift-logging
  annotations:
    openshift.io/node-selector: ""
  labels:
    openshift.io/cluster-monitoring: "true"
----

.. Create the namespace:
+
[source,terminal]
----
$ oc create -f <file-name>.yaml
----
+
For example:
+
[source,terminal]
----
$ oc create -f olo-namespace.yaml
----

. Install the Red Hat OpenShift Logging Operator by creating the following objects:

.. Create an Operator Group object YAML file (for example, `olo-og.yaml`) for the Red Hat OpenShift Logging Operator:
+
[source,yaml]
----
apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: cluster-logging
  namespace: openshift-logging <1>
spec:
  targetNamespaces:
  - openshift-logging <1>
----
<1> You must specify the `openshift-logging` namespace.

.. Create an Operator Group object:
+
[source,terminal]
----
$ oc create -f <file-name>.yaml
----
+
For example:
+
[source,terminal]
----
$ oc create -f olo-og.yaml
----

.. Create a Subscription object YAML file (for example, `olo-sub.yaml`) to
subscribe a namespace to the Red Hat OpenShift Logging Operator.
+
[source,yaml]
----
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: cluster-logging
  namespace: openshift-logging <1>
spec:
  channel: "stable" <2>
  name: cluster-logging
  source: redhat-operators <3>
  sourceNamespace: openshift-marketplace
----
<1> You must specify the `openshift-logging` namespace.
<2> Specify `stable`, or `stable-5.<y>` as the channel.
<3> Specify `redhat-operators`. If your {product-title} cluster is installed on a restricted network, also known as a disconnected cluster, specify the name of the CatalogSource object you created when you configured the Operator Lifecycle Manager (OLM).
+
[source,terminal]
----
$ oc create -f <file-name>.yaml
----
+
For example:
+
[source,terminal]
----
$ oc create -f olo-sub.yaml
----
+
The Red Hat OpenShift Logging Operator is installed to the `openshift-logging` namespace.

.. Verify the Operator installation.
+
There should be a Red Hat OpenShift Logging Operator in the `openshift-logging` namespace. The Version number might be different than shown.
+
[source,terminal]
----
$ oc get csv -n openshift-logging
----
+
.Example output
[source,terminal]
----
NAMESPACE                                               NAME                                         DISPLAY                  VERSION               REPLACES   PHASE
...
openshift-logging                                       clusterlogging.5.1.0-202007012112.p0         OpenShift Logging          5.1.0-202007012112.p0              Succeeded
...
----

. Create an OpenShift Logging instance:

.. Create an instance object YAML file (for example, `olo-instance.yaml`) for the Red Hat OpenShift Logging Operator:
+
[NOTE]
====
This default OpenShift Logging configuration should support a wide array of environments. Review the topics on tuning and
configuring {logging} components for information on modifications you can make to your OpenShift Logging cluster.
====
+
[source,yaml]
----
  apiVersion: logging.openshift.io/v1
  kind: ClusterLogging
  metadata:
    name: instance <1>
    namespace: openshift-logging
  spec:
    managementState: Managed <2>
    logStore:
      type: lokistack
      lokistack:
        name: logging-loki
      collection:
        type: "vector"
----
<1> The name must be `instance`.
<2> The OpenShift Logging management state. In some cases, if you change the OpenShift Logging defaults, you must set this to `Unmanaged`.
However, an unmanaged deployment does not receive updates until OpenShift Logging is placed back into a managed state. Placing a deployment back into a managed state might revert any modifications you made.

.. Create the instance:
+
[source,terminal]
----
$ oc create -f <file-name>.yaml
----
+
For example:
+
[source,terminal]
----
$ oc create -f olo-instance.yaml
----
+
This creates the {logging} custom resource and components.

. Verify the installation by listing the pods in the *openshift-logging* project.
+
[source,terminal]
----
$ oc get pods -n openshift-logging
----
