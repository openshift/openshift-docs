// Module included in the following assemblies:
//
// microshift/microshift-embed-into-rpm-ostree.adoc

:_content-type: PROCEDURE
[id="adding-microshift-service-to-blueprint_{context}"]
= Adding the {product-title} service to a blueprint

Adding the {product-title} RPM package to an Image Builder blueprint enables the build of a {op-system-ostree} image with {product-title} embedded.

.Procedure

. Use the following example to create your blueprint:
+
.Image Builder blueprint example
+
[source,terminal]
----
$ cat > minimal-microshift.toml <<EOF
name = "minimal-microshift"

description = ""
version = "0.0.1"
modules = []
groups = []

[[packages]]
name = "microshift"
version = "*"

[[packages]]
name = "microshift-greenboot" <1>
version = "*"

[customizations.services]
enabled = ["microshift"]
EOF
----
[.small]
<1> Optional `microshift-greenboot` RPM. For more information, read the "Greenboot health check" guide in the "Running Applications" section.
+
[NOTE]
====
The wildcard `*` in the commands uses the latest {product-title} RPMs. If you need a specific version, substitute the wildcard for the version you want. For example, insert `4.13.1` to download the {product-title} 4.13.1 RPMs.
====

. Add the blueprint to the Image Builder by running the following command:
+
[source,terminal]
----
$ sudo composer-cli blueprints push minimal-microshift.toml
----

.Verification

. Verify the Image Builder configuration listing only {product-title} packages by running the following command:
+
[source,terminal]
----
$ sudo composer-cli blueprints depsolve minimal-microshift | grep microshift
----
+
.Example output
+
[source,terminal]
----
blueprint: minimal-microshift v0.0.1
    microshift-greenboot-4.13.1-202305250827.p0.g4105d3b.assembly.4.13.1.el9.noarch
    microshift-networking-4.13.1-202305250827.p0.g4105d3b.assembly.4.13.1.el9.x86_64
    microshift-release-info-4.13.1-202305250827.p0.g4105d3b.assembly.4.13.1.el9.noarch
    microshift-4.13.1-202305250827.p0.g4105d3b.assembly.4.13.1.el9.x86_64
    microshift-selinux-4.13.1-202305250827.p0.g4105d3b.assembly.4.13.1.el9.noarch
----

. Optional: Verify the Image Builder configuration listing all components to be installed by running the following command:
+
[source,terminal]
----
$ sudo composer-cli blueprints depsolve minimal-microshift
----
