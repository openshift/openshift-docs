// Module included in the following assemblies:
//
// * networking/k8s_nmstate/k8s-nmstate-updating-node-network-config.adoc

:_mod-docs-content-type: PROCEDURE
[id="virt-removing-interface-from-nodes_{context}"]
= Removing an interface from nodes

[role="_abstract"]
You can remove an interface from one or more nodes in the cluster by editing the `NodeNetworkConfigurationPolicy` object and setting the `state` of the interface to `absent`.

Removing an interface from a node does not automatically restore the node network configuration to a previous state. If you want to restore the previous state, you will need to define that node network configuration in the policy.

If you remove a bridge or bonding interface, any node NICs in the cluster that were previously attached or subordinate to that bridge or bonding interface are placed in a `down` state and become unreachable. To avoid losing connectivity, configure the node NIC in the same policy so that it has a status of `up` and either DHCP or a static IP address.

[NOTE]
====
Deleting the node network policy that added an interface does not change the configuration of the policy on the node. Although a `NodeNetworkConfigurationPolicy` is an object in the cluster, the object only represents the requested configuration. Similarly, removing an interface does not delete the policy.
====

.Prerequisites

* You have installed the {oc-first}.

.Procedure

. Update the `NodeNetworkConfigurationPolicy` manifest used to create the interface. The following example removes a Linux bridge and configures the `eth1` NIC with DHCP to avoid losing connectivity:
+
[source,yaml]
----
apiVersion: nmstate.io/v1
kind: NodeNetworkConfigurationPolicy
metadata:
  name: <br1-eth1-policy>
spec:
  nodeSelector:
    node-role.kubernetes.io/worker: ""
  desiredState:
    interfaces:
    - name: br1
      type: linux-bridge
      state: absent
    - name: eth1
      type: ethernet
      state: up
      ipv4:
        dhcp: true
        enabled: true
----
+
`metadata.name`:: Name of the policy.
`spec.nodeSelector`:: Optional: If you do not include the `nodeSelector` parameter, the policy applies to all nodes in the cluster.
`spec.nodeSelector.node-role.kubernetes.io/worker`:: This example uses the `node-role.kubernetes.io/worker: ""` node selector to select all worker nodes in the cluster.
`spec.desiredState.interfaces.name`:: The name of the interface.
`spec.desiredState.interfaces.type`:: The type of interface. This example creates both Linux bridge and Ethernet networking interfaces.
`spec.desiredState.interfaces.state`:: The requested state for the interface. Changing the state to `absent` removes the interface.
`spec.desiredState.interfaces.ipv4.dhcp`:: Optional: If you do not use `dhcp`, you can either set a static IP or leave the interface without an IP address.
`spec.desiredState.interfaces.ipv4.enabled`:: Enables `ipv4` in this example.

. Update the policy on the node and remove the interface:
+
[source,terminal]
----
$ oc apply -f <filename.yaml>
----
+
Where `<filename.yaml>` is the filename of the policy manifest.
