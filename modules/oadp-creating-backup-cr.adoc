// Module included in the following assemblies:
//
// * backup_and_restore/application_backup_and_restore/backing_up_and_restoring/backing-up-applications.adoc

:_content-type: PROCEDURE
[id="oadp-creating-backup-cr_{context}"]
= Creating a Backup CR

You back up Kubernetes images, internal images, and persistent volumes (PVs) by creating a `Backup` custom resource (CR).

.Prerequisites

* You must install the OpenShift API for Data Protection (OADP) Operator.
* The `DataProtectionApplication` CR must be in a `Ready` state.
* Backup location prerequisites:
** You must have S3 object storage configured for Velero.
** You must have a backup location configured in the `DataProtectionApplication` CR.
* Snapshot location prerequisites:
** Your cloud provider must have a native snapshot API or support Container Storage Interface (CSI) snapshots.
** For CSI snapshots, you must create a `VolumeSnapshotClass` CR to register the CSI driver.
** You must have a volume location configured in the `DataProtectionApplication` CR.

.Procedure

. Retrieve the `backupStorageLocations` CRs:
+
[source,terminal]
----
$ oc get backupStorageLocations
----
+
.Example output
+
[source,terminal]
----
NAME              PHASE       LAST VALIDATED   AGE   DEFAULT
velero-sample-1   Available   11s              31m
----

. Create a `Backup` CR, as in the following example:
+
[source,yaml]
----
apiVersion: velero.io/v1
kind: Backup
metadata:
  name: <backup>
  labels:
    velero.io/storage-location: default
  namespace: openshift-adp
spec:
  hooks: {}
  includedNamespaces:
  - <namespace> <1>
  storageLocation: <velero_sample_1> <2>
  ttl: 720h0m0s
  labelSelector: <3>
  - matchLabels:
      app=<label_1>
  - matchLabels:
      app=<label_2>
  - matchLabels:
      app=<label_3>
  orlabelSelectors: <4>
  - matchLabels:
      app=<label_1>
  - matchLabels:
      app=<label_2>
  - matchLabels:
      app=<label_3>
----
<1> Specify an array of namespaces to back up.
<2> Specify the name of the `backupStorageLocations` CR.
<3> Optional. You can configure the backup to include only the resources with all the labels that you specify in this field. Note that the `labelSelector` and `orlabelSelectors` fields are mutually exclusive. You can use only one of them.
<4> Optional. You can configure the backup to include the resources with any of the labels that you specify in this field. Note that the `orlabelSelectors` and `labelSelector` fields are mutually exclusive. You can use only one of them.

. Verify that the status of the `Backup` CR is `Completed`:
+
[source,terminal]
----
$ oc get backup -n openshift-adp <backup> -o jsonpath='{.status.phase}'
----
