// Module included in the following assemblies:
//
// * operators/admin/olm-restricted-networks.adoc
// * operators/admin/managing-custom-catalogs.adoc
// * migrating_from_ocp_3_to_4/installing-and-upgrading-3-4.adoc
// * migration/migrating_4_1_4/deploying-cam-4-1-4.adoc
// * migration/migrating_4_2_4/deploying-cam-4-2-4.adoc

ifdef::openshift-origin[]
:index-image: catalog
:tag: latest
endif::[]
ifndef::openshift-origin[]
:index-image: redhat-operator-index
:tag: v{product-version}
endif::[]
ifeval::["{context}" == "olm-restricted-networks"]
:olm-restricted-networks:
endif::[]

[id="olm-creating-catalog-from-index_{context}"]
= Creating a catalog from an index image

You can create a catalog from an index image and apply it to an {product-title} cluster.

.Prerequisites

* An index image built and pushed to a registry.

.Procedure

. Apply a `CatalogSource` object to your cluster that references your index image:
+
[source,terminal]
----
$ cat <<EOF | oc apply -f -

apiVersion: operators.coreos.com/v1alpha1
kind: CatalogSource
metadata:
  name: test-catalog
  namespace: openshift-marketplace
spec:
  sourceType: grpc
  image: quay.io/<namespace>/test-catalog:latest <1>
  displayName: Test Catalog
  updateStrategy:
    registryPoll: <2>
      interval: 30m
EOF
----
<1> Specify your index image.
<2> Catalog sources can automatically check for new versions to keep up to date.

. Verify using the {product-title} web console or CLI that the catalog loaded successfully and that packages are available. For example, using the CLI:

.. Check the pods:
+
[source,terminal]
----
$ oc get pods -n openshift-marketplace
----

.. Check the catalog source:
+
[source,terminal]
----
$ oc get catalogsource -n openshift-marketplace
----

.. Check the package manifest:
+
[source,terminal]
----
$ oc get packagemanifests -n openshift-marketplace
----
