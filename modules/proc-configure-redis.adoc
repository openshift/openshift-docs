// Module included in the following assemblies:
//
// *install-guide/install-guide.adoc

:_mod-docs-content-type: PROCEDURE
[id="configure-redis_{context}"]
= Configuring Redis storage for rate limiting

[role="_abstract"]
To configure persistence for rate limit counters in a multicluster environment, you must configure the connection details for your shared Redis-based datastore. This datastore is used to persist shared rate limit counters for the Limitador component of {prodname}.

[IMPORTANT]
====
You must configure connection details for your shared Redis-based datastore on each {ocp} cluster that you want to use {prodname} for rate limiting.
====

.Prerequisites

* You installed Connectivity Link.
//TODO

.Procedure

. Set the following environment variable to your shared Redis-based instance URL:
+
[source,bash]
----
$ export REDIS_URL=rediss://user:xxxxxx@some-redis.com:10340
----
+
Include the appropriate URI scheme for your environment:

* Secure Redis: `rediss://`
* Standard Redis: `redis://`

. Create a `Secret` resource for your Redis URL as follows:
+
[source,bash]
----
$ kubectl -n kuadrant-system create secret generic redis-config \
  --from-literal=URL=$REDIS_URL
----

. Update your Limitador custom resource to use the secret that you created as follows:
+
[source,bash]
----
$ kubectl patch limitador limitador --type=merge -n kuadrant-system -p '
spec:
  storage:
    redis:
      configSecretRef:
        name: redis-config
'
----
