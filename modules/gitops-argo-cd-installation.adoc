// Module included in the following assemblies:
//
// * argocd_instance/setting-up-argocd-instance.adoc

:_mod-docs-content-type: PROCEDURE
[id="gitops-argo-cd-installation_{context}"]
= Installing a user-defined Argo CD instance 

[role="_abstract"]
To manage cluster configurations or deploy applications, you can install and deploy a new user-defined Argo CD instance.

.Prerequisites

* You have access to the cluster with `cluster-admin` privileges.

* You have installed the {gitops-title} Operator on your {OCP} cluster.

.Procedure
. Log in to the {OCP} web console. 

. In the *Administrator* perspective of the web console, click *Operators* -> *Installed Operators*.

. Create or select the project where you want to install the user-defined Argo CD instance from the *Project* list.

. Select *{gitops-title}* from the installed Operators list and click the *Argo CD* tab.

. Click *Create ArgoCD* to configure the parameters:

.. Enter the *Name* of the instance. By default, the *Name* is set to `example`. 

.. Create an external OS Route to access Argo CD server. Click *Server* -> *Route* and check *Enabled*. 
+
[TIP]
====
You can alternatively configure YAML to create an external OS Route as shown in the following example:

.Example Argo CD with external OS route created

[source,yaml]
----
apiVersion: argoproj.io/v1beta1
kind: ArgoCD
metadata:
  name: example
  namespace: openshift-gitops
spec:
  server:
    route:
      enabled: true
----
====

.. Optional: Modify the route TLS termination policy by configuring the `.spec.server.route.tls` field of the Argo CD CR.
+
[NOTE]
====
When configuring custom TLS certificates for Argo CD Server route, avoid using the `.spec.server.route.tls.key` and `.spec.server.route.tls.certificate` fields. Use the `.spec.server.route.tls.externalCertificate` field instead. For more information about configuring a route for custom TLS certificate, see examples in link:https://argocd-operator.readthedocs.io/en/latest/usage/routes/#custom-tls-certificates[Custom TLS certificates for Routes].
====

. Click *Create*.

. Go to *Networking* -> *Routes* -> *<instance_name>-server* in the project where the user-defined Argo CD instance is installed.

. On the *Details* tab, click the Argo CD web UI link under *Route details* -> *Location*. The Argo CD web UI opens in a separate browser window.

. Optional: To log in with your {OCP} credentials, ensure you are a user of the `cluster-admins` group and then select the `LOG IN VIA OPENSHIFT` option in the Argo CD user interface.
+
[NOTE]
====
To be a user of the `cluster-admins` group, use the `oc adm groups new cluster-admins <user>` command, where `<user>` is the default cluster role that you can bind to users and groups cluster-wide or locally.
====
. Obtain the password for the user-defined Argo CD instance:
.. Use the navigation panel to go to the *Workloads* -> *Secrets* page.
.. Use the *Project* list and select the namespace where the user-defined Argo CD instance is created.
.. Select the *<argo_CD_instance_name>-cluster* instance to display the password.
.. On the *Details* tab, copy the password under *Data* -> *admin.password*.
. Use `admin` as the *Username* and the copied password as the *Password* to log in to the Argo CD UI in the new window.
