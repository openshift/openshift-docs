// Module included in the following assemblies:
//
// * edge_computing/ibi-image-based-install.adoc 

:_content-type: PROCEDURE
[id="embed-sno-to-live-iso_{context}"]
= Embedding the installation artifacts in a live installation ISO

You can embed your {sno} seed image URL, and other installation artifacts, in a live installation ISO by using the `ib-cli` CLI tool. Extract the `ib-cli` CLI tool binary from the {lcao}. 

For further information about the command line arguments for the `ib-cli` CLI tool, see the _ib-cli CLI tool reference_ section.

.Prerequisites
* You generated a seed image from a {sno} seed cluster.
* You installed Podman.
* The target host has network access to the seed image URL and all other installation artifacts.

.Procedure

. Extract the `ib-cli` CLI tool from the {lcao}:

.. Create a temporary container for the {lcao} image by running the following command:
+
[source,terminal]
----
$ podman create --name temp_container quay.io/openshift-kni/lifecycle-agent-operator:4.16
----

.. Copy the `ib-cli` CLI tool from the container to the local host by running the following command:
+
[source,terminal]
----
$ podman cp temp_container:/usr/local/bin/ib-cli .
----

. Create an installation ISO and embed your {sno} seed image URL and other installation artifacts

.. Create a working directory by running the following:
+
[source,terminal]
----
$ mkdir ibi-iso-workdir
----

.. Create a YAML file called `image-based-install-iso.yaml` in your working directory to define the installation artifacts:
+
.Example `image-based-install-iso.yaml` file
[source,yaml]
----
seedImage: quay.io/repo-id/seed:latest
seedVersion: 4.16.0
pullSecret: |
  {"auths": ...}
installationDisk: /dev/disk/by-id/wwn-0x62c...
sshKey: 'ssh-ed25519 AAAA...'
----

.. Create the installation ISO by running the following command:
+
[source,terminal]
----
$ ib-cli create-iso --dir ibi-iso-workdir
----
+
.Example output
[source,terminal]
----
ib-cli assists Image Based Install (IBI).

  Find more information at: https://github.com/openshift-kni/lifecycle-agent/blob/main/ib-cli/README.md

INFO[2024-02-12 15:58:09] Installation ISO creation has started
INFO[2024-02-12 15:58:09] Creating IBI installation ISO
INFO[2024-02-12 15:58:09] Generating Ignition Config
INFO[2024-02-12 15:58:09] Executing podman with args [run -v ./ibi-iso-workdir:/data:rw,Z --rm quay.io/coreos/butane:release --pretty --strict -d /data /data/config.bu]
INFO[2024-02-12 15:58:10] Downloading live ISO
INFO[2024-02-12 15:59:24] Executing podman with args [run -v ./ibi-iso-workdir:/data:rw,Z quay.io/coreos/coreos-installer:latest iso ignition embed -i /data/ibi-ignition.json -o /data/rhcos-ibi.iso /data/rhcos-live.x86_64.iso]
INFO[2024-02-12 15:59:24] installation ISO created at: ibi-iso-workdir/rhcos-ibi.iso
INFO[2024-02-12 15:59:24] Installation ISO created successfully!
----

.Verification

* View the output in the working directory:
+
[source,text]
----
ibi-iso-workdir/
  ├── ibi-ignition.json
  ├── image-based-install-iso.yaml
  ├── rhcos-ibi.iso
  └── rhcos-live.x86_64.iso
----

[discrete]
.Provisioning the live installation ISO to a host 

* Boot the `rhcos-ibi.iso` live installation ISO to a bare-metal host, using your preferred method, to preinstall {sno} on the machine.