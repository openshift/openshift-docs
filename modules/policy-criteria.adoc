// Module included in the following assemblies:
//
// * operating/manage_security_policies/about-security-policies.adoc
:_mod-docs-content-type: REFERENCE
[id="policy-criteria_{context}"]
= Policy criteria

[role="_abstract"]
You can set up rules in {product-title-short} and configure the data on which you want to trigger a policy. This data is also referred to as _policy criteria_ or _policy fields_.

You can configure the policy based on the attributes listed in the following table.

In this table:

* The *Regular expressions*, *AND, OR*, and *NOT* columns indicate whether you can use regular expressions and other logical operators along with the specific attribute.
** `!` for *Regex* (Regular expressions) indicates that you can only use regular expressions for the listed fields.
** `!` for *AND*, or *OR* indicates that you can only use the mentioned logical operator for the attribute.
** ✕ in the *Regex* / *NOT* / *AND, OR* column indicates that the attribute does not support any of those (regex, negation, logical operators).
* The *{product-title-short} version* column indicates the version of {product-title} that you must have to use the attribute.
* You cannot use logical combination operators `AND` and `OR` for attributes that have:
** Boolean values `true` and `false`
** Minimum-value semantics, for example:
*** *Minimum RBAC permissions*
*** *Days since image was created*
* You cannot use the `NOT` logical operator for attributes that have:
** Boolean values `true` and `false`
** Numeric values that already use comparison, such as the `<`, `>`, `+<=+`, `>=` operators.
** Compound criteria that can have multiple values, for example:
*** *Dockerfile line*, which includes both instructions and arguments.
*** *Environment variable*, which consists of both name and value.
** Other meanings, including *Add capabilities*, *Drop capabilities*, *Days since image was created*, and *Days since image was last scanned*.

[id="reference-image-criteria_{context}"]
== Image criteria

Image registry::

[cols="<,<,<,<,^,<"]
|===
| *Attribute* | *Description* | *JSON Attribute* | *Allowed Values* | *Regex*, *NOT*, *AND, OR* | *Phase*

| Image registry
| The name of the image registry.
| Image Registry
| String
| Regex, +
NOT, +
AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Image name
| The full name of the image in registry, for example `library/nginx`.
| Image Remote
| String
| Regex, +
NOT, +
AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Image tag
| Identifier for an image.
| Image Tag
| String
| Regex, +
NOT, +
AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Require image signature
| The list of signature integrations you can use to verify an image's signature. Create alerts on images that either do not have a signature or their signature is not verifiable by at least one of the provided signature integrations.
| Image Signature Verified By
| A valid ID of an already configured image signature integration
| ! `OR` only
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

|===

Image contents::

[cols="<,<,<,<,^,<"]
|===
| *Attribute* | *Description* | *JSON Attribute* | *Allowed Values* | *Regex*, *NOT*, *AND, OR* | *Phase*

| Image age
| The minimum number of days from image creation date.
| Image Age
| Integer
| ✕
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Image user
| Matches the USER directive in the Dockerfile. See https://docs.docker.com/engine/reference/builder/#user for details
.
| Image User
| String
| Regex, +
NOT, +
AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Dockerfile line
| A specific line in the Dockerfile, including both instructions and arguments.
| Dockerfile Line
| One of: LABEL, RUN, CMD, EXPOSE, ENV, ADD, COPY, ENTRYPOINT, VOLUME, USER, WORKDIR, ONBUILD
| ! Regex only for values, +
AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Image component
| Name and version number of a specific software component present in an image.
| Image Component
| key=value +

Value is optional. +

If value is missing, it must be in format "key=".
| Regex, +
AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Image OS
| Name and version number of the base operating system of the image. For example, `alpine:3.17.3`
| Image OS
| String
| Regex, +
NOT, +
AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Require image label
| Ensure the presence of a Docker image label. The policy triggers if any image in the deployment does not have the specified label. You can use regular expressions for both key and value fields to match labels. The `Require Image Label` policy criteria only works when you integrate with a Docker registry. For details about Docker labels see Docker documentation, https://docs.docker.com/config/labels-custom-metadata/.
| Required Image Label
| key=value +

Value is optional. +

If value is missing, it must be in format "key=".
| Regex, +
AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Disallow image label
| Ensure that a particular Docker image label is NOT used. The policy triggers if any image in the deployment has the specified label. You can use regular expressions for both key and value fields to match labels. The 'Disallow Image Label policy' criteria only works when you integrate with a Docker registry. For details about Docker labels see Docker documentation, https://docs.docker.com/config/labels-custom-metadata/.
| Disallowed Image Label
| key=value +

Value is optional. +

If value is missing, it must be in format "key=".
| Regex, +
AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

|===

Image scanning::

[cols="<,<,<,<,^,<"]
|===
| *Attribute* | *Description* | *JSON Attribute* | *Allowed Values* | *Regex*, *NOT*, *AND, OR* | *Phase*

| Image scan age
| The minimum number of days since the image was last scanned.
| Image Scan Age
| Integer
| ✕
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Image scan status
| Check if an image was scanned.
| Unscanned Image
| Boolean
| ✕
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Common Vulnerability Scoring System (CVSS)
| CVSS: Use it to match images with vulnerabilities whose scores are greater than `>`, less than `<`, or equal to `=` the specified CVSS.
| CVSS
| <, >, \<=, >= or nothing (which implies equal to) +

-- and --
 +
a decimal (a number with an optional fractional value). +

Examples: +
>=5, or +
9.5
| AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| National Vulnerability Database (NVD) CVSS
| Requires Scanner V4. NVD CVSS: Use it to match images with vulnerabilities reported by NVD whose scores are greater than `>`, less than `<`, or equal to `=` the specified CVSS.
| CVSS
| <, >, \<=, >= or nothing (which implies equal to) +

-- and --
 +
a decimal (a number with an optional fractional value). +

Examples: +
>=5, or +
9.5
| AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Severity
| The severity of the vulnerability based on the CVSS or the vendor. Can be one of Low, Moderate, Important or Critical.
| Severity
| <, >, <=, >= or nothing (which implies equal to) +

-- and --
 +
One of: +
UNKNOWN +
LOW +
MODERATE +
IMPORTANT +
CRITICAL +

Examples: +
>=IMPORTANT, or +
CRITICAL
| AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Fixable
| This criterion results in a violation only if the image in the deployment you are evaluating has a fixable CVE.
| Fixable
| Boolean
| ✕
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Fixed by
| The version string of a package that fixes a flagged vulnerability in an image. This criterion may be used in addition to other criteria that identify a vulnerability, for example using the CVE criterion.
| Fixed By
| String
| Regex, +
NOT, +
AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| CVE
| Common Vulnerabilities and Exposures, use it with specific CVE numbers.
| CVE
| String
| Regex, +
NOT, +
AND, OR
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Days since CVE was published
| This criterion results in a violation only if it has been more than a specified number of days since {product-title-short} was first published.
| Days Since CVE Was First Published
| Integer
| ✕
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)


| Days since CVE was first discovered in image
| This criterion results in a violation only if it has been more than a specified number of days since {product-title-short} discovered the CVE in a specific image.
| Days Since CVE Was First Discovered In Image
| Integer
| ✕
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Days since CVE was first discovered in system
| This criterion results in a violation only if it has been more than a specified number of days since {product-title-short} discovered the CVE across all deployed images in all clusters that {product-title-short} monitors.
| Days Since CVE Was First Discovered In System
| Integer
| ✕
| *Build*, +
*Deploy*, +
*Runtime* (when used with a Runtime criterion)
|===

[id="workload-config-criteria_{context}"]
== Workload configuration criteria

Container configuration::

[cols="<,<,<,<,^,<"]
|===
| *Attribute* | *Description* | *JSON Attribute* | *Allowed Values* | *Regex*, *NOT*, *AND, OR* | *Phase*

| Environment variable
| Check environment variables by name or value. When you create a policy that includes the environment variable attribute,
you can choose which types of environment variables the policy should match. For example, you can specify raw values, which are provided directly in the deployment YAML, or you can specify references to values from config maps, secrets, fields, or resource requests or limits.
For any type other than a raw value specified directly in the deployment YAML, the corresponding `value` attribute of the policy rule is ignored. In this case, the policy match is evaluated on the existence of the specified environment variable type. Additionally, this criteria disallows the creation of policies with a non-empty `value` attribute for types other than raw values.
| Environment Variable
a| RAW=key=value to match an environment variable as directly specified in the deployment YAML with a specific key and value. You can omit the `value` attribute to match on only the key. +

If the environment variable is not defined in the configuration YAML, then you can use the format `SOURCE=KEY`, where `SOURCE` is one of the following objects:

* SECRET_KEY (SecretKeyRef)
* CONFIG_MAP_KEY (ConfigMapRef)
* FIELD (FieldRef)
* RESOURCE_FIELD (ResourceFieldRef)

The preceding list provides the API object label first, and then provides the user interface label in parentheses.

| ! Regex only for key and value (if using RAW) +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Container CPU request
| Check for the number of cores reserved for a given resource.
| Container CPU Request
| <, >, <=, >= or nothing (which implies equal to) +

-- and --
 +
A decimal (a number with an optional fractional value) +

Examples: +
  >=5, or +
  9.5
| AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Container CPU limit
| Check for the maximum number of cores a resource is allowed to use.
| Container CPU Limit
| (Same as Container CPU Request)
| AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Container memory request
| Number, including fraction, of MB requested.
// Do we convert the K8s resource into MB (including convert MiB to MB) ? If so, the documentation should explain this conversion .
| Container Memory Request
| (Same as Container CPU Request)
| AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Container memory limit
| Check for the maximum amount of memory a resource is allowed to use.
| Container Memory Limit
| (Same as Container CPU Request)
| AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Privileged container
| Check if a deployment is configured in privileged mode. This criterion only checks the value of the `privileged` field in the respective link:https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.28/#securitycontext-v1-core[Pod Security Context].
| Privileged Container
| Boolean: `true` when the value of the `privileged` field in the respective `PodSecurityContext` is set to `true`
| ✕
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Root filesystem writeability
| Check if a deployment is configured in the `readOnlyFilesystem` mode.
| Read-Only Root Filesystem
| Boolean: `true` when the value of the `readOnlyRootFilesystem` field in the respective `PodSecurityContext` is set to `true`
| ✕
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Seccomp profile type
| The type of `seccomp` profile defined for the deployment. If `seccomp` options are provided at both the pod and container level, the container options override the pod options. See link:https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/pod-v1/#security-context-1[Security Context].
| Seccomp Profile Type
| One of: +

UNCONFINED +
RUNTIME_DEFAULT +
LOCALHOST
| ✕
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Privilege escalation
| Provides alerts when a deployment allows a container process to gain more privileges than its parent process.
| Allow Privilege Escalation
| Boolean
| ✕
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Drop capabilities
| Linux capabilities that must be dropped from the container. Provides alerts when the specified capabilities are not dropped.
For example, if configured with `SYS_ADMIN` AND `SYS_BOOT`, and the deployment drops only _one_ or _neither_ of these two capabilities, the alert occurs.
| Drop Capabilities +

| One of: +

ALL +
AUDIT_CONTROL +
AUDIT_READ +
AUDIT_WRITE +
BLOCK_SUSPEND +
CHOWN +
DAC_OVERRIDE +
DAC_READ_SEARCH +
FOWNER +
FSETID +
IPC_LOCK +
IPC_OWNER +
KILL +
LEASE +
LINUX_IMMUTABLE +
MAC_ADMIN +
MAC_OVERRIDE +
MKNOD +
NET_ADMIN +
NET_BIND_SERVICE +
NET_BROADCAST +
NET_RAW +
SETGID +
SETFCAP +
SETPCAP +
SETUID +
SYS_ADMIN +
SYS_BOOT +
SYS_CHROOT +
SYS_MODULE +
SYS_NICE +
SYS_PACCT +
SYS_PTRACE +
SYS_RAWIO +
SYS_RESOURCE +
SYS_TIME +
SYS_TTY_CONFIG +
SYSLOG +
WAKE_ALARM +
| AND
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Add capabilities
| Linux capabilities that must not be added to the container, such as the ability to send raw packets or override file permissions. Provides alerts when the specified capabilities are added. For example, if configured with `NET_ADMIN` or `NET_RAW`, and the deployment manifest YAML file includes at least one of these two capabilities, the alert occurs.
| Add Capabilities
|
AUDIT_CONTROL +
AUDIT_READ +
AUDIT_WRITE +
BLOCK_SUSPEND +
CHOWN +
DAC_OVERRIDE +
DAC_READ_SEARCH +
FOWNER +
FSETID +
IPC_LOCK +
IPC_OWNER +
KILL +
LEASE +
LINUX_IMMUTABLE +
MAC_ADMIN +
MAC_OVERRIDE +
MKNOD +
NET_ADMIN +
NET_BIND_SERVICE +
NET_BROADCAST +
NET_RAW +
SETGID +
SETFCAP +
SETPCAP +
SETUID +
SYS_ADMIN +
SYS_BOOT +
SYS_CHROOT +
SYS_MODULE +
SYS_PACCT +
SYS_PTRACE +
SYS_RAWIO +
SYS_RESOURCE +
SYS_TIME +
SYS_TTY_CONFIG +
SYSLOG +
WAKE_ALARM +
| OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Container name
| The name of the container.
| Container Name
| String
| Regex, +
NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| AppArmor profile
| The Application Armor ("AppArmor") profile used in the container.
| AppArmor Profile
| String
| Regex, +
NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Liveness probe
| Whether the container defines a liveness probe.
| Liveness Probe
| Boolean
| ✕
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Readiness probe
| Whether the container defines a readiness probe.
| Readiness Probe
| Boolean
| ✕
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)
|===

Deployment metadata::

[cols="<,<,<,<,^,<"]
|===
| *Attribute* | *Description* | *JSON Attribute* | *Allowed Values* | *Regex*, *NOT*, *AND, OR* | *Phase*

| Disallowed annotation
| An annotation which is not allowed to be present on Kubernetes resources in a specified environment.
| Disallowed Annotation
| key=value +

Value is optional. +

If value is missing, it must be in format "key=".
| Regex, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Required label
| Check for the presence of a required label in Kubernetes.
| Required Label
| key=value +

Value is optional. +

If value is missing, it must be in format "key=".
| Regex, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Required annotation
| Check for the presence of a required annotation in Kubernetes.
| Required Annotation
| key=value +

Value is optional. +

If value is missing, it must be in format "key=".
| Regex, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Runtime class
| The `RuntimeClass` of the deployment.
| Runtime Class
| String
| Regex, +
NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Host network
| Check if `HostNetwork` is enabled which means that the container is not placed inside a separate network stack (for example, the container's networking is not containerized). This implies that the container has full access to the host's network interfaces.
| Host Network
| Boolean
| ✕
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Host PID
| Check if the Process ID (PID) namespace is isolated between the containers and the host. This allows for processes in different PID namespaces to have the same PID.
| Host PID
| Boolean
| ✕
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Host IPC
| Check if the IPC (POSIX/SysV IPC) namespace (which provides separation of named shared memory segments, semaphores and message queues) on the host is shared with containers.
| Host IPC
| Boolean
| ✕
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Namespace
| The name of the namespace the deployment belongs to.
| Namespace
| String
| Regex, +
NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Replicas
| The number of deployment replicas. If you use `oc scale` to scale the deployment replicas from 0 to a number, then the admission controller blocks this action if the deployment violates a policy.
| Replicas
| <, >, <=, >= or nothing (which implies equal to) +

-- and --
 +
a decimal (a number with an optional fractional value). +

Examples: +
>=5, or +
9.5
| NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)
|===

Storage::

[cols="<,<,<,<,^,<"]
|===
| *Attribute* | *Description* | *JSON Attribute* | *Allowed Values* | *Regex*, *NOT*, *AND, OR* | *Phase*

| Volume name
| Name of the storage.
| Volume Name
| String
| Regex, +
NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Volume source path
| The  volume's path on the host.
| Volume Source
| String
| Regex, +
NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Volume destination path
| The path where the volume is mounted.
| Volume Destination
| String
| Regex, +
NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Volume type
| Indicates the form in which the volume is provisioned. For example, `persistentVolumeClaim` or `hostPath`.
| Volume Type
| String
| Regex, +
NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Mounted volume writability
| Volumes that are mounted as writable.
| Writable Mounted Volume
| Boolean
| ✕
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Mount propagation
| Check if container is mounting volumes in `Bidirectional`, `Host to Container`, or `None` modes.
| Mount Propagation
| One of: +

NONE +
HOSTTOCONTAINER +
BIDIRECTIONAL +
| NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Host mount writability
| Resource has mounted a path on the host with write permissions.
| Writable Host Mount
| Boolean
| ✕
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

6+| *Section: Networking*

| Exposed port protocol
| Protocol, such as TCP or UDP, that is used by the exposed port.
| Exposed Port Protocol
| String
| Regex, +
NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Exposed node port
| Port numbers exposed externally by a deployment.
| Exposed Node Port
| (Same as Exposed Port)
| NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Exposed port
| Port numbers exposed by a deployment.
| Exposed Port
| <, >, <=, >= or nothing (which implies equal to) +

-- and --
 +
an integer. +

Examples: +
>=1024, or +
22
| NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Port exposure method
| Exposure method of the service, for example, load balancer or node port.
| Port Exposure Method
| One of: +

Route +
LoadBalancer +
NodePort +
HostPort +
Exposure type is not set +
| NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Ingress network policy
| Check the presence or absence of ingress Kubernetes network policies.
| Has Ingress Network Policy
| Boolean
| Regex, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Egress network policy
| Check the presence or absence of egress Kubernetes network policies.
| Has Egress Network Policy
| Boolean
| Regex, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)
|===

Access control::

[cols="<,<,<,<,^,<"]
|===
| *Attribute* | *Description* | *JSON Attribute* | *Allowed Values* | *Regex*, *NOT*, *AND, OR* | *Phase*

| Service account
| The name of the service account.
| Service Account
| String
| Regex, +
NOT, +
AND, OR
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Automount service account token
| Check if the deployment configuration automatically mounts the service account token.
| Automount Service Account Token
| Boolean
| ✕
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

| Minimum RBAC permissions
| Match if the deployment's Kubernetes service account has Kubernetes RBAC permission level equal to `=` or greater than `>` the specified level.
| Minimum RBAC Permissions
| One of: +

DEFAULT +
ELEVATED_IN_NAMESPACE +
ELEVATED_CLUSTER_WIDE +
CLUSTER_ADMIN
| NOT
| *Deploy*, +
*Runtime* (when used with a Runtime criterion)

|===

[id="reference-workload-activity-criteria_{context}"]
== Workload activity criteria

Process activity::

[cols="<,<,<,<,^,<"]
|===
| *Attribute* | *Description* | *JSON Attribute* | *Allowed Values* | *Regex*, *NOT*, *AND, OR* | *Phase*

| Process name
| Name of the process executed in a deployment.
| Process Name
| String
| Regex, +
NOT, +
AND, OR
| *Runtime* ONLY - Process

| Process ancestor
| Name of any parent process for a process executed in a deployment.
| Process Ancestor
| String
| Regex, +
NOT, +
AND, OR
| *Runtime* ONLY - Process

| Process arguments
| Command arguments for a process executed in a deployment.
| Process Arguments
| String
| Regex, +
NOT, +
AND, OR
| *Runtime* ONLY - Process

| Process UID
| Unix user ID for a process executed in a deployment.
| Process UID
| Integer
| NOT, +
AND, OR
| *Runtime* ONLY - Process

|===

Baseline deviation::

[cols="<,<,<,<,^,<"]
|===
| *Attribute* | *Description* | *JSON Attribute* | *Allowed Values* | *Regex*, *NOT*, *AND, OR* | *Phase*

| Unexpected network flow detected
| Check if the detected network traffic is part of the network baseline for the deployment.
| Unexpected Network Flow Detected
| Boolean
| ✕
| *Runtime* ONLY - Network

| Unexpected process executed
| Check deployments for which process executions are not listed in the deployment's locked process baseline.
| Unexpected Process Executed
| Boolean
| ✕
| *Runtime* ONLY - Process

|===

User issued container commands::

[cols="<,<,<,<,^,<"]
|===
| *Attribute* | *Description* | *JSON Attribute* | *Allowed Values* | *Regex*, *NOT*, *AND, OR* | *Phase*

| Kubernetes action
| The name of the Kubernetes action, such as `Pod Exec`.
| Kubernetes Resource
| One of: +

PODS_EXEC +
PODS_PORTFORWARD +
| ! `OR` only
| *Runtime* ONLY - Kubernetes Events

| Kubernetes API verb
| Do not use; not valid for runtime policies.
| Kubernetes API Verb
| N/A
| N/A
| N/A

| Kubernetes user name
| The name of the user who accessed the resource.
| Kubernetes User Name
| Alphanumeric with hyphens (-) and colon (:) only
| Regex, +
NOT, +
! `OR` only
| *Runtime* ONLY - Kubernetes Events

| Kubernetes user group
| The name of the group to which the user who accessed the resource belongs to.
| Kubernetes User Groups
| Alphanumeric with hyphens (-) and colon (:) only
| Regex, +
NOT, +
! `OR` only
| *Runtime* ONLY - Kubernetes Events

|===

[id="kube-resource-operations_{context}"]
== Audit log: Kubernetes resource operations

Resource operation (Required)::

[cols="<,<,<,<,^,<"]
|===
| *Attribute* | *Description* | *JSON Attribute* | *Allowed Values* | *Regex*, *NOT*, *AND, OR* | *Phase*

| Kubernetes API verb
| The Kubernetes API verb that is used to access the resource, such as `GET` or `POST`.
| Kubernetes API Verb
| One of: +

CREATE +
DELETE +
GET +
PATCH +
UPDATE +
| ! `OR` only
| *Runtime* ONLY - Audit Log

| Kubernetes resource type
| Type of the accessed Kubernetes resource.
| Kubernetes Resource
| One of: +

CONFIGMAPS +
SECRETS +
CLUSTERROLES +
CLUSTERROLEBINDINGS +
NETWORKPOLICIES +
SECURITYCONTEXTCONSTRAINTS +
EGRESSFIREWALLS

| ! `OR` only
| *Runtime* ONLY - Audit Log

|===

Resource attributes::

[cols="<,<,<,<,^,<"]
|===
| *Attribute* | *Description* | *JSON Attribute* | *Allowed Values* | *Regex*, *NOT*, *AND, OR* | *Phase*

| Kubernetes resource name
| The name of the accessed Kubernetes resource.
| Kubernetes Resource Name
| Alphanumeric with hyphens (-) and colon (:) only
| Regex, +
NOT, +
! `OR` only
| *Runtime* ONLY - Audit Log

| Kubernetes user name
| The name of the user who accessed the resource.
| Kubernetes User Name
| Alphanumeric with hyphens (-) and colon (:) only
| Regex, +
NOT, +
! `OR` only
| *Runtime* ONLY - Kubernetes Events

| Kubernetes user groups
| The name of the group to which the user who accessed the resource belongs to.
| Kubernetes User Groups
| Alphanumeric with hyphens (-) and colon (:) only
| Regex, +
NOT, +
! `OR` only
| *Runtime* ONLY - Kubernetes Events

| User agent
| The user agent that the user used to access the resource.
For example `oc`, or `kubectl`.
| User Agent
| String
| Regex, +
NOT, +
! `OR` only
| *Runtime* ONLY - Audit Log

| Source IP address
| The IP address from which the user accessed the resource.
| Source IP Address
| IPV4 or IPV6 address
| Regex, +
NOT, +
! `OR` only
| *Runtime* ONLY - Audit Log

| Is impersonated user
| Check if the request was made by a user that is impersonated by a service account or some other account.
| Is Impersonated User
| Boolean
| ✕
| *Runtime* ONLY - Audit Log

|===
