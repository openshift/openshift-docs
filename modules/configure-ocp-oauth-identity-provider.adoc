// Module included in the following assemblies:
//
// * operating/manage-user-access/configure-ocp-oauth.adoc
:_content-type: PROCEDURE
[id="configure-ocp-oauth-identity-provider_{context}"]
= Configuring {ocp} OAuth server as an identity provider

[role="_abstract"]
To integrate the built-in {ocp} OAuth server as an identity provider for {product-title-short}, use the instructions in this section.

.Prerequisites
* You must have the `AuthProvider` permission to configure identity providers in {product-title-short}.
* You must have already configured users and groups in {ocp} OAuth server through an identity provider. For information about the identity provider requirements, see link:https://docs.openshift.com/container-platform/4.9/authentication/understanding-identity-provider.html[Understanding identity provider configuration].

[NOTE]
====
The following procedure configures only a single main route named `central` for the {ocp} OAuth server.
====

.Procedure
. On the {product-title-short} portal, navigate to *Platform Configuration* -> *Access Control*.
. Click *Create auth provider* and select *OpenShift Auth* from the drop-down list.
. Enter a name for the authentication provider in the *Name* field.
. Assign a *Minimum access role* for users that access {product-title-short} using the selected identity provider. A user must have the permissions granted to this role or a role with higher permissions to log in to {product-title-short}.
+
[TIP]
====
For security, Red Hat recommends first setting the *Minimum access role* to *None* while you complete setup. Later, you can return to the *Access Control* page to set up more tailored access rules based on user metadata from your identity provider.
====

. Optional: To add access rules for users and groups accessing {product-title-short}, click *Add new rule* in the *Rules* section, then enter the rule information and click *Save*. You will need attributes for the user or group so that you can configure access. 
+
[TIP]
====
Group mappings are more robust because groups are usually associated with teams or permissions sets and require modification less often than users.
====
+

To get user information in {ocp}, you can use one of the following methods:
+
--
* Click *User Management* -> *Users* -> *<username*> -> *YAML*.
* Access the `k8s/cluster/user.openshift.io\~v1~User/<username>/yaml` file and note the values for `name`, `uid` (`userid` in {product-title-short}), and `groups`. 
* Use the {ocp} API as described in the _{ocp} API reference_.
--
+
The following configuration example describes how to configure rules for an *Admin* role with the following attributes:
+
--
** `name`: `administrator`
** `groups`: `["system:authenticated", "system:authenticated:oauth", "myAdministratorsGroup"]`
** `uid`: `12345-00aa-1234-123b-123fcdef1234`
--
+
You can add a rule for this administrator role using one of the following steps:
+
** To configure a rule for a name, select `name` from the *Key* drop-down list, enter `administrator` in the *Value* field, then select *Administrator* under *Role*.
** To configure a rule for a group, select `groups` from the *Key* drop-down list, enter `myAdministratorsGroup` in the *Value* field, then select *Admin* under *Role*.
** To configure a rule for a user name, select `userid` from the *Key* drop-down list, enter `12345-00aa-1234-123b-123fcdef1234` in the *Value* field, then select *Admin* under *Role*.

