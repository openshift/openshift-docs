// Module included in the following assemblies:
// install/ossm-installing-openshift-service-mesh.adoc

:_mod-docs-content-type: PROCEDURE
[id="deploying-book-info_{context}"]
= Deploying the Bookinfo application

.Prerequisites

* You have deployed a cluster on {ocp-product-title} 4.15 or later.
* You are logged in to the {ocp-product-title} web console as a user with the `cluster-admin` role.
* You have access to the {ocp-short-name} CLI (oc).
* You have installed the {SMProductName} Operator, created the {istio} resource, and the Operator has deployed {istio}.
* You have created IstioCNI resource, and the Operator has deployed the necessary IstioCNI pods.

.Procedure

. In the {ocp-product-title} web console, navigate to the *Home* -> *Projects* page.

. Click *Create Project*.

. Enter `bookinfo` in the *Project name* field.
+
The *Display name* and *Description* fields provide supplementary information and are not required. 

. Click *Create*.

. Apply the {Istio} discovery selector and injection label to the `bookinfo` namespace by entering the following command:
+
[source,terminal]
----
$ oc label namespace bookinfo istio-discovery=enabled istio-injection=enabled 
----
+
[NOTE]
====
In this example, the name of the Istio resource is `default`. If the Istio resource name is different, you must set the `istio.io/rev` label to the name of the Istio resource instead of adding the `istio-injection=enabled` label.
====

. Apply the `bookinfo` YAML file to deploy the `bookinfo` application by entering the following command:
+
[source,terminal]
----
oc apply -f https://raw.githubusercontent.com/istio/istio/release-1.23/samples/bookinfo/platform/kube/bookinfo.yaml -n bookinfo
----

.Verification

. Verify that the `bookinfo` service is available by running the following command:
+
[source,terminal]
----
$ oc get services -n bookinfo
----
+
.Example output
[source,terminal]
----
NAME          TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE
details       ClusterIP   172.30.137.21   <none>        9080/TCP   44s
productpage   ClusterIP   172.30.2.246    <none>        9080/TCP   43s
ratings       ClusterIP   172.30.33.85    <none>        9080/TCP   44s
reviews       ClusterIP   172.30.175.88   <none>        9080/TCP   44s
----

. Verify that the `bookinfo` pods are available by running the following command:
+
[source,terminal]
----
$ oc get pods -n bookinfo
----
+
.Example output
[source,terminal]
----
NAME                             READY   STATUS    RESTARTS   AGE
details-v1-698d88b-km2jg         2/2     Running   0          66s
productpage-v1-675fc69cf-cvxv9   2/2     Running   0          65s
ratings-v1-6484c4d9bb-tpx7d      2/2     Running   0          65s
reviews-v1-5b5d6494f4-wsrwp      2/2     Running   0          65s
reviews-v2-5b667bcbf8-4lsfd      2/2     Running   0          65s
reviews-v3-5b9bd44f4-44hr6       2/2     Running   0          65s
----
+
When the `Ready` columns displays `2/2`, the proxy sidecar was successfully injected. Confirm that `Running` appears in the `Status` column for each pod.

. Verify that the `bookinfo` application is running by sending a request to the `bookinfo` page. Run the following command:
+
[source,terminal]
----
$ oc exec "$(oc get pod -l app=ratings -n bookinfo -o jsonpath='{.items[0].metadata.name}')" -c ratings -n bookinfo -- curl -sS productpage:9080/productpage | grep -o "<title>.*</title>" 
----