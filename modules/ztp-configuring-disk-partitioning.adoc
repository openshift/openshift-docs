// Module included in the following assemblies:
//
// * scalability_and_performance/ztp_far_edge/ztp-advanced-install-ztp.adoc

:_module-type: PROCEDURE
[id="ztp-configuring-disk-partitioning_{context}"]
= Configuring disk partitioning with SiteConfig CRs

Create a persistent disk partition in the managed cluster by configuring the `SiteConfig` CR that you use to deploy the cluster. The values you specify must match the configuration of the underlying disk on the cluster host and must be established prior to cluster installation.

[NOTE]
====
Use persistent naming for devices to prevent reboot errors occuring when you have more than one disk and device names such as `/dev/sda` and `/dev/sdb`. You can use `rootDeviceHints` to choose the bootable device.
====

.Prerequisites

* You have installed the OpenShift CLI (`oc`).

* You have logged in as a user with `cluster-admin` privileges.

* Create a Git repository where you manage your custom site configuration data for use with GitOps Zero Touch Provisioning (ZTP). The repository must be accessible from the hub cluster and be defined as a source repository for the Argo CD application.

.Procedure

. Add the following YAML to the `SiteConfig` CR that you use to install the cluster:
+
[source,yaml]
----
nodes:
  - rootDeviceHints:
      wwn: "0x62cea7f05c98c2002708a0a22ff480ea" <1>
    diskPartition:
    - device: /dev/disk/by-id/wwn-0x62cea7f05c98c2002708a0a22ff480ea <2>
      partitions:
       - mount_point: /var/imageregistry <3>
         size: 102500 <4>
         start: 344844 <5>
----
<1> `wwn` is used here, but you can specify a different root device hint as required.
<2> This setting depends on the hardware. The setting can be a serial number or device name. The value must match the value set in `rootDeviceHints`.
<3> Mount point name. If you are configuring a local image registry, this value should match what you set in the related `PolicyGenTemplate` CR that configures the storage class.
<3> The minimum value for `size` is 102500 MiB.
<4> The minimum value for `start` is 25000 MiB. The total value of `size` and `start` must not exceed the disk size, or the installation will fail.

. Save the `SiteConfig` CR and push it to the site configuration repo.
+
The ZTP pipeline provisions the cluster using the `SiteConfig` CR  and configures the disk partition.
