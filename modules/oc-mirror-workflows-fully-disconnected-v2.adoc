// Module included in the following assemblies:
//
// * installing/disconnected_install/installing-mirroring-disconnected-v2.adoc

:_mod-docs-content-type: PROCEDURE
[id="oc-mirror-workflows-fully-disconnected-v2_{context}"]
= Mirroring an image set in a fully disconnected environment: Mirror-to-Disk and Disk-to-Mirror

In a fully disconnected environment, the mirror registry that the Openshift cluster can access is not reachable from the public internet. Following are the steps of the workflow:

. Mirror to disk: preparing an archive containing the image set that needs to be mirrored. This step requires internet access.
. A manual step, where the user transfers the archive to the network of the mirror registry (disconnected registry).
. Disk to mirror: from the environment that has access to the mirror registry, execute oc-mirror to mirror the image set from the archive to the target disconnected registry.

[id="mirror-to-disk-v2"]
== Mirroring from mirror to disk

You can use the oc-mirror plugin to generate an image set and save the contents to disk. The generated image set can then be transferred to the disconnected environment and mirrored to the target registry.

oc-mirror pulls the container images from the source specified in the image set configuration and pack them into a tar archive on disk (local directory).

.Procedure

. Copy the container images from the tar archive to a container registry.
+
[source,terminal]
----
$ oc mirror -c isc.yaml 
file://<file path> <1>
--v2
----
<1> Add the desired file path 

.Verification

. Navigate into the <file path> directory that was generated.
. Verify that the archive files have been generated.

.Next steps

* Configure your cluster to use the resources generated by oc-mirror.

[id="disk-mirror-v2"]
== Mirroring from disk to mirror

. Copy the container images from the tar archive to a container registry.
+
[source,terminal]
----
$ oc mirror -c isc.yaml --from file://<file path> docker://<mirror registry url> --v2
----

.Verification
. Navigate into the working-dir directory that was generated under <file path>.
. Navigate into the cluster-resources directory.
. Verify that YAML files are present for the `ImageDigestMirrorSet`, `ImageTagMirrorSet` and `CatalogSource` resources.

.Next steps

* Configure your cluster to use the resources generated by oc-mirror.
