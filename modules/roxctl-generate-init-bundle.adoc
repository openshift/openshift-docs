// Module included in the following assemblies:
//
// * installing/installing_helm/install-helm-customization.adoc
// * installing/install-ocp-operator.adoc
//
// You must declare the `topic-helm` or `topic-operator` attribute when using this module.
:_mod-docs-content-type: PROCEDURE
[id="roxctl-generate-init-bundle_{context}"]
= Generating an init bundle by using the roxctl CLI

ifeval::["{context}" == "init-bundle-cloud-other"]
:other:
endif::[]

ifeval::["{context}" == init-bundle-cloud-ocp"]
:openshift:
endif::[]

ifeval::["{context}" == "init-bundle-cloud-ocp-generate"]
:cloud-ocp-generate:
endif::[]

ifeval::["{context}" == "init-bundle-cloud-other-generate"]
:cloud-other-generate:
endif::[]

You can create an init bundle with secrets by using the `roxctl` CLI.

[NOTE]
====
You must have the `Admin` user role to create init bundles.
====

.Prerequisites

* You have configured the `ROX_API_TOKEN` and the `ROX_CENTRAL_ADDRESS` environment variables:

.. Set the `ROX_API_TOKEN` by running the following command:
+
[source,terminal]
----
$ export ROX_API_TOKEN=<api_token>
----

.. Set the `ROX_CENTRAL_ADDRESS` environment variable by running the following command:
+
[source,terminal]
----
$ export ROX_CENTRAL_ADDRESS=<address>:<port_number>
----

ifdef::cloud-ocp-generate,cloud-other-generate[]
[IMPORTANT]
====
In {product-title-managed-short}, when using `roxctl` commands that require the Central address, use the *Central instance address* as displayed in the *Instance Details* section of the {cloud-console}. For example, use `acs-ABCD12345.acs.rhcloud.com` instead of `acs-data-ABCD12345.acs.rhcloud.com`.
====
endif::cloud-ocp-generate,cloud-other-generate[]

.Procedure

* To generate a cluster init bundle containing secrets for Helm installations, run the following command:
+
[source,terminal]
----
$ roxctl -e "$ROX_CENTRAL_ADDRESS" \
  central init-bundles generate --output \
  <cluster_init_bundle_name> cluster_init_bundle.yaml
----

* To generate a cluster init bundle containing secrets for Operator installations, run the following command:
+
[source,terminal]
----
$ roxctl -e "$ROX_CENTRAL_ADDRESS" \
  central init-bundles generate --output-secrets \
  <cluster_init_bundle_name> cluster_init_bundle.yaml
----
+
[IMPORTANT]
====
Ensure that you store this bundle securely because it contains secrets.
You can use the same bundle to set up multiple secured clusters.
====

ifeval::["{context}" == "init-bundle-cloud-other"]
:!other:
endif::[]

ifeval::["{context}" == init-bundle-cloud-ocp"]
:!openshift:
endif::[]

ifeval::["{context}" == "init-bundle-cloud-ocp-generate"]
:!cloud-ocp-generate:
endif::[]

ifeval::["{context}" == "init-bundle-cloud-other-generate"]
:!cloud-other-generate:
endif::[]