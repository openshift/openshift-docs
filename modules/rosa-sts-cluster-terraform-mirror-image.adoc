// Module included in the following assemblies:
//
// * rosa_hcp/terraform/rosa-hcp-creating-a-cluster-quickly-terraform.adoc


// ifeval::["{context}" == "rosa-classic-creating-a-cluster-quickly-terraform"]
// :tf-rosa-classic:
// endif::[]
// ifeval::["{context}" == "rosa-hcp-creating-a-cluster-quickly-terraform"]
// :tf-rosa-hcp:
// endif::[]
:_mod-docs-content-type: CONCEPT

[id="rosa-sts-cluster-terraform-mirror-image_{context}"]
= Configuring image mirroring in Terraform for your {product-title} cluster

Terraform users can configure an image mirror for {product-title} clusters. This action creates a rule that redirects requests for container images from a public source to your internal corporate registries.

include::snippets/terraform-modification-disclaimer.adoc[]

.Procedure

. Add the following `rhcs_image_mirror` resource block to your Terraform configuration file (for example, `main.tf`), replacing the variable values with your specific requirements.
+
[source,terminal]
----
resource "rhcs_image_mirror" "corp_registry_explicit" {
  cluster_id = rhcs_cluster_rosa_hcp.my_cluster.id
  name       = "corp-registry-explicit"
  type       = "digest"

  source = "registry.example.com/team"
  mirrors = [
    "mirror.corp.com/team",
    "backup.corp.com/team"
  ]
 }
----

. Initialize the directory by running the following command:

+
[source,terminal]
----
$ terraform init
----
+
. Review the execution plan by running the following command:
+
[source,terminal]
----
$ terraform plan
----
+
. Once you have confirmed that only one resource (`rhcs_image_mirror`) will be added to your {product-title} cluster, and nothing will be changed or destroyed, run the following command to apply the changes:
+
[source,terminal]
----
$ terraform apply
----
+
. Click **Enter** to approve the changes.

The `ImageContentSourcePolicy` is now configured on your cluster, and the image mirror will be active.