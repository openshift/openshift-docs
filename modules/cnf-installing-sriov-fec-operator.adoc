// CNF-1498 Validate and Document Intel SRO and SRIOV FEC Operator
// Module included in the following assemblies:
//
// *cnf-optimize-data-performance-n3000.adoc

[id="cnf-installing-sriov-fec-operator_{context}"]
= Installing the OpenNESS SR-IOV Operator for Wireless FEC Accelerators

The role of the OpenNESS SR-IOV Operator for Wireless FEC Accelerators is to orchestrate and manage the devices exposed by a range of Intel vRAN FEC acceleration hardware within the {product-title} cluster.

One of the most compute-intensive 4G/LTE and 5G workloads is RAN layer 1 (L1) forward error correction (FEC). FEC resolves data transmission errors over unreliable or noisy communication channels. FEC technology detects and corrects a limited number of errors in 4G/LTE or 5G data without the need for retransmission.

The FEC devices are provided by the Intel FPGA PAC N3000 and the Intel vRAN Dedicated Accelerator ACC100 for the vRAN use case.

[NOTE]
====
The Intel FPGA PAC N3000 FPGA requires flashing with an 4G/LTE or 5G bitstream.
====

The OpenNESS SR-IOV Operator for Wireless FEC Accelerators provides functionality to create virtual functions (VFs) for the FEC device, binds them to appropriate drivers, and configures the VFs queues for functionality in 4G/LTE or 5G deployment.

As a cluster administrator, you can install the OpenNESS SR-IOV Operator for Wireless FEC Accelerators by using the {product-title} CLI or the web console.

[id="installing-sriov-fec-operator-using-the-cli_{context}"]
== Installing the OpenNESS SR-IOV Operator for Wireless FEC Accelerators by using the CLI

As a cluster administrator, you can install the OpenNESS SR-IOV Operator for Wireless FEC Accelerators by using the CLI.

.Prerequisites

* A cluster installed on bare-metal hardware.
* Install the OpenShift CLI (`oc`).
* Log in as a user with `cluster-admin` privileges.

.Procedure

. Create a namespace for the OpenNESS SR-IOV Operator for Wireless FEC Accelerators by completing the following actions:

.. Define the `vran-acceleration-operators` namespace by creating a file named `sriov-namespace.yaml` as shown in the following example:
+
[source,yaml]
----
apiVersion: v1
kind: Namespace
metadata:
    name: vran-acceleration-operators
    labels:
       openshift.io/cluster-monitoring: "true"
----

.. Create the namespace by running the following command:
+
[source,terminal]
----
$ oc create -f sriov-namespace.yaml
----

. Install the OpenNESS SR-IOV Operator for Wireless FEC Accelerators in the namespace you created in the previous step by creating the following objects:

.. Create the following `OperatorGroup` CR and save the YAML in the `sriov-operatorgroup.yaml` file:
+
[source,yaml]
----
apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
    name: vran-operators
    namespace: vran-acceleration-operators
spec:
    targetNamespaces:
      - vran-acceleration-operators
----

.. Create the `OperatorGroup` CR by running the following command:
+
[source,terminal]
----
$ oc create -f sriov-operatorgroup.yaml
----

.. Run the following command to get the `channel` value required for the next step.
+
[source,terminal]
----
$ oc get packagemanifest sriov-fec -n openshift-marketplace -o jsonpath='{.status.defaultChannel}'
----
+
.Example output
[source,terminal]
----
stable
----

.. Create the following Subscription CR and save the YAML in the `sriov-sub.yaml` file:
+
[source,yaml]
----
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
    name: sriov-fec-subscription
    namespace: vran-acceleration-operators
spec:
    channel: "<channel>" <1>
    name: sriov-fec
    source: certified-operators <2>
    sourceNamespace: openshift-marketplace
----
<1> Specify the value for channel from the value obtained in the previous step for the `.status.defaultChannel` parameter.
<2> You must specify the `certified-operators` value.

.. Create the `Subscription` CR by running the following command:
+
[source,terminal]
----
$ oc create -f sriov-sub.yaml
----

.Verification

* Verify that the Operator is installed:
+
[source,terminal]
----
$ oc get csv -n vran-acceleration-operators -o custom-columns=Name:.metadata.name,Phase:.status.phase
----
+
.Example output
[source,terminal]
----
Name                                        Phase
sriov-fec.v1.1.0                            Succeeded
----

[id="installing-openness-sriov-fec-operator-using-web-console_{context}"]
== Installing the OpenNESS SR-IOV Operator for Wireless FEC Accelerators by using the web console

As a cluster administrator, you can install the OpenNESS SR-IOV Operator for Wireless FEC Accelerators by using the web console.

[NOTE]
====
You must create the `Namespace` and `OperatorGroup` CR as mentioned in the previous section.
====

.Procedure

. Install the OpenNESS SR-IOV Operator for Wireless FEC Accelerators by using the {product-title} web console:

.. In the {product-title} web console, click *Operators* -> *OperatorHub*.

.. Choose *OpenNESS SR-IOV Operator for Wireless FEC Accelerators* from the list of available Operators, and then click *Install*.

.. On the *Install Operator* page, select *All namespaces on the cluster*. Then, click *Install*.

. Optional: Verify that the SRIOV-FEC Operator is installed successfully:

.. Switch to the *Operators* -> *Installed Operators* page.

.. Ensure that *OpenNESS SR-IOV Operator for Wireless FEC Accelerators* is listed in the *vran-acceleration-operators* project with a *Status* of *InstallSucceeded*.
+
[NOTE]
====
During installation an Operator might display a *Failed* status. If the installation later succeeds with an *InstallSucceeded* message, you can ignore the *Failed* message.
====
+
If the console does not indicate that the Operator is installed, perform the following troubleshooting steps:
+
* Go to the *Operators* -> *Installed Operators* page and inspect the *Operator Subscriptions* and *Install Plans* tabs for any failure or errors
under *Status*.
* Go to the *Workloads* -> *Pods* page and check the logs for pods in the `vran-acceleration-operators` project.
