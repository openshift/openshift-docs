[id="sbo-understanding-the-consumption-of-binding-metadata_{context}"]
= Understanding the consumption of binding metadata

For projecting metadata, by default, files are mounted at a specific directory in your workload resource. You can configure the directory path using the existing `SERVICE_BINDING_ROOT` environment variable setup in the container where your workload runs.

.Example
----
$SERVICE_BINDING_ROOT <1>
├── account-database <2>
│   ├── type <3>
│   ├── provider <4>
│   ├── uri
│   ├── username
│   └── password
└── transaction-event-stream <2>
    ├── type
    ├── connection-count
    ├── uri
    ├── certificates
    └── private-key
----
<1> Root directory.
<2> Directory that stores the binding metadata.
<3> Mandatory identifier that identifies the type of the binding metadata.
<4> An optional identifier to identify the provider so that the application can identify the type of  backing service it can connect to.

For projecting metadata as environment variables, you can use the built-in language feature of your programming language of choice to read environment variables.

[NOTE]
====
The container must restart to update the values of environment variables if there is a change in the `Secret` resource.
====

.Example: Python client usage
----
import os
username = os.getenv("USERNAME")
password = os.getenv("PASSWORD")
----

== Computation of the final path for projecting the binding metadata

The following table summarizes the configuration of how the final path for metadata projection is computed when files are mounted at a specific directory, by default:

.Summary of the final path computation
[cols="1,1",options="header"]
|===
| `SERVICE_BINDING_ROOT` | Final path

| Not available
| `/bindings/<ServiceBinding_ResourceName>`

| `dir/path/root`
| `dir/path/root/<ServiceBinding_ResourceName>`

|===

In the previous table, the `<ServiceBinding_ResourceName>` entry specifies the name of the `ServiceBinding` resource that you configure in the `.metadata.name` section of the custom resource definition (CRD).

For accessing the binding metadata within the existing `SERVICE_BINDING_ROOT` environment variable, you can use the built-in language feature of your programming language of choice to read environment variables.

.Example: Python client usage
----
from pyservicebinding import binding
try:
    sb = binding.ServiceBinding()
except binding.ServiceBindingRootMissingError as msg:
    # log the error message and retry/exit
    print("SERVICE_BINDING_ROOT env var not set")
sb = binding.ServiceBinding()
bindings_list = sb.bindings("postgresql")
----

In the previous example, the `bindings_list` parameter contains the binding metadata for the `postgresql` database service type.
