// Module included in the following assemblies:
//
// * networking/network_security/network_policy/creating-network-policy.adoc

:_mod-docs-content-type: PROCEDURE
[id="nw-networkpolicy-configuring-internet-egress-pods_{context}"]
= Configuring internet egress for pods

With the deny all egress network policy created in a namespace, pods within that namespace are made incapable of reaching _out_ to the internet. In most cases, at least some pods within a namespace will need the able to reach external traffic. 

The following procedure shows you how to designate labels to pods that require internet egress.

.Prerequisites

* You have created a network policy to deny all egress traffic.

.Procedure

. Create the following `internet-egress.yaml` file that both defines a network policy that allows traffic from pods with the matching label to access internet egress. For example:
+
[source,yaml]
----
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: internet-egress
spec:
  podSelector:
    matchLabels:
      networking/allow-internet-egress: "true" <1>
  egress:
  - {}
  policyTypes:
  - Egress
----

. Apply the network policy by entering the following command:
+
[source,terminal]
----
$ oc apply -f internet-egress.yaml -n <namespace_a>
----
+
.Example output
+
[source,terminal]
----
networkpolicy.networking.k8s.io/internet-egress created
----
+
Repeat this step for each namespace that requires this network policy.

. Apply the `allow-internet-egress` label to pods that require egress by entering the following command:
+
[source,terminal]
----
$ oc label pod <pod_name> networking/allow-internet-egress=true -n <namespace_a>
----
+
.Example output
+
[source,terminal]
----
pod/<pod_name> labeled
----
+
Repeat this step for each pod that requires internet egress. 

.Verification

* Check whether a labeled pod in a namespace where you applied the `internet-egress.yaml` network policy can resolve a DNS name by entering the following command:
+
[source,terminal]
----
$ oc exec -it <pod_name> -n <namespace_a> -- nslookup google.com
----
+
.Example output
+
[source,terminal]
----
...
Name:	google.com
Address: 142.250.125.102
...
----
