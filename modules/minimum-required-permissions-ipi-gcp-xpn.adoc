// Module included in the following assemblies:
//
// * installing/installing_gcp/installing-gcp-account.adoc

:_mod-docs-content-type: PROCEDURE
[id="minimum-required-permissions-ipi-gcp-xpn_{context}"]
= Required {gcp-short} permissions for shared VPC installations

When you are installing a cluster to a link:https://cloud.google.com/vpc/docs/shared-vpc[shared VPC], you must configure the service account for both the host project and the service project.

[IMPORTANT]
====
You can use granular permissions for a Cloud Credential Operator that operates in either Manual or Mint credentials mode. For more information about the minimum permissions required for a standard installation that is configured with either of these credentials modes, see "Required Google Cloud permissions for installer-provisioned infrastructure".

You cannot use granular permissions in Passthrough credentials mode. For more information about the minimum roles required, see "Required Google Cloud roles".
====

If you are not installing to a shared Virtual Private Cloud (VPC), you can skip the procedure.

[IMPORTANT]
====
When installing a cluster on shared Virtual Private Cloud (VPC) infrastructure and you want to manually create credentials, grant the `compute.subnetworks.use` permission on the host project to the credentials that the Machine API Operator uses.
====

Ensure that the host project applies one of the following configurations to the service account:

.Required permissions for creating firewalls in the host project
[source,text]
----
* `projects/<host-project>/roles/dns.networks.bindPrivateDNSZone`
* `roles/compute.networkAdmin`
* `roles/compute.securityAdmin`
----

.Required permissions for deleting firewalls in the host project
[source,text]
----
* `compute.firewalls.delete`
* `compute.networks.updatePolicy`
----

.Required minimal permissions
[source,text]
----
* `projects/<host-project>/roles/dns.networks.bindPrivateDNSZone`
* `roles/compute.networkUser`
----

If you do not supply a service account for control plane nodes in the `install-config.yaml` file, please grant the below permissions to the service account in the host project. If you do not supply a service account for compute nodes in the `install-config.yaml` file, please grant the below permissions to the service account in the host project for cluster destruction.

[source,text]
----
* `resourcemanager.projects.getIamPolicy`
* `resourcemanager.projects.setIamPolicy`
----

