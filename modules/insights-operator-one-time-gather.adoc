// Module included in the following assemblies:
//
// * support/remote_health_monitoring/remote-health-reporting-from-restricted-network.adoc



[id="insights-operator-one-time-gather_{context}"]
= Running an Insights Operator gather operation 

From {product-title} 4.8 and above, you must first run a one-time gathering operation to create an Insights Operator archive.

.Prerequisites

* {product-title} 4.8

.Procedure

. Create a file named `gather-job.yaml` using this template:
+
[source,yaml]
----
include::https://raw.githubusercontent.com/openshift/insights-operator/release-4.8/docs/gather-job.yaml[]
----
. Get your `insights-operator` image version:
+
[source,terminal]
----
$ oc get -n openshift-insights deployment insights-operator -o yaml
----
. Find and enter your image version in `gather-job.yaml`:
+
[source,yaml]
----
initContainers:
      - name: insights-operator
        image: <your_insights_operator_image_version>
        terminationMessagePolicy: FallbackToLogsOnError
        volumeMounts:
----
. Create the gather job:
+
[source,terminal]
----
$ oc apply -n openshift-insights -f gather-job.yaml
----
. Find the name of the job pod:
+
[source,terminal]
----
$ oc describe -n openshift-insights job/insights-operator-job
----
+
.Example output
[source,terminal]
----
Events:
  Type    Reason            Age    From            Message
  ----    ------            ----   ----            -------
  Normal  SuccessfulCreate  7m18s  job-controller  Created pod: insights-operator-job-<your_job> 
----
Where `insights-operator-job-<your_job>` is the name of the pod. 

. Verify the operation has finished:
+
[source,terminal]
----
$ oc logs -n openshift-insights insights-operator-job-<your_job> insights-operator
----
+
.Example output
[source,terminal]
----
I0407 11:55:38.192084       1 diskrecorder.go:34] Wrote 108 records to disk in 33ms  
----
. Save the created archive:
+
[source,terminal]
----
$ oc cp openshift-insights/insights-operator-job-<your-job>:/var/lib/insights-operator ./insights-data
----
. Cleanup the job:
+
[source,terminal]
----
$ oc delete -n openshift-insights job insights-operator-job
----

