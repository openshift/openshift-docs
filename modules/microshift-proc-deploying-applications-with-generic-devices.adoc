// Module included in the following assemblies:
//
// microshift_configuring/microshift-gdp.adoc

:_mod-docs-content-type: PROCEDURE
[id="microshift-deploying-applications-with-generic-devices_{context}"]
= Deploying applications that use generic devices

After the Generic Device Plugin (GDP) is configured and enabled in {microshift-short}, you can deploy Kubernetes workloads, such as pods, deployments, or `StatefulSets`, that request access to the host devices that you have exposed. Devices are made available inside the container without requiring the pod to run with elevated privileges.

.Prerequisites

* You installed {microshift-short}.
* You enabled and configured GDP.
* You installed {oc-first}.

.Procedure

. Define the device request in your `Pod` specification:
+
[source,yaml]
----
apiVersion: v1
kind: Pod
metadata:
  name: device-app
spec:
  containers:
  - name: container
    image: <your_application_image> <1>
    command: ["/path/to/your/app"] <2>
    args: ["--device_path=/dev/video0"] <3>
    resources:
      limits: <4>
        device.microshift.io/video: 1 <5>
    securityContext: <6>
      allowPrivilegeEscalation: false
      capabilities:
        drop: ["ALL"]
      runAsNonRoot: true
      seccompProfile:
        type: "RuntimeDefault"  
----
<1> Replace with your container image.
<2> Replace with the command for your application.
<3> For example, how your application might use the device.
<4> The resource name must follow the pattern `device.microshift.io/<device_name>`, where `<device_name>` matches the `name` that you specified in your configuration file.
<5> A request for one instance of the `video` device.
<6> Define and configure with the least privilege value to ensure that the container has only required permissions, such as access to the device file, and to restrict other capabilities for the container.
+
. Deploy the Kubernetes workload by applying the manifest to the {microshift-short} cluster by running the following command:
+
[source,terminal,subs="+quotes"]
----
$ oc apply -f _<your-workload-manifest.yaml>_ <1>
----
<1> Replace _<your_workload_manifest>_ with the name of your workload manifest.

.Results

After the pod is running, the specified host device is available at its original path, or `mountPath` if specified, inside the container. Your application can then interact with it as if it were a local device.

For example, if you requested `device.microshift.io/serial`, which maps to `/dev/ttyUSB*`, your application might find the device at `/dev/ttyUSB0` or a similar path inside the container.

.Verification

* Verify device access by running the following command inside the running pod:
+
[source,terminal,subs="+quotes"]
----
$ oc exec -it _<pod_name>_ -- ls -l /dev/video0 <1>
----
<1> Replace _<pod_name>_ with the name of the pod.
+