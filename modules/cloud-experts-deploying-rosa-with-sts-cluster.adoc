// Module included in the following assemblies:
//
// * cloud_experts_tutorials/cloud-experts-getting-started/cloud-experts-rosa-sts-explained.adoc

:_mod-docs-content-type: PROCEDURE
[id="cloud-experts-deploying-rosa-with-sts-cluster_{context}"]
= Deploying a {product-title} STS cluster

[role="_abstract"]
You are not expected to create the resources listed in the below steps from scratch. The {product-title} CLI creates the required JSON files for you and outputs the commands you need. The {product-title} CLI can also take this a step further and run the commands for you, if desired.

.Procedure
. Steps to deploy a {product-title} with STS cluster
. Create the account-wide roles and policies.
. Assign the permissions policy to the corresponding account-wide role.
. Create the cluster.
. Create the Operator roles and policies.
. Assign the permission policy to the corresponding Operator role.
. Create the OIDC provider.
+
The roles and policies can be created automatically by the {product-title} CLI, or they can be manually created by utilizing the `--mode manual` or `--mode auto` flags in the {rosa-cli}.
. Scaling the cluster: The `machine-api-operator` uses link:https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html[AssumeRoleWithWebIdentity] to assume the `machine-api-aws-cloud-credentials` role. This launches the sequence for the cluster Operators to receive the credentials. The `machine-api-operator` role can now make the relevant API calls to add more EC2 instances to the cluster.