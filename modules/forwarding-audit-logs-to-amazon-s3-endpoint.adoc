:_newdoc-version: 2.18.4
:_template-generated: 2025-10-06
:_mod-docs-content-type: PROCEDURE

[id="forwarding-audit-logs-to-amazon-s3-endpoint_{context}"]
= Forwarding audit logs to Amazon s3 endpoint

You can forward audit logs to an S3 endpoint to retain them for longer periods with reduced costs when compared to Cloudwatch. Additionally, you might want to forward audit logs to an S3 endpoint when the log size exceeds the size limits of CloudWatch.  

.Prerequisites
* {clo} has been installed.
* You have configured a credential secret.
* You have administrator access to {product-title}.
* You have configured cross account access with AssumeRole.

.Procedure

. Create an S3 bucket on the host platform.

. Grant IAM Role the permissions to write to the S3 bucket.

. Create or update a `ClusterLogForwarder` custom resource (CR):
+
[source,yaml]
----
apiVersion: observability.openshift.io/v1
kind: ClusterLogForwarder
metadata:
  name: <log_forwarder_name>
  namespace: openshift-logging
spec:
  serviceAccount:
    name: <service_account_name>  #<1>
  outputs:
  - name: s3-output  #<2>
    type: s3  #<3>
    s3:
      url: <alternate_url>  #<4>
      region: <region>  #<5>
      bucket: <S3_bucket>  #<6>
      keyPrefix: <templated_string>  #<7>
      authentication:
        type:
        awsAccessKey:  #<8>
          assumeRole:  #<9>
            roleARN:   
            externalID: <secret_reference> 
        iamRole:  #<10>
          roleARN:  
          token:   
        assumeRole:  #<11>
          roleARN: <sercret_reference> 
          externalID: 
  pipelines:
    - name: to-s3
      inputRefs:
        - audit
      outputRefs: 
        - s3-output
----
<1> Specify the service account.
<2> Specify a name for the output.
<3> Specify the `s3` type.
<4> TODO
<5> TODO
<6> TODO
<7> TODO
<8> Specify `awsAccessKey` as the authentication type for STS.
<9> TODO
<10> Specify `iamRole` as the authentication type for STS.
<11> Specify `assumeRole` as the authentication type for STS.

////
.Verification
Delete this section if it does not apply to your module. Provide the user with verification methods for the procedure, such as expected output or commands that confirm success or failure.

* Provide an example of expected command output or a pop-up window that the user receives when the procedure is successful.
* List actions for the user to complete, such as entering a command, to determine the success or failure of the procedure.
* Make each step an instruction.
* Use an unnumbered bullet (*) if the verification includes only one step.

.Troubleshooting
Delete this section if it does not apply to your module. Provide the user with troubleshooting steps.

* Make each step an instruction.
* Use an unnumbered bullet (*) if the troubleshooting includes only one step.

.Next steps
* Delete this section if it does not apply to your module.
* Provide a bulleted list of links that contain instructions that might be useful to the user after they complete this procedure.
* Use an unnumbered bullet (*) if the list includes only one step.

NOTE: Do not use *Next steps* to provide a second list of instructions.

[role="_additional-resources"]
.Additional resources
* link:https://github.com/redhat-documentation/modular-docs#modular-documentation-reference-guide[Modular Documentation Reference Guide]
* xref:some-module_{context}[]
////
