// Module included in the following assemblies:
//
// * osd_cluster_create/managing-byo-vpc-multiple-az.adoc

[id="byo-vpc-multiple-az_{context}"]
= Configuring subnets for a VPC with multiple availability zones

For virtual private clouds (VPC) with multiple availability zones, you must do the following for each availability zone:

* Configure a public and private subnet.
* Create the appropriate routing rule and NAT gateway.

.Procedure

. Create six subnets for three separate zones as follows:
+
[cols="3",options="header"]
|===
| Availability zone | Subnet name | CIDR IP address
| A | `publicA`  | `10.0.0.0/19`
| A | `privateA` | `10.0.96.0/19`
| B | `publicB`  | `10.0.32.0/19`
| B | `privateB` | `10.0.128.0/19`
| C | `publicC`  | `10.0.64.0/19`
| C | `privateC` | `10.0.160.0/19`
|===
+
[NOTE]
====
Each availability zone has one public subnet and one private subnet.
====

. Create a route table that has an association with the three public subnets.
. Create three NAT gateways in the subnet:
.. On the `publicA` subnet, create a NAT gateway with an elastic internet address (EIP). Name this gateway `privateA`.
.. On the `publicB` subnet, create a NAT gateway with an elastic internet address (EIP). Name this gateway `privateB`.
.. On the `publicC` subnet, create a NAT gateway with an elastic internet address (EIP). Name this gateway `privateC`.
+
[NOTE]
====
AWS has a default limit of five EIPs per region.
====
+
. Create a routing rule on the route table that is associated with each of the public subnets for IP address `0.0.0.0/0` to the internet gateway you created.

.Additional resources

* For information on route table association, see link:https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Route_Tables.html#RouteTables[Route tables for your VPC] in the AWS documentation.
