// Module included in the following assemblies:
//
// * argocd_applications/managing-apps-in-non-control-plane-namespaces.adoc

:_mod-docs-content-type: PROCEDURE
[id="gitops-creating-and-configuring-user-defined-appproject-instance-with-target-namespaces_{context}"]
= Creating and configuring a user-defined AppProject instance with the target namespaces

[role="_abstract"]
As a cluster administrator, you can define a certain set of non-control plane namespaces in which users can create, update, and reconcile `Application` resources. After you configure your user-defined cluster-scoped Argo CD instance with target namespaces, you must create and configure a user-defined `AppProject` instance in the `openshift-gitops` control plane namespace. In addition, you must explicitly configure the target namespaces in the `.spec.sourceNamespaces` field of the user-defined `AppProject` instance.

[NOTE]
====
Applications in the {gitops-shortname} control plane namespace (`openshift-gitops`) are allowed to set their `.spec.project` field to reference any `AppProject` instance, regardless of the restrictions placed by the `.spec.sourceNamespaces` field in the `AppProject` custom resource (CR).
====

.Prerequisites
* You are logged in to the {OCP} cluster as an administrator.
* You have installed {gitops-title} 1.13.0 or a later version on your {OCP} cluster.

.Procedure

. Create and configure a user-defined `AppProject` instance in the `openshift-gitops` control plane namespace to specify the target namespaces in the `.spec.sourceNamespaces` field:
.. From the *Project* list, select the `openshift-gitops` project.
.. In the *Administrator* perspective of the web console, click *Operators* -> *Installed Operators* -> *{gitops-title}* and go to the *AppProject* tab.
.. Click *Create AppProject* and enter the following configuration in the YAML view:
+
.Example user-defined `AppProject` instance
[source,yaml]
----
kind: AppProject
apiVersion: argoproj.io/v1alpha1
metadata:
  name: project-one # <1>
  namespace: openshift-gitops # <2>
spec:
  sourceNamespaces: # <3>
  - dev # <4>
  - app-team-* # <5>
  destinations: # <6>
    - name: '*'
      namespace: '*'
      server: '*'
   sourceRepos: # <7>
    - '*'     
----
<1> The name of the user-defined `AppProject` instance.
<2> The control plane namespace where you want to run the user-defined `AppProject` instance.
<3> The list of non-control plane namespaces for creating and managing `Application` resources.
<4> The name of the target namespace for the Argo CD server to create and manage `Application` resources.
<5> With wildcards (`pass:[*]`), specifies the name of the target namespaces matching the pattern `app-team-pass:[*]`, such as `app-team-1` and `app-team-2`, for the Argo CD server to create and manage `Application` resources.
<6> References to the clusters and namespaces into which applications within the user-defined `AppProject` instance can deploy.
<7> References to the repositories from which applications within the user-defined `AppProject` instance can pull manifests.
.. Click *Create*.
+
The *AppProjects* page displays the created user-defined `AppProject` instance.
