:_newdoc-version: 2.18.4
:_template-generated: 2025-10-27
:_mod-docs-content-type: PROCEDURE

[id="forwarding-logs-to-amazon-s3-endpoint_{context}"]
= Forwarding logs to Amazon S3 endpoint

You can collect logs by using the {clo} and forward them to an S3 configured endpoint.

.Prerequisites
* You have installed {clo}.
* You have configured a credential secret.
* You have administrator access to {ocp-product-title}.
* You have installed {oc-first}

.Procedure

. Create or update a `ClusterLogForwarder` custom resource (CR):
+
[source,yaml]
----
apiVersion: observability.openshift.io/v1
kind: ClusterLogForwarder
metadata:
  name: <log_forwarder_name>
  namespace: openshift-logging
spec:
  serviceAccount:
    name: <service_account_name>
  outputs:
   - name: s3-output
     type: s3
     s3:
       keyPrefix: 's3{.log_type||"missing"}'
       bucket: <bucket_name>
       region: us-east-2
       authentication:
         type: iamRole
         iamRole:
           roleARN:
             key: role_arn 
             secretName: sts-secret
           token:
             from: serviceAccount  
  pipelines:
    - name: to-s3
      inputRefs:
        - infrastructure
        - audit
        - application
      outputRefs:
        - s3-output
----
+
* `keyPrefix`: Defines the S3 key prefix for log objects.
You can use static or dynamic values consisting of field paths separated by `||` and ending with a static fallback value.
* `bucket`: Specifies the S3 bucket name where logs will be stored. 

. Apply the `ClusterLogForwarder` CR by running the following command:
+
[source,terminal]
----
$ oc apply -f <filename>.yaml
----
