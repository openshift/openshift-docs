// Module is included in the following assemblies:
//
// * installing_gitops/preparing-gitops-install.adoc

:_mod-docs-content-type: CONCEPT
[id="sizing-requirements-for-gitops_{context}"]
= Sizing requirements for {gitops-shortname}

[role="_abstract"]
{gitops-title} is a declarative way to implement continuous deployment for cloud-native applications. Through GitOps, you can define and configure the CPU and memory requirements of your application.

Every time you install the {gitops-title} Operator, the resources on the namespace are installed within the defined limits. If the default installation does not set any limits or requests, the Operator fails within the namespace with quotas. Without enough resources, the cluster cannot schedule ArgoCD related pods. The following table details the resource requests and limits for the default workloads:

[cols="2,2,2,2,2",options="header"]
|===
|Workload |CPU requests |CPU limits |Memory requests |Memory limits
|openshift-gitops-application-controller |250m |2 |1024Mi |2048Mi
|applicationset-controller |250m |2 |512Mi |1024Mi
|openshift-gitops-server |125m |500m |128Mi |256Mi
|openshift-gitops-repo-server |250m |1 |256Mi |1024Mi
|openshift-gitops-redis |250m |500m |128Mi |256Mi
|openshift-gitops-dex-server |250m |500m |128Mi |256Mi
|openshift-gitops-redis-ha-haproxy |250m |500m |128Mi |256Mi
|===

Optionally, you can also use the ArgoCD custom resource with the `oc` command to see the specifics and modify them:

[source,terminal]
----
oc edit argocd <name of argo cd> -n namespace
----

[id="sizing-requirements-for-argocd-redis_{context}"]
== Sizing requirements for argocd-redis

During the capacity planning stage for your application in the {gitops-title} Operator, you must ensure that an adequate amount of resources, such as memory, CPU, and storage, are allocated for the `argocd-redis` pod.

The default memory limit for the Redis pod might not be enough to manage a large number of resources. In these instances, you must increase the memory limit, monitor the memory metrics, and change the memory configuration while the application deployment scales up.

The following command shows the example of the memory configuration for a Redis pod in the `openshift-gitops` namespace:
[source,terminal]
----
$ oc get argocd -n openshift-gitops openshift-gitops -o json | jq '.spec.redis.resources'
----

.Example Output
[source,terminal]
----
{
    "limits": { #<1>
        "cpu": "500m",
        "memory": "256Mi"
  },
  "requests": { #<2>
    "cpu": "250m",
    "memory": "128Mi"
  }
}
----
<1> The highest resource limit threshold allocated to the pod.
<2> The lowest resource limit threshold allocated to the pod.

The following example command changes the memory configuration for a Redis pod. The highest resource limit threshold is set to 8 GiB and the lowest is set to 256 MiB.
[source,terminal]
----
$ oc patch argocd -n openshift-gitops openshift-gitops --type json -p '[{"op": "replace", "path":  \
  "/spec/redis/resources/limits/memory", "value": "8Gi"}, {"op": "replace", "path": \
  "/spec/redis/resources/requests/memory", "value": "256Mi"}]'
----

.Example Output
[source,terminal]
----
argocd.argoproj.io/openshift-gitops patched
----