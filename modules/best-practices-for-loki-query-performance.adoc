// Module included in the following assemblies:
//
// * configuring/loki-query-performance-troubleshooting.adoc


:_newdoc-version: 2.18.4
:_template-generated: 2025-09-25
:_mod-docs-content-type: CONCEPT

[id="best-practices-for-loki-query-performance_{context}"]
= Best practices for Loki query performance

You can take the following steps to improve Loki query performance:

* Ensure that you are running the latest version of the {loki-op}.

* Ensure that you have migrated LokiStack schema to the `v13` version.

* Ensure that you use reliable and fast object storage. Loki is a database capable of doing a tremendous amount of work on object storage.
If you are not using an object store solution from a cloud provider, use Solid state-drive (SSD) for your object storage.
By using SSDs you can benefit from the high parallelization capabilities of Loki.
+
To better understand the utilization of object storage by Loki, you can use the following query in the *Metrics* dashboard in the {ocp-product-title} web console:
+
[source]
----
sum by(status, container, operation) (label_replace(rate(loki_s3_request_duration_seconds_count{namespace="openshift-logging"}[5m]), "status", "${1}xx", "status_code", "([0-9]).."))
----

* Ensure that automatic stream sharding is enabled for Loki. For information see link:https://docs.redhat.com/en/documentation/red_hat_openshift_logging/latest/html/configuring/configuring-the-log-store#enabling-automatic-stream-sharding_configuring-the-log-store[Enabling automatic stream sharding].

* If you use the OpenTelemetry Protocol (OTLP) data model, you can configure additional stream labels in LokiStack. For more information, see link:https://docs.redhat.com/en/documentation/red_hat_openshift_logging/latest/html/configuring/configuring-the-log-store#best-practices-for-loki-labels_loki-query-performance-troubleshooting[Best practices for Loki labels].

* Different types of queries have different performance characteristics. Use simple filter queries instead of regular expressions for better performance.

[role="_additional-resources"]
.Additional resources
* link:https://docs.redhat.com/en/documentation/red_hat_openshift_logging/latest/html/about_openshift_logging/index/analyzing-loki-query-performance_loki-query-performance-troubleshooting[Analyzing Loki query performance]
