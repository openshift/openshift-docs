// Module included in the following assemblies:
//
// * networking/enabling-automatic-egress-ips.adoc

[id="enabling-automatic-egress-ips-{context}"]
= Enabling automatic egress IPs for a namespace

In {product-title} you can enable automatic egress IPs for a specific namespace
across one or more nodes.

.Prerequisites

* Install the OpenShift Command-line Interface (CLI), commonly known as `oc`.
* You must be logged in to the cluster with the `cluster-admin` role.

.Procedure

. Update the `NetNamespace` with the egress IP address using the following JSON:
+
----
 $ oc patch netnamespace <project_name> \ <1>
  -p '{
    "egressIPs": [
      "<ip_address>" <2>
      ]
    }'
----
<1> Specify the name of the project.
<2> Specify an egress IP address.
+
For example, to assign `project1` to an IP address of 192.168.1.100 and
`project2` to an IP address of 192.168.1.101:
+
----
$ oc patch netnamespace project1 -p '{"egressIPs": ["192.168.1.100"]}'
$ oc patch netnamespace project2 -p '{"egressIPs": ["192.168.1.101"]}''
----
+
. Indicate which nodes can host egress IP addresses by setting their
`egressCIDRs` fields using the following JSON:
+
----
$ oc patch hostsubnet <node_name> -p \ <1>
  '{
    "egressCIDRs": [
      "<ip_address_range_1>", "<ip_address_range_2>" <2>
    ]
  }'
----
<1> Specify a node name.
<2> Specify one or more IP address ranges in CIDR format.
+
For example, to set `node1` and `node2` to host egress IP addresses
in the range 192.168.1.0 to 192.168.1.255:
+
----
$ oc patch hostsubnet node1 -p '{"egressCIDRs": ["192.168.1.0/24"]}'
$ oc patch hostsubnet node2 -p '{"egressCIDRs": ["192.168.1.0/24"]}'
----
+
. {product-title} automatically assigns specific egress IP addresses to
available nodes, in a balanced way. In this case, it assigns the egress IP
address 192.168.1.100 to `node1` and the egress IP address 192.168.1.101 to
`node2` or vice versa.
