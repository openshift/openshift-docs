// Module included in the following assemblies:
// * serverless-logic/serverless-logic-upgrading-operator-from-1.34-to-1.35


:_mod-docs-content-type: PROCEDURE
[id="serverless-logic-upgrade-deleting-migrating-workflows-with-preview-profile_{context}"]
= Deleting and migrating workflows with the preview profile

Before upgrading the Operator, you must delete workflows running with the `Preview` profile, and migrate any data that is persisted. When the upgrade is completed, you must redeploy the workflows.

.Procedure

. If you are using persistence, back up the workflow database and ensure the backup includes both database objects and table data.

. Ensure you have a backup of all necessary Kubernetes resources, including `SonataFlow` CRDs, `ConfigMaps`, or any other related custom configurations.

. Delete the workflow by executing the following command: 
+
[source,terminal]
----
$ oc delete -f <my-workflow.yaml> -n <target_namespace>
----

. If you are using persistence, you must execute the following database migration script:
+
[source,sql]
----
ALTER TABLE flyway_schema_history
    RENAME CONSTRAINT flyway_schema_history_pk TO kie_flyway_history_runtime_persistence_pk;

ALTER INDEX flyway_schema_history_s_idx
  RENAME TO kie_flyway_history_runtime_persistence_s_idx;

ALTER TABLE flyway_schema_history RENAME TO kie_flyway_history_runtime_persistence;
----