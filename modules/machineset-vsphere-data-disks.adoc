
// Module included in the following assemblies:
//
// * machine_management/creating_machinesets/creating-machineset-vsphere.adoc
// * machine_management/control_plane_machine_management/cpmso_provider_configurations/cpmso-config-options-vsphere.adoc

:_mod-docs-content-type: PROCEDURE
[id="machineset-vsphere-data-disks_{context}"]
= Configuring data disks by using machine sets

{product-title} clusters on {vmw-first} support adding up to 29 disks to controller of a virtual machine (VM).
By configuring data disks, you can attach disks to VMs to separate data for such things as etcd, container images, etc allowing for the primary disk to not become full preventing important activities such as upgrades or to ensure performance of certain activities.

[NOTE]
====
Adding the disks will attach them to the VM, but will not mount them to any specific location other than the one designated by RHCOS.
Each machine will need to be configured to use them according to your needs.
====

:FeatureName: Configuring vSphere Data Disks
include::snippets/technology-preview.adoc[]

.Prerequisites

* You have administrator access to {oc-first} for an {product-title} cluster on {vmw-short}.

.Procedure

. In a text editor, open the YAML file for an existing machine set or create a new one.

. Edit the following lines under the providerSpec field:
+
[source,yaml]
----
tag::compute[]
apiVersion: machine.openshift.io/v1beta1
kind: MachineSet
end::compute[]
tag::controlplane[]
apiVersion: machine.openshift.io/v1
kind: ControlPlaneMachineSet
end::controlplane[]
# ...
spec:
  template:
    spec:
      providerSpec:
        value:
          dataDisk: <1>
          - name: "<disk_name>" <2>
            provisioningMode: "<mode>" <3>
            sizeGiB: 20 <4>
# ...
----
<1> The collection of data disk definitions.
<2> The name of the data disk with a max length of 80.
<3> The data disk provisioning method. This value defaults to the vSphere default storage policy if not set. Valid values are `Thin`, `Thick`, or `EagerlyZeroed`
<4> The size of the data disk in GiB. Max allowed size 16384 GiB.

