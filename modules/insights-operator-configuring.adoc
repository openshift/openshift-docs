// Module included in the following assemblies:
//
// * support/remote_health_monitoring/using-insights-operator.adoc


:_mod-docs-content-type: CONCEPT
[id="insights-operator-configuring_{context}"]
= Configuring Insights Operator

Insights Operator configuration is a combination of the default Operator configuration and the configuration that is stored in either the *insights-config* `ConfigMap` object in the `openshift-insights` namespace, OR in the support secret in the `openshift-config` namespace. 

When a `ConfigMap` object or support secret exists, the contained attribute values override the default Operator configuration values. If both a `ConfigMap` object _and_ a support secret exist, the Operator reads the `ConfigMap` object.

The `ConfigMap` object does not exist by default, so an {product-title} cluster administrator must create it. 

//[NOTE]
//====
//Red Hat Insights encourages cluster administrators to use the config-map configuration method. Support secrets will continue to be supported in the near future but will eventually be deprecated.
//====

.ConfigMap object configuration structure
This example of an *insights-config* `ConfigMap` object (`config.yaml` configuration) shows configuration options by using standard YAML formatting.

image::insights-operator-configmap-example.png[Example of Insights Operator ConfigMap object]

.Configurable attributes and default values
The following table describes the available configuration attributes:

[NOTE]
====
The *insights-config* `ConfigMap` object follows standard YAML formatting, wherein child values are below the parent attribute and indented two spaces. For the *Obfuscation* attribute, enter values as bulleted children of the parent attribute.
====

.Insights Operator configurable attributes
[options="header"]
[cols=".^2l,.^3a,.^1a,.^1a",options="header"]
|====
|Attribute name|Description|Value type|Default value

|enableGlobalObfuscation
|Enables the global obfuscation of IP addresses and the cluster domain name.
|Boolean
|`false`

|endpoint
|Sets the upload endpoint.
|URL
|https://console.redhat.com/api/ingress/v1/upload

|clusterTransferEndpoint
|The endpoint for checking and downloading cluster transfer data.
|URL
|https://api.openshift.com/api/accounts_mgmt/v1/cluster_transfers/

|clusterTransferInterval
|Sets the frequency for checking available cluster transfers.
|Time interval
|`24h`

|conditionalGathererEndpoint
|Sets the endpoint for providing conditional gathering rule definitions.
|URL
|https://console.redhat.com/api/gathering/gathering_rules

|httpProxy, 
 httpsProxy, 
 noProxy
|Set custom proxy for Insights Operator.
|URL
|No default

|interval 
|Sets the data gathering and upload frequency.
|Time interval
|`2h`

|reportEndpoint 
|Specifies the endpoint for downloading the latest Insights analysis. For the specified default value, ensure that you replace `<cluster_id>` with the unique identified, cluster ID, of your cluster.
|URL
|https://console.redhat.com/api/insights-results-aggregator/v2/cluster/<cluster_id>/reports

|reportPullingDelay
|Sets the delay between data upload and data download.
|Time interval
|`60s`

|reportPullingTimeout 
|Sets the timeout value for the Insights download request.
|Time interval
|`30s`

|reportMinRetryTime 
|Sets the time for when to retry a request.
|Time interval
|`30s`

|scaEndpoint 
|Specifies the endpoint for downloading the simple content access (SCA) entitlements.
|URL
|https://api.openshift.com/api/accounts_mgmt/v1/entitlement_certificates

|scaInterval
|Specifies the frequency of the simple content access entitlements download.
|Time interval
|`8h`

|scaPullDisabled
|Disables the simple content access entitlements download.
|Boolean
|`false`
|====

:_mod-docs-content-type: PROCEDURE
[id="creating-insights-config-configmap_{context}"]
== Creating the insights-config ConfigMap object

This procedure describes how to create the *insights-config* `ConfigMap` object for the Insights Operator to set custom configurations.

[IMPORTANT]
====
Red Hat recommends you consult Red Hat Support before making changes to the default Insights Operator configuration.
====

.Prerequisites

* Remote health reporting is enabled, which is the default.
* You are logged in to the {product-title} web console as a user with `cluster-admin` role.

.Procedure

. Go to *Workloads* -> *ConfigMaps* and select *Project: openshift-insights*.
. Click *Create ConfigMap*.
. Select *Configure via: YAML view* and enter your configuration preferences, for example
+
[source,yaml]
----
apiVersion: v1
kind: ConfigMap
metadata:
  name: insights-config
  namespace: openshift-insights
data:
  config.yaml: |
    dataReporting:
      obfuscation:
        - networking
        - workload_names
    sca:
      disabled: false
      interval: 2h
    alerting:
       disabled: false
binaryData: {}
immutable: false
----

. Optional: Select *Form view* and enter the necessary information that way.
. In the *ConfigMap Name* field, enter *insights-config*.
. In the *Key* field, enter *config.yaml*.
. For the *Value* field, either browse for a file to drag and drop into the field or enter your configuration parameters manually.
. Click *Create* and you can see the `ConfigMap` object and configuration information.