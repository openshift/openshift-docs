// Module included in the following assemblies:
//
// * installing/installing_oci/installing-oci-assisted-installer.adoc

:_mod-docs-content-type: PROCEDURE
[id="provision-oci-infrastructure-ocp-cluster_{context}"]
= Provisioning {oci} infrastructure for your cluster - 1

By using the {ai-full} to create details for your {product-title} cluster, you can specify these details in a stack. A stack is an {oci} feature where you can automate the provisioning of all necessary {oci} infrastructure resources, such as the custom image, that are required for installing an {product-title} cluster on {oci}.

The {oci-first} Compute Service creates a virtual machine (VM) instance on {oci}. This instance can then automatically attach to a virtual network interface controller (vNIC) in the virtual cloud network (VCN) subnet. On specifying the IP address of your {product-title} cluster in the custom manifest template files, the {oci} instance can communicate with your cluster over the VCN.

.Prerequisites

* You downloaded the discovery ISO image to a local directory. For more information, see "Using the {ai-full} to generate an {oci}-compatible discovery ISO image".

.Procedure

. Log in to your link:https://cloud.oracle.com/a/[{oci-first-no-rt}] account.

. Upload the discovery ISO image from your local drive to the new object storage bucket you created. For details, see link:https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/managingobjects_topic-To_upload_objects_to_a_bucket.htm[Uploading an Object Storage Object to a Bucket]. 

. Create a Pre-Authenticated Request for the ISO image in *Object Storage*. For details, see link:https://docs.oracle.com/iaas/Content/Object/Tasks/usingpreauthenticatedrequests.htm[Pre-Authenticated Requests for Object Storage]. The URL is used for the OpenShift Image Source URI in the next step.

. Create the terraform stack:
+
[NOTE]
====
 The terraform stack includes files for creating cluster resources and custom manifests. The stack also includes a script, and when you run apply the stack, the script creates OCI resources, such as DNS records, an instance, and so on.
====
+
--
.. Upload the terraform stack template to the new object storage bucket.

.. Complete the stack information and click *Next*. 
+
[IMPORTANT]
====
* Make sure that *Cluster Name* matches *Cluster Name* in {ai-full}, and *Zone DNS* matches *Base Domain* in {ai-full}. 
* In the *openshift_image_source_uri* field, paste the Pre-Authenticated Request URL link that you generated in the previous step. 
* Ensure that the correct *Compute Shape* field value is defined, depending on whether you are installing on bare metal or a virtual machine. For details, see link:docs.oracle.com/en-us/iaas/Content/Compute/References/computeshapes.htm[Compute Shapes (Oracle documentation)]. *not sure if they have to add something here or if it is defined automatically*
====
--
+
For details, see link:https://docs.oracle.com/en-us/iaas/Content/openshift-on-oci/installing-assisted.htm#install-cluster-apply-stack[Creating OpenShift Container Platform Infrastructure Using Resource Manager (Oracle documentation)].

. Get the `custom_manifest.yml` file:
+
[NOTE]
====
This YAML file contains all the required manifests, concatenated and preformatted with the configuration values for CCM and CSI. For clusters deployed on bare-metal instance (BMI) nodes using iSCSI, two additional manifests are included that provide a second vNIC to be used for the iSCSI service.
====
+
--
.. Open the stack and select *Outputs*. 
.. Copy the `custom_manifest.yml` file and contents. 
--
+
For details, see TBD.*waiting for them to publish so I can provide a link*
