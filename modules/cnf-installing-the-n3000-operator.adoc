// CNF-1498 Validate and Document Intel SRO and SRIOV FEC Operator
// Module included in the following assemblies:
//
// *cnf-optimize-data-performance-n3000.adoc

[id="installing-the-n3000-operator_{context}"]
= Installing the OpenNESS Operator for Intel FPGA PAC N3000

The OpenNESS Operator for Intel FPGA PAC N3000 orchestrates and manages the resources or devices exposed by the Intel FPGA PAC N3000 card within the {product-title} cluster.

For vRAN use cases, the OpenNESS Operator for Intel FPGA PAC N3000 is used with the OpenNESS Operator for Wireless FEC Accelerators.

As a cluster administrator, you can install the OpenNESS Operator for Intel FPGA PAC N3000 by using the {product-title} CLI or the web console.

[id="install-operator-cli_{context}"]
== Installing the Operator by using the CLI

As a cluster administrator, you can install the Operator by using the CLI.

.Prerequisites

* A cluster installed on bare-metal hardware.
* Install the OpenShift CLI (`oc`).
* Log in as a user with `cluster-admin` privileges.

.Procedure

. Create a namespace for the N3000 Operator by completing the following actions:

.. Define the `vran-acceleration-operators` namespace by creating a file named `n3000-namespace.yaml` file as shown in the following example:
+
[source,yaml]
----
apiVersion: v1
kind: Namespace
metadata:
    name: vran-acceleration-operators
    labels:
        openshift.io/cluster-monitoring: "true"
----

.. Create the namespace by running the following command:
+
[source,terminal]
----
$ oc create -f n3000-namespace.yaml
----

. Install the N3000 Operator in the namespace you created in the previous step:

.. Create the following `OperatorGroup` CR and save the YAML in the `n3000-operatorgroup.yaml` file:
+
[source,yaml]
----
apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
    name: n3000-operators
    namespace: vran-acceleration-operators
spec:
    targetNamespaces:
    - vran-acceleration-operators
----

.. Create the `OperatorGroup` CR by running the following command:
+
[source,terminal]
----
$ oc create -f n3000-operatorgroup.yaml
----

.. Run the following command to get the `channel` value required for the next step.
+
[source,terminal]
----
$ oc get packagemanifest n3000 -n openshift-marketplace -o jsonpath='{.status.defaultChannel}'
----
+
.Example output
[source,terminal]
----
stable
----

.. Create the following `Subscription` CR and save the YAML in the `n3000-sub.yaml` file:
+
[source,yaml]
----
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
    name: n3000-subscription
    namespace: vran-acceleration-operators
spec:
    channel: "<channel>"        <1>
    name: n3000
    source: certified-operators <2>
    sourceNamespace: openshift-marketplace
----
<1> Specify the value for channel from the value obtained in the previous step for the `.status.defaultChannel` parameter.
<2> You must specify the `certified-operators` value.

.. Create the `Subscription` CR by running the following command:
+
[source,terminal]
----
$ oc create -f n3000-sub.yaml
----

.Verification

* Verify the Operator is installed:
+
[source,terminal]
----
$ oc get csv
----
+
.Example output
[source,terminal]
----
NAME            DISPLAY                                         VERSION  REPLACES    PHASE
n3000.v1.1.0    OpenNESS Operator for IntelÂ® FPGA PAC N3000     1.1.0                Succeeded
----
+
You have now successfully installed the Operator.

[id="install-n3000operator-web-console_{context}"]
== Installing the OpenNESS Operator for Intel FPGA PAC N3000 Operator by using the web console

As a cluster administrator, you can install the OpenNESS Operator for Intel FPGA PAC N3000 by using the web console.

[NOTE]
====
You must create the `Namespace` and `OperatorGroup` CR as mentioned in the previous section.
====

.Procedure

. Install the OpenNESS Operator for Intel FPGA PAC N3000 by using the {product-title} web console:

.. In the {product-title} web console, click *Operators* -> *OperatorHub*.

.. Choose *OpenNESS Operator for Intel FPGA PAC N3000* from the list of available Operators, and then click *Install*.

.. On the *Install Operator* page, select *All namespaces on the cluster*. Then, click *Install*.

. Optional: Verify that the N3000 Operator is installed successfully:

.. Switch to the *Operators* -> *Installed Operators* page.

.. Ensure that *OpenNESS Operator for Intel FPGA PAC N3000* is listed in the *vran-acceleration-operators* project with a *Status* of *InstallSucceeded*.
+
[NOTE]
====
During installation, an Operator might display a *Failed* status. If the installation later succeeds with an *InstallSucceeded* message, you can ignore the *Failed* message.
====
+
If the console does not indicate that the Operator is installed, perform the following troubleshooting steps:
+
* Go to the *Operators* -> *Installed Operators* page and inspect the *Operator Subscriptions* and *Install Plans* tabs for any failure or errors
under *Status*.
* Go to the *Workloads* -> *Pods* page and check the logs for pods in the `vran-acceleration-operators` project.
