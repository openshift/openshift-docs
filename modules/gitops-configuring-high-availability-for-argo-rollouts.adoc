// Module included in the following assemblies:
//
// * argo_rollouts/enabling-ha-support-for-argo-rollouts.adoc

:_mod-docs-content-type: PROCEDURE
[id="gitops-configuring-high-availability-for-argo-rollouts_{context}"]
= Configuring high availability for Argo Rollouts

[role="_abstract"]
To enable high availability, configure the `ha` specification in the `RolloutManager` custom resource (CR) by completing the following steps:

.Procedure

.  Log in to the {OCP} web console as a cluster administrator. 

. In the *Administrator* perspective, click *Operators* -> *Installed Operators*.

. Create or select the project where you want to create and configure a `RolloutManager` CR from the *Project* drop-down menu.

. Select *{gitops-title}* from the installed Operators.

. In the *Details* tab, under the *Provided APIs* section, click *Create instance* in the *RolloutManager* pane.

. On the *Create RolloutManager* page, select the *YAML view* and edit the YAML.
+
.Example enabling the `ha` field in the `RolloutManager` CR
[source,yaml]
----
apiVersion: argoproj.io/v1alpha1
kind: RolloutManager
metadata:
  name: argo-rollouts
  namespace: openshift-gitops
spec:
  ha:
    enabled: true #<1>
----
<1> Specifies whether high availability is enabled or not. If the value is set to `true`, high availability is enabled.

. Click *Create*.

. In the *RolloutManager* tab, under the *RolloutManagers* section, verify that the *Status* field of the RolloutManager instance shows *Phase: Available*.

. Verify the status of the Rollouts deployment by completing the following steps:
.. In the *Administrator* perspective, click *Workloads* -> *Deployments*.
.. Click the *argo-rollouts* deployment.
+
.. Click the *Details* tab and confirm that the number of replicas in the Rollouts deployment is now set to 2. 
.. Click the *YAML* tab and confirm that the following configuration is displayed:
+
.Example Argo Rollouts deployment configuration file
[source,yaml]
----
kind: Deployment
metadata:
  name: argo-rollouts
  namespace: openshift-gitops
spec:
  replicas: 2 #<1>
  selector:
    matchLabels:
      app.kubernetes.io/name: argo-rollouts
  template:
    metadata:
      creationTimestamp: null
      labels:
        app.kubernetes.io/name: argo-rollouts
    spec:
      containers:
          args:
            - '--leader-elect'
            - 'true' #<2>
----
<1> Specifies the number of pods.
<2> Specifies that the `--leader-elect=true` flag is passed to the Rollouts deployment. Although this flag is set to `true` by default, explicitly setting it ensures that leader election remains consistently enforced.
