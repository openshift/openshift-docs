// Module included in the following assemblies:
//
// * logging/log_collection_forwarding/cluster-logging-collector.adoc

:_mod-docs-content-type: PROCEDURE
[id="cluster-logging-collector-tolerations_{context}"]
= Using taints and tolerations to control log collector pod placement

You can specify which nodes the logging collector pods run on, and prevent other workloads from using those nodes, by configuring taints and tolerations.

You apply tolerations to logging collector pods by modifying the `ClusterLogging` custom resource (CR), and apply taints to a node through the node specification. You can use taints and tolerations to ensure that the pod is not evicted due to memory or CPU issues.

By default, logging collector pods have the following toleration:

[source,yaml]
----
apiVersion: logging.openshift.io/v1
kind: ClusterLogging
# ...
spec:
  collection:
# ...
    tolerations:
    - key: "node-role.kubernetes.io/master"
      operator: "Exists"
      effect: "NoExecute"
# ...
----

.Prerequisites

* You have installed the {clo}.

.Procedure

. Use the following command to add a taint to a node where you want logging collector pods to schedule logging collector pods:
+
[source,terminal]
----
$ oc adm taint nodes <node_name> <key>=<value>:<effect>
----
+
For example:
+
[source,terminal]
----
$ oc adm taint nodes node1 collector=node:NoExecute
----
+
This example places a taint on `node1` that has key `collector`, value `node`, and taint effect `NoExecute`. You must use the `NoExecute` taint effect. `NoExecute` schedules only pods that match the taint and removes existing pods that do not match.

. Edit the `collection` stanza of the `ClusterLogging` custom resource (CR) to configure a toleration for the logging collector pods. The following example toleration configuration matches the taint created by the `oc adm taint` command. A pod with this toleration schedules onto `node1`.
+
.Example toleration configuration
[source,yaml]
----
apiVersion: logging.openshift.io/v1
kind: ClusterLogging
# ...
spec:
  collection:
    type: vector
    tolerations:
    - key: "node.kubernetes.io/disk-pressure" # <1>
      operator: "Exists" # <2>
      effect: "NoSchedule" # <3>
      tolerationSeconds: 6000 # <4>
# ...
----
<1> Specify the key that you added to the node.
<2> Specify the `Exists` operator to require the `key`/`value`/`effect` parameters to match.
<3> Specify the `NoSchedule` effect.
<4> Optional. Specify the `tolerationSeconds` parameter to set how long a pod can remain bound to a node before being evicted.
