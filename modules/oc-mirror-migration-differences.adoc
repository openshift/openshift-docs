// Module included in the following assemblies:
//
// * disconnected/mirroring/oc-mirror-migration-v1-to-v2.adoc

:_mod-docs-content-type: CONCEPT
[id="oc-mirror-migration-differences_{context}"]
= Changes from oc-mirror plugin v1 to v2

Before migrating from oc-mirror plugin v1 to v2, see the following differences between oc-mirror plugin v1 and v2:

* Explicit version selection: Users must explicitly specify `--v2` when using `oc-mirror`. If no version is specified, v1 is executed by default. This behavior is expected to change in future releases, where `--v2` will be the default.

* Updated commands: Commands for mirroring workflows have changed to align with oc-mirror plugin v2's new workflow.

** For mirror-to-disk, run the following command:
+
[source,terminal]
----
$ oc-mirror --config isc.yaml file://<directory_name> --v2
----

** For disk-to-mirror, run the following command:
+
[source,terminal]
----
$ oc-mirror --config isc.yaml --from file://<directory_name> docker://<remote_registry> --v2
----

** For mirror-to-mirror, run the following command:
+
[source,terminal]
----
$ oc-mirror --config isc.yaml --workspace file://<directory_name> docker://<remote_registry> --v2
----
+
[NOTE]
====
`--workspace` is now required for mirror-to-mirror operation.
====

* API version update: The `ImageSetConfiguration` API version changes from `v1alpha2` (v1) to `v2alpha1` (v2). You must manually update the configuration files before migration.

* Configuration changes: 
- `storageConfig` must be removed in oc-mirror plugin v2. 
- Incremental mirroring is now handled automatically through the working directory or local cache.

* Changes in results directory: All custom resources to be applied to the disconnected cluster are generated in the `<workspace_path>/working-dir/cluster-resources` directory after the migration.
- Outputs in oc-mirror plugin v2 are not stored in the same location as oc-mirror plugin v1.
- You must check the `cluster-resources` folder under the working directory for the following resources:
** `ImageDigestMirrorSet` (IDMS)
** `ImageTagMirrorSet` (ITMS)
** `CatalogSource`
** `ClusterCatalog`
** `UpdateService`

* Workspace and directory naming: Follow the new oc-mirror v2 convention to prevent any potential data inconsistencies when transitioning between versions.
- The oc-mirror plugin v1 `oc-mirror-workspace` directory is no longer needed.
- Use a new directory for oc-mirror plugin v2 to avoid conflicts.

* Replacing `ImageContentSourcePolicy` (ICSP) resources with IDMS/ITMS:
+
[IMPORTANT]
====
Deleting all `ImageContentSourcePolicy` (ICSP) resources might remove configurations unrelated to oc-mirror.

To avoid unintended deletions, identify ICSP resources generated by oc-mirror before removing them. If you are unsure, check with your cluster administrator. For more information, see "Mirroring images for a disconnected installation by using the oc-mirror plugin v2".
====

- In oc-mirror plugin v2, the ICSP resource is replaced by `ImageDigestMirrorSet` (IDMS) and `ImageTagMirrorSet` (ITMS) resources.