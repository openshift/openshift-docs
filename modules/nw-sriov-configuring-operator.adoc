// Module included in the following assemblies:
//
// * networking/multiple-networks/configuring-sr-iov.adoc

[id="configuring-sr-iov-operator_{context}"]
= Configuring the operator

The SR-IOV Network Operator adds the `SriovOperatorConfig.sriovnetwork.openshift.io` Custom Resource Definition (CRD) to {product-title}.
You can configure the SR-IOV software compoenents by modifying the default 
SriovOperatorConfig Custom Resource (CR).

[NOTE]
=====
A SriovOperatorConfig Custom Resource is created when the
operator is running. Change the operator config by modifying this pre-created CR.
=====

== Disabling the Network Resource Injector

Network Resource Injector is a Kubernetes Dynamic Admission Controller 
application that provides functionality for patching pod specifications with 
requests and limits of custom network resources managed by the SRIOV network device plugin.

By default the Network Resource Injector is enabled by the operator. You can follow this to disable it.

.Prerequisites

* Install the OpenShift Command-line Interface (CLI), commonly known as `oc`.
* Log in as a user with `cluster-admin` privileges.
* You must have installed the SR-IOV Operator.

.Procedure
. Update the default SriovOperatorConfig Custom Resource
+
[source,bash]
----
oc patch sriovoperatorconfig default --patch '{ "spec": { "enableInjector": false}}' --type=merge
----

== Disabling SRIOV Operator Admission Control Webhook
The SRIOV Operator Admission Control Webhook a Kubernetes Dynamic 
Admission Controller application that:

* Validates the SriovNetworkNodePolicy Custom Resource when it is being created or
updated.
* Mutates the SriovNetworkNodePolicy Custom Resource by setting the default 
value to `priority` and `deviceType` when it is being created or updated.

By default the SRIOV Operator Admission Control Webhook will be enabled by the
operator. You can follow this procedure to disable it.

.Prerequisites

* Install the OpenShift Command-line Interface (CLI), commonly known as `oc`.
* Log in as a user with `cluster-admin` privileges.
* You must have installed the SR-IOV Operator.

.Procedure
. Update the default SriovOperatorConfig Custom Resource
+
[source,bash]
----
oc patch sriovoperatorconfig default --patch '{ "spec": { "enableOperatorWebhook": false}}' --type=merge
----

== Configuring Custom NodeSelector for SRIOV Network Config Daemon

The SRIOV Network Config Daemon is in charge of discovering and configuring the SRIOV
network devices on nodes.

By default it will be deployed to all the `worker` nodes in the cluster. You
can follow this procedure to select the nodes where the SRIOV Network Config
Daemon shall be deployed to with node labels.

.Procedure
. Update the default SriovOperatorConfig Custom Resource
+
[source,bash]
----
oc patch sriovoperatorconfig default --patch '[{"op": "replace", "path": "/spec/configDaemonNodeSelector", "value": {<node-label>}}]' --type=json
----
