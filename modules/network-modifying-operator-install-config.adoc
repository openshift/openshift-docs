// Module included in the following assemblies:
//
// * installing/installing_aws/installing-aws-network-customizations.adoc

[id="modifying-nwoperator-config-startup-{context}"]
= Modifying advanced network configuration parameters

You can modify the advanced network configuration parameters only before you
install the cluster.

[NOTE]
====
You must use the installer program to create an `install-config.yaml` file
before continuing.
====

.Prerequisites

* The `install-config.yaml` configuration file for the cluster you are creating.

.Procedure

. Use the following command to create manifests:
+
----
$ openshift-install create manifests --dir=<directory> <1>
----
<1> Specify the directory name to store the files that the installation program
creates.
+
The installer creates a `manifests/` directory that contains the
`cluster-network-02-config.yml` file describing a `Network.config.openshift.io`
Custom Resource (CR):
+
[source,yaml]
----
apiVersion: config.openshift.io/v1
kind: Network
metadata:
  creationTimestamp: null
  name: cluster
spec:
  clusterNetwork:
  - cidr: 10.128.0.0/14
    hostPrefix: 23
  networkType: OpenShiftSDN
  serviceNetwork:
  - 172.30.0.0/16
status: {}
----
+
The Network Operator takes its configuration from the
`cluster-network-02-config.yml` file when the cluster is created. Both the
`Network.config.openshift.io` CR and the `Network.operator.openshift.io` CR must
be stored in `cluster-network-02-config.yml`.

. Open `cluster-network-02-config.yml` in a text editor.

. Add the following `Network.operator.openshift.io` CR after the
`Network.config.openshift.io` CR in the `cluster-network-02-config.yml` file.
You must include the `---` separator between the CRs.
+
[source,yaml]
----
apiVersion: operator.openshift.io/v1
kind: Network
metadata:
  name: cluster
spec:
  clusterNetwork:
  - cidr: 10.128.0.0/14
    hostPrefix: 23
  defaultNetwork:
    type: OpenShiftSDN
  serviceNetwork:
  - 172.30.0.0/16
  status: {}
----
+
The following example shows the updated `cluster-network-02-config.yml` file:
+
// extra space between --- and <1> necessary for rendering
+
[source,yaml]
----
apiVersion: config.openshift.io/v1
kind: Network
metadata:
  creationTimestamp: null
  name: cluster
spec:
  clusterNetwork:
  - cidr: 10.128.0.0/14
    hostPrefix: 23
  networkType: OpenShiftSDN
  serviceNetwork:
  - 172.30.0.0/16
status:
  clusterNetwork: null
  clusterNetworkMTU: 0
  networkType: ""
  serviceNetwork: null

---  <1>

apiVersion: operator.openshift.io/v1
kind: Network
metadata:
  name: default
spec:
  clusterNetworks:
  - cidr: 10.128.0.0/14
    hostPrefix: 23
  defaultNetwork:
    type: OpenShiftSDN
  serviceNetwork: 172.30.0.0/16
  status: {}
----
<1> YAML separator to allow both CRs to exist in the same YAML file.

. Edit the `cluster-network-02-config.yml` to customize your cluster network
configuration. If the value for a parameter is different in the two CRs, the
Network Operator uses the value in the `Network.config.openshift.io` CR.
+
The Network Operator provides defaults for the parameters in the CRs, so you
need to specify only the parameters that you want to change in the
`Network.operator.openshift.io` CR.

. Save the `cluster-network-02-config.yml` file and quit the text editor.

////
<1> The `Network.config.openshift.io` CR
<2> The Network Operator reads these basic network settings from the
`Network.config.openshift.io` CR. They are also listed in the
`Network.operator.openshift.io` CR.

. The `Network.operator.openshift.io` CR in the example above only
shows basic network configuration. Add optional configurations if necessary.
  * `kube-proxy`
  * `OpenShiftSDN`
 and  settings to the CR.
////
