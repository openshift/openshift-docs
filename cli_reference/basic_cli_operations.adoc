= Developer CLI Operations
{product-author}
{product-version}
:data-uri:
:icons:
:experimental:
:toc: macro
:toc-title:

toc::[]

== Overview
This topic provides information on the developer CLI operations and their
syntax. You must link:get_started_cli.html[setup and login] with the CLI before
you can perform these operations.

The developer CLI uses the `oc` command, and is used for project-level
operations. This differs from the link:admin_cli_operations.html[administrator
CLI], which uses the `oadm` command for more advanced, administrator operations.

[[oc-common-operations]]

== Common Operations
The developer CLI allows interaction with the various
objects that are managed by OpenShift. Many common `oc` operations are invoked
using the following syntax:

----
$ oc <action> <object_type> <object_name_or_id>
----

This specifies:

- An `<action>` to perform, such as `get` or `describe`.
- The `<object_type>` to perform the action on, such as `service` or the
abbreviated `svc`.
- The `<object_name_or_id>` of the specified `<object_type>`.

For example, the `oc get` operation returns a complete list of services that are
currently defined:

====

[options="nowrap"]
----
$ oc get svc
NAME              LABELS                                    SELECTOR                  IP              PORT(S)
docker-registry   docker-registry=default                   docker-registry=default   172.30.78.158   5000/TCP
kubernetes        component=apiserver,provider=kubernetes   <none>                    172.30.0.2      443/TCP
kubernetes-ro     component=apiserver,provider=kubernetes   <none>                    172.30.0.1      80/TCP
----
====

The `oc describe` operation can then be used to return detailed information
about a specific object:

====

[options="nowrap"]
----
$ oc describe svc docker-registry
Name:			docker-registry
Labels:			docker-registry=default
Selector:		docker-registry=default
IP:			172.30.78.158
Port:			<unnamed>	5000/TCP
Endpoints:		10.128.0.2:5000
Session Affinity:	None
No events.
----
====

[WARNING]
====
Versions of `oc` prior to
ifdef::openshift-origin[]
1.0.5
endif::[]
ifdef::openshift-enterprise[]
3.0.2.0
endif::[]
did not have the ability to negotiate API versions against a server. So if you
are using `oc` up to
ifdef::openshift-origin[]
1.0.4
endif::[]
ifdef::openshift-enterprise[]
3.0.1.0
endif::[]
with a server that only supports v1 or higher versions of the API, make sure to
pass `--api-version` in order to point the `oc` client to the correct API
endpoint. For example: `oc get svc --api-version=v1`.
====

[[object-types]]

== Object Types
The CLI supports the following object types, some of which have abbreviated
syntax:

[options="header"]
|===

|Object Type |Abbreviated Version

|`build` |
|`buildConfig` | `bc`
|`deploymentConfig` | `dc`
|`event` |`ev`
|`imageStream` | `is`
|`imageStreamTag` | `istag`
|`imageStreamImage` | `isimage`
|`job` |
|`LimitRange` | `limits`
|`node` |
|`pod` |`po`
|`ResourceQuota` | `quota`
|`replicationController` |`rc`
|`secrets` |
|`service` |`svc`
|`ServiceAccount` | `serviceaccounts`
|`persistentVolume` |`pv`
|`persistentVolumeClaim` |`pvc`
|===

[[basic-cli-operations]]

== Basic CLI Operations
The following table describes basic `oc` operations and their general syntax:

=== types
Display an introduction to some core OpenShift concepts:
----
$ oc types
----

=== login
Log in to the OpenShift server:
----
$ oc login
----

=== logout
End the current session:
----
$ oc logout
----

=== new-project
Create a new project:
----
$ oc new-project <project_name>
----

=== new-app
link:../dev_guide/new_app.html[Creates a new application] based on the source
code in the current directory:
----
$ oc new-app .
----

=== status
Show an overview of the current project:
----
$ oc status
----

=== project
Switch to another project. Run without options to display the current project.
To view all projects you have access to run `oc projects`. Run without options
to display the current project. To view all projects you have access to run `oc
projects`.
----
$ oc project <project_name>
----

[[application-modification-cli-operations]]

== Application Modification CLI Operations

=== get
Return a list of objects for the specified link:#object-types[object type]. If
the optional `<object_name_or_id>` is included in the request, then the list of
results is filtered by that value.
----
$ oc get <object_type> [<object_name_or_id>]
----

=== describe
Returns information about the specific object returned by the query. A specific
`<object_name_or_id>` must be provided. The actual information that is available
varies as described in link:#object-types[object type].
----
$ oc describe <object_type> <object_id>
----

=== edit
Edit the desired object type:
----
$ oc edit <object_type>/<object_type_name>
----
Edit the desired object type with a specified text editor:
----
$ OC_EDITOR="<text_editor>" oc edit <object_type>/<object_type_name>
----
Edit the desired object in a specified format (eg: JSON):
----
$ oc edit <object_type>/<object_type_name> \
    --output-version=<object_type_version> \
    -o <object_type_format>
----

=== env
Update the desired object type with a new environment variable:
----
$ oc env <object_type>/<object_type_name> <var_name>=<value>
----

=== volume
Modify a link:../dev_guide/volumes.html[volume]:
----
$ oc volume <object_type>/<object_type_name> [--option]
----

=== label
Update the labels on a object:
----
$ oc label <object_type> <object_name_or_id> <label>
----

=== expose
Look up a service and expose it as a route. There is also the ability to expose
a deployment configuration, replication controller, service, or pod as a new
service on a specified port. If no labels are specified, the new object will
re-use the labels from the object it exposes.
----
$ oc expose <object_type> <object_name_or_id>
----

=== delete
Delete the specified object. An object configuration can also be passed in
through STDIN. The `oc delete all -l <label>` operation deletes all objects
matching the specified `<label>`, including the
link:../architecture/core_concepts/deployments.html#replication-controllers[replication
controller] so that pods are not re-created.
----
$ oc delete -f <file_path>
----
----
$ oc delete <object_type> <object_name_or_id>
----
----
$ oc delete <object_type> -l <label>
----
----
$ oc delete all -l <label>
----

[[build-and-deployment-cli-operations]]

== Build and Deployment CLI Operations
One of the fundamental capabilities of OpenShift is the ability to build
applications into a container from source.

OpenShift provides CLI access to inspect and manipulate
link:../dev_guide/deployments.html[deployment configurations] using standard
`oc` resource operations, such as `get`, `create`, and `describe`.

=== start-build
Manually start the build process with the specified build configuration file:
----
$ oc start-build <buildconfig_name>
----
Manually start the build process by specifying the name of a previous build as a
starting point:
----
$ oc start-build --from-build=<build_name>
----
Manually start the build process by specifying either a configuration file or
the name of a previous build and retrieve its build logs:
----
$ oc start-build --from-build=<build_name> --follow
----
----
$ oc start-build <buildconfig_name> --follow
----
Wait for a build to complete and exit with a non-zero return code if the build
fails:
----
$ oc start-build --from-build=<build_name> --wait
----
Set or override environment variables for the current build without changing the
build configuration. Alternatively, use `-e`.
----
$ oc start-build --env <var_name>=<value>
----
Set or override the default build log level output during the build:
----
$ oc start-build --build-loglevel [0-5]
----
Specify the source code commit identifier the build should use; requires a build
based on a Git repository:
----
$ oc start-build --commit=<hash>
----
Re-run build with name `<build_name>`:
----
$ oc start-build --from-build=<build_name>
----
Archive `<dir_name>` and build with it as the binary input:
----
$ oc start-build --from-dir=<dir_name>
----
Use `<file_name>` as the binary input for the build. This file must be the only
one in the build source. For example, *_pom.xml_* or *_Dockerfile_*.
----
$ oc start-build --from-file=<file_name>
----
The path to a local source code repository to use as the binary input for a
build:
----
$ oc start-build --from-repo=<path_to_repo>
----
Specify a webhook URL for an existing build configuration to trigger:
----
$ oc start-build --from-webhook=<webhook_URL>
----
The contents of the post-receive hook to trigger a build:
----
$ oc start-build --git-post-receive=<contents>
----
The path to the Git repository for post-receive; defaults to the current
directory:
----
$ oc start-build --git-repository=<path_to_repo>
----
List the webhooks for the specified build configuration or build; accepts `all`,
`generic`, or `github`:
----
$ oc start-build --list-webhooks
----

=== deploy
View a link:../dev_guide/deployments.html[deployment], or manually start,
cancel, or retry a deployment:
----
$ oc deploy <deploymentconfig>
----

=== rollback
Perform a
link:../dev_guide/deployments.html#rolling-back-a-deployment[rollback]:
----
$ oc rollback <deployment_name>
----

=== new-build
Create a build configuration based on the source code in the current Git
repository (with a public remote) and a Docker image:
----
$ oc new-build .
----

=== cancel-build
Stop a build that is in progress:
----
$ oc cancel-build <build_name>
----

=== import-image
Import tag and image information from an external Docker image repository:
----
$ oc import-image <imagestream>
----

=== scale
Set the number of desired replicas for a
link:../architecture/core_concepts/deployments.html#replication-controllers[replication
controller] or a link:../dev_guide/deployments.html[deployment configuration] to
the number of specified replicas:
----
$ oc scale <object_type> <object_id> --replicas=<#_of_replicas>
----

=== tag
Take an existing tag or image from an image stream, or a Docker image pull spec,
and set it as the most recent image for a tag in one or more other image
streams:
----
$ oc tag <current_image> <image_stream>
----

[[advanced-commands]]

== Advanced Commands

=== create
Parse a configuration file and create one or more OpenShift objects based on the
file contents. The `-f` flag can be passed multiple times with different file or
directory paths. When the flag is passed multiple times, `oc create` iterates
through each one, creating the objects described in all of the indicated files.
Any existing resources are ignored.
----
$ oc create -f <file_or_dir_path>
----

=== update
Attempt to modify an existing object based on the contents of the specified
configuration file. The `-f` flag can be passed multiple times with different
file or directory paths. When the flag is passed multiple times, `oc update`
iterates through each one, updating the objects described in all of the
indicated files.
----
$ oc update -f <file_or_dir_path>
----

=== process
Transform a project link:../dev_guide/templates.html[template] into a project
configuration file:
----
$ oc process -f <template_file_path>
----

=== run
Create and run a particular image, possibly replicated. Create a deployment
configuration to manage the created container(s). You can choose to run in the
foreground for an interactive container execution.
----
$ oc run NAME --image=<image> \
    [--port=<port>] \
    [--replicas=<replicas>] \
    [--dry-run=<bool>] \
    [--overrides=<inline-json>] \
    [options]
----

=== export
Export resources to be used elsewhere:
----
$ oc export <object_type> [--options]
----

=== policy
Manage authorization policies:
----
$ oc policy [--options]
----

=== secrets
Configure link:../dev_guide/secrets.html[secrets]:
----
$ oc secrets [--options] path/to/ssh_key
----

=== autoscale
Setup an link:../dev_guide/pod_autoscaling.html[autoscaler] for your
application. Requires metrics to be enabled in the cluster.
ifdef::openshift-enterprise,openshift-origin[]
See link:../install_config/cluster_metrics.html[Enabling Cluster Metrics] for
cluster administrator instructions, if needed.
endif::[]
ifdef::openshift-online,openshift-dedicated[]
Check with your cluster administrator to confirm whether metrics are enabled in
your environment.
endif::[]
----
$ oc autoscale dc/<dc_name> [--options]
----

[[troubleshooting-and-debugging-cli-operations]]

== Troubleshooting and Debugging CLI Operations

=== logs
Retrieve the log output for a specific build, deployment, or pod. This command
works for builds, build configurations, deployment configurations, and pods.
----
$ oc logs -f <pod_name>
----

=== exec
Execute a command in an already-running container. You can optionally specify a
container ID, otherwise it defaults to the first container.
----
$ oc exec <pod_ID> [-c <container_ID>] <command>
----

=== rsh
Open a remote shell session to a container:
----
$ oc rsh <pod_ID>
----

=== rsync
Copy contents of local directory to a directory in an already-running pod
container. It will default to the first container if none is specified.
----
$ oc rsync <local_dir> <pod_ID>:<pod_dir> -c <container_ID>
----

=== port-forward
link:../dev_guide/port_forwarding.html[Forward one or more local ports] to a
pod:
----
$ oc port-forward <pod_ID> <first_port_ID> <second_port_ID>
----

=== proxy
Run a proxy to the Kubernetes API server:
----
$ oc proxy --port=<port_ID> --www=<static_directory>
----

[IMPORTANT]
====
link:https://access.redhat.com/errata/RHSA-2015:1650[For security purposes], the
`oc exec` command does not work when accessing privileged containers. Instead,
administrators can SSH into a node host, then use the `docker exec` command on
the desired container.
====
