= CLI Operations
{product-author}
{product-version}
:data-uri:
:icons:
:experimental:
:toc: macro
:toc-title:

toc::[]

== Overview
This topic provides information on some general CLI operations and their syntax.

== Common CLI Operations
The CLI allows interaction with the various objects that are managed by OpenShift. The common `osc` operations are invoked by specifying the following:

* An _action_
* The _object type_ to perform the action on
* The _object name_ or _ID_ of the specified _object type_

In the following example the `osc get` operation returns a complete list of services that are currently defined.

----
$ osc get se
NAME                LABELS                                    SELECTOR            IP                  PORT
kubernetes          component=apiserver,provider=kubernetes   <none>              172.30.17.96        443
kubernetes-ro       component=apiserver,provider=kubernetes   <none>              172.30.17.77        80
docker-registry     <none>                                    name=registrypod    172.30.17.158       5001
----

The following example operation returns the same list that is filtered down to an individual object:

----
$ osc get se kubernetes-ro
NAME                LABELS                                    SELECTOR            IP                  PORT
kubernetes-ro       component=apiserver,provider=kubernetes   <none>              172.30.17.77        80
----

The following table describes the common `osc` operations and their general syntax.

.Common CLI Operations
[cols=".^2,.^5,8",options="header"]
|===

|Operation |Syntax |Description

|`get`
|`osc get [replaceable]#<object_type># _<object_id>_`
|Returns a list of objects for the specified link:#cli-object-types[object type]. If the optional _object name_ or _ID_ is included in the request, then the list of results is filtered by that value.

|`describe`
|`osc describe _<object_type>_ _<object_id>_`
|Returns information about the specific object returned by the query; a specific _object name_ or _ID_ must be provided. The actual information that is available varies as described in link:#cli-object-types[object type].

|`create`
|`osc create -f _<file_or_directory_path>_`
|Parses a configuration file and creates one or more OpenShift objects based on the file contents. The -f flag can be passed multiple times with different file or directory paths. When the flag is passed multiple times, `osc create` iterates through each one, creating the objects described in all of the indicated files. Any existing resources are ignored.

|`describe`
|`osc describe _<object_type>_ _<object_id>_`
|Returns information about the specific object returned by the query; a specific _object name_ or _ID_ must be provided. The actual information that is available varies as described in link:#object-types[object type].

|`create`
|`osc create -f _<file_path>_`
|Parses a configuration file and creates one or more OpenShift objects based on the file contents.

|`update`
|`osc update -f _<file_or_directory_path>_`
|Attempts to modify an existing object based on the contents of the specified configuration file. The -f flag can be passed multiple times with different file or directory paths. When the flag is passed multiple times, `osc update` iterates through each one, updating the objects described in all of the indicated files.

|`delete`
a|`osc delete -f _<file_path>_`

`osc delete _<object_type>_ _<object_id>_`

`osc delete _<object_type>_ -l _<label>_`
.^|Deletes the specified OpenShift object. An object configuration can also be passed in through STDIN.

|`log`
|`osc log -f _<pod_name>_ _<container_name>_`
|Retrieves the log output for a specific pod or container. This command does not work for other object types.
|===

== Project CLI Operations
These advanced operations are used to define and instantiate OpenShift objects at the project level.

The simplest way to create a new project is:
`osadm new-project _<project-name> --display-name=<display-name> --description=<description> --admin=<admin-username>`


For example: `osadm new-project test --display-name="OpenShift 3 Sample" --description="This is an example project to demonstrate OpenShift v3" --admin=anypassword:test-admin` creates a new project called `test` that appears in the web console as "Openshift 3 Sample", with `test-admin` as the project admin.

.Project CLI Operations
[cols=".^2,.^5,8",options="header"]
|===

|Operation |Syntax |Description

|`process`
|`osc process -f _<template_file_path>_`
|Transforms a project template into a project configuration file.

|`apply`
|`osc apply -f _<config_file_path>_`
|Creates all of the OpenShift objects for a given project based on the specified configuration file.
|===

== Build CLI Operations
One of the fundamental capabilities of OpenShift is the ability to build applications into a container from source. The following table describes the CLI operations for working with application builds.

.Build CLI Operations
[cols=".^2,.^5,8",options="header"]
|===

|Operation |Syntax |Description

|`start-build`
|`osc start-build _<buildConfig_name>_`
|Manually starts the build process with the specified build configuration file.

|`start-build`
|`osc start-build --from-build=_<build_name>_`
|Manually starts the build process by specifying the name of a previous build as a starting point.

|`start-build`
|`osc start-build [_<buildConfig_name>_ or --from-build=_<build_name>_] --follow`
|Manually starts the build process by specifying either the name of a previous build or a configuration file and retrieves its build logs.

|`cancel-build`
|`osc cancel-build _<build_name>_`
|Stops a build that is in progress.

|`build-logs`
|`osc build-logs _<build_name>_`
|Retrieves the build logs for the specified build.
|===

== Deployment CLI Operations
OpenShift provides CLI access to inspect and manipulate deployment configurations using standard `osc` resource operations such as `get`, `create`, and `describe`.

=== Deployment Configurations

The syntax to describe a deployment configuration in human-readable form is:

****
`osc deploymentConfigs describe [replaceable]#<deployment config>#`
****

=== Deployment Rollbacks

Rollbacks revert an application back to a previous deployment. Note that environment variables and volumes are included in rollbacks, so there are a variety of considerations to make when deciding whether a rollback is viable, such as:

* If security credentials have been recently updated, the previous deployment may not have the correct values.
* If the previous deployment used a custom strategy, which is no longer available or usable, the deployment may not be deployed correctly.

By default, only the pod and container configuration will be changed and scaling or trigger settings will be left as-is.

Using the `-d`, or `--dry-run` option prints a human-readable representation of the updated deployment configuration instead of executing the rollback. This is useful for inspecting a desired outcome before an actual rollback.

Use the `osc rollback` command to revert part of an application back to a previous deployment. The syntax for `rollback` is:

****
`osc rollback [replaceable]#<deployment># [replaceable]#[options]#`
****

.Rollback CLI Configuration Options
[cols="4,8",options="header"]
|===

|Option |Description

.^|`--change-triggers`
|Include the previous deployment's triggers in the rollback.

.^|`--change-strategy`
|Include the previous deployment's strategy in the rollback.

.^|`-d, --dry-run`
|Instead of performing the rollback, describe what the rollback will look like in human-readable form.

.^|`-o, --output`
|Instead of performing the rollback, print the updated deployment configuration in the specified format (json\|yaml\|template\|templatefile).

.^|`-t, --template`
|Template string or path to template file to use when -o=template or -o=templatefile.
|===

==== Rollback Examples

Perform a rollback:

****
`osc rollback deployment-1`
****

See what the rollback will look like without performing the rollback:

****
`osc rollback deployment-1 --dry-run`
****

Perform the rollback manually by piping the JSON of the new config back to `osc`:

****
`osc rollback deployment-1 --output=json | osc update deploymentConfigs deployment -f -`
****
