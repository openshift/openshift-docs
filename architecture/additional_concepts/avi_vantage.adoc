[[architecture-additional-concepts-f5-big-ip]]
= Avi Vantage Router and Services
{product-author}
{product-version}
:data-uri:
:icons:
:experimental:
:toc: macro
:toc-title:

toc::[]

== Overview

A router is one way to get traffic into the cluster.
Avi Vantage is one of the available
xref:../../architecture/additional_concepts/networking.adoc#network-plugins[router plugins].

link:https://avinetworks.com/service-mesh-for-openshift-kubernetes[*Avi Vantage*] 
operates as an elastic service mesh fabric from within the OpenShift 
cluster and provides Enterprise class routing (L4/L7 ingress load balancing, 
SSL/TLS offload, certificate management, client authentication, rate limiting, 
DoS detection/mitigation, etc.), Global Service load balancing, service 
discovery, internal load balancing for OpenShift Services, 
application/infrastructure/security analytics, network 
security policies and a Web Application Firewall.

Avi Vantage is fully transparent to the applications for all features with
standard OpenShift Routes and Services. Applications can optionally use 
additional Avi features and functions by specifying Avi annotations in Routes 
and Services.

[[avi-vantage-ingress-routing]]
== Avi Vantage Ingress Routing

Avi Vantage Routing supports xref:../../architecture/core_concepts/routes.adoc#route-types[unsecured], 
xref:../../architecture/core_concepts/routes.adoc#edge-termination[edge terminated] 
and xref:../../architecture/core_concepts/routes.adoc#re-encryption-termination[re-encryption terminated] matching on HTTP vhost and request path. 

The Avi Vantage router is feature compatible with the 
xref:../../architecture/core_concepts/routes.adoc#haproxy-template-router[HAProxy template router]
and additionally supports TCP/UDP local/global load balancing, SSL/TLS offload, 
certificate management, client authentication, rate limiting and DoS 
detection/mitigation features specified via Avi annotations.

Every Route creates to an individual VirtualService and is deployed across the
fabric of Service Engines (proxies). Every VirtualService is further scaled 
out across multiple Service Engines to scale its performance.

[[avi-vantage-gslb-service-discovery]]
== Avi Vantage Global Service Load Balancing and Service Discovery

Avi Vantage allows application availability across datacenters, 
availability zones and regions by providing Global Service Load Balancing for 
Routes deployed across clusters in different datacenters, availability zones 
and regions. A single FQDN for a global application resolves to one of several 
Virtual IP Addresses corresponding to Routes deployed across clusters in 
different locations. GSLB Service creation is fully automated across OpenShift 
clusters via Avi annotations.

Avi Vantage provides service discovery for Routes and Services via DNS. Avi 
Vantage is an authoritative DNS server for OpenShift Routes and Services 
serving A records mapping Route and Service FQDNs to Virtual IP Addresses.

[[avi-vantage-internal-load-balancing]]
== Avi Vantage Internal load balancing for OpenShift Services

Avi Vantage Service Engines are distributed across the OpenShift cluster with a
single Service Engine (proxy) per OpenShift Node. Each Service Engine acts as 
a full TCP/UDP/HTTP(s) proxy/load balancer for requests originating from Pods 
on that Node and load balances such requests to destination Pods.

[[avi-vantage-network-security-policies]]
== Avi Vantage Network Security Policies

Avi Vantage enforces security policies for Routes and Services based on 
configured OpenShift network policies.

[[avi-vantage-openshift-architecture]]
== Avi Vantage OpenShift Architecture

image::Avi-Vantage-Architecture.png[Avi Vantage OpenShift Architecture]

* A OpenShift cloud is configured on Avi Controller
* Avi Controller discovers all OpenShift Nodes and brings up a Avi ServiceEngine on every Node
* Every OpenShift Project maps to a Tenant on Avi
* Avi Controller allocates a VIP, creates a North-South VirtualService and an 
A record mapping the FQDN to the VIP for every OpenShift Route
* Avi Controller allocates a VIP, creates a East-South VirtualService and an A 
record mapping the FQDN to the VIP for every OpenShift Service
* Avi VirtualServices track the lifecycle of OpenShift Routes and Service

[[avi-vantage-route-traffic-flow]]
== Avi Vantage OpenShift Route Traffic Flow

image::Avi-Vantage-Route-Traffic-Flow.png[Avi Vantage Route Traffic Flow]

[[avi-vantage-service-traffic-flow]]
== Avi Vantage OpenShift Service Traffic Flow

image::Avi-Vantage-Service-Traffic-Flow.png[Avi Vantage Service Traffic Flow]

[[avi-vantage-gslb]]
== Avi Vantage Global Service Load Balancing across datacenters

image::Avi-Vantage-Gslb.png[Avi Vantage Gslb]

[[avi-vantage-getting-started]]
== Avi Vantage for OpenShift

The following page has more information on Avi installation, deployment and 
features with OpenShift.

link:https://avinetworks.com/service-mesh-for-openshift-kubernetes[*Avi Vantage for OpenShift*] 

