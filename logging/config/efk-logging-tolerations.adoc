:context: efk-logging-tolerations
[id="efk-logging-tolerations"]
= Using tolerations to control cluster logging pod placement
include::modules/common-attributes.adoc[]

toc::[]

You can use taints and tolerations to ensure that cluster logging pods run 
on specific nodes and that no other workload can run on those nodes.

.Sample cluster logging CR with tolerations
[source,yaml]
----
apiVersion: "logging.openshift.io/v1"
kind: "ClusterLogging"
metadata:
  name: "instance"
  namespace: openshift-logging
spec:
  managementState: "Managed"
  logStore:
    type: "elasticsearch"
    elasticsearch:
      nodeCount: 1
      tolerations: <1>
      - key: "logging"
        operator: "Exists"
        effect: "NoExecute"
        tolerationSeconds: 6000
      resources:
        limits:
          memory: 8Gi
        requests:
          cpu: 100m
          memory: 1Gi
      storage: {}
      redundancyPolicy: "ZeroRedundancy"
  visualization:
    type: "kibana"
    kibana:
      tolerations: <2>
      - key: "logging"
        operator: "Exists"
        effect: "NoExecute"
        tolerationSeconds: 6000
      resources:
        limits:
          memory: 2Gi
        requests:
          cpu: 100m
          memory: 1Gi
      replicas: 1
  curation:
    type: "curator"
    curator:
      tolerations: <3>
      - key: "logging"
        operator: "Exists"
        effect: "NoExecute"
        tolerationSeconds: 6000
      resources:
        limits:
          memory: 200Mi
        requests:
          cpu: 100m
          memory: 100Mi
      schedule: "*/5 * * * *"
  collection:
    logs:
      type: "fluentd"
      fluentd: 
        tolerations: <4>
        - key: "logging"
          operator: "Exists"
          effect: "NoExecute"
          tolerationSeconds: 6000
        resources:
          limits:
            memory: 2Gi
          requests:
            cpu: 100m
            memory: 1Gi
----

<1> This toleration is added to the Elasticsearch pods.
<2> This toleration is added to the Kibana pod.
<3> This toleration is added to the Curator pod.
<4> This toleration is added to the logging collector pods.

// The following include statements pull in the module files that comprise
// the assembly. Include any combination of concept, procedure, or reference
// modules required to cover the user story. You can also include other
// assemblies.

include::modules/efk-logging-elasticsearch-tolerations.adoc[leveloffset=+1]

include::modules/efk-logging-kibana-tolerations.adoc[leveloffset=+1]

include::modules/efk-logging-curator-tolerations.adoc[leveloffset=+1]

include::modules/efk-logging-fluentd-tolerations.adoc[leveloffset=+1]

[id="efk-logging-tolerations-addtl-resources"]
== Additional resources

For more information on taints and tolerations, see 
xref:../../nodes/scheduling/nodes-scheduler-taints-tolerations.adoc#nodes-scheduler-taints-tolerations[Controlling pod placement using node taints].


