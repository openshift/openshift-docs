[id="efk-logging-elasticsearch-storage"]
= Configuring Elasticsearch storage
include::modules/common-attributes.adoc[]

toc::[]



You can configure the number of Elasticsearch nodes in your cluster and configure persistent storage.

You can bind each data node in the Elasticsearch cluster to a persistent volume claim using a Cluster Logging Custom Resource (CR).

[NOTE]
====
If you omit the storage block, the deployment will include ephemeral storage only.
====

The following example specifies each data node in the cluster is bound to a Persistent Volume Claim that requests 200G of General Purpose SSD (gp2) storage.

[source,yaml]
----
apiVersion: "logging.openshift.io/v1"
kind: "ClusterLogging"
metadata:
  name: "clusterlogging"

....

 spec:
    logStore:
      type: "elasticsearch"
      elasticsearch:
        nodeCount: 3
        storage:
          storageClass:
            name: "gp2"
            size: "200G"
----

[NOTE]
====
You must set cluster logging to Unmanaged state before performing these configurations, unless otherwise noted. For more information, see xref:../logging/efk-logging-management.adoc#efk-logging-management[Changing the cluster logging management state].
====

// The following include statements pull in the module files that comprise
// the assembly. Include any combination of concept, procedure, or reference
// modules required to cover the user story. You can also include other
// assemblies.

include::modules/efk-logging-elasticsearch-storage.adoc[leveloffset=+1]

include::modules/efk-logging-elasticsearch-persistent-storage-empty.adoc[leveloffset=+1]

include::modules/efk-logging-elasticsearch-add-remove.adoc[leveloffset=+1]

include::modules/efk-logging-elasticsearch-exposing.adoc[leveloffset=+1]

include::modules/efk-logging-elasticsearch-rules.adoc[leveloffset=+1]
