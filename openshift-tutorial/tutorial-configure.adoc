[[openshift-tutorial-config]]
= A Few Necessary Configurations
{product-author}
{product-version}
:data-uri:
:icons:
:experimental:
:toc: macro
:toc-title:

toc::[]
{nbsp} +


== Overview


[[change-log-in-identity-provider]]
== Change Log In Identity Provider

The default behavior of a freshly installed {product-title} instance is to deny
any user from logging in. 

In thise exercise we are changing that default behavior and configuring the *HTPasswd*
authentication method. {product-title} allows 
xref:..//install_config/configuring_authentication.html#install-config-configuring-authentication[several types of authentication],
any of which you can use. 

To change the authentication method to *HTPasswd*:

. Open the *_/etc/origin/master/master-config.yaml_* file in any text editor.

. Set the following parameters:
+
----
oauthConfig:
  ...
  identityProviders:
  - challenge: true
    login: true
----

. Specify the mappingMethod parameter to determine how identities are mapped to users:
+
----
oauthConfig:
  ...
  identityProviders:
  - mappingMethod: claim
----

. Change the `name` parameter to `htpasswd_auth`:
+
----
identifyProviders:
  name:htpasswd_auth
----

. Find the `identityProviders` section, then change the
`DenyAllPasswordIdentityProvider` parameter to: `HTPasswdPasswordIdentityProvider`
provider and add a new line `file`:
+
----
identifyProviders:
  providers:
    kind: HTPasswdPasswordIdentityProvider 
    file: /etc/users.htpasswd
----
+
The section should look like this:
+
----
oauthConfig:
  ...
  identityProviders:
  - challenge: true
    login: true
    mappingMethod: claim
    name: htpasswd_auth 
    provider:
      apiVersion: v1
      kind: HTPasswdPasswordIdentityProvider 
      file: /etc/users.htpasswd 
----

. Save the file.

[[create-user-accounts]]
== Create User Accounts

Now that you are using the *HTPasswdPasswordIdentityProvider* authentication, you
need to generate user accounts.

. You can use the *httpd-tools* package to obtain the *htpasswd* binary that can
generate these accounts.
+
----
$ yum -y install httpd-tools
----

. Create a file with a user name and password, by executing the following command:
+
----
$ htpasswd -c /etc/users.htpasswd admin
----
+
Enter and confirm a clear-text password for the user. The command generates a file with a hashed version of the password.
+
----
htpasswd -c users.htpasswd admin
New password:
Re-type new password:
Adding password for user admin
----

. Start or restart the {product-title} services:
+
ifdef::openshift-enterprise[]
----
# systemctl restart atomic-openshift-master
----
endif::[]
ifdef::openshift-origin[]
----
# systemctl restart origin-master
----
endif::[]

== Give the User Privileges

After you create the user, you need to assign privileges to that user. In this 
exercise we are going to make our `admin` user an admin. 

There are all kinds of roles that you can assign. Take a look 
at xref:../admin_guide/manage_authorization_policy.html#admin-guide-manage-authorization-policy[Managing Authorization Policies]
if you are interested.

. Enter the following command:
+
----
$ oadm policy add-cluster-role-to-user cluster-admin admin
----

. Use this username/password combination to log in:
+
----
oc login -u admin
----

== Next Up

Let's take a xref:../openshift-tutorial/tutorial-walkthrough.adoc#openshift-tutorial-walk[quick walkthrough] of the {product-title} web console and CLI.

