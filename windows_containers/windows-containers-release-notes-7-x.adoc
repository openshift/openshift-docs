:_mod-docs-content-type: ASSEMBLY
[id="windows-containers-release-notes-7-x"]
= {productwinc} release notes
include::_attributes/common-attributes.adoc[]
:context: windows-containers-release-notes

toc::[]

[id="about-windows-containers"]
== About {productwinc}

{productwinc} enables running Windows compute nodes in an {product-title} cluster. Running Windows workloads is possible by using the Red Hat Windows Machine Config Operator (WMCO) to install and manage Windows nodes. With Windows nodes available, you can run Windows container workloads in {product-title}.

These release notes track the development of the WMCO, which provides all Windows container workload capabilities in {product-title}.

ifndef::openshift-origin[]
[id="getting-support"]
== Getting support

// wording taken and modified from https://access.redhat.com/support/policy/updates/openshift#windows

{productwinc} is provided and available as an optional, installable component. {productwinc} is not part of the {product-title} subscription. It requires an additional Red Hat subscription and is supported according to the link:https://access.redhat.com/support/offerings/production/soc/[Scope of coverage] and link:https://access.redhat.com/support/offerings/production/sla[Service level agreements].

You must have this separate subscription to receive support for {productwinc}. Without this additional Red Hat subscription, deploying Windows container workloads in production clusters is not supported. You can request support through the link:http://access.redhat.com/[Red Hat Customer Portal].

For more information, see the Red Hat OpenShift Container Platform Life Cycle Policy document for link:https://access.redhat.com/support/policy/updates/openshift#windows[{productwinc}].

If you do not have this additional Red Hat subscription, you can use the Community Windows Machine Config Operator, a distribution that lacks official support.
endif::openshift-origin[]

[id="wmco-7-2-2"]
== Release notes for Red{nbsp}Hat Windows Machine Config Operator 7.2.2

This release of the WMCO provides new features and bug fixes for running Windows compute nodes in an {product-title} cluster. The components of the WMCO 7.2.2 were released in link:https://access.redhat.com/errata/RHBA-2024:TBD[RHBA-2024:TBD].

[id="wmco-7-2-2-bug-fixes"]
=== Bug fixes


[id="wmco-7-2-1"]
== Release notes for Red{nbsp}Hat Windows Machine Config Operator 7.2.1

This release of the WMCO provides new features and bug fixes for running Windows compute nodes in an {product-title} cluster. The components of the WMCO 7.2.1 were released in link:https://access.redhat.com/errata/RHBA-2024:1476[RHBA-2024:1476].

[id="wmco-7-2-1-bug-fixes"]
=== Bug fixes

// Also in 10.15.0
* Previously, the WMCO did not properly wait for Windows virtual machines (VMs) to finish rebooting. This led to occasional timing issues where the WMCO would attempt to interact with a node that was in the middle of a reboot, causing WMCO to log an error and restart node configuration. Now, the WMCO waits for the instance to completely reboot. (link:https://issues.redhat.com/browse/OCPBUGS-23036[*OCPBUGS-23036*])

// Also in 10.15.0
* Previously, the WMCO configuration was missing the `DeleteEmptyDirData: true` field, which is required for draining nodes that have `emptyDir` volumes attached. As a consequence, customers that had nodes with `emptyDir` volumes would see the following error in the logs: `cannot delete Pods with local storage`. With this fix, the `DeleteEmptyDirData: true` field was added to the node drain helper struct in the WMCO. As a result, customers are able to drain nodes with `emptyDir` volumes attached. (link:https://issues.redhat.com/browse/OCPBUGS-23081[*OCPBUGS-23081*])

// Also in 10.15.0
* Previously, because of bad logic in the networking configuration script, the WICD was incorrectly reading carriage returns in the CNI configuration file as changes, and identified the file as modified. This caused the CNI configuration to be unnecessarily reloaded, potentially resulting in container restarts and brief network outages. With this fix, the WICD now reloads the CNI configuration only when the CNI configuration is actually modified. (link:https://issues.redhat.com/browse/OCPBUGS-27771[*OCPBUGS-27771*])

* Previously, the WMCO incorrectly approved the node certificate signing requests (CSR) for all nodes trying to join a cluster, not just Windows node CSRs. With this fix, the WMCO approves CSRs for only Windows nodes as expected. (link:https://issues.redhat.com/browse/OCPBUGS-27139[*OCPBUGS-27139*])

// Also in 10.15.0
* Previously, because of routing issues present in Windows Server 2019, under certain conditions and after more than one hour of running time, workloads on Windows Server 2019 could have experienced packet loss when communicating with other containers in the cluster. This fix enables Direct Server Return (DSR) routing within kube-proxy. As a result, DSR now causes request and response traffic to use a different network path, circumventing the bug within Windows Server 2019. (link:https://issues.redhat.com/browse/OCPBUGS-28254[*OCPBUGS-28254*])

* Previously, because the upgrade path from WMCO 6.x to WMCO 7.x included previously released versions, the WMCO would fail during the upgrade. With this fix, you can successfully upgrade from WMCO 6.x to WMCO 7.x. (link:https://issues.redhat.com/browse/OCPBUGS-27775[*OCPBUGS-27775*])

// Also in 10.15.0
* Previously, because of a lack of synchronization between Windows compute machine set nodes and Bring-Your-Own-Host (BYOH) instances, during an update the compute machine set nodes and the BYOH instances could update simultaneously, which could have impacted running workloads. This fix introduces a locking mechanism so that compute machine set nodes and BYOH instances update individually. (link:https://issues.redhat.com/browse/OCPBUGS-23020[*OCPBUGS-23020*])

[id="wmco-7-1-0"]
== Release notes for Red Hat Windows Machine Config Operator 7.1.0

This release of the WMCO provides new features and bug fixes for running Windows compute nodes in an {product-title} cluster. The components of the WMCO 7.1.0 were released in link:https://access.redhat.com/errata/RHSA-2023:4025[RHSA-2023:4025].

[IMPORTANT]
====
Due to a known issue, your {product-title} cluster must be on version 4.12.3 or greater before updating the WMCO from version 7.0.1 to version 7.1.0. The update fails if the cluster is lower than version 4.12.3.
====

[id="wmco-7-1-0-bug-fixes"]
=== Bug fixes

* Previously, the `containerd` container runtime reported an incorrect version on each Windows node because repository tags were not propagated to the build system. This configuration caused `containerd` to report its `go build` version as the version of each Windows node. With this update, the correct version is injected into the binary during build time, so that `containerd` reports the correct version for each Windows node. (link:https://issues.redhat.com/browse/OCPBUGS-7843[**OCPBUGS-7843**])

* Previously, the Windows Machine Config Operator (WMCO) could not drain daemon set workloads. This issue caused Windows daemon set pods to block Windows nodes that the WMCO attempted to remove or update. With this update, the WMCO includes additional role-based access control (RBAC) permissions, so that the WMCO can remove daemon set workloads. The WMCO can also delete any processes that were created with the containerd shim, so that daemon set containers do not exist on a Windows instance after a WMCO removes a node from a cluster. (link:https://issues.redhat.com/browse/OCPBUGS-8056[*OCPBUGS-8056*])

* Previously, on an Azure Windows Server 2019 platform that does not have Azure container services installed, WMCO would fail to deploy Windows instances and would display the `Install-WindowsFeature : Win32 internal error "Access is denied" 0x5 occurred while reading the console output buffer` error message. The failure occurred because the Microsoft `Install-WindowsFeature` cmdlet displays a progress bar, which cannot be sent over an SSH connection. This fix hides the progress bar. As a result, Windows instances can be deployed as nodes. (link:https://issues.redhat.com/browse/OCPBUGS-14445[*OCPBUGS-14445*])

[id="wmco-7-0-1"]
== Release notes for Red Hat Windows Machine Config Operator 7.0.1

This release of the WMCO provides new features and bug fixes for running Windows compute nodes in an {product-title} cluster. The components of the WMCO 7.0.1 were released in link:https://access.redhat.com/errata/RHBA-2023:0748[RHBA-2023:0748].

[id="wmco-7-0-1-bug-fixes"]
=== Bug fixes

* Previously, WMCO 7.0.0 did not support running in a namespace other than `openshift-windows-machine-operator`. With this fix, you can run WMCO in a custom namespace and can upgrade clusters that have WMCO installed in a custom namespace. (link:https://issues.redhat.com/browse/OCPBUGS-5065[**OCPBUGS-5065**])

[id="wmco-7-0-0"]
== Release notes for Red Hat Windows Machine Config Operator 7.0.0

This release of the WMCO provides new features and bug fixes for running Windows compute nodes in an {product-title} cluster. The components of the WMCO 7.0.0 were released in link:https://access.redhat.com/errata/RHSA-2022:9096[RHSA-2022:9096].

[id="wmco-7-0-0-new-features"]
=== New features and improvements

[id="wmco-7-0-0-wicd"]
==== Windows Instance Config Daemon (WICD)

The Windows Instance Config Daemon (WICD) is now performing many of the tasks that were previously performed by the Windows Machine Config Bootstrapper (WMCB). The WICD is installed on your Windows nodes. Users do not need to interact with the WICD and should not experience any difference in WMCO operation.

[id="wmco-7-0-0-gcp"]
==== Support for clusters running on Google Cloud Platform
You can now run Windows Server 2022 nodes on a cluster installed on Google Cloud Platform (GCP). You can create a Windows `MachineSet` object on GCP to host Windows Server 2022 compute nodes. For more information, see xref:../windows_containers/creating_windows_machinesets/creating-windows-machineset-gcp.adoc#creating-windows-machineset-gcp[Creating a Windows MachineSet object on vSphere].

[id="wmco-7-0-0-bug-fixes"]
=== Bug fixes

* Previously, restarting the WMCO in a cluster with running Windows Nodes caused the windows exporter endpoint to be removed. Because of this, each Windows node could not report any metrics data. After this fix, the endpoint is retained when the WMCO is restarted. As a result, metrics data is reported properly after restarting WMCO. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2107261[**BZ#2107261**])

* Previously, the test to determine if the Windows Defender antivirus service is running was incorrectly checking for any process whose name started with Windows Defender, regardless of state. This resulted in an error when creating firewall exclusions for containerd on instances without Windows Defender installed. This fix now checks for the presence of the specific running process associated with the Windows Defender antivirus service. As a result, the WMCO can properly configure Windows instances as nodes regardless of whether Windows Defender is installed or not. (https://issues.redhat.com/browse/OCPBUGS-3573[**OCPBUGS-3573**])

[id="wmco-7-0-0-known-issues"]
=== Known issues

The following known limitations have been announced after the previous WMCO release:

* {ServerlessProductName}, Horizontal Pod Autoscaling, and Vertical Pod Autoscaling are not supported on Windows nodes.

* {productwinc} does not support adding Windows nodes to a cluster through a trunk port. The only supported networking configuration for adding Windows nodes is through an access port that carries traffic for the VLAN.

* WMCO 7.0.0 does not support running in a namespace other than `openshift-windows-machine-operator`. If you are using a custom namespace, it is recommended that you not upgrade to WMCO 7.0.0. Instead, you should upgrade to WMCO 7.0.1 when it is released. If your WMCO is configured with the *Automatic* update approval strategy, you should change it to *Manual* for WMCO 7.0.0. See the xref:../windows_containers/enabling-windows-container-workloads.adoc#installing-wmco-using-web-console_enabling-windows-container-workloads[installation instructions] for information on changing the approval strategy.

.Additional resources

See the full list of xref:../windows_containers/windows-containers-release-notes-7-x.html#windows-containers-release-notes-limitations_windows-containers-release-notes[known limitations]

include::modules/wmco-prerequisites.adoc[leveloffset=+1]

include::modules/windows-containers-release-notes-limitations.adoc[leveloffset=+1]

