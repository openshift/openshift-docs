ifdef::context[:parent-context: {context}]
[id='managing-multiple-networks-{context}']
= Managing Multiple Networks
toc::[]
:context: managing-multiple-networks
== Overview

Multus CNI is included with OpenShift to provide the capability to attach multiple network interfaces to pods. All pods in the cluster will still use the cluster-wide default network to maintain pod-to-pod connectivity across the cluster. If one is to execute an `ip a` command in a pod (e.g. `oc exec -it pod_name -- ip a`), you’ll notice that there is an `eth0` which is attached to the cluster-wide network. Additional network interfaces will be named `net1, net2, …, netN`.

In order to attach additional network interfaces to a pod one must create configurations which define how the interfaces are attached. The additional interfaces are specified using custom resources (CR’s) with a type of `NetworkAttachmentDefinition`. Inside each of these CR’s, one specifies a CNI configuration which defines how that interface will be created. Multus CNI is a "meta plugin" -- a CNI plugin that can call other CNI plugins, this allows the use of other CNI plugins to create additional network interfaces.

There are essentially 3 steps involved in attaching additional network interfaces to pods:

. Create CNI configuration as a custom resource.
. Annotate pod with configuration name.
. (Optional) Review results of attachment by looking at the status annotation.

== CNI Configurations

CNI configuration are JSON data with only a single required field, `type`. Otherwise, the configuration is free-form JSON data which allows the specific CNI plugins to make the configurations in whatever form they may -- in which case it’s recommended to look at the documentation specific to the plugin you wish to use.

An example CNI configuration:

[source,json]
----
{
  "cniVersion": "0.3.0", <1>
  "type": "loopback", <2>
  "additional": "information" <3>
}
----

<1> `cniVersion`: Tells each CNI plugin which version is being used and may give the plugin information if it's using a too late (or too early) version.
<2> `type`: This tells CNI which binary to call on disk. Each CNI plugin is a binary that's called. In this case we've specified the loopback binary (used to create a loopback-type network interface).
<3> `additional`: This field is put here as an example, each CNI plugin may specify whatever configuration parameters they'd like in JSON. These are specific to the binary you're calling in the type field.

include::modules/multinetwork-creating-first-attachments.adoc[leveloffset=+1]
include::modules/multinetwork-dhcp.adoc[leveloffset=+1]
include::modules/multinetwork-host-device.adoc[leveloffset=+1]
include::modules/multinetwork-bridge.adoc[leveloffset=+1]
