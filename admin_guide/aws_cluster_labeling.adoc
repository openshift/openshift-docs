[[admin-guide-aws-cluster-labeling]]
= Cluster Labeling for Amazon Web Services (AWS)
{product-author}
{product-version}
:data-uri:
:icons:
:experimental:
:toc: macro
:toc-title:

toc::[]

== Overview
This topic describes how to label an existing {product-title} cluster running on
Amazon Web Services (AWS).

In order to correctly identify which resources are associated to a cluster, resources
should be tagged with the key `kubernetes.io/cluster/<name>` where <name> is a unique
name for the cluster.  Tagging all resources with the `kubernetes.io/cluster/<name>`
tag will avoid potential issues with mutliple zones or multiple clusters.

== Resources That Need Tags
There are 4 types of resources that need to be tagged:

* Instances
* Security Groups
* Load Balancers
* EBS Volumes

== Steps for Tagging an Existing Cluster
A cluster will use value of the `kubernetes.io/cluster/<name>` tag to determine which
resources belond to the cluster.  Therefore, all resources must be tagged with the
key `kubernetes.io/cluster/<name>` and have the same value for that key.

. Tag all instances with `kubernetes.io/cluster/<name>` and a value to be used as the cluster id
. Tag any security groups with `kubernetes.io/cluster/<name>` and the same value as was used for the instances
. Tag any load-balancers with `kubernetes.io/cluster/<name>` and the same value as was used for the instances
. Tag all EBS volumes with `kubernetes.io/cluster/<name>` and the same value as was used for the instances. The EBS Volumes that need to be tagged can found with:
[source,bash]
oc get pv -o json|jq '.items[].spec.awsElasticBlockStore.volumeID'

. Restart atomic-openshift-master and atomic-openshift-node process on all nodes:
[source,bash]
systemctl restart atomic-openshift-master-api atomic-openshift-master-controller atomic-openshift-node

