:_mod-docs-content-type: ASSEMBLY
[id="k8s-nmstate-updating-node-network-config"]
= Observing and updating the node network state and configuration
include::_attributes/common-attributes.adoc[]
:VirtProductName: OpenShift Container Platform
:context: k8s_nmstate-updating-node-network-config

toc::[]


include::modules/virt-viewing-network-state-of-node.adoc[leveloffset=+1]

include::modules/virt-viewing-network-state-of-node-console.adoc[leveloffset=+1]

include::modules/virt-node-network-config-console.adoc[leveloffset=+1]
include::modules/virt-monitor-node-network-config-console.adoc[leveloffset=+2]
include::modules/virt-create-node-network-config-console.adoc[leveloffset=+2]

=== Updating the policy
include::modules/virt-update-node-network-config-form.adoc[leveloffset=+3]
include::modules/virt-update-node-network-config-yaml.adoc[leveloffset=+3]
include::modules/virt-delete-node-network-config.adoc[leveloffset=+2]

[id="virt-manage-nncp-cli"]
== Managing policy by using the CLI
include::modules/virt-creating-interface-on-nodes.adoc[leveloffset=+2]

[discrete]
[role="_additional-resources"]
== Additional resources
* xref:../../networking/k8s_nmstate/k8s-nmstate-updating-node-network-config.adoc#virt-example-nmstate-multiple-interfaces_{context}[Example for creating multiple interfaces in the same policy]
* xref:../../networking/k8s_nmstate/k8s-nmstate-updating-node-network-config.adoc#virt-example-nmstate-IP-management_{context}[Examples of different IP management methods in policies]

include::modules/virt-confirming-policy-updates-on-nodes.adoc[leveloffset=+2]

include::modules/virt-removing-interface-from-nodes.adoc[leveloffset=+2]

[id="virt-nmstate-example-policy-configurations"]
== Example policy configurations for different interfaces

The following examples show different `NodeNetworkConfigurationPolicy` manifest configurations.

For best performance, consider the following factors when applying a policy:

* When you need to apply a policy to more than one node, create a `NodeNetworkConfigurationPolicy` manifest for each target node. Scoping a policy to a single node reduces the overall length of time for the Kubernetes NMState Operator to apply the policies.
+
In contrast, if a single policy includes configurations for several nodes, the Kubernetes NMState Operator applies the policy to each node in sequence, which increases the overall length of time for policy application.

* All related network configurations should be specified in a single policy.
+
When a node restarts, the Kubernetes NMState Operator cannot control the order in which policies are applied. Therefore, the Kubernetes NMState Operator might apply interdependent policies in a sequence that results in a degraded network object.

include::modules/virt-example-bridge-nncp.adoc[leveloffset=+2]

include::modules/virt-example-vlan-nncp.adoc[leveloffset=+2]

include::modules/virt-example-vf-host-services.adoc[leveloffset=+2]

[role="_additional-resources"]
.Additional resources
* xref:../../networking/hardware_networks/configuring-sriov-device.adoc#configuring-sriov-device[Configuring an SR-IOV network device]

include::modules/virt-example-bond-nncp.adoc[leveloffset=+2]

include::modules/virt-example-ethernet-nncp.adoc[leveloffset=+2]

include::modules/virt-example-nmstate-multiple-interfaces.adoc[leveloffset=+2]

include::modules/virt-example-host-vrf.adoc[leveloffset=+2]

[role="_additional-resources"]
.Additional resources

* xref:../../networking/multiple_networks/about-virtual-routing-and-forwarding.adoc#cnf-about-virtual-routing-and-forwarding_about-virtual-routing-and-forwarding[About virtual routing and forwarding]
* xref:../../networking/metallb/metallb-configure-bgp-peers.adoc#nw-metallb-bgp-peer-vrf_configure-metallb-bgp-peers[Exposing a service through a network VRF]

[id="capturing-nic-static-ip_k8s-nmstate-updating-node-network-config"]
== Capturing the static IP of a NIC attached to a bridge

ifdef::openshift-enterprise[]
:FeatureName: Capturing the static IP of a NIC
include::snippets/technology-preview.adoc[leveloffset=+2]
endif::[]

include::modules/virt-example-inherit-static-ip-from-nic.adoc[leveloffset=+2]

[role="_additional-resources"]
.Additional resources
* link:https://nmstate.io/nmpolicy/user-guide/102-policy-syntax.html[The NMPolicy project - Policy syntax]

// Examples: IP management
include::modules/virt-example-nmstate-IP-management.adoc[leveloffset=+1]
