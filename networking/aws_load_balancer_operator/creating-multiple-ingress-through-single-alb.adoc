// Module included in the following assemblies:
//
// * networking/aws_load_balancer_operator/multiple-ingress-through-single-alb.adoc

:_content-type: PROCEDURE
[id="nw-creating-multiple-ingress-through-single-alb_{context}"]
= creating-multiple-ingress-through-single-alb

The user can route the traffic to multiple Ingresses through a single ALB.

.Prerequisites

.Procedure

. Create an `AWSLoadBalancerController` and three `Ingress` resources:
+
[source,yaml]
----
kind: Ingress
metadata:
  name: example-1 <1>
  annotations:
    alb.ingress.kubernetes.io/scheme: internet-facing <2>
    alb.ingress.kubernetes.io/group.name: example <3>
    alb.ingress.kubernetes.io/group.order: "1" <4>
spec:
  ingressClass: alb <5>
  rules:
  - host: example.com <6>
    http:
        paths:
        - path: /blog <7>
          backend:
            service:
              name: example-1 <8>
              port:
                number: 80 <9>
  —--
kind: Ingress
metadata:
  name: example-2
  annotations:
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/group.name: example
    alb.ingress.kubernetes.io/group.order: "2"
spec:
  ingressClass: alb
  rules:
  - host: example.com
    http:
        paths:
        - path: /store
          backend:
            service:
              name: example-2
              port:
                number: 80
  —--
kind: Ingress
  metadata:
  name: example-3
  annotations:
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/group.name: example
    alb.ingress.kubernetes.io/group.order: "3"
spec:
  ingressClass: alb
  rules:
  - host: example.com
    http:
        paths:
        - path: /
          backend:
            service:
              name: example-3
              port:
                number: 80
----

<1> Defines name of an `Ingress`.
<2> Indicates the load balancer to provision in the public subnet and makes it accessible over the internet.
<3> The name of the `IngressGroup` ensures that the same load balancer services all Ingresses that belong the group .
<4> Specifies the order in which the rules from the Ingresses are matched when the request is received at the load balancer.
<5> Specifies `IngressClass` that belongs to this `Ingress`.
<6> Defines name of a `domain` used for request routing.
<7> Defines the `path` which must route to the `service`.
<8> Defines the `name` of the `service` which serves the endpoint configured in the `Ingress`.
<9> Defines the `port` on the `service` which serves the endpoint.
