:_mod-docs-content-type: ASSEMBLY
include::_attributes/common-attributes.adoc[]
[id="log6x-clf"]
= Configuring log forwarding
:context: logging-6x

toc::[]

The `ClusterLogForwarder` CR serves as a single point of configuration for log forwarding, making it easier to manage and maintain log collection and forwarding rules.

* Defines inputs (sources) for log collection
* Specifies outputs (destinations) for log forwarding
* Configures filters for log processing
* Defines pipelines to route logs from inputs to outputs
* Indicates management state (managed or unmanaged)

// Needs engineering eval re applicability to 6.0
include::modules/log6x-create-log-forwarder.adoc[leveloffset=+1]

// This needs to be called out extensively.
.Example ClusterLogForwarder CR
[source,yaml]
----
apiVersion: observability.openshift.io/v1
kind: ClusterLogForwarder
metadata:
  name: logging
  namespace: openshift-logging
spec:
  serviceAccount:
    name: <service_account_name> 
  collector:
    nodeSelector:
      kubernetes.io/os: linux
  filters:
  - name: add-label
    openshiftLabels:
      custom-labels-added: "true"
    type: openshiftLabels
  inputs:
  - application:
      includes:
      - namespace: project-qa-1
      - namespace: project-qa-2
      selector:
        matchLabels:
          test: centos-logtest
    name: selected-app-logs
    type: application
  managementState: managed
  outputs:
  - lokiStack:
      authentication:
        token:
          from: serviceAccount
      target:
        name: lokistack-sample
        namespace: openshift-logging
    name: default
    tls:
      ca:
        configMapName: openshift-service-ca.crt
        key: service-ca.crt
    type: lokiStack
  pipelines:
  - filterRefs:
    - add-label
    inputRefs:
    - selected-app-logs
    name: pipe1
    outputRefs:
    - default
  serviceAccount:
    name: logcollector
----

// All of these need to be validated by engineering for 6.0.
include::modules/log6x-audit-log-filtering.adoc[leveloffset=+1]

include::modules/log6x-content-filter-drop-records.adoc[leveloffset=+1]

include::modules/log6x-content-filter-prune-records.adoc[leveloffset=+1]

include::modules/log6x-input-spec-filter-audit-infrastructure.adoc[leveloffset=+1]

include::modules/log6x-input-spec-filter-labels-expressions.adoc[leveloffset=+1]

include::modules/log6x-input-spec-filter-namespace-container.adoc[leveloffset=+1]

include::modules/log6x-multiline-except.adoc[leveloffset=+1]