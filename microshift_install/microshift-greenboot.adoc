:_mod-docs-content-type: ASSEMBLY
[id="microshift-greenboot"]
= The Greenboot health check
include::_attributes/attributes-microshift.adoc[]
:context: microshift-greenboot

toc::[]

Greenboot is the generic health check framework for the `systemd` service on RPM-OSTree-based systems. The `microshift-greenboot` RPM and `greenboot-default-health-checks` are RPM packages installed with {microshift-short}. Greenboot is used to assess system health and automate a rollback to the last healthy state in the event of software trouble, for example:

* This health check framework is especially useful when you need to check for software problems and perform system rollbacks on edge devices where direct serviceability is either limited or non-existent.
* When health check scripts are installed and configured, health checks run every time the system starts.
* Using Greenboot can reduce your risk of being locked out of edge devices during updates and prevent a significant interruption of service if an update fails.
* When a failure is detected, the system boots into the last known working configuration using the `rpm-ostree` rollback capability.

A {microshift-short} application health check script is included in the `microshift-greenboot` RPM. The `greenboot-default-health-checks` RPM also includes health check scripts verifying that DNS and `ostree` services are accessible. In addition, you can create your own health check scripts for the workloads you are running. You can write one that verifies that an application has started, for example.

[NOTE]
====
Rollback is not possible in the case of an update failure on a system not using OSTree. This is true even though health checks might run.
====

include::modules/microshift-greenboot-dir-structure.adoc[leveloffset=+1]

include::modules/microshift-greenboot-microshift-health-script.adoc[leveloffset=+1]

include::modules/microshift-greenboot-systemd-journal-data.adoc[leveloffset=+1]

[role="_additional-resources"]
.Additional resources
* xref:../microshift_running_apps/microshift-applications.adoc#microshift-manifests-example_applications-microshift[Auto applying manifests]

include::modules/microshift-greenboot-updates-workloads.adoc[leveloffset=+1]

include::modules/microshift-greenboot-workloads-validation.adoc[leveloffset=+1]

include::modules/microshift-greenboot-health-check-log.adoc[leveloffset=+1]

include::modules/microshift-greenboot-prerollback-log.adoc[leveloffset=+1]

include::modules/microshift-greenboot-check-update.adoc[leveloffset=+1]

[id="additional-resources_microshift-greenboot_{context}"]
[role="_additional-resources_microshift-greenboot"]
== Additional resources
* xref:../microshift_running_apps/microshift-greenboot-workload-scripts.adoc#microshift-greenboot-workload-scripts[Greenboot workload health check scripts]