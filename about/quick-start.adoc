:_mod-docs-content-type: ASSEMBLY
include::_attributes/common-attributes.adoc[]
[id="quick-start"]
= Quick start
:context: quick-start

toc::[]

.Prerequisites
* You have access to an {ocp-product-title} cluster with `cluster-admin` permissions.
* You have installed the {oc-first}.
* You have access to a supported object store. For example, AWS S3, Google Cloud Storage, {azure-short}, Swift, Minio, or {rh-storage}.

.Procedure

. Install the `{clo}`, `{loki-op}`, and `{coo-first}` from OperatorHub.

. Create a secret to access an existing object storage bucket: 
+
.Example command for AWS
[source,terminal,subs="+quotes"]
----
$ oc create secret generic logging-loki-s3 \
  --from-literal=bucketnames="<bucket_name>" \
  --from-literal=endpoint="<aws_bucket_endpoint>" \
  --from-literal=access_key_id="<aws_access_key_id>" \
  --from-literal=access_key_secret="<aws_access_key_secret>" \
  --from-literal=region="<aws_region_of_your_bucket>" \
  -n openshift-logging
----

. Create a `LokiStack` custom resource (CR) in the `openshift-logging` namespace:
+
[source,yaml]
----
apiVersion: loki.grafana.com/v1
kind: LokiStack
metadata:
  name: logging-loki
  namespace: openshift-logging
spec:
  managementState: Managed
  size: 1x.extra-small
  storage:
    schemas:
    - effectiveDate: '2022-06-01'
      version: v13
    secret:
      name: logging-loki-s3
      type: s3
  storageClassName: gp3-csi
  tenants:
    mode: openshift-logging
----

. Create a service account for the collector:
+
[source,shell]
----
$ oc create sa collector -n openshift-logging
----

. Bind the `ClusterRole` to the service account:
+
[source,shell]
----
$ oc adm policy add-cluster-role-to-user logging-collector-logs-writer -z collector -n openshift-logging
----

. Create a `UIPlugin` to enable the Log section in the Observe tab:
+
[source,yaml]
----
apiVersion: observability.openshift.io/v1alpha1
kind: UIPlugin
metadata:
  name: logging
spec:
  type: Logging
  logging:
    lokiStack:
      name: logging-loki
----

. Add additional roles to the collector service account:
+
[source,shell]
----
$ oc adm policy add-cluster-role-to-user collect-application-logs -z collector -n openshift-logging
----
+
[source,terminal]
----
$ oc adm policy add-cluster-role-to-user collect-audit-logs -z collector -n openshift-logging
----
+
[source,terminal]
----
$ oc adm policy add-cluster-role-to-user collect-infrastructure-logs -z collector -n openshift-logging
----

. Create a `ClusterLogForwarder` CR to configure log forwarding:
+
[source,yaml]
----
apiVersion: observability.openshift.io/v1
kind: ClusterLogForwarder
metadata:
  name: collector
  namespace: openshift-logging
spec:
  serviceAccount:
    name: collector
  outputs:
  - name: default-lokistack
    type: lokiStack
    lokiStack:
      target:
        name: logging-loki
        namespace: openshift-logging
      authentication:
        token:
          from: serviceAccount
    tls:
      ca:
        key: service-ca.crt
        configMapName: openshift-service-ca.crt
  pipelines:
  - name: default-logstore
    inputRefs:
    - application
    - infrastructure
    outputRefs:
    - default-lokistack
----

.Verification
* Verify that logs are visible in the *Log* section of the *Observe* tab in the {ocp-product-title} web console.
