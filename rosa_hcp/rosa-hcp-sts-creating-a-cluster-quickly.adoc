:_content-type: ASSEMBLY
[id="rosa-hcp-sts-creating-a-cluster-quickly"]
= Creating hosted control planes for ROSA cluster using the default options
include::_attributes/attributes-openshift-dedicated.adoc[]
:context: rosa-hcp-sts-creating-a-cluster-quickly

toc::[]

[NOTE]
====
If you are looking for a quickstart guide for ROSA, see xref:../rosa_getting_started/rosa-quickstart-guide-ui.adoc#rosa-quickstart-guide-ui[{product-title} quickstart guide].
====

{hcp-first} for {product-title} (ROSA) offers a more efficient and reliable architecture for creating ROSA clusters. With {hcp} for ROSA, each cluster has a dedicated control plane that is isolated in a Red Hat account. 

[IMPORTANT]
====
Since it is not possible to "upgrade" to a {hcp} architecture, you must create a new cluster to benefit from the {hcp} for {product-title} functionality.
====

Create {hcp} for a {product-title} (ROSA) cluster quickly by using the default options and automatic AWS Identity and Access Management (IAM) resource creation. You can deploy your cluster by using the ROSA CLI (`rosa`).

[NOTE]
====
All {hcp} for ROSA clusters require AWS Security Token Service (STS) to be enabled.
====

include::modules/rosa-hcp-classic-comparison.adoc[leveloffset=+2]

The procedures in this document use the `auto` mode in the ROSA CLI (`rosa`) to immediately create the required IAM resources using the current AWS account. The required resources include the account-wide IAM roles and policies, cluster-specific Operator roles and policies, and OpenID Connect (OIDC) identity provider.

Alternatively, you can use `manual` mode, which outputs the `aws` commands needed to create the IAM resources instead of deploying them automatically. For steps to deploy a {hcp} for ROSA cluster by using `manual` mode or with customizations, see xref:../rosa_install_access_delete_clusters/rosa-sts-creating-a-cluster-with-customizations.adoc#rosa-sts-creating-cluster-using-customizations_rosa-sts-creating-a-cluster-with-customizations[Creating a cluster using customizations].

[id="next-steps-hcp_{context}"]
.Next steps

* Ensure that you have completed the xref:../rosa_planning/rosa-sts-aws-prereqs.adoc[AWS prerequisites].

include::modules/rosa-sts-overview-of-the-default-cluster-specifications.adoc[leveloffset=+1]
//include::modules/rosa-sts-understanding-aws-account-association.adoc[leveloffset=+1]

// Commenting this section until OCM functionality is supported
//[role="_additional-resources"]
//.Additional resources
//
//* For detailed steps to create and link the {cluster-manager} and user IAM roles, see xref:../rosa_install_access_delete_clusters/rosa-sts-creating-a-cluster-quickly.adoc#rosa-sts-associating-your-aws-account_rosa-sts-creating-a-cluster-quickly[Associating your AWS account with your Red Hat organization].
//
//include::modules/rosa-sts-creating-a-cluster-quickly-ocm.adoc[leveloffset=+1]
//include::modules/rosa-sts-associating-your-aws-account.adoc[leveloffset=+2]
include::modules/rosa-hcp-creating-account-wide-sts-roles-and-policies.adoc[leveloffset=+1]
[id="rosa-hcp-creating-vpc"]
= Creating a Virtual Private Cloud for your ROSA {hcp} clusters

You must have a Virtual Private Cloud (VPC) to create {hcp} for ROSA cluster. You can manually create these using the AWS console, or you can use `terraform` to create a VPC by using a template.

include::modules/rosa-hcp-vpc-terraform.adoc[leveloffset=+2]

include::modules/rosa-hcp-vpc-manual.adoc[leveloffset=+2]

[role="_additional-resources"]
[id="additional-resources_rosa-hcp-vpc-aws"]
.Additional resources

* link:https://docs.aws.amazon.com/vpc/latest/userguide/vpc-getting-started.html[Get Started with Amazon VPC]
* link:https://developer.hashicorp.com/terraform[HashiCorp Terraform documentation]

[id="rosa-hcp-byo-odic-overview_{context}"]
== Creating an OpenID Connect Configuration

When using a Red Hat-hosted cluster, you can create a managed or unmanaged OpenID Connect (OIDC) configuration that is generated by the CLI. With a managed OIDC configuration, it is stored within Red Hat's AWS account. A generated unmanaged OIDC configuration is stored in your AWS account. The configuration is registered to be used with OCM. This generated unmanaged OIDC configuration provides the private key for you to access. This process does not provide a private key for users to access.

[discrete]
include::modules/rosa-hcp-byo-oidc.adoc[leveloffset=+2]

[discrete]
include::modules/rosa-hcp-byo-oidc-options.adoc[leveloffset=+2]

include::modules/rosa-hcp-sts-creating-a-cluster-cli.adoc[leveloffset=+1]

[id="next-steps-2_{context}"]
== Next steps

* xref:../rosa_install_access_delete_clusters/rosa-sts-accessing-cluster.adoc#rosa-sts-accessing-cluster[Accessing a ROSA cluster]

[role="_additional-resources"]
[id="additional-resources_rosa-sts-creating-a-cluster-quickly"]
== Additional resources

* For steps to deploy a ROSA cluster using manual mode, see xref:../rosa_install_access_delete_clusters/rosa-sts-creating-a-cluster-with-customizations.adoc#rosa-sts-creating-cluster-using-customizations_rosa-sts-creating-a-cluster-with-customizations[Creating a cluster using customizations].
* For more information about the AWS Identity Access Management (IAM) resources required to deploy {product-title} with STS, see xref:../rosa_architecture/rosa-sts-about-iam-resources.adoc#rosa-sts-about-iam-resources[About IAM resources for clusters that use STS].
* For details about optionally setting an Operator role name prefix, see xref:../rosa_architecture/rosa-sts-about-iam-resources.adoc#rosa-sts-about-operator-role-prefixes_rosa-sts-about-iam-resources[About custom Operator IAM role prefixes].
* For information about the prerequisites to installing ROSA with STS, see xref:../rosa_planning/rosa-sts-aws-prereqs.adoc#rosa-sts-aws-prereqs[AWS prerequisites for ROSA with STS].
* For details about using the `auto` and `manual` modes to create the required STS resources, see xref:../rosa_install_access_delete_clusters/rosa-sts-creating-a-cluster-with-customizations.adoc#rosa-understanding-deployment-modes_rosa-sts-creating-a-cluster-with-customizations[Understanding the auto and manual deployment modes].
* For more information about using OpenID Connect (OIDC) identity providers in AWS IAM, see link:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_create_oidc.html[Creating OpenID Connect (OIDC) identity providers] in the AWS documentation.
* For more information about troubleshooting ROSA cluster installations, see xref:../sd_support/rosa-troubleshooting-installations.adoc#rosa-troubleshooting-installations[Troubleshooting installations].
* For steps to contact Red Hat Support for assistance, see xref:../rosa_architecture/rosa-getting-support.adoc#rosa-getting-support[Getting support for Red Hat OpenShift Service on AWS].