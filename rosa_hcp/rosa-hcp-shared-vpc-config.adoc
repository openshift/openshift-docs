:_mod-docs-content-type: ASSEMBLY
include::_attributes/attributes-openshift-dedicated.adoc[]
[id="rosa-hcp-shared-vpc-config"]
= Configuring a shared VPC for {product-title} clusters
:context: rosa-shared-vpc-config

toc::[]

You can create {product-title} clusters in shared, centrally-managed AWS virtual private clouds (VPCs).

include::snippets/install-cluster-in-vpc.adoc[]

[NOTE]
====
* This process requires *two separate* AWS accounts that belong to the same AWS organization. One account functions as the VPC-owning AWS account (*VPC Owner*), while the other account creates the cluster in the cluster-creating AWS account (*Cluster Creator*).

* Installing a cluster in a shared VPC is supported only for OpenShift 4.17.9 and later.
====

image::522-shared-vpc-overview.png[]

*{sp}The hosted zones can be created in either the centrally-managed VPC account or in the workload account in which the cluster is deployed.

[NOTE]
====
Only certain cluster-to-VPC relationships are supported. Multiple  {product-title} clusters in a single VPC are not supported. For more information, see link:https://access.redhat.com/solutions/6980058[Multiple {product-title} clusters in a single VPC]
====

.Prerequisites for the *VPC Owner*
* You have an AWS account with the proper permissions to create roles and share resources.
* You link:https://docs.aws.amazon.com/ram/latest/userguide/getting-started-sharing.html#getting-started-sharing-orgs[enabled resource sharing] from the management account for your organization.
* You have access to an AWS entrypoint such as the link:https://signin.aws.amazon.com[AWS console] or the link:https://aws.amazon.com/cli/[AWS command-line interface] (CLI).

.Prerequisites for the *Cluster Creator*
* You installed the link:https://console.redhat.com/openshift/downloads#tool-rosa[ROSA CLI (`rosa`)] 1.2.49 or later.
* You created all of the required link:https://docs.openshift.com/rosa/rosa_install_access_delete_clusters/rosa-sts-creating-a-cluster-quickly.html[{product-title} account roles] for creating a cluster.
* The *Cluster Creator's* AWS account is separate from the *VPC Owner's* AWS account.

include::modules/rosa-hcp-sharing-vpc-creation-and-sharing.adoc[leveloffset=+1]

[role="_additional-resources"]
[id="additional-resources_hcp-shared-vpc_vpc-creation"]
[discrete]
=== Additional resources
* See the AWS documentation for information about link:https://docs.aws.amazon.com/ram/latest/userguide/getting-started-sharing.html[sharing your AWS resources].

include::modules/rosa-hcp-sharing-vpc-dns-and-roles.adoc[leveloffset=+1]
include::modules/rosa-hcp-sharing-vpc-hosted-zones.adoc[leveloffset=+1]
include::modules/rosa-hcp-sharing-vpc-cluster-creation.adoc[leveloffset=+1]