:_mod-docs-content-type: ASSEMBLY
[id="ibi-image-based-install_{context}"]
= About image-based deployments for {sno} clusters
include::_attributes/common-attributes.adoc[]
:context: ibi-edge-image-based-install

toc::[]

When a host preinstalled with {sno} using an image-based installation arrives at a remote site, a technician can easily reconfigure and deploy the host in a matter of minutes.

To complete the deployment of a preinstalled host, you must first define site-specific configuration resources on the hub cluster for each host. These resources contain configuration information such as the properties of the bare-metal host, authentication details, and other deployment and networking information. 

The Image Based Install (IBI) Operator creates a configuration ISO from these resources, and then boots the host with the configuration ISO attached. The host mounts the configuration ISO and runs the reconfiguration process. When the reconfiguration completes, the {sno} cluster is ready.

[NOTE]
====
You must create distinct configuration resources for each bare-metal host. 
====

See the following high-level steps to deploy a preinstalled host:

* Install the IBI Operator on the hub cluster.
* Create site-specific configuration resources in the hub cluster for each host.
* Apply these resources in the hub cluster. 
* The IBI Operator creates a configuration ISO from these resources and boots the target host with the configuration ISO attached.
* The host mounts the configuration ISO and runs the reconfiguration process. When the reconfiguration completes, the {sno} cluster is ready. 

include::modules/ibi-install-ibi-operator.adoc[leveloffset=+1]

== Cluster configuration resources for deploying a preinstalled host
To complete a deployment for a preinstalled host at a remote site, you must configure the following site-specifc cluster configuration resources in the hub cluster for each bare-metal host.

.Cluster configuration resources reference
[cols="1,3", options="header"]
|===

| Resource | Description

|`Namespace`
|Namespace for the managed {sno} cluster.

|`BareMetalHost`
|Describes the physical host and its properties, such as the provisioning and hardware configuration.

|`Secret` for the bare-metal host
|Credentials for the host BMC.

|`Secret` for the image registry
|Credentials for the image registry. The secret for the image registry must be of type `kubernetes.io/dockerconfigjson`.

|`ImageClusterInstall`
|References the bare-metal host, deployment, and image set resources.

|`ClusterImageSet`
|Describes the release images to use for the cluster.

|`ClusterDeployment`
|Describes networking, authentication, and platform-specific settings.

|`ManagedCluster`
|Describes cluster details to enable {rh-rhacm-first} to register and manage.

|`ConfigMap`
|Describes networking setting, such as static networking and routing information. This is resource is optional.

|===

include::modules/ibi-create-config-iso.adoc[leveloffset=+1]

[role="_additional-resources"]
== Additional resources

* link:https://docs.openshift.com/container-platform/4.15/post_installation_configuration/bare-metal-configuration.html#about-the-baremetalhost-resource_post-install-bare-metal-configuration[About the BareMetalHost resource]

* link:https://docs.openshift.com/container-platform/4.15/openshift_images/managing_images/using-image-pull-secrets.html[Using image pull secrets]

