:_mod-docs-content-type: ASSEMBLY
[id="cloud-experts-custom-dns-resolver"]
= Tutorial: Deploying {product-title} with a Custom DNS Resolver

include::_attributes/attributes-openshift-dedicated.adoc[]
:context: cloud-experts-custom-dns-resolver

toc::[]

[role="_abstract"]
A link:https://docs.aws.amazon.com/vpc/latest/userguide/DHCPOptionSet.html[custom DHCP option set] enables you to customize your VPC with your own DNS server, domain name, and more. {product-title} clusters support using custom DHCP option sets. By default, {product-title} clusters require setting the "domain name servers" option to `AmazonProvidedDNS` to ensure successful cluster creation and operation. Customers who want to use custom DNS servers for DNS resolution must do additional configuration to ensure successful {product-title} cluster creation and operation. 

In this tutorial, we will configure our DNS server to forward DNS lookups for specific DNS zones (further detailed below) to an link:https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver.html[Amazon Route 53 Inbound Resolver]. 

[NOTE]
====
This tutorial uses the open-source BIND DNS server (`named`) to demonstrate the configuration necessary to forward DNS lookups to an Amazon Route 53 Inbound Resolver located in the VPC you plan to deploy a {product-title} cluster into. Refer to the documentation of your preferred DNS server for how to configure zone forwarding.
====

== Prerequisites

* ROSA CLI (`rosa`)
* AWS CLI (`aws`)
ifdef::openshift-rosa[]
* A manually created AWS VPC
endif::openshift-rosa[]
ifdef::openshift-rosa-hcp[]
* A xref:../rosa_hcp/rosa-hcp-sts-creating-a-cluster-quickly.adoc#rosa-hcp-creating-vpc_rosa-hcp-sts-creating-a-cluster-quickly[manually created AWS VPC]
endif::openshift-rosa-hcp[]
* A DHCP option set configured to point to a custom DNS server and set as the default for your VPC

include::modules/cloud-experts-custom-dns-resolver-environment-setup.adoc[leveloffset=+1]
include::modules/cloud-experts-custom-dns-resolver-create-inbound-resolver.adoc[leveloffset=+1]
ifdef::openshift-rosa-hcp[]
include::modules/cloud-experts-custom-dns-resolver-configure-dns-server-hcp.adoc[leveloffset=+1]
endif::openshift-rosa-hcp[]
ifdef::openshift-rosa[]
include::modules/cloud-experts-custom-dns-resolver-configure-dns-server-classic.adoc[leveloffset=+1]
endif::openshift-rosa[]

[role="_additional-resources"]
== Additional resources
ifdef::openshift-rosa[]
* xref:../rosa_install_access_delete_clusters/rosa-sts-creating-a-cluster-quickly.adoc#rosa-sts-creating-account-wide-sts-roles-and-policies_rosa-sts-creating-a-cluster-quickly[Create your cluster]
endif::openshift-rosa[]
ifdef::openshift-rosa-hcp[]
* xref:../rosa_hcp/rosa-hcp-sts-creating-a-cluster-quickly.adoc#rosa-hcp-sts-creating-a-cluster-quickly[Create your cluster]
endif::openshift-rosa-hcp[]