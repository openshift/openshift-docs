:_mod-docs-content-type: ASSEMBLY
[id="build-time-network-policy-tools"]
= Build-time network policy tools
include::modules/common-attributes.adoc[]
:context: network-policy-tools

toc::[]

[role="_abstract"]
Build-time network policy tools let you automate the creation and validation of Kubernetes network policies in your development and operations workflows using the `roxctl` CLI. These tools work with a specified file directory containing your project's workload and network policy manifests and do not require {product-title-short} authentication.

.Network policy tools
[%autowidth,options="header"]
|===
|Command |Description

|`roxctl netpol generate`
|Generates Kubernetes network policies by analyzing your project's YAML manifests in a specified directory. For more information, see xref:../operating/build-time-network-policy-tools.adoc#using-the-build-time-network-policy-generator_network-policy-tools[Using the build-time network policy generator].

|`roxctl netpol connectivity map`
|Lists the allowed connections between workloads in your project directory by examining the workload and Kubernetes network policy manifests. You can generate the output in various text formats or in a graphical `.dot` format. For more information, see xref:../operating/build-time-network-policy-tools.adoc#connectivity-mapping-using-the-roxctl-netpol-connectivity-map-command_network-policy-tools[Connectivity mapping using the roxctl netpol connectivity map command].

|`roxctl netpol connectivity diff`
|Creates a list of variations in the allowed connections between two project versions. This is determined by the workload and Kubernetes network policy manifests in each version's directory. This feature shows the semantic differences which are not obvious when performing a source code (syntactic) `diff`. For more information, see xref:../operating/build-time-network-policy-tools.adoc#identifying-the-differences-in-allowed-connections-between-project-versions_network-policy-tools[Identifying the differences in allowed connections between project versions].

|===

//Network policy generator
[id="build-time-network-policy-generator_{context}"]
== Build-time network policy generator

The build-time network policy generator can automatically generate Kubernetes network policies based on application YAML manifests. You can use it to develop network policies as part of the continuous integration/continuous deployment (CI/CD) pipeline before deploying applications on your cluster.

Red{nbsp}Hat developed this feature in partnership with the developers of the link:https://np-guard.github.io/[NP-Guard project].
First, the build-time network policy generator analyzes Kubernetes manifests in a local folder, including service manifests, config maps, and workload manifests such as `Pod`, `Deployment`, `ReplicaSet`, `Job`, `DaemonSet`, and `StatefulSet`.
Then, it discovers the required connectivity and creates the Kubernetes network policies to achieve pod isolation.
These policies allow no more and no less than the needed ingress and egress traffic.

include::modules/using-the-build-time-network-policy-generator.adoc[leveloffset=+2]

[role="_additional-resources"]
.Additional resources

* xref:../cli/command-reference/roxctl-netpol.adoc#roxctl-netpol-generate_roxctl-netpol[roxctl netpol generate command options].

.Next steps

* After generating the policies, you must inspect them for completeness and accuracy, in case any relevant network address was not specified as expected in the YAML files.

* Most importantly, verify that required connections are not blocked by the isolating policies. To help with this inspection you can use the `roxctl netpol connectivity map` tool.

[NOTE]
====
Applying network policies to the cluster as part of the workload deployment using automation saves time and ensures accuracy.
You can follow a GitOps approach by submitting the generated policies using pull requests, providing the team an opportunity to review the policies before deploying them as part of the pipeline.
====

//Connectivity mapping
include::modules/connectivity-mapping-using-the-roxctl-netpol-connectivity-map-command.adoc[leveloffset=+1]

include::modules/retrieving-connectivity-mapping-information-from-a-kubernetes-manifest-directory.adoc[leveloffset=+2]

[role="_additional-resources"]
.Additional resources

* xref:../cli/command-reference/roxctl-netpol.adoc#roxctl-netpol-connectivity-map_roxctl-netpol[roxctl netpol connectivity map command options].

include::modules/connectivity-map-output-formats-and-visualizations.adoc[leveloffset=+2]

include::modules/generating-svg-graphs-from-the-dot-output-using-graphviz.adoc[leveloffset=+2]

//Connectivity diff
include::modules/identifying-the-differences-in-allowed-connections-between-project-versions.adoc[leveloffset=+1]

include::modules/generating-connectivity-difference-reports.adoc[leveloffset=+2]

[role="_additional-resources"]
.Additional resources

* xref:../cli/command-reference/roxctl-netpol.adoc#roxctl-netpol-connectivity-diff_roxctl-netpol[roxctl netpol connectivity diff command options].
* link:https://github.com/np-guard/netpol-analyzer/blob/main/test_outputs/diff/diff_between_netpol-diff-example-minimal_and_netpol-analysis-example-minimal.txt[Output generated by the `roxctl netpol connectivity diff` command. Example 1: text format]
* link:https://github.com/np-guard/netpol-analyzer/blob/main/test_outputs/diff/diff_between_netpol-diff-example-minimal_and_netpol-analysis-example-minimal.md[Output generated by the `roxctl netpol connectivity diff` command. Example 2: md format]
* link:https://github.com/np-guard/netpol-analyzer/blob/main/test_outputs/diff/diff_between_netpol-diff-example-minimal_and_netpol-analysis-example-minimal.dot.svg[Output generated by the `roxctl netpol connectivity diff` command. Example 3: svg graph generated from dot format]
* link:https://github.com/np-guard/netpol-analyzer/blob/main/test_outputs/diff/diff_between_netpol-diff-example-minimal_and_netpol-analysis-example-minimal.csv[Output generated by the `roxctl netpol connectivity diff` command. Example 4: csv format]

include::modules/distinguishing-between-syntactic-and-semantic-difference-outputs.adoc[leveloffset=+2]

include::modules/syntactic-difference-output.adoc[leveloffset=+3]

include::modules/semantic-difference-output.adoc[leveloffset=+3]