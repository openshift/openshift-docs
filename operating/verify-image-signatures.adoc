[id="verify-image-signatures"]
= Verifying image signatures
include::modules/common-attributes.adoc[]
:context: verify-image-signatures

toc::[]

[role="_abstract"]
You can use {product-title} ({product-title-short}) to ensure the integrity of the container images in your clusters by verifying image signatures against pre-configured keys.

You can create policies to block unsigned images and images that do not have a verified signature.
You can also enforce the policy by using the {product-title-short} admission controller to stop unauthorized deployment creation.

[NOTE]
====
* {product-title-short} supports Cosign signature verification by using Cosign public keys, Cosign certificates, or both.
+
For more information about Cosign, see link:https://docs.sigstore.dev/cosign/signing/overview/[Overview] (Sigstore documentation).
* For Cosign signature verification, {product-title-short} supports communication with the transparency log.
+
For more information, see link:https://docs.sigstore.dev/logging/overview/[Rekor] (Sigstore documentation).
* For Cosign signature verification, you can use keyless verification with {product-title-short}. If you want to host the key infrastructure yourself, you can do this by using {rh-rhtas-first}.
* You must configure signature integration with at least 1 Cosign verification method for signature verification.
* For all deployed and watched images:
** {product-title-short} fetches and verifies the signatures every 4 hours.
** {product-title-short} verifies the signatures whenever you change or update your signature integration verification data.
====

//Securing container images by using signature integration
include::modules/securing-container-images-by-using-signature-integration.adoc[leveloffset=+1]

//Verifying image signatures to ensure image integrity
include::modules/verifying-image-signatures-to-ensure-image-integrity.adoc[leveloffset=+1]

[role="_additional-resources"]
.Additional resources
* xref:../operating/verify-image-signatures.adoc#securing-container-images-by-using-signature-integration_verify-image-signatures[Securing container images by using signature integration]

//Using signature verification in a policy
include::modules/use-signature-verification.adoc[leveloffset=+1]

[role="_additional-resources"]
.Additional resources
* xref:../operating/manage_security_policies/custom-security-policies.adoc#create-policy-from-system-policies-view_custom-security-policies[Creating a security policy from the system policies view]

* xref:../operating/manage_security_policies/security-policy-reference.adoc#policy-criteria_security-policy-reference[Understanding rules and policy criteria]

== Enforcing signature verification
To prevent the users from using unsigned images, you can enforce signature verification by using the {product-title-short} admission controller.
You must first enable the *Contact Image Scanners* feature in your cluster configuration settings.
Then, while creating a security policy to enforce signature verification, you can use the *Inform and enforce* option.

For more information, see xref:../operating/manage_security_policies/use-admission-controller-enforcement.adoc#enable-admission-controller-enforcement_use-admission-controller-enforcement[Enabling admission controller enforcement].

[role="_additional-resources"]
.Additional resources
* xref:../operating/manage_security_policies/custom-security-policies.adoc#create-policy-from-system-policies-view_custom-security-policies[Creating a security policy from the system policies view]
