// Module included in the following assemblies:
//
// * operating/manage-vulnerabilities/scan-rhcos-node-host.adoc
// * cloud_service/upgrading-cloud/upgrade-cloudsvc-roxctl.adoc
:_mod-docs-content-type: PROCEDURE
[id="rhcos-restore-node-scan-stackrox-scanner_{context}"]
= Restoring {op-system} node scanning with the StackRox Scanner

[role="_abstract"]
If you use {ocp}, you can enable scanning of {op-system-first} nodes for vulnerabilities by using {rh-rhacs-first}.
This feature is available with both the StackRox Scanner and Scanner V4.
Follow this procedure if you want to use the StackRox Scanner to scan {op-system-first} nodes,
but you want to keep using Scanner V4 to scan other nodes.
//Should this module be deleted? Why would the user want to keep scanning nodes with StackRox scanner since Scanner V4 now scans nodes and is installed by default?

.Prerequisites
* For scanning {op-system} node hosts of the secured cluster, you must have installed Secured Cluster services on {ocp} {ocp-supported-version} or later. For information about supported platforms and architecture, see the link:https://access.redhat.com/articles/7045053[{product-title} Support Matrix]. For life cycle support information for {product-title-short}, see the link:https://access.redhat.com/support/policy/updates/rhacs[{product-title} Support Policy].

.Procedure

To enable node indexing, also known as node scanning, by using the StackRox Scanner:

. Ensure that the StackRox Scanner is deployed in the Central cluster:
+
[source,terminal]
----
$ kubectl -n stackrox get deployment scanner scanner-db<1>
----
<1> For {ocp}, use `oc` instead of `kubectl`.
. In the Central pod, on the `central` container, set `ROX_NODE_INDEX_ENABLED` to `false` by running the following command on the Central cluster:
+
[source,terminal]
----
$ kubectl -n stackrox set env deployment/central ROX_NODE_INDEX_ENABLED=false<1>
----
<1> For {ocp}, use `oc` instead of `kubectl`.
. In the Collector Daemonset, in the `compliance` container, set `ROX_CALL_NODE_INVENTORY_ENABLED` to `true` by running the following command on all secured clusters where you want to enable node scanning:
+
[source,terminal]
----
$ kubectl -n stackrox set env daemonset/collector ROX_CALL_NODE_INVENTORY_ENABLED=true<1>
----
<1> For {ocp}, use `oc` instead of `kubectl`.
. To verify that node scanning is working, examine the Central logs for the following message:
+
[source,text]
----
Scanned node inventory <node_name> (id: <node_id>) with <number> components.
----
+
where:

<number>:: Specifies the number of discovered components.
<node_name>:: Specifies the name of the node.
<node_id>:: Specifies the internal ID of the node.

