[id="updating-cluster-using-custom-mcp"]
= Using custom machine config pools to delay 
include::modules/common-attributes.adoc[]
:context: updating-cluster-using-custom-mcp

toc::[]


However there might be some secenarios where a controlled rollout of upgrade to the worker nodes is desired.
This helps to make sure the mission critical application stays available during the whole update process even if the upgrade process causes a failure.
It is also useful in scenarios where we can not have a single maintenance window to complete the whole update process.

During an upgrade, the Machine Config Operator cordons and drains nodes up to the specified `maxUnavailable` number of nodes, if configured. This marks the nodes as unschedulable and evicts all pods from the nodes. If you have specific nodes that you do not want to drain and uncordon at the time of an update, before the update, create a custom machine config pool (MCP) and move the nodes the new MCP. Then, pause the MCP. The nodes associated with a paused MCP do not get updated. When you are ready to update those nodes, move the nodes back to the worker MCP and they will be updated. If you have more than one custom MCP for updating, after the first set nodes are updated, verify that your applications on the node are functioning properly before updating the other nodes.

[NOTE]
====
Creating custom MCP using master nodes is not supported. The Machine Config Operator ignores the custom MCP created for the master nodes. This is required to make sure control plane nodes remain stable.
====

This slow rollout of an update to the worker nodes can be characterized as a _canary_ release.

include::modules/update-upgrading-mcp.adoc[leveloffset=+1]

