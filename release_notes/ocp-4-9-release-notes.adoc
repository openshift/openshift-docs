[id="ocp-4-9-release-notes"]
= {product-title} {product-version} release notes
include::modules/common-attributes.adoc[]
:context: release-notes

toc::[]

Red Hat {product-title} provides developers and IT organizations with a hybrid cloud application platform for deploying both new and existing applications on secure, scalable resources with minimal configuration and management overhead. {product-title} supports a wide selection of programming languages and frameworks, such as Java, JavaScript, Python, Ruby, and PHP.

Built on {op-system-base-full} and Kubernetes, {product-title} provides a more secure and scalable multi-tenant operating system for today's enterprise-class applications, while delivering integrated application runtimes and libraries. {product-title} enables organizations to meet security, privacy, compliance, and governance requirements.

[id="ocp-4-9-about-this-release"]
== About this release

// TODO: Update k8s link once there is a version-specific URL for the Kubernetes release
{product-title} (link:https://access.redhat.com/errata/RHSA-2021:2438[RHSA-2021:2438]) is now available. This release uses link:https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.22.md[Kubernetes 1.22] with CRI-O runtime. New features, changes, and known issues that pertain to {product-title} {product-version} are included in this topic.

//Red Hat did not publicly release {product-title} 4.9.0 as the GA version and, instead, is releasing {product-title} 4.9.TBD as the GA version.

{product-title} {product-version} clusters are available at https://cloud.redhat.com/openshift. The {cloud-redhat-com} application for {product-title} allows you to deploy OpenShift clusters to either on-premise or cloud environments.

{product-title} {product-version} is supported on {op-system-base-full} 7.9 and 8.4, as well as on {op-system-first} 4.8.

You must use {op-system} machines for the control plane, and you can use either {op-system} or {op-system-base-full} 7.9 or 8.4 for compute machines.
//Removed the note per https://issues.redhat.com/browse/GRPA-3517

//{product-title} 4.6 is an Extended Update Support (EUS) release. More information on Red Hat OpenShift EUS is available in link:https://access.redhat.com/support/policy/updates/openshift#ocp4_phases[OpenShift Life Cycle] and link:https://access.redhat.com/support/policy/updates/openshift-eus[OpenShift EUS Overview].

With the release of {product-title} 4.9, version 4.6 is now end of life. For more information, see the link:https://access.redhat.com/support/policy/updates/openshift[Red Hat OpenShift Container Platform Life Cycle Policy].

[id="ocp-4-9-inclusive-language"]
== Making open source more inclusive

Red Hat is committed to replacing problematic language in our code, documentation, and web properties.

As part of that effort, with this release the following changes are in place:

* The link:https://github.com/openshift/openshift-docs[OpenShift Docs GitHub repository] `master` branch has been renamed to `main`.
* We have begun to progressively replace the terminology of "master" with "control plane". You will notice throughout the documentation that we use both terms, with "master" in parenthesis. For example "... the control plane node (also known as the master node)". In a future release, we will update this to be "the control plane node".

[id="ocp-4-9-add-on-support-status"]
== {product-title} layered and dependant component support and compatibility

The scope of support for layered and dependant components of {product-title} changes independently of the {product-title} version. To determine the current support status and compatibility for an add-on, refer to its release notes. For more information, see the link:https://access.redhat.com/support/policy/updates/openshift[Red Hat OpenShift Container Platform Life Cycle Policy].

[id="ocp-4-9-new-features-and-enhancements"]
== New features and enhancements

This release adds improvements related to the following components and concepts.

[id="ocp-4-9-rhcos"]
=== {op-system-first}

[id="ocp-4-9-installation-and-upgrade"]
=== Installation and upgrade

[id="ocp-4-9-installation-ash-upi"]
==== Installing a cluster on Microsoft Azure Stack Hub using user-provisioned infrastructure

{product-title} 4.9 introduces support for installing a cluster on Azure Stack Hub using user-provisioned infrastructure.

You can incorporate example Azure Resource Manager (ARM) templates provided by Red Hat to assist in the deployment process, or create your own. You are also free to create the required resources through other methods; the ARM templates are just an example.

//See ../installing/install_azure_stack_hub/installing-azure-stack-hub-user-infra.adoc#installing-azure-stack-hub-user-infra[Installing a cluster on Azure Stack Hub using ARM templates] for details.


[id=ocp-4.9-azure-cidr]
==== Increased size of Azure subnets within the machine CIDR
The {product-title} installation program for Microsoft Azure now creates subnets as large as possible within the machine CIDR. This lets the cluster use a machine CIDR that is appropriately sized to accommodate the number of nodes in the cluster.

[id="ocp-4-9-aws-china-regions"]
==== Support for AWS regions in China
{product-title} {product-version} introduces support for AWS regions in China. You can now install and update {product-title} clusters in the `cn-north-1` (Beijing) and `cn-northwest-1`(Ningxia) regions.

//For more information, ../installing/installing_aws/installing-aws-china.adoc[Installing a cluster on AWS into a China region].

[id="ocp-4-9-web-console"]
=== Web console

[id="ocp-4-9-ibm-z"]
=== IBM Z and LinuxONE

[id="ocp-4-9-ibm-power"]
=== IBM Power Systems

[id="ocp-4-9-security"]
=== Security and compliance

[id="ocp-4-9-networking"]
=== Networking

[id="ocp-4-9-ovn-kubernetes-egress-ips-balance"]
==== OVN-Kubernetes cluster network provider egress IP feature balances across nodes

The egress IP feature of OVN-Kubernetes now balances network traffic approximately equally across nodes for a given namespace, if that namespace is assigned multiple egress IP addresses. Each IP address must reside on a different node.
For more information, refer to xref:../networking/ovn_kubernetes_network_provider/configuring-egress-ips-ovn.adoc#configuring-egress-ips-ovn[Configuring egress IPs for a project] for OVN-Kubernetes.

[id="ocp-4-9-sriov-dpdk-ga"]
==== SR-IOV containerized Data Plane Development Kit (DPDK) is GA

The containerized Data Plane Development Kit (DPDK) is now GA in {product-title} {product-version}. For more information, see xref:../networking/hardware_networks/using-dpdk-and-rdma.adoc#using-dpdk-and-rdma[Using virtual functions (VFs) with DPDK and RDMA modes].

[id="ocp-4-9-storage"]
=== Storage

[id="ocp-4-9-registry"]
=== Registry

[id="ocp-4-9-olm"]
=== Operator lifecycle

[id="ocp-4-9-osdk"]
=== Operator development

[id="ocp-4-9-builds"]
=== Builds

[id="ocp-4-9-images"]
=== Images

[id="ocp-4-9-machine-api"]
=== Machine API

[id="ocp-4-9-machine-api-rhel8"]
==== {op-system-base-full} 8 now supported for compute machines

Starting in {product-title} {product-version}, you can now use {op-system-base-full} 8.4 for compute machines. Previously, {op-system-base} 8 was not supported for compute machines.

You cannot upgrade {op-system-base} 7 compute machines to {op-system-base} 8. You must deploy new {op-system-base} 8 hosts, and the old {op-system-base} 7 hosts should be removed.

[id="ocp-4-9-nodes"]
=== Nodes

[id="ocp-4-9-nodes-scheduler-profiles"]
==== Scheduler profiles GA

Scheduling pods using a scheduler profile is now generally available. This is a replacement for configuring a scheduler policy. The following scheduler profiles are available:

* `LowNodeUtilization`: This profile attempts to spread pods evenly across nodes to get low resource usage per node.

* `HighNodeUtilization`: This profile attempts to place as many pods as possible onto as few nodes as possible, to minimize node count with high usage per node.

* `NoScoring`: This is a low-latency profile that strives for the quickest scheduling cycle by disabling all score plug-ins. This might sacrifice better scheduling decisions for faster ones.

For more information, see xref:../nodes/scheduling/nodes-scheduler-profiles.adoc#nodes-scheduler-profiles[Scheduling pods using a scheduler profile].

[id="ocp-4-9-nodes-descheduler"]
==== New descheduler profiles and customization

The following descheduler profiles are now available:

* `SoftTopologyAndDuplicates`: This profile is the same as `TopologyAndDuplicates`, except that pods with soft topology constraints, such as `whenUnsatisfiable: ScheduleAnyway`, are also considered for eviction.
* `EvictPodsWithLocalStorage`: This profile allows pods with local storage to be eligible for eviction.
* `EvictPodsWithPVC`: This profile allows pods with persistent volume claims to be eligible for eviction.

You can also customize the pod lifetime value for the `LifecycleAndUtilization` profile.

For more information, see xref:../nodes/scheduling/nodes-descheduler.adoc#nodes-descheduler[Evicting pods using the descheduler].

[id="ocp-4-9-logging"]
=== Red Hat OpenShift Logging

In {product-title} 4.7, _Cluster Logging_ became _Red Hat OpenShift Logging_. For more information, see xref:../logging/cluster-logging-release-notes.adoc[Release notes for Red Hat OpenShift Logging].

[id="ocp-4-9-monitoring"]
=== Monitoring

[id="ocp-4-9-metering"]
=== Metering

The Metering Operator is deprecated as of {product-title} 4.6, and is scheduled to be removed in {product-title} 4.9.

[id="ocp-4-9-scale"]
=== Scale

[id="ocp-4-9-backup-and-restore"]
=== Backup and restore

[id="ocp-4-9-dev-exp"]
=== Developer experience

[id="ocp-4-9-insights-operator"]
=== Insights Operator

[id="ocp-4-9-auth"]
=== Authentication and authorization

[id="ocp-4-9-cco-ash-support"]
==== Support for Microsoft Azure Stack Hub with Cloud Credential Operator in manual mode

With this release, installations on Microsoft Azure Stack Hub can be performed by configuring the Cloud Credential Operator (CCO) in manual mode.

For more information, see xref:../authentication/managing_cloud_provider_credentials/cco-mode-manual.adoc[Using manual mode].

[id="ocp-4-9-sandboxed-containers"]
=== {sandboxed-containers-first}

FIPS mode is now automatically enabled for {sandboxed-containers-first}. {sandboxed-containers-first} deployed on an {product-title} cluster installed in FIPS mode will not taint the cluster's FIPS support. For more information, see

The {sandboxed-containers-operator} now includes a must-gather image, allowing you to collect custom resources and log files specific to this operator and the underlying runtime components for diagnostic purposes. For more information, see

You can now install the Sandboxed container operator in a disconnected environment. For more information, see

[id="ocp-4-9-notable-technical-changes"]
== Notable technical changes

{product-title} 4.9 introduces the following notable technical changes.

// Note: use [discrete] for these sub-headings.

[id="ocp-4-9-deprecated-removed-features"]
== Deprecated and removed features

Some features available in previous releases have been deprecated or removed.

Deprecated functionality is still included in {product-title} and continues to be supported; however, it will be removed in a future release of this product and is not recommended for new deployments. For the most recent list of major functionality deprecated and removed within {product-title} {product-version}, refer to the table below. Additional details for more fine-grained functionality that has been deprecated and removed are listed after the table.

In the table, features are marked with the following statuses:

* *GA*: _General Availability_
* *TP*: _Technology Preview_
* *DEP*: _Deprecated_
* *REM*: _Removed_

//TODO: remove anything that has been REM since 4.6

.Deprecated and removed features tracker
[cols="3,1,1,1",options="header"]
|====
|Feature |OCP 4.7 |OCP 4.8 |OCP 4.9

|Package manifest format (Operator Framework)
|DEP
|REM
|

|`oc adm catalog build`
|DEP
|REM
|

|`--filter-by-os` flag for `oc adm catalog mirror`
|DEP
|REM
|

|v1beta1 CRDs
|DEP
|DEP
|

|Docker Registry v1 API
|DEP
|DEP
|

|Metering Operator
|DEP
|DEP
|

|Scheduler policy
|DEP
|DEP
|

|`ImageChangesInProgress` condition for Cluster Samples Operator
|DEP
|DEP
|

|`MigrationInProgress` condition for Cluster Samples Operator
|DEP
|DEP
|

|Use of `v1` in `apiVersion` for {product-title} resources
|DEP
|DEP
|

|Use of `dhclient` in {op-system-first}
|DEP
|DEP
|

|Cluster Loader
|GA
|DEP
|

|Bring your own RHEL 7 compute machines
|DEP
|DEP
|DEP

|`lastTriggeredImageID` field in the `BuildConfig` spec for Builds
|GA
|DEP
|

|Jenkins Operator
|TP
|DEP
|

|HPA custom metrics adapter based on Prometheus
|TP
|REM
|

|====

[id="ocp-4-9-deprecated-features"]
=== Deprecated features

[id="ocp-4-9-removed-features"]
=== Removed features

[id="ocp-4-9-bug-fixes"]
== Bug fixes

*assisted-installer*

*Bare Metal Hardware Provisioning*

*Builds*

*Cloud Compute*

*Cloud Credential Operator*

*Cluster Version Operator*

*Compliance Operator*

*Console Kubevirt Plug-in*

*Console Storage Plug-in*

*DNS*

*etcd*

*Image Registry*

*ImageStreams*

*Insights Operator*

*Installer*

*kube-apiserver*

*Machine Config Operator*

*Metering Operator*
//TODO: remove if this Operator is removed as planned

*Monitoring*

*Networking*

*Node*

*oauth-apiserver*

*oc*

*Operator Lifecycle Manager (OLM)*

*Operator SDK*

*openshift-apiserver*

*Performance Addon Operator*

*RHCOS*

*Routing*

*Samples*

*service-ca*

*Storage*

*Web console (Administrator perspective)*

*Web console (Developer perspective)*

*Windows Containers*

[id="ocp-4-9-technology-preview"]
== Technology Preview features

Some features in this release are currently in Technology Preview. These experimental features are not intended for production use. Note the following scope of support on the Red Hat Customer Portal for these features:

link:https://access.redhat.com/support/offerings/techpreview[Technology Preview Features Support Scope]

In the table below, features are marked with the following statuses:

* *TP*: _Technology Preview_
* *GA*: _General Availability_
* *-*: _Not Available_
* *DEP*: _Deprecated_

//TODO: remove anything that has been GA since 4.6

.Technology Preview tracker
[cols="4,1,1,1",options="header"]
|====
|Feature |OCP 4.7 |OCP 4.8 |OCP 4.9

|Precision Time Protocol (PTP)
|TP
|TP
|

|`oc` CLI plug-ins
|TP
|GA
|

|Descheduler
|GA
|GA
|

|HPA for memory utilization
|GA
|GA
|

|Service Binding
|TP
|TP
|

|Raw Block with Cinder
|TP
|GA
|

|CSI volume snapshots
|GA
|GA
|

|CSI volume expansion
|TP
|TP
|

|vSphere Problem Detector Operator
|GA
|GA
|

|CSI Azure Disk Driver Operator
|-
|TP
|

|CSI GCP PD Driver Operator
|TP
|GA
|

|CSI OpenStack Cinder Driver Operator
|TP
|TP
|

|CSI AWS EBS Driver Operator
|TP
|TP
|

|CSI automatic migration
|-
|TP
|

|CSI inline ephemeral volumes
|TP
|TP
|

|CSI vSphere Driver Operator
|-
|TP
|

|Automatic device discovery and provisioning with Local Storage Operator
|TP
|TP
|

|OpenShift Pipelines
|TP
|GA
|

|OpenShift GitOps
|TP
|GA
|

|OpenShift sandboxed containers
|-
|TP
|TP

|Vertical Pod Autoscaler
|TP
|GA
|

|Cron jobs
|TP
|GA
|

|PodDisruptionBudget
|TP
|GA
|

|Adding kernel modules to nodes with kvc
|TP
|TP
|

|Egress router CNI plug-in
|TP
|GA
|

|Scheduler profiles
|TP
|TP
|GA

|Non-preempting priority classes
|TP
|TP
|

|Kubernetes NMState Operator
|TP
|TP
|

|Assisted Installer
|TP
|TP
|

|AWS Security Token Service (STS)
|TP
|GA
|GA

|Kdump
|TP
|TP
|

|OpenShift Serverless
|-
|GA
|

|Serverless functions
|-
|TP
|

|Data Plane Development Kit (DPDK) support
|TP
|TP
|GA

|====

[id="ocp-4-9-known-issues"]
== Known issues

// TODO: This known issue should carry forward to 4.8 and beyond! This needs some SME/QE review before being updated for 4.9.
* In {product-title} 4.1, anonymous users could access discovery endpoints. Later releases revoked this access to reduce the possible attack surface for security exploits because some discovery endpoints are forwarded to aggregated API servers. However, unauthenticated access is preserved in upgraded clusters so that existing use cases are not broken.
+
If you are a cluster administrator for a cluster that has been upgraded from {product-title} 4.1 to 4.8, you can either revoke or continue to allow unauthenticated access. It is recommended to revoke unauthenticated access unless there is a specific need for it. If you do continue to allow unauthenticated access, be aware of the increased risks.
+
[WARNING]
====
If you have applications that rely on unauthenticated access, they might receive HTTP `403` errors if you revoke unauthenticated access.
====
+
Use the following script to revoke unauthenticated access to discovery endpoints:
+
[source,bash]
----
## Snippet to remove unauthenticated group from all the cluster role bindings
$ for clusterrolebinding in cluster-status-binding discovery system:basic-user system:discovery system:openshift:discovery ;
do
### Find the index of unauthenticated group in list of subjects
index=$(oc get clusterrolebinding ${clusterrolebinding} -o json | jq 'select(.subjects!=null) | .subjects | map(.name=="system:unauthenticated") | index(true)');
### Remove the element at index from subjects array
oc patch clusterrolebinding ${clusterrolebinding} --type=json --patch "[{'op': 'remove','path': '/subjects/$index'}]";
done
----
+
This script removes unauthenticated subjects from the following cluster role bindings:
+
--
** `cluster-status-binding`
** `discovery`
** `system:basic-user`
** `system:discovery`
** `system:openshift:discovery`
--
+
(link:https://bugzilla.redhat.com/show_bug.cgi?id=1821771[*BZ#1821771*])

// TODO: This known issue should carry forward to 4.9 and beyond!
* The `oc annotate` command does not work for LDAP group names that contain an equal sign (`=`), because the command uses the equal sign as a delimiter between the annotation name and value. As a workaround, use `oc patch` or `oc edit` to add the annotation. (link:https://bugzilla.redhat.com/show_bug.cgi?id=1917280[*BZ#1917280*])

[id="ocp-4-9-asynchronous-errata-updates"]
== Asynchronous errata updates

Security, bug fix, and enhancement updates for {product-title} 4.9 are released as asynchronous errata through the Red Hat Network. All {product-title} 4.9 errata is https://access.redhat.com/downloads/content/290/[available on the Red Hat Customer Portal]. See the https://access.redhat.com/support/policy/updates/openshift[{product-title} Life Cycle] for more information about asynchronous errata.

Red Hat Customer Portal users can enable errata notifications in the account settings for Red Hat Subscription Management (RHSM). When errata notifications are enabled, users are notified via email whenever new errata relevant to their registered systems are released.

[NOTE]
====
Red Hat Customer Portal user accounts must have systems registered and consuming {product-title} entitlements for {product-title} errata notification emails to generate.
====

This section will continue to be updated over time to provide notes on enhancements and bug fixes for future asynchronous errata releases of {product-title} 4.9. Versioned asynchronous releases, for example with the form {product-title} 4.9.z, will be detailed in subsections. In addition, releases in which the errata text cannot fit in the space provided by the advisory will be detailed in subsections that follow.

[IMPORTANT]
====
For any {product-title} release, always review the instructions on xref:../updating/updating-cluster.adoc#updating-cluster[updating your cluster] properly.
====

[id="ocp-4-9-0-ga"]
=== #RHSA-2021:TBD1# - {product-title} #4.9.0# image release, bug fix, and security update advisory

Issued: #2021-10-18#

{product-title} release #4.9.0#, which includes security updates, is now available. The list of bug fixes that are included in the update is documented in the #link:https://access.redhat.com/errata/RHSA-2021:TBD1[RHSA-2021:TBD1]# advisory. The RPM packages that are included in the update are provided by the #link:https://access.redhat.com/errata/RHSA-2021:TBD2[RHSA-2021:TBD2]# advisory.

Space precluded documenting all of the container images for this release in the advisory. See the following article for notes on the container images in this release:

#link:https://access.redhat.com/solutions/TBD3[{product-title} 4.9.0 container image list]#
