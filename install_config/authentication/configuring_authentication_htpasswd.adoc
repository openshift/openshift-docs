[[install-config-configuring-authentication-htpasswd]]
= Configuring the HTPasswd Identity Provider
{product-author}
{product-version}
:data-uri:
:icons:
:experimental:
:toc: macro
:toc-title:
:prewrap!:


toc::[]

== Overview


You can configure the {product-title} master configuration file to use the HTPassword identity provider for authentication within your cluster.

== Configuring HTPasswd Authentication

Set `HTPasswdPasswordIdentityProvider` in the `identityProviders` stanza to
validate user names and passwords against a flat file generated using
link:http://httpd.apache.org/docs/2.4/programs/htpasswd.html[`htpasswd`].

{product-title} supports the Bcrypt, SHA-1, and MD5 cryptographic hash
functions. MD5 is the default for `htpasswd`. Plaintext, encrypted text, and
other hash functions are not currently supported.

For information on creating the required HTPasswd user name and password file, see xref:config_auth_using_htpasswd[Using the `htpasswd` Command] below.

To configure the HTPasswd identity provider:

include::install_config/authentication/configuring_authentication_allow_all.adoc[tag=configuring_authentication_common_steps1]

. Specify the `mappingMethod` parameter to determine how identities are mapped to users.
include::install_config/authentication/configuring_authentication_allow_all.adoc[tag=configuring_authentication_common_steps2]

. Specify the following values to configure HTPasswd authentication:
+
.Master Configuration Using `HTPasswdPasswordIdentityProvider`
====

----
oauthConfig:
  ...
  identityProviders:
  - challenge: true
    login: true
    mappingMethod: claim
    name: my_htpasswd_provider <1>
    provider:
      apiVersion: v1
      kind: HTPasswdPasswordIdentityProvider <2>
      file: /path/to/users.htpasswd <3>
----
<1> This provider name is prefixed to provider user names to form an identity
name.
<2> Specify *_HTPasswdPasswordIdentityProvider_* as the provider kind.
<3> File generated using `htpasswd`. See xref:config_auth_using_htpasswd[Using the `htpasswd` Command] in the following section.
====

include::install_config/authentication/configuring_authentication_allow_all.adoc[tag=restart-after-config-master]


[[config_auth_using_htpasswd]]
== Using the `htpasswd` Command

If necessary, download the `http-tools` package to install the `htpasswd` utility.

----
# yum install httpd-tools
----

To use the htpasswd command:

// tag::htpasswd[]

* To create a flat file with a user name and password, execute the following command:
+
----
$ htpasswd -c </path/to/users.htpasswd> <username>
----
+
Then, enter and confirm a clear-text password for the user. The command generates a file with a hashed version of the password.
+
For example:
+
----
htpasswd -c users.htpasswd user1
New password:
Re-type new password:
Adding password for user user1
----
+
----
cat users.htpasswd
admin:$apr1$CSTJyOhm.ZfUGuwp3h0
user1:$apr1$SBjNoyoBnYPgZM0fCkh.
----
+
[NOTE]
====
You can include the `-b` option to supply the password on the command line:

----
$ htpasswd -c -b <username> <password>
----

For example:
----
$ htpasswd -c -b file user1 MyPassword!
Adding password for user user1
----
====

// end::htpasswd[]

* To add users to, or update existing users in, the *_users.htpasswd_* file, execute:
+
----
$ htpasswd </path/to/users.htpasswd> <username>
----

* To remove a user from the file, execute:
+
----
$ htpasswd -D </path/to/users.htpasswd> <username>
----
