[[install-config-configuring-authentication-allow]]
= Configuring the Allow All Identity Provider
{product-author}
{product-version}
:data-uri:
:icons:
:experimental:
:toc: macro
:toc-title:
:prewrap!:


toc::[]

== Overview

You can configure the {product-title} master configuration file to use Allow All authentication in your cluster.


== Configuring Allow All Authentication

Setting the `AllowAllPasswordIdentityProvider` in the `identityProviders` stanza allows any non-empty user name and password to log in. This is the default
identity provider when running {product-title} without a
xref:../../install_config/master_node_configuration.adoc#install-config-master-node-configuration[master configuration file].

To configure the Allow All identity provider:

//tag::configuring_authentication_common_steps1[]

. Edit the master configuration file:
+
----
/etc/origin/master/master-config.yaml
----

. Set the following parameters, as needed, or use the default values:
+
----
oauthConfig:
  ...
  identityProviders:
  - challenge: true
    login: true 
---- 
+
[cols="2a,8a",options="header"]
|===
|Parameter     | Description
|`challenge` | When `true`, unauthenticated token requests from non-web
clients (like the CLI) are sent a `WWW-Authenticate` challenge header. Not
supported by all identity providers.

To prevent cross-site request forgery (CSRF) attacks against browser clients
Basic authentication challenges are only sent if a `X-CSRF-Token` header is
present on the request. Clients that expect to receive Basic `WWW-Authenticate`
challenges should set this header to a non-empty value.

|`login`     | When `true`, unauthenticated token requests from web clients
(like the web console) are redirected to a login page backed by this provider.
Not supported by all identity providers.

If you want users to be sent to a branded page before being redirected to
the identity provider's login, then set `oauthConfig -> alwaysShowProviderSelection: true`. This provider selection page can be
xref:../../install_config/web_console_customization.adoc#customizing-the-login-page[customized].
|===
//end::configuring_authentication_common_steps1[]

. Specify the `mappingMethod` parameter to determine how identities are mapped to users.
//tag::configuring_authentication_common_steps2[]
+
----
oauthConfig:
  ...
  identityProviders:
  - mappingMethod: claim 
----
+
[cols="2,8"]
|===
|Parameter  | Description

|`claim` | The default value. Provisions a user with the identity's preferred
user name. Fails if a user with that user name is already mapped to another
identity.

|`lookup` | Looks up an existing identity, user identity mapping, and user,
but does not automatically provision users or identities. This allows cluster
administrators to set up identities and users manually, or using an external
process.

|`generate` | Provisions a user with the identity's preferred user name. If a
user with the preferred user name is already mapped to an existing identity, a
unique user name is generated. For example, `myuser2`. This method should not be
used in combination with external processes that require exact matches between
{product-title} user names and identity provider user names, such as LDAP group
sync.

|`add` | Provisions a user with the identity's preferred user name. If a user
with that user name already exists, the identity is mapped to the existing user,
adding to any existing identity mappings for the user. Required when multiple
identity providers are configured that identify the same set of users and map to
the same user names.
|===
//end::configuring_authentication_common_steps2[]

. Specify the following values to configure the Allow All provider:
+
.Master Configuration Using `AllowAllPasswordIdentityProvider`
====

----
oauthConfig:
  ...
  identityProviders:
  - challenge: true 
    login: true 
    mappingMethod: claim 
    name: my_allow_provider <1>    
    provider:
      apiVersion: v1
      kind: AllowAllPasswordIdentityProvider <2>
----
<1> This provider name is prefixed to provider user names to form an identity
name.
<2> Specify *_AllowAllPasswordIdentityProvider_* as the provider kind.
====
//tag::restart-after-config-master[]
. Restart the {product-title} service.
+
ifdef::openshift-enterprise[]
----
# systemctl restart atomic-openshift-master
----
endif::[]
ifdef::openshift-origin[]
----
# systemctl restart origin-master
----
endif::[]
//end::restart-after-config-master[]

