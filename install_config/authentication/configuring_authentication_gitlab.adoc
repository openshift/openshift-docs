[[install-config-configuring-authentication-gitlab]]
= Configuring the GitLab Identity Provider
{product-author}
{product-version}
:data-uri:
:icons:
:experimental:
:toc: macro
:toc-title:
:prewrap!:


toc::[]

== Overview

You can configure the {product-title} master configuration file to use GitLab authentication in your cluster.


== Configuring GitLab Authentication

Set `GitLabIdentityProvider` in the `identityProviders` stanza to use
link:https://gitlab.com/[GitLab.com] or any other GitLab instance as an identity provider, using the
link:http://doc.gitlab.com/ce/integration/oauth_provider.html[OAuth integration].
The OAuth provider feature requires GitLab version 7.7.0 or higher.

[NOTE]
====
Using GitLab as an identity provider requires users to get a token using
`<master>/oauth/token/request` to use with command-line tools.
====

To configure the GitLab identity provider:

include::install_config/authentication/configuring_authentication_allow_all.adoc[tag=configuring_authentication_common_steps1]

. Specify the `mappingMethod` parameter to determine how identities are mapped to users.
include::install_config/authentication/configuring_authentication_allow_all.adoc[tag=configuring_authentication_common_steps2]

. Set the `name` parameter to an appropriate string. 
+
----
name: gitlab
----
+
This provider name is prefixed to the GitLab numeric user ID to form an identity name. It is also used to build the callback URL.

. Specify the following values to configure GitLab authentication:
+
.Master Configuration Using `GitLabIdentityProvider`
====

----
oauthConfig:
  ...
  identityProviders:
  - 
    challenge: true
    login: true
    mappingMethod: claim 
    name: gitlab
    provider:
      apiVersion: v1
      kind: GitLabIdentityProvider <1>
      url: ... <2>
      clientID: ... <3>
      clientSecret: ... <4>
      ca: ... <5>
----
<1> Specify *_GitLabIdentityProvider_* for the provider name.
<2> The host URL of a GitLab OAuth provider. This could either be `\https://gitlab.com/`
or any other self hosted instance of GitLab.
<3> The client ID of a
link:https://gitlab.com/oauth/applications/new[registered GitLab OAuth
application]. The application must be configured with a callback URL of
`<master>/oauth2callback/<identityProviderName>`.
<4> The client secret issued by GitLab. This value may also be provided in an
xref:../../install_config/master_node_configuration.adoc#master-node-configuration-passwords-and-other-data[environment
variable, external file, or encrypted file].
<5> CA is an optional trusted certificate authority bundle to use when making
requests to the GitLab instance. If empty, the default system roots are used.
====

include::install_config/authentication/configuring_authentication_allow_all.adoc[tag=restart-after-config-master]

