[[install-config-configuring-authentication-google]]
= Configuring the Google Identity Provider
{product-author}
{product-version}
:data-uri:
:icons:
:experimental:
:toc: macro
:toc-title:
:prewrap!:

toc::[]

== Overview

You can configure the {product-title} master configuration file to use Google authentication in your cluster.


== Configuring Google Authentication

Set `GoogleIdentityProvider` in the `*identityProviders*` stanza to use Google
as an identity provider, using
link:https://developers.google.com/identity/protocols/OpenIDConnect[Google's OpenID
Connect integration].

[NOTE]
====
Using Google as an identity provider requires users to get a token using
`<master>/oauth/token/request` to use with command-line tools.
====

[WARNING]
====
Using Google as an identity provider allows any Google user to authenticate to your server.
You can limit authentication to members of a specific hosted domain with the
`hostedDomain` configuration attribute, as shown below.
====

To configure the Google identity provider:

. Edit the master configuration file:
+
----
/etc/origin/master/master-config.yaml
----

. Set the `challenge` parameter to `false`.
+
----
oauthConfig:
  ...
  identityProviders:
  - challenge: false
    login: true
----
+
The Google identity provider cannot be used to send `WWW-Authenticate` challenges.

. Set the `login` parameter to `true`.

. Specify the `mappingMethod` parameter to determine how identities are mapped to users.
include::install_config/authentication/configuring_authentication_allow_all.adoc[tag=configuring_authentication_common_steps2]

. Set the `name` parameter to an appropriate string. 
+
----
name: google
----
+
This provider name is prefixed to the Google numeric user ID to form an identity name. It is also used to build the callback URL.


. Specify the following values to configure Google authentication:
+
.Master Configuration Using `GoogleIdentityProvider`
====

----
oauthConfig:
  ...
  identityProviders:
  - challenge: false
    login: true 
    mappingMethod: claim
    name: google 
    provider:
      apiVersion: v1
      kind: GoogleIdentityProvider <1>
      clientID: ... <2>
      clientSecret: ... <3>
      hostedDomain: "" <4>
----
<1> Specify `GoogleIdentityProvider` for the provider kind.
<2> The client ID of a link:https://console.developers.google.com/[registered
Google project]. The project must be configured with a redirect URI of
`<master>/oauth2callback/<identityProviderName>`.
<3> The client secret issued by Google. This value may also be provided in an
xref:../../install_config/master_node_configuration.adoc#master-node-configuration-passwords-and-other-data[environment
variable, external file, or encrypted file].
<4> Optional
link:https://developers.google.com/identity/protocols/OpenIDConnect#hd-param[hosted
domain] to restrict sign-in accounts to. If empty, any Google account is allowed
to authenticate.
====

include::install_config/authentication/configuring_authentication_allow_all.adoc[tag=restart-after-config-master] 


