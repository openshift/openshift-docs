[[install-config-configuring-authentication-basic]]
= Configuring the Basic Authentication (Remote) Identity Provider
{product-author}
{product-version}
:data-uri:
:icons:
:experimental:
:toc: macro
:toc-title:
:prewrap!:

toc::[]
{nbsp} +

== Overview

You can configure the {product-title} master configuration file to use Basic authentication in your cluster.


== Configuring Basic Authentication

Set `BasicAuthPasswordIdentityProvider` in the `*identityProviders*` stanza to
validate user names and passwords against a remote server using a
server-to-server Basic authentication request. User names and passwords are
validated against a remote URL that is protected by Basic authentication and
returns JSON.

For information on Basic authentication responses, see xref:configuring_authentication_basic_auth_messages[Understanding Basic Authentication Messages].

To configure the Basic Authentication identity provider:

include::install_config/authentication/configuring_authentication_allow_all.adoc[tag=configuring_authentication_common_steps1]

. Specify the `*mappingMethod*` parameter to determine how identities are mapped to users.
include::install_config/authentication/configuring_authentication_allow_all.adoc[tag=configuring_authentication_common_steps2]

. Specify the following values to configure Basic authentication:
+
[[basic-auth-example-config]]
.Master Configuration Using `BasicAuthPasswordIdentityProvider`
====

----
oauthConfig:
  ...
  identityProviders:
  - challenge: true
    login: true
    mappingMethod: claim
    name: my_remote_basic_auth_provider <1>
    provider:
      apiVersion: v1
      kind: BasicAuthPasswordIdentityProvider <2>
      url: https://www.example.com/remote-idp <3>
      ca: /path/to/ca.file <4>
      certFile: /path/to/client.crt <5>
      keyFile: /path/to/client.key <6>
----
<1> This provider name is prefixed to the returned user ID to form an identity
name.
<2> Specify *_BasicAuthPasswordIdentityProvider_* as the provider kind.
<3> URL accepting credentials in Basic authentication headers.
<4> Optional: Certificate bundle to use to validate server certificates for the
configured URL.
<5> Optional: Client certificate to present when making requests to the
configured URL.
<6> Key for the client certificate. Required if `certFile` is specified.
====

include::install_config/authentication/configuring_authentication_allow_all.adoc[tag=restart-after-config-master]

[discrete]
[[configuring_authentication_basic_auth_messages]]
== Understanding Basic Authentication Messages

If the authentication is successful:

A `200` status with a `sub` (subject) key indicates success:

----
{"sub":"userid"}
----

The subject must be unique to the authenticated user and must not be able to
be modified.


A successful response may optionally provide additional data, such as:

* A display name using the `name` key. For example:
+
----
{"sub":"userid", "name": "User Name", ...}
----
+
* An email address using the `email` key. For example:
+
----
{"sub":"userid", "email":"user@example.com", ...}
----
+
* A preferred user name using the `preferred_username` key. This is useful when
the unique, unchangeable subject is a database key or UID, and a more
human-readable name exists. This is used as a hint when provisioning the
{product-title} user for the authenticated identity. For example:
+
----
{"sub":"014fbff9a07c", "preferred_username":"bob", ...}
----

If the authentication fails:

A `401` response indicates failed authentication.

A non-`200` status, or the presence of a non-empty "error" key, indicates an
error:

----
{"error":"Error message"}
----
