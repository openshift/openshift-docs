:_mod-docs-content-type: ASSEMBLY
include::_attributes/common-attributes.adoc[]
[id="customizing-permissions-by-creating-aggregated-cluster-roles"]
= Customizing permissions by creating aggregated cluster roles
:context: customizing-permissions-by-creating-aggregated-cluster-roles

toc::[]

The default cluster role for the Argo CD Application Controller has a specific set of hard-coded permissions. The {gitops-title} Operator manages this cluster role, so you cannot modify it. As a cluster administrator, you can customize the permissions by using any one of the following methods:

* xref:../declarative_clusterconfig/customizing-permissions-by-creating-user-defined-cluster-roles-for-cluster-scoped-instances.adoc#customizing-permissions-by-creating-user-defined-cluster-roles-for-cluster-scoped-instances[Creating user-defined cluster roles]
* xref:../declarative_clusterconfig/customizing-permissions-by-creating-aggregated-cluster-roles.adoc#gitops-creating-aggregated-cluster-roles_customizing-permissions-by-creating-aggregated-cluster-roles[Creating aggregated cluster roles]

[id="aggregated-cluster-roles_{context}"]
== Aggregated cluster roles

By using aggregated cluster roles, you do not have to define permissions by creating new cluster roles from scratch. Instead, you can combine several cluster roles into a single one. 

With {gitops-title} 1.14 and later, as a cluster administrator, you can use aggregated cluster roles and enable users to easily add user-defined permissions for Argo CD Application Controller.

[IMPORTANT]
====
* The aggregated cluster roles functionality is optional and disabled by default. You can create aggregated cluster roles only for the Argo CD Application Controller component of a cluster-scoped Argo CD instance.
* Deleting the `aggregatedClusterRoles` field from the Argo CD custom resource (CR) does not delete the user-defined cluster role. You must manually delete the user-defined cluster role using the CLI or UI.
====

[id="prerequisites_{context}"]
== Prerequisites

* You understand link:https://kubernetes.io/docs/reference/access-authn-authz/rbac/#aggregated-clusterroles[aggregated cluster roles].
* You have installed {gitops-title} on your {OCP} cluster.
* You have installed the OpenShift CLI (`oc`).
* You have installed the {gitops-title} `argocd` CLI.
* You have installed a xref:../declarative_clusterconfig/configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations.adoc#using-argo-cd-instance-to-manage-cluster-scoped-resources_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations[cluster-scoped Argo CD instance] in your defined namespace.
* You have validated that the user-defined cluster-scoped instance is configured with the cluster roles and cluster role bindings for the following components:
+
** Argo CD Application Controller
** Argo CD server
** Argo CD ApplicationSet Controller, if ApplicationSet Controller is created
* You have xref:../declarative_clusterconfig/customizing-permissions-by-creating-user-defined-cluster-roles-for-cluster-scoped-instances.adoc#gitops-disabling-the-creation-of-the-default-cluster-roles-for-the-cluster-scoped-instance_customizing-permissions-by-creating-user-defined-cluster-roles-for-cluster-scoped-instances[disabled the creation of the default cluster roles] for the cluster-scoped instance.

// Creating aggregated cluster roles
include::modules/gitops-creating-aggregated-cluster-roles.adoc[leveloffset=+1]

// Enable the creation of aggregated cluster roles
include::modules/gitops-enable-creation-of-aggregated-cluster-roles.adoc[leveloffset=+2]

// Create user-defined cluster roles and configure user-defined permissions
include::modules/gitops-create-configure-aggregated-user-defined-permissions.adoc[leveloffset=+2]

// Enabling the creation of aggregated cluster roles
include::modules/gitops-enabling-the-creation-of-aggregated-cluster-roles.adoc[leveloffset=+1]

[role="_additional-resources"]
.Additional resources
* xref:../argocd_instance/setting-up-argocd-instance.adoc#setting-up-argocd-instance[Installing a user-defined Argo CD instance]

// Creating user-defined cluster roles and configuring user-defined permissions for Application Controller
include::modules/gitops-creating-user-defined-cluster-roles-and-configuring-user-defined-permissions-for-application-controller.adoc[leveloffset=+1]

[role="_additional-resources"]
[id="additional-resources_{context}"]
== Additional resources

* xref:../argocd_instance/setting-up-argocd-instance.adoc#setting-up-argocd-instance[Installing a user-defined Argo CD instance]
* xref:../declarative_clusterconfig/configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations.adoc#gitops-additional-permissions-for-cluster-config_configuring-an-openshift-cluster-by-deploying-an-application-with-cluster-configurations[Adding permissions for cluster configuration]
* xref:../declarative_clusterconfig/customizing-permissions-by-creating-user-defined-cluster-roles-for-cluster-scoped-instances.adoc#customizing-permissions-by-creating-user-defined-cluster-roles-for-cluster-scoped-instances[Customizing permissions by creating user-defined cluster roles for cluster-scoped instances]