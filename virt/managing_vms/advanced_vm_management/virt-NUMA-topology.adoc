:_mod-docs-content-type: ASSEMBLY
include::_attributes/common-attributes.adoc[]
[id="virt-NUMA-topology"]
= Working with NUMA topology for virtual machines
:context: virt-NUMA-topology

toc::[]

include::snippets/about-numa.adoc[]

include::modules/virt-using-NUMA.adoc[leveloffset=+1]

include::modules/virt-NUMA-prereqs.adoc[leveloffset=+1]

[id="virt-NUMA-topology-create-VM"]
== Creating a VM with NUMA functionality enabled

VM owners can enable NUMA with `ComputeExclusive` (CX) instance types, which are specifically designed for high-performance, compute-intensive workloads, and are configured to use NUMA features.

For information about creating VMs using a CX instance type, see xref:../../../virt/creating_vm/virt-creating-vms-from-instance-types.adoc#virt-creating-vms-from-instance-types[Creating virtual machines from instance types].

include::modules/virt-numa-check-config.adoc[leveloffset=+1]

[id="virt-NUMA-topology-disabling-hotplugs"]
== Disabling the hot plug capability for VMs

_Hot plugging_ is the ability to add resources like memory or CPU dynamically to a VM while it is running.

Default {VirtProductName} hot plug multipliers can cause VMs to request an excessive number of sockets. For example, if your VM requests 10 sockets, the default hot plug behavior multiplies this by 4, which means that the total request is 40 sockets. This can exceed the recommended CPUs supported by the Kernel-based Virtual Machine (KVM), which can cause deployment failures.

You can keep VM resource requests aligned with NUMA and optimize performance for resource-intensive workloads by disabling the VM's default hot plug capability.

include::modules/virt-disable-CPU-VM-hotplug-instancetype.adoc[leveloffset=+2]

include::modules/virt-disable-CPU-VM-hotplug.adoc[leveloffset=+2]

include::modules/virt-disable-kubervirt-hotplug-ratio.adoc[leveloffset=+2]

include::modules/virt-NUMA-limitations.adoc[leveloffset=+1]

include::modules/virt-NUMA-live-migration.adoc[leveloffset=+1]

== Additional resources
* xref:../../../scalability_and_performance/using-cpu-manager.adoc#using-cpu-manager_topology-manager-policies[Topology Manager policies]
