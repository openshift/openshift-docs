:_mod-docs-content-type: ASSEMBLY
[id="virt-4-16-release-notes"]
= {VirtProductName} release notes
include::_attributes/common-attributes.adoc[]
:context: virt-4-16-release-notes

toc::[]

[id="virt-doc-feedback_{context}"]
== Providing documentation feedback

To report an error or to improve our documentation, log in to your link:https://issues.redhat.com[Red Hat Jira account] and submit a link:https://issues.redhat.com/secure/CreateIssueDetails!init.jspa?pid=12323181&issuetype=1&components=12333768&priority=10200&summary=%5BDoc%5D&customfield_12316142[Jira issue].

[id="virt-about-virt_{context}"]
== About Red Hat {VirtProductName}

With Red Hat {VirtProductName}, you can bring traditional virtual machines (VMs) into {product-title} and run them alongside containers. In {VirtProductName}, VMs are native Kubernetes objects that you can manage by using the {product-title} web console or the command line.

{VirtProductName} is represented by the image:virt-icon.png[{VirtProductName},40,40] icon.

You can use {VirtProductName} with either the xref:../../networking/ovn_kubernetes_network_provider/about-ovn-kubernetes.adoc#about-ovn-kubernetes[OVN-Kubernetes] or the xref:../../networking/openshift_sdn/about-openshift-sdn.adoc#about-openshift-sdn[OpenShiftSDN] default Container Network Interface (CNI) network provider.

Learn more about xref:../../virt/about_virt/about-virt.adoc#about-virt[what you can do with {VirtProductName}].

Learn more about xref:../../virt/about_virt/virt-architecture.adoc#virt-architecture[{VirtProductName} architecture and deployments].

xref:../../virt/install/preparing-cluster-for-virt.adoc#preparing-cluster-for-virt[Prepare your cluster] for {VirtProductName}.

include::modules/virt-supported-cluster-version.adoc[leveloffset=+2]


[id="virt-guest-os_{context}"]
=== Supported guest operating systems
To view the supported guest operating systems for {VirtProductName}, see link:https://access.redhat.com/articles/973163#ocpvirt[Certified Guest Operating Systems in Red Hat OpenStack Platform, Red Hat Virtualization, OpenShift Virtualization and Red Hat Enterprise Linux with KVM].

//Ensure platform passes Windows Server Virtualization Validation Program. Otherwise, comment out the section below.
[id="virt-svvp-certification_{context}"]
=== Microsoft Windows SVVP certification

//CNV-31842 SVVP 4.15 Release Note: NEW
//NOTE: This is a recurring release note. Modify the existing note text below if recommended by QE.
{VirtProductName} is certified in Microsoft's Windows Server Virtualization Validation Program (SVVP) to run Windows Server workloads.

The SVVP certification applies to:

* Red Hat Enterprise Linux CoreOS workers. In the Microsoft SVVP Catalog, they are named __Red Hat OpenShift Container Platform 4 on RHEL CoreOS 9__.
* Intel and AMD CPUs.

[id="virt-quick-starts_{context}"]
== Quick starts

Quick start tours are available for several {VirtProductName} features. To view the tours, click the *Help* icon *?* in the menu bar on the header of the {product-title} web console and then select *Quick Starts*. You can filter the available tours by entering the keyword `virtualization` in the *Filter* field.


[id="virt-4-16-new_{context}"]
== New and changed features

This release adds new features and enhancements related to the following components and concepts:

[id="virt-4-16-installation-update_{context}"]
=== Installation and update

//CNV-38590
* After upgrading to {VirtProductName} {product-version}, data volumes that were previously removed through garbage collection might be recreated. This behavior is expected. You can ignore the recreated data volumes because data volume garbage collection is now disabled.

//[id="virt-4-16-infrastructure_{context}"]
//=== Infrastructure

[id="virt-4-16-virtualization_{context}"]
=== Virtualization

//CNV-29170 Real-time cluster configuration (Uncomment the note below when feature goes out with a 4.16.z release)
//* You can :../../virt/virtual_machines/advanced_vm_management/virt-configuring-cluster-realtime-workloads.adoc#virt-configuring-cluster-realtime-workloads[configure an {product-title} cluster] to run real-time virtual machine (VM) workloads that require low and predictable latency.

//CNV-29192 Running real-time checkup (Uncomment the note below when feature goes out with a 4.16.z release)
//* You can now run a predefined xref:../../virt/monitoring/virt-running-cluster-checkups.adoc#virt-running-real-time-checkup_virt-running-cluster-checkups[checkup] to verify that your {product-title} cluster is configured to run virtualized real-time workloads.

//CNV-33366 Release note: NEW - Adopt UEFI in all Windows versions
* Windows 10 VMs now boot using UEFI with TPM.

//CNV-29984: RN - Document auto memory and cpu resource limits
* Enabling the `AutoResourceLimits` feature gate automatically manages CPU and memory limits of a VM.

* The KubeVirt Tekton tasks are now shipped as a part of the link:https://github.com/openshift-pipelines/tektoncd-catalog/tree/p/tasks[{product-title} Pipelines catalog].

[id="virt-4-16-networking_{context}"]
=== Networking

//CNV-37037 headless services support
* You can now xref:../../virt/vm_networking/virt-accessing-vm-internal-fqdn.adoc#virt-accessing-vm-internal-fqdn[access a VM] that is connected to the default internal pod network on a stable fully qualified domain name (FQDN) by using headless services.

//[id="virt-4-16-storage_{context}"]
//=== Storage

[id="virt-4-16-web_{context}"]
=== Web console

//CNV-34687 Release note: Generally available (GA) CPU Hotplug
* Hot plugging virtual CPUs (vCPUs) into virtual machines is now generally available. If a vCPU cannot be hot plugged, the condition `RestartRequired` is applied to the VM. You can view this condition in the *Diagnostics* tab of the web console.

//CNV-37545 RN: enhancement Specializing a Windows VM flow during VM creation
* You can now select `sysprep` options when you create a Microsoft Windows VM from an instance type. Previously, you had to set the `sysprep` options by customizing the VM after its creation.

[id="virt-4-16-monitoring"]
=== Monitoring

//CNV-41655 Release note: NEW Downward Metrics 4.16
* As an administrator, you can now xref:../../virt/monitoring/virt-exposing-downward-metrics.adoc#virt-exposing-downward-metrics[expose a limited set of host and virtual machine (VM) metrics to a guest VM through a virtio-serial port] for {VirtProductName} by enabling a `downwardMetrics` feature gate and configuring a `downwardMetrics` device. Users retrieve the metrics by using the `vm-dump-metrics` tool or from the command line.
+
On {op-system-base-full} 9, xref:../../virt/monitoring/virt-exposing-downward-metrics.adoc#virt-viewing-downward-metrics-cli_virt-exposing-downward-metrics[use the command line] to view downward metrics. The `vm-dump-metrics` tool is not supported on the {op-system-base-full} 9 platform.

[id="virt-4-16-notable-technical-changes_{context}"]
=== Notable technical changes

//CNV-43342: RN: VMs require 1GiB memory
* VMs require a minimum of 1 GiB of allocated memory to enable memory hotplug. If a VM has less than 1 GiB of allocated memory, then memory hotplug is disabled.

//CNV-34681: runbooks moved to openshift/runbooks repo
* Runbooks for {VirtProductName} alerts are now maintained only in the https://github.com/openshift/runbooks/tree/master/alerts/openshift-virtualization-operator[`openshift/runbooks` git repository]. xref:../../virt/monitoring/virt-runbooks.adoc#virt-runbooks[Links to the runbook source files] are now available in place of the removed runbooks.

[id="virt-4-16-deprecated-removed_{context}"]
== Deprecated and removed features
//NOTE: Comment out deprecated and removed features (and their IDs) if not used in a release

[id="virt-4-16-deprecated_{context}"]
=== Deprecated features
// NOTE: When uncommenting deprecated features list, change the Removed features header level below to ===

Deprecated features are included in the current release and remain supported. However, deprecated features will be removed in a future release and are not recommended for new deployments.

//CNV-26426 [DOCS] Release note: Deprecate TTO
* The `tekton-tasks-operator` is deprecated and Tekton tasks and example pipelines are now deployed by the `ssp-operator`.

//CNV-26316: Release note: Align tekton tasks with instancestypes
* The `copy-template`, `modify-vm-template`, and `create-vm-from-template` tasks are deprecated.

//CNV-32032 Release note: DEPRECATED FEATURE (Windows 2012R2 templates deprecated)
* Support for Windows Server 2012 R2 templates is deprecated.

//CNV-34681: Deprecated alerts
* The alerts `KubeVirtComponentExceedsRequestedMemory` and `KubeVirtComponentExceedsRequestedCPU` are deprecated. You can safely xref:../../observability/monitoring/managing-alerts/managing-alerts-as-an-administrator.adoc#silencing-alerts-adm_managing-alerts-as-an-administrator[silence] them.

[id="virt-4-16-removed"]
=== Removed features

Removed features are not supported in the current release.

//CNV-45783
* CentOS 7 and CentOS Stream 8 are now in the End of Life phase. As a consequence, the container images for these operating systems have been removed from OpenShift Virtualization and are no longer link:https://access.redhat.com/articles/4234591#community[community supported].

[id="virt-4-16-technology-preview_{context}"]
== Technology Preview features

Some features in this release are currently in Technology Preview. These experimental features are not intended for production use. Note the following scope of support on the Red Hat Customer Portal for these features:

link:https://access.redhat.com/support/offerings/techpreview[Technology Preview Features Support Scope]

//CNV-28944 Release note: Preview Cluster level eviction strategy change
* You can now configure a xref:../../virt/nodes/virt-node-maintenance.adoc#eviction-strategies[VM eviction strategy] for the xref:../../virt/nodes/virt-node-maintenance.adoc#virt-configuring-cluster-eviction-strategy-cli_virt-node-maintenance[entire cluster].

//CNV-15028: Nested virt in virt hosts. This feature will remain in tech preview indefinitely.
* You can now enable link:https://access.redhat.com/solutions/6692341[nested virtualization on {VirtProductName} hosts].

//CNV-33125: Add CPU limits to the UI
* Cluster admins can now enable CPU resource limits on a namespace in the {product-title} web console under *Overview* -> *Settings* -> *Preview features*.

//CNV-22314: Safe memory overcommitment using `wasp-agent`
* Cluster admins can now use the `wasp-agent` tool to xref:../../virt/post_installation_configuration/virt-configuring-higher-vm-workload-density.adoc#virt-configuring-higher-vm-workload-density[configure a higher VM workload density] in their clusters by overcommitting the amount of memory, in RAM, and assigning swap resources to VM workloads.

//CNV-31997: PREVIEW - compatibility with ODF Regional DR
* {VirtProductName} now supports compatibility with {rh-storage-first} (ODF) Regional Disaster Recovery.

[id="virt-4-16-bug-fixes_{context}"]
== Bug fixes

//CNV-64690
* Fixed an issue where uploading data to a Persistent Volume Claim (PVC) using the **Upload Data** form in the web console failed (link:https://issues.redhat.com/browse/CNV-37607[CNV-37607]).

[id="virt-4-16-known-issues_{context}"]
== Known issues

[discrete]
[id="virt-4-16-ki-monitoring_{context}"]
==== Monitoring
//CNV-33834: 4.16 - Antonio Cardace said this is still an issue
* The Pod Disruption Budget (PDB) prevents pod disruptions for migratable virtual machine images. If the PDB detects pod disruption, then `openshift-monitoring` sends a `PodDisruptionBudgetAtLimit` alert every 60 minutes for virtual machine images that use the `LiveMigrate` eviction strategy. (link:https://issues.redhat.com/browse/CNV-33834[*CNV-33834*])
** As a workaround, xref:../../observability/monitoring/managing-alerts/managing-alerts-as-an-administrator.adoc#silencing-alerts-adm_managing-alerts-as-an-administrator[silence alerts].

[discrete]
[id="virt-4-16-ki-networking_{context}"]
==== Networking
//CNV-38746
* When you update from {product-title} 4.12 to a newer minor version, VMs that use the `cnv-bridge` Container Network Interface (CNI) fail to live migrate. (link:https://access.redhat.com/solutions/7069807[])
** As a workaround, change the `spec.config.type` field in your `NetworkAttachmentDefinition` manifest from `cnv-bridge` to `bridge` before performing the update.


[discrete]
[id="virt-4-16-ki-nodes_{context}"]
==== Nodes
//CNV-38543 - 4.16 Still an issue
* Uninstalling {VirtProductName} does not remove the `feature.node.kubevirt.io` node labels created by {VirtProductName}. You must remove the labels manually. (link:https://issues.redhat.com/browse/CNV-38543[*CNV-38543*])

//BZ 2151169
* In a heterogeneous cluster with different compute nodes, virtual machines that have HyperV reenlightenment enabled cannot be scheduled on nodes that do not support timestamp-counter scaling (TSC) or have the appropriate TSC frequency. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2151169[*BZ#2151169*])


[discrete]
[id="virt-4-16-ki-storage_{context}"]
==== Storage
//CNV-32695: 4.16 - Keep per Jenia Peimer
* If you use Portworx as your storage solution on AWS and create a VM disk image, the created image might be smaller than expected due to the filesystem overhead being accounted for twice. (link:https://issues.redhat.com/browse/CNV-40217[*CNV-40217*])
** As a workaround, you can manually expand the persistent volume claim (PVC) to increase the available space after the initial provisioning process completes.

//CNV-13500: 4.16 - Keeping in until CNV-40857 is completed
* In some instances, multiple virtual machines can mount the same PVC in read-write mode, which might result in data corruption. (link:https://issues.redhat.com/browse/CNV-13500[*CNV-13500*])
** As a workaround, avoid using a single PVC in read-write mode with multiple VMs.

//CNV-23501: 4.16 - Keep per Dominik Holler
* If you clone more than 100 VMs using the `csi-clone` cloning strategy, then the Ceph CSI might not purge the clones. Manually deleting the clones might also fail. (link:https://issues.redhat.com/browse/CNV-23501[*CNV-23501*])
** As a workaround, you can restart the `ceph-mgr` to purge the VM clones.



[discrete]
[id="virt-4-16-ki-virtualization_{context}"]
==== Virtualization

//CNV-43195: 4.16 - VM migration fails with virError
* VM migrations might fail on clusters with mixed CPU types. (link:https://issues.redhat.com/browse/CNV-43195[*CNV-43195*])
** As a workaround, you can set the CPU model at the xref:../../virt/virtual_machines/advanced_vm_management/virt-schedule-vms.adoc#virt-schedule-supported-cpu-model-vms_virt-schedule-vms[VM spec level] or at the xref:../../virt/virtual_machines/advanced_vm_management/virt-configuring-default-cpu-model.adoc#virt-configuring-default-cpu-model_virt-configuring-default-cpu-model[cluster level].

//CNV-36448: 4.16 - Unresolved
* When adding a virtual Trusted Platform Module (vTPM) device to a Windows VM, the BitLocker Drive Encryption system check passes even if the vTPM device is not persistent. This is because a vTPM device that is not persistent stores and recovers encryption keys using ephemeral storage for the lifetime of the `virt-launcher` pod. When the VM migrates or is shut down and restarts, the vTPM data is lost. (link:https://issues.redhat.com/browse/CNV-36448[*CNV-36448*])

//CNV-33835: 4.16 - Unresolved
* {VirtProductName} links a service account token in use by a pod to that specific pod. {VirtProductName} implements a service account volume by creating a disk image that contains a token. If you migrate a VM, then the service account volume becomes invalid. (link:https://issues.redhat.com/browse/CNV-33835[*CNV-33835*])
** As a workaround, use user accounts rather than service accounts because user account tokens are not bound to a specific pod.

//CNV-NA: 4.16 - Keep this per Stu, ETA for fixing this issue is 4.18
* With the release of the link:https://access.redhat.com/errata/RHSA-2023:3722[RHSA-2023:3722] advisory, the TLS `Extended Master Secret` (EMS) extension (link:https://datatracker.ietf.org/doc/html/rfc7627[RFC 7627]) is mandatory for TLS 1.2 connections on FIPS-enabled {op-system-base-full} 9 systems. This is in accordance with FIPS-140-3 requirements. TLS 1.3 is not affected.
+
Legacy OpenSSL clients that do not support EMS or TLS 1.3 now cannot connect to FIPS servers running on RHEL 9. Similarly, RHEL 9 clients in FIPS mode cannot connect to servers that only support TLS 1.2 without EMS. This in practice means that these clients cannot connect to servers on RHEL 6, RHEL 7 and non-RHEL legacy operating systems. This is because the legacy 1.0.x versions of OpenSSL do not support EMS or TLS 1.3. For more information, see link:https://access.redhat.com/solutions/7018256[TLS Extension "Extended Master Secret" enforced with Red Hat Enterprise Linux 9.2].

** As a workaround, update legacy OpenSSL clients to a version that supports TLS 1.3 and configure {VirtProductName} to use TLS 1.3, with the `Modern` TLS security profile type, for FIPS mode.


[discrete]
[id="virt-4-16-ki-webconsole_{context}"]
==== Web console
//CNV-38293: 4.16 - Ronen Sde-Or said this was still an issue
* When you first deploy an {product-title} cluster, creating VMs from templates or instance types by using the web console, fails if you do not have `cluster-admin` permissions.
** As a workaround, the cluster administrator must first xref:../../nodes/pods/nodes-pods-configmaps.adoc#nodes-pods-configmap-create-from-console_configmaps[create a config map] to enable other users to use templates and instance types to create VMs. (link:https://issues.redhat.com/browse/CNV-38284[*CNV-38284*])