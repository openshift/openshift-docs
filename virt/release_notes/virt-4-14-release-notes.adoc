:_content-type: ASSEMBLY
[id="virt-4-14-release-notes"]
= {VirtProductName} release notes
include::_attributes/common-attributes.adoc[]
:context: virt-4-14-release-notes

toc::[]

[id="virt-4-14-inclusive-language"]
== Making open source more inclusive

Red Hat is committed to replacing problematic language in our code, documentation, and web properties. We are beginning with these four terms: master, slave, blacklist, and whitelist. Because of the enormity of this endeavor, these changes will be implemented gradually over several upcoming releases. For more details, see link:https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language[our CTO Chris Wright's message].


== About Red Hat {VirtProductName}

Red Hat {VirtProductName} enables you to bring traditional virtual machines (VMs) into {product-title} where they run alongside containers, and are managed as native Kubernetes objects.

{VirtProductName} is represented by the image:virt-icon.png[{VirtProductName},40,40] icon.

You can use {VirtProductName} with either the xref:../../networking/ovn_kubernetes_network_provider/about-ovn-kubernetes.adoc#about-ovn-kubernetes[OVN-Kubernetes] or the xref:../../networking/openshift_sdn/about-openshift-sdn.adoc#about-openshift-sdn[OpenShiftSDN] default Container Network Interface (CNI) network provider.

Learn more about xref:../../virt/about_virt/about-virt.adoc#about-virt[what you can do with {VirtProductName}].

Learn more about xref:../../virt/about_virt/virt-architecture.adoc#virt-architecture[{VirtProductName} architecture and deployments].

xref:../../virt/install/preparing-cluster-for-virt.adoc#preparing-cluster-for-virt[Prepare your cluster] for {VirtProductName}.

include::modules/virt-supported-cluster-version.adoc[leveloffset=+2]


[id="virt-guest-os"]
=== Supported guest operating systems
//CNV-16390 Supported guest operating systems
To view the supported guest operating systems for {VirtProductName}, see link:https://access.redhat.com/articles/973163#ocpvirt[Certified Guest Operating Systems in Red Hat OpenStack Platform, Red Hat Virtualization, OpenShift Virtualization and Red Hat Enterprise Linux with KVM].


[id="virt-4-14-new"]
== New and changed features

//CNV-28173 SVVP 4.14 Release Note: NEW
//Remove CNV-21735 when text for this version is set.

//CNV-21735 SVVP for 4.13: Ensure platform passes Windows Server Virtualization Validation Program - with RHCOS workers
//NOTE: This is a recurring release note. Modify the existing note text below if recommended by QE.
* {VirtProductName} is certified in Microsoft's Windows Server Virtualization Validation Program (SVVP) to run Windows Server workloads.
+
The SVVP Certification applies to:
+
** Red Hat Enterprise Linux CoreOS workers. In the Microsoft SVVP Catalog, they are named __Red Hat OpenShift Container Platform 4 on RHEL CoreOS 9__.
** Intel and AMD CPUs.

// todo: when 4.12.3 releases, uncomment the line below and fix the xref
//** To learn more, see xref .. virt/upgrading-virt.adoc #virt-rhel-9_upgrading-virt[{VirtProductName} on {op-system-base} 9].

//CNV-16553 Release notes: NEW (VM Backup and Restore with OADP (GA))
* As a cluster administrator, you can back up and restore applications running on {VirtProductName} by using the xref:../../virt/backup_restore/virt-backup-restore-overview.adoc#virt-backup-restore-overview[OpenShift API for Data Protection (OADP)].

//CNV-29935
* You can add a static xref:../../virt/virtual_machines/virt-accessing-vm-ssh#static-key-management-vm[authorized SSH key] to a project by using the web console. The key is then added to all VMs that you create in the project.

//CNV-25428
* You can enable xref:../../virt/virtual_machines/virt-accessing-vm-ssh#adding-dynamic-key-vm[dynamic SSH key injection] for {op-system-base} 9 VMs. Then, you can update the authorized SSH keys at runtime.

//CNV-20240 Release notes: CHANGE

//CNV-20458 Release notes: NEW

//CNV-25428 Release note: NEW

//CNV-26316 Release notes: CHANGE

//CNV-28720 Release note: CHANGE

//CNV-28725 Release note: NEW

//CNV-28096 Release note: NEW feature -- clone from cached snapshot

//CNV-28726 Release note: New
* By default, Windows 11 and Windows Server 2022 virtual machines (VMs) have a non-persistent trusted platform module (TPM) device state, which is required to enable the VM snapshot feature. A non-persistent TPM will, however, render the VM incompatible with software that relies on TPM persistence, such as BitLocker.

//CNV-28731 Release note: NEW

//CNV-28732 Release note: NEW

//CNV-30838 Release note: datavolume garbage collection no longer default
* Garbage collection for data volumes is disabled by default.

// CNV-30800 Release note: CHANGE
* The following runbooks have been changed:
** xref:../../virt/monitoring/virt-runbooks.adoc#virt-runbook-SingleStackIPv6Unsupported[`SingleStackIPv6Unsupported`] and xref:../../virt/monitoring/virt-runbooks.adoc#virt-runbook-VirtualMachineCRCErrors[`VirtualMachineCRCErrors`] have been added.
** `KubeMacPoolDown` has been renamed xref:../../virt/monitoring/virt-runbooks.adoc#virt-runbook-KubemacpoolDown[`KubemacpoolDown`].
** `KubevirtHyperconvergedClusterOperatorInstallationNotCompletedAlert` has been renamed xref:../../virt/monitoring/virt-runbooks.adoc#virt-runbook-HCOInstallationIncomplete[`HCOInstallationIncomplete`].
** `KubevirtHyperconvergedClusterOperatorCRModification` has been renamed xref:../../virt/monitoring/virt-runbooks.adoc#virt-runbook-KubeVirtCRModified[`KubeVirtCRModified`].
** `KubevirtHyperconvergedClusterOperatorUSModification` has been renamed xref:../../virt/monitoring/virt-runbooks.adoc#virt-runbook-UnsupportedHCOModification[`UnsupportedHCOModification`].
** `SSPOperatorDown` has been renamed xref:../../virt/monitoring/virt-runbooks.adoc#virt-runbook-SSPDown[`SSPDown`].

// CNV-15738: Update the documentation with supported upgrade paths
* Retrospective upgrades between previously released z-streams are now supported.

[id="virt-4-14-quick-starts"]
=== Quick starts

* Quick start tours are available for several {VirtProductName} features. To view the tours, click the *Help* icon *?* in the menu bar on the header of the {VirtProductName} console and then select *Quick Starts*. You can filter the available tours by entering the `virtualization` keyword in the *Filter* field.


[id="virt-4-14-installation-new"]
=== Installation


[id="virt-4-14-networking-new"]
=== Networking


[id="virt-4-14-storage-new"]
=== Storage


[id="virt-4-14-web-new"]
=== Web console

* Cluster administrators can now enable automatic subscription for {op-system-base-full} virtual machines in the {VirtProductName} xref:../../virt/getting_started/virt-web-console-overview.adoc#overview-settings-cluster_virt-web-console-overview[web console].

// CNV-29848: Release: Mechanism to manage DP/TP features in the UI
* Cluster administrators can enable or disable link:https://access.redhat.com/support/offerings/techpreview[Technology Preview] features on the link:https://docs.openshift.com/container-platform/4.14/virt/getting_started/virt-web-console-overview.html#overview-settings-cluster_virt-web-console-overview[*Settings*] tab on the *Virtualization* -> *Overview* page.

// CNV-28720
// pending merge of bootable volumes PR
* The *DataSources* and the *Bootable volumes* pages have been merged into the xref:../../virt/getting_started/virt-web-console-overview.adoc#bootablevolumes-page_virt-web-console-overview[*Bootable volumes* page] so that you can manage these similar resources in a single location.

//CNV-18298 force stop
* You can now force stop an unresponsive VM from the xref:../../virt/getting_started/virt-web-console-overview.adoc#virtualmachine-details-page_virt-web-console-overview[action menu]. To force stop a VM, select *Stop* and then *Force stop* from the action menu.

//NOTE: Comment out deprecated and removed features (and their IDs) if not used in a release
[id="virt-4-14-deprecated-removed"]
== Deprecated and removed features


[id="virt-4-14-deprecated"]
=== Deprecated features
// NOTE: when uncommenting deprecated features list, change the Removed features header level below to ===

Deprecated features are included in the current release and supported. However, they will be removed in a future release and are not recommended for new deployments.

//CNV-26426 [DOCS] Release note: Deprecate TTO
* The `tekton-tasks-operator` is deprecated and Tekton tasks and example pipelines are now deployed by the `ssp-operator`.

//CNV-29048 Release note: DEPRECATED FEATURE (Metrics backlog 4.14)

//CNV-32032 Release note: DEPRECATED FEATURE (Windows 2012R2 templates deprecated)
* Support for Windows Server 2012 R2 templates is deprecated.


[id="virt-4-14-removed"]
=== Removed features

Removed features are not supported in the current release.

//CNV-23499: Carry over/repeat removed feature from version 4.12 and 4.13
* Support for the legacy HPP custom resource, and the associated storage class, has been removed for all new deployments. In {VirtProductName} {VirtVersion}, the HPP Operator uses the Kubernetes Container Storage Interface (CSI) driver to configure local storage. A legacy HPP custom resource is supported only if it had been installed on a previous version of {VirtProductName}.

//NOTE: RNs related to 4.14 Removed features begin here.

//CNV-27160 Release note: REMOVED RHEL 7/virtctl RPMs
* Installing the `virtctl` client as an RPM is no longer supported for {op-system-base-full} 7 and {op-system-base} 9.

[id="virt-4-14-changes"]
== Notable technical changes


[id="virt-4-14-technology-preview"]
== Technology Preview features

Some features in this release are currently in Technology Preview. These experimental features are not intended for production use. Note the following scope of support on the Red Hat Customer Portal for these features:

link:https://access.redhat.com/support/offerings/techpreview[Technology Preview Features Support Scope]

* You can now install and edit xref:../../virt/virtual_machines/creating_vms/virt-creating-vms-from-rh-images.adoc#virt-creating-vm-instancetype_virt-creating-vms-from-rh-images[customized instance types] and preferences to create a VM from a volume or PersistentVolumeClaim (PVC).

//NOTE: RNs related to 4.14 TP features begin here

//CNV-18090 Release note: PREVIEW

//CNV-19436 Release note: NEW Retrieve a temporary token to access the VNC endpoint of a VM
//NOTE: Is this is a TP item for virt-4.14?

//CNV-20965 Release note: PREVIEW Default creation and deployment of common set of instancetypes and preferences that eventually replace common templates
//NOTE: This is a TP item for virt-4.14

//CNV-21991 Release notes: PREVIEW (CNV hypershift)
//NOTE: Targeted for 4.13.1 per Avital and Pan

//CNV-28723 Release note: PREVIEW

//CNV-28944 Release note: Preview Cluster level eviction strategy change

//CNV-29940 Release note: Preview UI Bridged network interface hot-plug for VMs
* You can hot plug a bridge network interface and then restart or live migrate the virtual machine (VM) to apply the change. Hot unplugging is supported only for VMs created with {VirtProductName} 4.13 or later.

[id="virt-4-14-bug-fix"]
== Bug fix



[id="virt-4-14-known-issues"]
== Known issues

//CNV-24889

//CNV-20106 Release note: Remove known issue 2092412/PREVIEW (depends on CNV-20086)


//Known issues from 4.13 (and several carried over from 4.12) begin here.Leave in all for now; will be reviewed closer to the 4.14 release.
* You cannot run {VirtProductName} on a single-stack IPv6 cluster. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2193267[*BZ#2193267*])

* When you use two pods with different SELinux contexts, VMs with the `ocs-storagecluster-cephfs` storage class fail to migrate and the VM status changes to `Paused`. This is because both pods try to access the shared `ReadWriteMany` CephFS volume at the same time. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2092271[*BZ#2092271*])
** As a workaround, use the `ocs-storagecluster-ceph-rbd` storage class to live migrate VMs on a cluster that uses Red Hat Ceph Storage.

//Leave in per Dominik
* If you clone more than 100 VMs using the `csi-clone` cloning strategy, then the Ceph CSI might not purge the clones. Manually deleting the clones might also fail. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2055595[*BZ#2055595*])
** As a workaround, you can restart the `ceph-mgr` to purge the VM clones.

//OCPBUGS-8398 for Dominik
* If you stop a node on a cluster and then use the Node Health Check Operator to bring the node back up, connectivity to Multus might be lost. (link:https://issues.redhat.com/browse/OCPBUGS-8398[*OCPBUGS-8398*])

//OCPBUGS-11277 for Dominik
* The must-gather tool might not collect diagnostic information for a node that is in a `NotReady` state. (link:https://issues.redhat.com/browse/OCPBUGS-11277[*OCPBUGS-11277*])

// Fix targeted for 4.12.1
//Pending reply from Jenia and kmajcher
* The `TopoLVM` provisioner name string has changed in {VirtProductName} 4.12. As a result, the automatic import of operating system images might fail with the following error message (link:https://bugzilla.redhat.com/show_bug.cgi?id=2158521[*BZ#2158521*]):
+
[source,terminal]
----
DataVolume.storage spec is missing accessMode and volumeMode, cannot get access mode from StorageProfile.
----
** As a workaround:
. Update the `claimPropertySets` array of the storage profile:
+
[source,terminal]
----
$ oc patch storageprofile <storage_profile> --type=merge -p '{"spec": {"claimPropertySets": [{"accessModes": ["ReadWriteOnce"], "volumeMode": "Block"}, \
    {"accessModes": ["ReadWriteOnce"], "volumeMode": "Filesystem"}]}}'
----
. Delete the affected data volumes in the `openshift-virtualization-os-images` namespace. They are recreated with the access mode and volume mode from the updated storage profile.

// Fix targeted for 4.13 Pending reply from Jenia and kmajcher
* When restoring a VM snapshot for storage whose binding mode is `WaitForFirstConsumer`, the restored PVCs remain in the `Pending` state and the restore operation does not progress.
** As a workaround, start the restored VM, stop it, and then start it again. The VM will be scheduled, the PVCs will be in the `Bound` state, and the restore operation will complete. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2149654[*BZ#2149654*])

// CNV-31344 FIPS and TLS. RN text is from BZ2157951. Applies to 4.14. Leave in per Simone
* With the release of the link:https://access.redhat.com/errata/RHSA-2023:3722[RHSA-2023:3722] advisory, the TLS `Extended Master Secret` (EMS) extension (link:https://datatracker.ietf.org/doc/html/rfc7627[RFC 7627]) is mandatory for TLS 1.2 connections on FIPS-enabled RHEL 9 systems. This is in accordance with FIPS-140-3 requirements. TLS 1.3 is not affected.
+
Legacy OpenSSL clients that do not support EMS or TLS 1.3 now cannot connect to FIPS servers running on RHEL 9. Similarly, RHEL 9 clients in FIPS mode cannot connect to servers that only support TLS 1.2 without EMS. This in practice means that these clients cannot connect to servers on RHEL 6, RHEL 7 and non-RHEL legacy operating systems. This is because the legacy 1.0.x versions of OpenSSL do not support EMS or TLS 1.3. For more information, see link:https://access.redhat.com/solutions/7018256[TLS Extension "Extended Master Secret" enforced with Red Hat Enterprise Linux 9.2].
+
As a workaround, upgrade legacy OpenSSL clients to a version that supports TLS 1.3 and configure {VirtProductName} to use TLS 1.3, with the `Modern` TLS security profile type, for FIPS mode.

//New known issues for 4.13 go above this comment
//Leave in per Stu
* VMs created from common templates on a Single Node OpenShift (SNO) cluster display a `VMCannotBeEvicted` alert because the template's default eviction strategy is `LiveMigrate`. You can ignore this alert or remove the alert by updating the VM's eviction strategy. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2092412[*BZ#2092412*])

//Leave in per Simone
* Uninstalling {VirtProductName} does not remove the `feature.node.kubevirt.io` node labels created by {VirtProductName}. You must remove the labels manually. (link:https://issues.redhat.com/browse/CNV-22036[*CNV-22036*])

//Leave in per Kedar
* Windows 11 virtual machines do not boot on clusters running in link:https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/security_hardening/index#con_federal-information-processing-standard-fips_assembly_installing-the-system-in-fips-mode[FIPS mode]. Windows 11 requires a TPM (trusted platform module) device by default. However, the `swtpm` (software TPM emulator) package is incompatible with FIPS. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2089301[*BZ#2089301*])

//BZ-1885605
//Leave in per Petr
* If your {product-title} cluster uses OVN-Kubernetes as the default Container Network Interface (CNI) provider, you cannot attach a Linux bridge or bonding device to a host's default interface because of a change in the host network topology of OVN-Kubernetes. (link:https://bugzilla.redhat.com/show_bug.cgi?id=1885605[*BZ#1885605*])
** As a workaround, you can use a secondary network interface connected to your host, or switch to the OpenShift SDN default CNI provider.

//Pending for Kevin
* In some instances, multiple virtual machines can mount the same PVC in read-write mode, which might result in data corruption. (link:https://bugzilla.redhat.com/show_bug.cgi?id=1992753[*BZ#1992753*])
** As a workaround, avoid using a single PVC in read-write mode with multiple VMs.

//Leave in per Stu
* The Pod Disruption Budget (PDB) prevents pod disruptions for migratable virtual machine images. If the PDB detects pod disruption, then `openshift-monitoring` sends a `PodDisruptionBudgetAtLimit` alert every 60 minutes for virtual machine images that use the `LiveMigrate` eviction strategy. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2026733[*BZ#2026733*])
** As a workaround, xref:../../monitoring/managing-alerts.adoc#silencing-alerts_managing-alerts[silence alerts].

//Leave in per Stu
* {VirtProductName} links a service account token in use by a pod to that specific pod. {VirtProductName} implements a service account volume by creating a disk image that contains a token. If you migrate a VM, then the service account volume becomes invalid. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2037611[*BZ#2037611*])
** As a workaround, use user accounts rather than service accounts because user account tokens are not bound to a specific pod.

//CNV-26301/BZ2151169 Leave in per Kedar
* In a heterogeneous cluster with different compute nodes, virtual machines that have HyperV Reenlightenment enabled cannot be scheduled on nodes that do not support timestamp-counter scaling (TSC) or have the appropriate TSC frequency.(link:https://bugzilla.redhat.com/show_bug.cgi?id=2151169[*BZ#2151169*])