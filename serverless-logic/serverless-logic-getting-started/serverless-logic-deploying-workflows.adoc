:_mod-docs-content-type: ASSEMBLY
[id="serverless-logic-deploying-workflows"]
= Deployment options and deploying workflows
include::_attributes/common-attributes.adoc[]
:context: serverless-logic-deploying-workflows

toc::[]

You can deploy the {ServerlessLogicProductShortName} workflows on the cluster using one of three deployment profiles: 

* Dev
* Preview
* GitOps

Each profile defines how the Operator builds and manages workflow deployments, including image lifecycle, live updates, and reconciliation behavior.

include::modules/serverless-logic-deploying-workflows-dev-mode.adoc[leveloffset=+1]

[id="serverless-logic-deploying-workflows-preview-mode_{context}"]
== Deploying workflows using the Preview profile

You can deploy your local workflow on {ocp-product-title} using the Preview profile. This allows you to validate and test workflows in a production-like environment directly on the cluster. Preview profile is ideal for final testing and validation before moving workflows to production, as well as for quick iteration without directly managing the build pipeline. It also ensures that workflows will run smoothly in a production-like setting.

.Prerequisites

* You have an {ServerlessLogicOperatorName} installed on your cluster.
* You have access to an {ServerlessLogicProductName} project with the appropriate roles and permissions to create applications and other workloads in {ocp-product-title}.
* You have installed the OpenShift CLI `(oc)`.

To deploy a workflow in Preview profile, {ServerlessLogicOperatorName} uses the build system on {ocp-product-title}, which automatically creates the image for deploying your workflow.

The following sections explain how to build and deploy your workflow on a cluster using the {ServerlessLogicOperatorName} with a `SonataFlow` custom resource.

[id="serverless-logic-configuring-workflows-preview-mode_{context}"]
=== Configuring workflows in Preview profile

include::modules/serverless-logic-workflow-base-builder-image.adoc[leveloffset=+3]
include::modules/serverless-logic-workflow-base-builder-dockerfile.adoc[leveloffset=+3]
include::modules/serverless-logic-workflow-changing-resource-requirements.adoc[leveloffset=+3]
include::modules/serverless-logic-workflow-passing-arguments-internal-builder.adoc[leveloffset=+3]
include::modules/serverless-logic-workflow-env-variables-internal-builder.adoc[leveloffset=+3]
include::modules/serverless-logic-workflow-changing-base-builder-image.adoc[leveloffset=+3]
include::modules/serverless-logic-building-deploying-workflow-preview-mode.adoc[leveloffset=+2]
include::modules/serverless-logic-verifying-workflow-deployment-preview-mode.adoc[leveloffset=+2]
include::modules/serverless-logic-restarting-the-build-preview-mode.adoc[leveloffset=+2]

[id="serverless-logic-deploying-workflows-gitops-mode_{context}"]
== Deploying workflows using the GitOps profile

[IMPORTANT]
====
Use the GitOps profile only for production deployments.  
For development, rapid iteration, or testing, use the Dev or Preview profiles instead.
====

You can deploy your local workflow on {ocp-product-title} using the GitOps profile. The GitOps profile provides full control over the workflow container image by allowing you to build and manage the image externally, typically through a CI/CD pipeline such as ArgoCD or Tekton. When a container image is defined in the `SonataFlow` custom resource (CR), the Operator automatically assumes the GitOps profile is being used and it does not attempt to build or modify the image in any way.

.Prerequisites

* You have {ServerlessLogicOperatorName} installed on your cluster.
* You have access to a {ServerlessLogicProductName} project with the appropriate roles and permissions to create applications and other workloads in {ocp-product-title}.
* You have installed the OpenShift CLI `(oc)`.

.Procedure

. Specify your container image in your SonataFlow CR:
+
.Example SonataFlow CR with set GitOps profile
[source,yaml]
----
apiVersion: sonataflow.org/v1alpha08
kind: SonataFlow
metadata:
  annotations:
    sonataflow.org/profile: gitops
  name: workflow_name
spec:
  flow: <1>
#...
  podTemplate:
    container:
      image: your-registry/workflow_name:tag
#...
----
<1> The `flow` definition must match the workflow definition used during the build process. When you deploy your workflow using the GitOps profile, the Operator compares this definition with the workflow files embedded in the container image. If the definition and files do not match, the deployment fails.

. Apply your CR to deploy the workflow:
+
[source,terminal]
----
$ oc apply -f <filename>
----

include::modules/serverless-logic-editing-workflows.adoc[leveloffset=+1]
include::modules/serverless-logic-testing-workflows.adoc[leveloffset=+1]
include::modules/serverless-logic-troubleshooting-workflows.adoc[leveloffset=+1]
include::modules/serverless-logic-deleting-workflows.adoc[leveloffset=+1]







