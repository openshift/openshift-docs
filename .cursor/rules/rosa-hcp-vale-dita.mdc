---
description: ROSA HCP build - fix Vale DITA issues without breaking constraints
alwaysApply: true
---

# ROSA HCP Vale/DITA workflow (openshift-docs)

## Goal

Fix **Vale DITA** issues for the **ROSA HCP build output** by mapping `drupal-build/openshift-rosa-hcp/support/includes/*.adoc` back to the **real source** under `modules/` (and assemblies under `support/`).

## Workflow

- Run `./scripts/prow-smoke-test.sh --validate openshift-rosa-hcp`
- Then run `vs` from `drupal-build/openshift-rosa-hcp/support`
- For each `vs` line like `includes/foo.adoc`, fix **the source file** `modules/foo.adoc` (not the `drupal-build` copy).
- Re-run `vs` **only when explicitly told**.

## Hard constraints (do not break)

- Do **not** run `git pull`. Ever.
- Ignore `AsciiDocDITA.AssemblyContents` warnings (do **not** fix them).
- Do **not** change any `[NOTE]` blocks (don’t convert them, don’t rewrite their content/format).
- Do **not** change `.Example ...` titles (e.g. `.Example output`, `.Example usage`).
- When a procedure has a **single step** (top-level or nested), use `*` (not `.`) for that single list item.
- Keep changes **minimal and mechanical**; preserve meaning; avoid editorial rewrites.
- Ensure edited files end with a **newline**.

## Mapping rules (drupal-build → source)

- `drupal-build/openshift-rosa-hcp/support/includes/foo.adoc` → usually `modules/foo.adoc`
- `drupal-build/openshift-rosa-hcp/support/*.adoc` → `support/*.adoc`
- Always edit **source files in repo root**, not `drupal-build` outputs (even if a `drupal-build` file is open).

## Fix patterns (apply only when Vale flags them)

- **ShortDescription**: Add `[role="_abstract"]` to the **first real paragraph after the title** (not before `include::`).
- **AuthorLine** (often assemblies): Put `:context:` **immediately after the title** and **before** any `include::` lines (especially when `include::_attributes/...[]` appears before `:context:`).
- **RelatedLinks**: Under `[role="_additional-resources"]` / “Additional resources”, bullets must be **links only**.
  - Bad: `* For details ..., see xref:...`
  - Good: `* xref:...[]`
- **BlockTitle**: Block titles are only allowed for **examples/figures/tables**. Otherwise convert the title into a real section heading (`== Heading`) unless it is `.Example ...` (leave those).
- **CalloutList**: Remove callouts (`<1>`, `<.>`) from code blocks and replace with a `where:` description list after the block.
- **TaskStep / TaskContents / TaskTitle / TaskSection**:
  - Tasks must be a **single step list** and include `.Procedure` when missing.
  - If content is really a “mini reference” with multiple `==` sections and triggers `TaskSection`, either refactor into a real procedure **or** (if not a procedure) change `_mod-docs-content-type` accordingly (for example, `REFERENCE`) to eliminate “sections in tasks” errors.

## Reliability note

The container-based validate can fail with Podman permission errors on some systems; `vs` output is still the authoritative list of what to fix.
---
description: ROSA HCP build - fix Vale DITA issues without breaking constraints
alwaysApply: true
---

# ROSA HCP Vale/DITA workflow (openshift-docs)

## Goal

Fix **Vale DITA** issues for the **ROSA HCP build output** by mapping `drupal-build/openshift-rosa-hcp/support/includes/*.adoc` back to the **real source** under `modules/` (and assemblies under `support/`).

## Workflow

- Run `./scripts/prow-smoke-test.sh --validate openshift-rosa-hcp`
- Then run `vs` from `drupal-build/openshift-rosa-hcp/support`
- For each `vs` line like `includes/foo.adoc`, fix **the source file** `modules/foo.adoc` (not the `drupal-build` copy).
- Re-run `vs` **only when explicitly told**.

## Hard constraints (do not break)

- Do **not** run `git pull`. Ever.
- Ignore `AsciiDocDITA.AssemblyContents` warnings (do **not** fix them).
- Do **not** change any `[NOTE]` blocks (don’t convert them, don’t rewrite their content/format).
- Do **not** change `.Example ...` titles (e.g. `.Example output`, `.Example usage`).
- When a procedure has a **single step** (top-level or nested), use `*` (not `.`) for that single list item.
- Keep changes **minimal and mechanical**; preserve meaning; avoid editorial rewrites.
- Ensure edited files end with a **newline**.

## Mapping rules (drupal-build → source)

- `drupal-build/openshift-rosa-hcp/support/includes/foo.adoc` → usually `modules/foo.adoc`
- `drupal-build/openshift-rosa-hcp/support/*.adoc` → `support/*.adoc`
- Always edit **source files in repo root**, not `drupal-build` outputs (even if a `drupal-build` file is open).

## Fix patterns (apply only when Vale flags them)

- **ShortDescription**: Add `[role="_abstract"]` to the **first real paragraph after the title** (not before `include::`).
- **AuthorLine** (often assemblies): Put `:context:` **immediately after the title** and **before** any `include::` lines (especially when `include::_attributes/...[]` appears before `:context:`).
- **RelatedLinks**: Under `[role="_additional-resources"]` / “Additional resources”, bullets must be **links only**.
  - Bad: `* For details ..., see xref:...`
  - Good: `* xref:...[]`
- **BlockTitle**: Block titles are only allowed for **examples/figures/tables**. Otherwise convert the title into a real section heading (`== Heading`) unless it is `.Example ...` (leave those).
- **CalloutList**: Remove callouts (`<1>`, `<.>`) from code blocks and replace with a `where:` description list after the block.
- **TaskStep / TaskContents / TaskTitle / TaskSection**:
  - Tasks must be a **single step list** and include `.Procedure` when missing.
  - If content is really a “mini reference” with multiple `==` sections and triggers `TaskSection`, either refactor into a real procedure **or** (if not a procedure) change `_mod-docs-content-type` accordingly (for example, `REFERENCE`) to eliminate “sections in tasks” errors.

## Reliability note

The container-based validate can fail with Podman permission errors on some systems; `vs` output is still the authoritative list of what to fix.
