:_mod-docs-content-type: ASSEMBLY
include::_attributes/common-attributes.adoc[]

:context: aws-compute-edge-tasks-wavelength

// Context Variables for edge zones
:aws-service-name-full: AWS Wavelength
:aws-service-name-short: Wavelength Zones
:aws-service-name-single: Wavelength Zone
:zone-type: wavelength-zone

[id="aws-compute-edge-tasks-wavelength"]
= AWS Wavelength tasks

// ATTENTION: All the content from here must be shared between books:
// aws-compute-edge-tasks
// installing-aws-wavelength

ifeval::["{zone-type}" == "{aws-zone-type-local}"]
:aws-localzones:
:aws-doc-zone: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html#concepts-local-zones
endif::[]
ifeval::["{zone-type}" == "{aws-zone-type-wavelength}"]
:aws-wavelength:
:aws-doc-zone: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html#concepts-wavelength-zones
endif::[]

toc::[]

After installing {product-title} on Amazon Web Services (AWS), you can further configure {aws-service-name-full} and an edge
compute pool, so that you can expand and customize your cluster to meet your needs.

// Extend existing clusters to use {aws-service-name-full}
include::modules/post-install-edge-aws-extend-cluster.adoc[leveloffset=+1]

// Additional Permissions for {aws-service-name-full}
include::modules/aws-edge-zones-permissions.adoc

[role="_additional-resources"]
.Additional resources

* For more information about {aws-service-name-full}, the supported instances types, and services,
ifdef::aws-localzones[]
  see link:https://aws.amazon.com/about-aws/global-infrastructure/localzones/features/[AWS Local Zones features]
endif::aws-localzones[]
ifdef::aws-wavelength[]
  see link:https://aws.amazon.com/wavelength/features[{aws-service-name-full} features]
endif::aws-wavelength[]
  in the AWS documentation.

// About the Edge Compute Pool
include::modules/edge-machine-pools-aws-local-zones.adoc[leveloffset=+2]

[id="post-install-extend-existing-to-local-zones-mtu"]
=== Changing the Cluster Network MTU to support {aws-service-name-full} subnets

You might need to change the maximum transmission unit (MTU) value for the cluster
network so that your cluster infrastructure can support communication between nodes
in the Region and in the {aws-service-name-single}.

// About the cluster MTU
include::modules/nw-cluster-mtu-change-about.adoc[leveloffset=+3]

// Changing the cluster MTU
include::modules/nw-cluster-mtu-change.adoc[leveloffset=+3]

// Opting in to {aws-service-name-full}
include::modules/installation-aws-add-local-zone-locations.adoc[leveloffset=+2]

// Creating network requirements in existing VPC to use {aws-service-name-full}
include::modules/post-install-existing-local-zone-subnet.adoc[leveloffset=+2]

==== Prerequisites

// Additional Permissions for {aws-service-name-full}
include::modules/aws-edge-zones-permissions.adoc[leveloffset=+0]

ifdef::aws-localzones[]
// Creating a subnet in {aws-service-name-full}
include::modules/installation-creating-aws-subnet-localzone.adoc[leveloffset=+3]

// CloudFormation template for the subnet that uses {aws-service-name-full}
include::modules/installation-cloudformation-subnet-localzone.adoc[leveloffset=+3]

endif::aws-localzones[]
ifdef::aws-wavelength[]

// Creating a Carrier Gateway in AWS VPC Carrier Gateway
include::modules/installation-creating-aws-vpc-carrier-gw.adoc[leveloffset=+3]

// CloudFormation template for the VPC Carrier Gateway
include::modules/installation-cloudformation-vpc-carrier-gw.adoc[leveloffset=+3]

// Creating the subnets in AWS {aws-service-name-full}
include::modules/installation-creating-aws-vpc-subnets.adoc[leveloffset=+3]

// CloudFormation template for the VPC Subnets
include::modules/installation-cloudformation-vpc-subnets.adoc[leveloffset=+3]

endif::aws-wavelength[]

// Creating a machine set manifest for {aws-service-name-full} node
include::modules/post-install-edge-aws-extend-machineset.adoc[leveloffset=+2]

// Sample YAML for a compute machine set custom resource on AWS
include::modules/machineset-yaml-aws.adoc[leveloffset=+3]

// Creating a compute machine set
include::modules/machineset-creating.adoc[leveloffset=+3]

[role="_additional-resources"]
.Additional resources

ifdef::aws-localzones[]
* xref:../installing/installing_aws/installing-aws-localzone.adoc#installing-aws-localzone[Installing a cluster on AWS with worker nodes on AWS Local Zones]
endif::aws-localzones[]
ifdef::aws-wavelength[]
* xref:../installing/installing_aws/installing-aws-wavelength.adoc#installing-aws-wavelength[Installing a cluster on AWS with worker nodes on {aws-service-name-full}]
endif::aws-wavelength[]

// Creating user workloads in {aws-service-name-full}
include::modules/installation-extend-edge-nodes-aws-local-zones.adoc[leveloffset=+1]

[role="_additional-resources"]
.Additional resources

ifdef::aws-localzones[]
* xref:../installing/installing_aws/installing-aws-localzone.adoc#installing-aws-localzone[Installing a cluster on AWS with worker nodes on AWS Local Zones]
endif::aws-localzones[]
ifdef::aws-wavelength[]
* xref:../installing/installing_aws/installing-aws-wavelength.adoc#installing-aws-wavelength[Installing a cluster on AWS with worker nodes on {aws-service-name-full}]
endif::aws-wavelength[]

* xref:../nodes/scheduling/nodes-scheduler-taints-tolerations.adoc#nodes-scheduler-taints-tolerations-about_nodes-scheduler-taints-tolerations[Understanding taints and tolerations]

.Next steps

* Optional: Use the AWS Load Balancer (ALB) Operator to expose a pod from a targeted edge worker node to services that run inside of a {aws-service-name-single} subnet from a public network.
See xref:../networking/aws_load_balancer_operator/install-aws-load-balancer-operator.adoc#nw-installing-aws-load-balancer-operator_aws-load-balancer-operator[Installing the AWS Load Balancer Operator].